import{a as Km,r as y,j as g,g as Jm,R as Ym}from"./vendor-CMFx7-E0.js";import{S as Xm,G as ea,P as Vt,M as ta,X as na,A as bs,T as Qm,C as ia,B as Zm,U as eg,a as ra,b as tg,c as ng,d as ig,e as rg,E as sg,f as Qo,g as og,F as lg,L as ag,h as cg,N as hg,i as ug,j as fg}from"./ui-DaN8Mjee.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var Iu,ac=Km;Iu=ac.createRoot,ac.hydrateRoot;var sa={};Object.defineProperty(sa,"__esModule",{value:!0});sa.parse=yg;sa.serialize=vg;const dg=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,pg=/^[\u0021-\u003A\u003C-\u007E]*$/,mg=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,gg=/^[\u0020-\u003A\u003D-\u007E]*$/,bg=Object.prototype.toString,xg=(()=>{const n=function(){};return n.prototype=Object.create(null),n})();function yg(n,e){const t=new xg,i=n.length;if(i<2)return t;const r=(e==null?void 0:e.decode)||wg;let s=0;do{const o=n.indexOf("=",s);if(o===-1)break;const l=n.indexOf(";",s),a=l===-1?i:l;if(o>a){s=n.lastIndexOf(";",o-1)+1;continue}const c=cc(n,s,o),h=hc(n,o,c),u=n.slice(c,h);if(t[u]===void 0){let f=cc(n,o+1,a),d=hc(n,a,f);const p=r(n.slice(f,d));t[u]=p}s=a+1}while(s<i);return t}function cc(n,e,t){do{const i=n.charCodeAt(e);if(i!==32&&i!==9)return e}while(++e<t);return t}function hc(n,e,t){for(;e>t;){const i=n.charCodeAt(--e);if(i!==32&&i!==9)return e+1}return t}function vg(n,e,t){const i=(t==null?void 0:t.encode)||encodeURIComponent;if(!dg.test(n))throw new TypeError(`argument name is invalid: ${n}`);const r=i(e);if(!pg.test(r))throw new TypeError(`argument val is invalid: ${e}`);let s=n+"="+r;if(!t)return s;if(t.maxAge!==void 0){if(!Number.isInteger(t.maxAge))throw new TypeError(`option maxAge is invalid: ${t.maxAge}`);s+="; Max-Age="+t.maxAge}if(t.domain){if(!mg.test(t.domain))throw new TypeError(`option domain is invalid: ${t.domain}`);s+="; Domain="+t.domain}if(t.path){if(!gg.test(t.path))throw new TypeError(`option path is invalid: ${t.path}`);s+="; Path="+t.path}if(t.expires){if(!Sg(t.expires)||!Number.isFinite(t.expires.valueOf()))throw new TypeError(`option expires is invalid: ${t.expires}`);s+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(s+="; HttpOnly"),t.secure&&(s+="; Secure"),t.partitioned&&(s+="; Partitioned"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():void 0){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${t.priority}`)}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:case"strict":s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"none":s+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${t.sameSite}`)}return s}function wg(n){if(n.indexOf("%")===-1)return n;try{return decodeURIComponent(n)}catch{return n}}function Sg(n){return bg.call(n)==="[object Date]"}var uc="popstate";function kg(n={}){function e(i,r){let{pathname:s,search:o,hash:l}=i.location;return Zo("",{pathname:s,search:o,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:Xi(r)}return Ag(e,t,null,n)}function Ae(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Ot(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Cg(){return Math.random().toString(36).substring(2,10)}function fc(n,e){return{usr:n.state,key:n.key,idx:e}}function Zo(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?vi(e):e,state:t,key:e&&e.key||i||Cg()}}function Xi({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function vi(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function Ag(n,e,t,i={}){let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,l="POP",a=null,c=h();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function h(){return(o.state||{idx:null}).idx}function u(){l="POP";let b=h(),x=b==null?null:b-c;c=b,a&&a({action:l,location:m.location,delta:x})}function f(b,x){l="PUSH";let v=Zo(m.location,b,x);c=h()+1;let w=fc(v,c),C=m.createHref(v);try{o.pushState(w,"",C)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;r.location.assign(C)}s&&a&&a({action:l,location:m.location,delta:1})}function d(b,x){l="REPLACE";let v=Zo(m.location,b,x);c=h();let w=fc(v,c),C=m.createHref(v);o.replaceState(w,"",C),s&&a&&a({action:l,location:m.location,delta:0})}function p(b){return Mg(b)}let m={get action(){return l},get location(){return n(r,o)},listen(b){if(a)throw new Error("A history only accepts one active listener");return r.addEventListener(uc,u),a=b,()=>{r.removeEventListener(uc,u),a=null}},createHref(b){return e(r,b)},createURL:p,encodeLocation(b){let x=p(b);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:d,go(b){return o.go(b)}};return m}function Mg(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Ae(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:Xi(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function Bu(n,e,t="/"){return Eg(n,e,t,!1)}function Eg(n,e,t,i){let r=typeof e=="string"?vi(e):e,s=Gt(r.pathname||"/",t);if(s==null)return null;let o=zu(n);Tg(o);let l=null;for(let a=0;l==null&&a<o.length;++a){let c=Hg(s);l=zg(o[a],c,i)}return l}function zu(n,e=[],t=[],i=""){let r=(s,o,l)=>{let a={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};a.relativePath.startsWith("/")&&(Ae(a.relativePath.startsWith(i),`Absolute route path "${a.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),a.relativePath=a.relativePath.slice(i.length));let c=qt([i,a.relativePath]),h=t.concat(a);s.children&&s.children.length>0&&(Ae(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),zu(s.children,e,h,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:Ig(c,s.index),routesMeta:h})};return n.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))r(s,o);else for(let a of ju(s.path))r(s,o,a)}),e}function ju(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=ju(i.join("/")),l=[];return l.push(...o.map(a=>a===""?s:[s,a].join("/"))),r&&l.push(...o),l.map(a=>n.startsWith("/")&&a===""?"/":a)}function Tg(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Bg(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var Rg=/^:[\w-]+$/,Dg=3,Ng=2,Og=1,Lg=10,Pg=-2,dc=n=>n==="*";function Ig(n,e){let t=n.split("/"),i=t.length;return t.some(dc)&&(i+=Pg),e&&(i+=Ng),t.filter(r=>!dc(r)).reduce((r,s)=>r+(Rg.test(s)?Dg:s===""?Og:Lg),i)}function Bg(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function zg(n,e,t=!1){let{routesMeta:i}=n,r={},s="/",o=[];for(let l=0;l<i.length;++l){let a=i[l],c=l===i.length-1,h=s==="/"?e:e.slice(s.length)||"/",u=xs({path:a.relativePath,caseSensitive:a.caseSensitive,end:c},h),f=a.route;if(!u&&c&&t&&!i[i.length-1].route.index&&(u=xs({path:a.relativePath,caseSensitive:a.caseSensitive,end:!1},h)),!u)return null;Object.assign(r,u.params),o.push({params:r,pathname:qt([s,u.pathname]),pathnameBase:_g(qt([s,u.pathnameBase])),route:f}),u.pathnameBase!=="/"&&(s=qt([s,u.pathnameBase]))}return o}function xs(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=jg(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:i.reduce((c,{paramName:h,isOptional:u},f)=>{if(h==="*"){let p=l[f]||"";o=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const d=l[f];return u&&!d?c[h]=void 0:c[h]=(d||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:n}}function jg(n,e=!1,t=!0){Ot(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,a)=>(i.push({paramName:l,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function Hg(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ot(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Gt(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function Fg(n,e="/"){let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?vi(n):n;return{pathname:t?t.startsWith("/")?t:Wg(t,e):e,search:Vg(i),hash:qg(r)}}function Wg(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function mo(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function $g(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Hu(n){let e=$g(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Fu(n,e,t,i=!1){let r;typeof n=="string"?r=vi(n):(r={...n},Ae(!r.pathname||!r.pathname.includes("?"),mo("?","pathname","search",r)),Ae(!r.pathname||!r.pathname.includes("#"),mo("#","pathname","hash",r)),Ae(!r.search||!r.search.includes("#"),mo("#","search","hash",r)));let s=n===""||r.pathname==="",o=s?"/":r.pathname,l;if(o==null)l=t;else{let u=e.length-1;if(!i&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),u-=1;r.pathname=f.join("/")}l=u>=0?e[u]:"/"}let a=Fg(r,l),c=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&t.endsWith("/");return!a.pathname.endsWith("/")&&(c||h)&&(a.pathname+="/"),a}var qt=n=>n.join("/").replace(/\/\/+/g,"/"),_g=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Vg=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,qg=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Ug(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var Wu=["POST","PUT","PATCH","DELETE"];new Set(Wu);var Gg=["GET",...Wu];new Set(Gg);var wi=y.createContext(null);wi.displayName="DataRouter";var _s=y.createContext(null);_s.displayName="DataRouterState";var $u=y.createContext({isTransitioning:!1});$u.displayName="ViewTransition";var Kg=y.createContext(new Map);Kg.displayName="Fetchers";var Jg=y.createContext(null);Jg.displayName="Await";var Pt=y.createContext(null);Pt.displayName="Navigation";var xr=y.createContext(null);xr.displayName="Location";var It=y.createContext({outlet:null,matches:[],isDataRoute:!1});It.displayName="Route";var oa=y.createContext(null);oa.displayName="RouteError";function Yg(n,{relative:e}={}){Ae(yr(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=y.useContext(Pt),{hash:r,pathname:s,search:o}=vr(n,{relative:e}),l=s;return t!=="/"&&(l=s==="/"?t:qt([t,s])),i.createHref({pathname:l,search:o,hash:r})}function yr(){return y.useContext(xr)!=null}function Wn(){return Ae(yr(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(xr).location}var _u="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Vu(n){y.useContext(Pt).static||y.useLayoutEffect(n)}function Vs(){let{isDataRoute:n}=y.useContext(It);return n?u0():Xg()}function Xg(){Ae(yr(),"useNavigate() may be used only in the context of a <Router> component.");let n=y.useContext(wi),{basename:e,navigator:t}=y.useContext(Pt),{matches:i}=y.useContext(It),{pathname:r}=Wn(),s=JSON.stringify(Hu(i)),o=y.useRef(!1);return Vu(()=>{o.current=!0}),y.useCallback((a,c={})=>{if(Ot(o.current,_u),!o.current)return;if(typeof a=="number"){t.go(a);return}let h=Fu(a,JSON.parse(s),r,c.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:qt([e,h.pathname])),(c.replace?t.replace:t.push)(h,c.state,c)},[e,t,s,r,n])}var Qg=y.createContext(null);function Zg(n){let e=y.useContext(It).outlet;return e&&y.createElement(Qg.Provider,{value:n},e)}function vr(n,{relative:e}={}){let{matches:t}=y.useContext(It),{pathname:i}=Wn(),r=JSON.stringify(Hu(t));return y.useMemo(()=>Fu(n,JSON.parse(r),i,e==="path"),[n,r,i,e])}function e0(n,e){return qu(n,e)}function qu(n,e,t,i){var x;Ae(yr(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=y.useContext(Pt),{matches:s}=y.useContext(It),o=s[s.length-1],l=o?o.params:{},a=o?o.pathname:"/",c=o?o.pathnameBase:"/",h=o&&o.route;{let v=h&&h.path||"";Uu(a,!h||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${a}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let u=Wn(),f;if(e){let v=typeof e=="string"?vi(e):e;Ae(c==="/"||((x=v.pathname)==null?void 0:x.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${v.pathname}" was given in the \`location\` prop.`),f=v}else f=u;let d=f.pathname||"/",p=d;if(c!=="/"){let v=c.replace(/^\//,"").split("/");p="/"+d.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=Bu(n,{pathname:p});Ot(h||m!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Ot(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=s0(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:qt([c,r.encodeLocation?r.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:qt([c,r.encodeLocation?r.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),s,t,i);return e&&b?y.createElement(xr.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},b):b}function t0(){let n=h0(),e=Ug(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=y.createElement(y.Fragment,null,y.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:s},"ErrorBoundary")," or"," ",y.createElement("code",{style:s},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),t?y.createElement("pre",{style:r},t):null,o)}var n0=y.createElement(t0,null),i0=class extends y.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?y.createElement(It.Provider,{value:this.props.routeContext},y.createElement(oa.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function r0({routeContext:n,match:e,children:t}){let i=y.useContext(wi);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),y.createElement(It.Provider,{value:n},t)}function s0(n,e=[],t=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let r=n,s=t==null?void 0:t.errors;if(s!=null){let a=r.findIndex(c=>c.route.id&&(s==null?void 0:s[c.route.id])!==void 0);Ae(a>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),r=r.slice(0,Math.min(r.length,a+1))}let o=!1,l=-1;if(t)for(let a=0;a<r.length;a++){let c=r[a];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(l=a),c.route.id){let{loaderData:h,errors:u}=t,f=c.route.loader&&!h.hasOwnProperty(c.route.id)&&(!u||u[c.route.id]===void 0);if(c.route.lazy||f){o=!0,l>=0?r=r.slice(0,l+1):r=[r[0]];break}}}return r.reduceRight((a,c,h)=>{let u,f=!1,d=null,p=null;t&&(u=s&&c.route.id?s[c.route.id]:void 0,d=c.route.errorElement||n0,o&&(l<0&&h===0?(Uu("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,p=null):l===h&&(f=!0,p=c.route.hydrateFallbackElement||null)));let m=e.concat(r.slice(0,h+1)),b=()=>{let x;return u?x=d:f?x=p:c.route.Component?x=y.createElement(c.route.Component,null):c.route.element?x=c.route.element:x=a,y.createElement(r0,{match:c,routeContext:{outlet:a,matches:m,isDataRoute:t!=null},children:x})};return t&&(c.route.ErrorBoundary||c.route.errorElement||h===0)?y.createElement(i0,{location:t.location,revalidation:t.revalidation,component:d,error:u,children:b(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):b()},null)}function la(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function o0(n){let e=y.useContext(wi);return Ae(e,la(n)),e}function l0(n){let e=y.useContext(_s);return Ae(e,la(n)),e}function a0(n){let e=y.useContext(It);return Ae(e,la(n)),e}function aa(n){let e=a0(n),t=e.matches[e.matches.length-1];return Ae(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function c0(){return aa("useRouteId")}function h0(){var i;let n=y.useContext(oa),e=l0("useRouteError"),t=aa("useRouteError");return n!==void 0?n:(i=e.errors)==null?void 0:i[t]}function u0(){let{router:n}=o0("useNavigate"),e=aa("useNavigate"),t=y.useRef(!1);return Vu(()=>{t.current=!0}),y.useCallback(async(r,s={})=>{Ot(t.current,_u),t.current&&(typeof r=="number"?n.navigate(r):await n.navigate(r,{fromRouteId:e,...s}))},[n,e])}var pc={};function Uu(n,e,t){!e&&!pc[n]&&(pc[n]=!0,Ot(!1,t))}y.memo(f0);function f0({routes:n,future:e,state:t}){return qu(n,void 0,t,e)}function d0(n){return Zg(n.context)}function Cn(n){Ae(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function p0({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:r,static:s=!1}){Ae(!yr(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),l=y.useMemo(()=>({basename:o,navigator:r,static:s,future:{}}),[o,r,s]);typeof t=="string"&&(t=vi(t));let{pathname:a="/",search:c="",hash:h="",state:u=null,key:f="default"}=t,d=y.useMemo(()=>{let p=Gt(a,o);return p==null?null:{location:{pathname:p,search:c,hash:h,state:u,key:f},navigationType:i}},[o,a,c,h,u,f,i]);return Ot(d!=null,`<Router basename="${o}"> is not able to match the URL "${a}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),d==null?null:y.createElement(Pt.Provider,{value:l},y.createElement(xr.Provider,{children:e,value:d}))}function m0({children:n,location:e}){return e0(el(n),e)}function el(n,e=[]){let t=[];return y.Children.forEach(n,(i,r)=>{if(!y.isValidElement(i))return;let s=[...e,r];if(i.type===y.Fragment){t.push.apply(t,el(i.props.children,s));return}Ae(i.type===Cn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ae(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=el(i.props.children,s)),t.push(o)}),t}var is="get",rs="application/x-www-form-urlencoded";function qs(n){return n!=null&&typeof n.tagName=="string"}function g0(n){return qs(n)&&n.tagName.toLowerCase()==="button"}function b0(n){return qs(n)&&n.tagName.toLowerCase()==="form"}function x0(n){return qs(n)&&n.tagName.toLowerCase()==="input"}function y0(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function v0(n,e){return n.button===0&&(!e||e==="_self")&&!y0(n)}var Rr=null;function w0(){if(Rr===null)try{new FormData(document.createElement("form"),0),Rr=!1}catch{Rr=!0}return Rr}var S0=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function go(n){return n!=null&&!S0.has(n)?(Ot(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${rs}"`),null):n}function k0(n,e){let t,i,r,s,o;if(b0(n)){let l=n.getAttribute("action");i=l?Gt(l,e):null,t=n.getAttribute("method")||is,r=go(n.getAttribute("enctype"))||rs,s=new FormData(n)}else if(g0(n)||x0(n)&&(n.type==="submit"||n.type==="image")){let l=n.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let a=n.getAttribute("formaction")||l.getAttribute("action");if(i=a?Gt(a,e):null,t=n.getAttribute("formmethod")||l.getAttribute("method")||is,r=go(n.getAttribute("formenctype"))||go(l.getAttribute("enctype"))||rs,s=new FormData(l,n),!w0()){let{name:c,type:h,value:u}=n;if(h==="image"){let f=c?`${c}.`:"";s.append(`${f}x`,"0"),s.append(`${f}y`,"0")}else c&&s.append(c,u)}}else{if(qs(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=is,i=null,r=rs,o=n}return s&&r==="text/plain"&&(o=s,s=void 0),{action:i,method:t.toLowerCase(),encType:r,formData:s,body:o}}function ca(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function C0(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function A0(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function M0(n,e,t){let i=await Promise.all(n.map(async r=>{let s=e.routes[r.route.id];if(s){let o=await C0(s,t);return o.links?o.links():[]}return[]}));return D0(i.flat(1).filter(A0).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function mc(n,e,t,i,r,s){let o=(a,c)=>t[c]?a.route.id!==t[c].route.id:!0,l=(a,c)=>{var h;return t[c].pathname!==a.pathname||((h=t[c].route.path)==null?void 0:h.endsWith("*"))&&t[c].params["*"]!==a.params["*"]};return s==="assets"?e.filter((a,c)=>o(a,c)||l(a,c)):s==="data"?e.filter((a,c)=>{var u;let h=i.routes[a.route.id];if(!h||!h.hasLoader)return!1;if(o(a,c)||l(a,c))return!0;if(a.route.shouldRevalidate){let f=a.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((u=t[0])==null?void 0:u.params)||{},nextUrl:new URL(n,window.origin),nextParams:a.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function E0(n,e,{includeHydrateFallback:t}={}){return T0(n.map(i=>{let r=e.routes[i.route.id];if(!r)return[];let s=[r.module];return r.clientActionModule&&(s=s.concat(r.clientActionModule)),r.clientLoaderModule&&(s=s.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(s=s.concat(r.hydrateFallbackModule)),r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function T0(n){return[...new Set(n)]}function R0(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function D0(n,e){let t=new Set;return new Set(e),n.reduce((i,r)=>{let s=JSON.stringify(R0(r));return t.has(s)||(t.add(s),i.push({key:s,link:r})),i},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var N0=new Set([100,101,204,205]);function O0(n,e){let t=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t.pathname==="/"?t.pathname="_root.data":e&&Gt(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function Gu(){let n=y.useContext(wi);return ca(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function L0(){let n=y.useContext(_s);return ca(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var ha=y.createContext(void 0);ha.displayName="FrameworkContext";function Ku(){let n=y.useContext(ha);return ca(n,"You must render this element inside a <HydratedRouter> element"),n}function P0(n,e){let t=y.useContext(ha),[i,r]=y.useState(!1),[s,o]=y.useState(!1),{onFocus:l,onBlur:a,onMouseEnter:c,onMouseLeave:h,onTouchStart:u}=e,f=y.useRef(null);y.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let m=x=>{x.forEach(v=>{o(v.isIntersecting)})},b=new IntersectionObserver(m,{threshold:.5});return f.current&&b.observe(f.current),()=>{b.disconnect()}}},[n]),y.useEffect(()=>{if(i){let m=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(m)}}},[i]);let d=()=>{r(!0)},p=()=>{r(!1),o(!1)};return t?n!=="intent"?[s,f,{}]:[s,f,{onFocus:Ti(l,d),onBlur:Ti(a,p),onMouseEnter:Ti(c,d),onMouseLeave:Ti(h,p),onTouchStart:Ti(u,d)}]:[!1,f,{}]}function Ti(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function I0({page:n,...e}){let{router:t}=Gu(),i=y.useMemo(()=>Bu(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?y.createElement(z0,{page:n,matches:i,...e}):null}function B0(n){let{manifest:e,routeModules:t}=Ku(),[i,r]=y.useState([]);return y.useEffect(()=>{let s=!1;return M0(n,e,t).then(o=>{s||r(o)}),()=>{s=!0}},[n,e,t]),i}function z0({page:n,matches:e,...t}){let i=Wn(),{manifest:r,routeModules:s}=Ku(),{basename:o}=Gu(),{loaderData:l,matches:a}=L0(),c=y.useMemo(()=>mc(n,e,a,r,i,"data"),[n,e,a,r,i]),h=y.useMemo(()=>mc(n,e,a,r,i,"assets"),[n,e,a,r,i]),u=y.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let p=new Set,m=!1;if(e.forEach(x=>{var w;let v=r.routes[x.route.id];!v||!v.hasLoader||(!c.some(C=>C.route.id===x.route.id)&&x.route.id in l&&((w=s[x.route.id])!=null&&w.shouldRevalidate)||v.hasClientLoader?m=!0:p.add(x.route.id))}),p.size===0)return[];let b=O0(n,o);return m&&p.size>0&&b.searchParams.set("_routes",e.filter(x=>p.has(x.route.id)).map(x=>x.route.id).join(",")),[b.pathname+b.search]},[o,l,i,r,c,e,n,s]),f=y.useMemo(()=>E0(h,r),[h,r]),d=B0(h);return y.createElement(y.Fragment,null,u.map(p=>y.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...t})),f.map(p=>y.createElement("link",{key:p,rel:"modulepreload",href:p,...t})),d.map(({key:p,link:m})=>y.createElement("link",{key:p,...m})))}function j0(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Ju=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Ju&&(window.__reactRouterVersion="7.6.2")}catch{}function H0({basename:n,children:e,window:t}){let i=y.useRef();i.current==null&&(i.current=kg({window:t,v5Compat:!0}));let r=i.current,[s,o]=y.useState({action:r.action,location:r.location}),l=y.useCallback(a=>{y.startTransition(()=>o(a))},[o]);return y.useLayoutEffect(()=>r.listen(l),[r,l]),y.createElement(p0,{basename:n,children:e,location:s.location,navigationType:s.action,navigator:r})}var Yu=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ci=y.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:r,reloadDocument:s,replace:o,state:l,target:a,to:c,preventScrollReset:h,viewTransition:u,...f},d){let{basename:p}=y.useContext(Pt),m=typeof c=="string"&&Yu.test(c),b,x=!1;if(typeof c=="string"&&m&&(b=c,Ju))try{let N=new URL(window.location.href),W=c.startsWith("//")?new URL(N.protocol+c):new URL(c),z=Gt(W.pathname,p);W.origin===N.origin&&z!=null?c=z+W.search+W.hash:x=!0}catch{Ot(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let v=Yg(c,{relative:r}),[w,C,S]=P0(i,f),M=$0(c,{replace:o,state:l,target:a,preventScrollReset:h,relative:r,viewTransition:u});function A(N){e&&e(N),N.defaultPrevented||M(N)}let O=y.createElement("a",{...f,...S,href:b||v,onClick:x||s?e:A,ref:j0(d,C),target:a,"data-discover":!m&&t==="render"?"true":void 0});return w&&!m?y.createElement(y.Fragment,null,O,y.createElement(I0,{page:v})):O});ci.displayName="Link";var Be=y.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:r=!1,style:s,to:o,viewTransition:l,children:a,...c},h){let u=vr(o,{relative:c.relative}),f=Wn(),d=y.useContext(_s),{navigator:p,basename:m}=y.useContext(Pt),b=d!=null&&G0(u)&&l===!0,x=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,v=f.pathname,w=d&&d.navigation&&d.navigation.location?d.navigation.location.pathname:null;t||(v=v.toLowerCase(),w=w?w.toLowerCase():null,x=x.toLowerCase()),w&&m&&(w=Gt(w,m)||w);const C=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let S=v===x||!r&&v.startsWith(x)&&v.charAt(C)==="/",M=w!=null&&(w===x||!r&&w.startsWith(x)&&w.charAt(x.length)==="/"),A={isActive:S,isPending:M,isTransitioning:b},O=S?e:void 0,N;typeof i=="function"?N=i(A):N=[i,S?"active":null,M?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let W=typeof s=="function"?s(A):s;return y.createElement(ci,{...c,"aria-current":O,className:N,ref:h,style:W,to:o,viewTransition:l},typeof a=="function"?a(A):a)});Be.displayName="NavLink";var F0=y.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:r,state:s,method:o=is,action:l,onSubmit:a,relative:c,preventScrollReset:h,viewTransition:u,...f},d)=>{let p=q0(),m=U0(l,{relative:c}),b=o.toLowerCase()==="get"?"get":"post",x=typeof l=="string"&&Yu.test(l),v=w=>{if(a&&a(w),w.defaultPrevented)return;w.preventDefault();let C=w.nativeEvent.submitter,S=(C==null?void 0:C.getAttribute("formmethod"))||o;p(C||w.currentTarget,{fetcherKey:e,method:S,navigate:t,replace:r,state:s,relative:c,preventScrollReset:h,viewTransition:u})};return y.createElement("form",{ref:d,method:b,action:m,onSubmit:i?a:v,...f,"data-discover":!x&&n==="render"?"true":void 0})});F0.displayName="Form";function W0(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Xu(n){let e=y.useContext(wi);return Ae(e,W0(n)),e}function $0(n,{target:e,replace:t,state:i,preventScrollReset:r,relative:s,viewTransition:o}={}){let l=Vs(),a=Wn(),c=vr(n,{relative:s});return y.useCallback(h=>{if(v0(h,e)){h.preventDefault();let u=t!==void 0?t:Xi(a)===Xi(c);l(n,{replace:u,state:i,preventScrollReset:r,relative:s,viewTransition:o})}},[a,l,c,t,i,e,n,r,s,o])}var _0=0,V0=()=>`__${String(++_0)}__`;function q0(){let{router:n}=Xu("useSubmit"),{basename:e}=y.useContext(Pt),t=c0();return y.useCallback(async(i,r={})=>{let{action:s,method:o,encType:l,formData:a,body:c}=k0(i,e);if(r.navigate===!1){let h=r.fetcherKey||V0();await n.fetch(h,t,r.action||s,{preventScrollReset:r.preventScrollReset,formData:a,body:c,formMethod:r.method||o,formEncType:r.encType||l,flushSync:r.flushSync})}else await n.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:a,body:c,formMethod:r.method||o,formEncType:r.encType||l,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[n,e,t])}function U0(n,{relative:e}={}){let{basename:t}=y.useContext(Pt),i=y.useContext(It);Ae(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),s={...vr(n||".",{relative:e})},o=Wn();if(n==null){s.search=o.search;let l=new URLSearchParams(s.search),a=l.getAll("index");if(a.some(h=>h==="")){l.delete("index"),a.filter(u=>u).forEach(u=>l.append("index",u));let h=l.toString();s.search=h?`?${h}`:""}}return(!n||n===".")&&r.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:qt([t,s.pathname])),Xi(s)}function G0(n,e={}){let t=y.useContext($u);Ae(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Xu("useViewTransitionState"),r=vr(n,{relative:e.relative});if(!t.isTransitioning)return!1;let s=Gt(t.currentLocation.pathname,i)||t.currentLocation.pathname,o=Gt(t.nextLocation.pathname,i)||t.nextLocation.pathname;return xs(r.pathname,o)!=null||xs(r.pathname,s)!=null}[...N0];function Qu(n){var e,t,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(e=0;e<r;e++)n[e]&&(t=Qu(n[e]))&&(i&&(i+=" "),i+=t)}else for(t in n)n[t]&&(i&&(i+=" "),i+=t);return i}function Zu(){for(var n,e,t=0,i="",r=arguments.length;t<r;t++)(n=arguments[t])&&(e=Qu(n))&&(i&&(i+=" "),i+=e);return i}const gc=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,bc=Zu,K0=(n,e)=>t=>{var i;if((e==null?void 0:e.variants)==null)return bc(n,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:r,defaultVariants:s}=e,o=Object.keys(r).map(c=>{const h=t==null?void 0:t[c],u=s==null?void 0:s[c];if(h===null)return null;const f=gc(h)||gc(u);return r[c][f]}),l=t&&Object.entries(t).reduce((c,h)=>{let[u,f]=h;return f===void 0||(c[u]=f),c},{}),a=e==null||(i=e.compoundVariants)===null||i===void 0?void 0:i.reduce((c,h)=>{let{class:u,className:f,...d}=h;return Object.entries(d).every(p=>{let[m,b]=p;return Array.isArray(b)?b.includes({...s,...l}[m]):{...s,...l}[m]===b})?[...c,u,f]:c},[]);return bc(n,o,a,t==null?void 0:t.class,t==null?void 0:t.className)},ua="-",J0=n=>{const e=X0(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:i}=n;return{getClassGroupId:o=>{const l=o.split(ua);return l[0]===""&&l.length!==1&&l.shift(),ef(l,e)||Y0(o)},getConflictingClassGroupIds:(o,l)=>{const a=t[o]||[];return l&&i[o]?[...a,...i[o]]:a}}},ef=(n,e)=>{var o;if(n.length===0)return e.classGroupId;const t=n[0],i=e.nextPart.get(t),r=i?ef(n.slice(1),i):void 0;if(r)return r;if(e.validators.length===0)return;const s=n.join(ua);return(o=e.validators.find(({validator:l})=>l(s)))==null?void 0:o.classGroupId},xc=/^\[(.+)\]$/,Y0=n=>{if(xc.test(n)){const e=xc.exec(n)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},X0=n=>{const{theme:e,prefix:t}=n,i={nextPart:new Map,validators:[]};return Z0(Object.entries(n.classGroups),t).forEach(([s,o])=>{tl(o,i,s,e)}),i},tl=(n,e,t,i)=>{n.forEach(r=>{if(typeof r=="string"){const s=r===""?e:yc(e,r);s.classGroupId=t;return}if(typeof r=="function"){if(Q0(r)){tl(r(i),e,t,i);return}e.validators.push({validator:r,classGroupId:t});return}Object.entries(r).forEach(([s,o])=>{tl(o,yc(e,s),t,i)})})},yc=(n,e)=>{let t=n;return e.split(ua).forEach(i=>{t.nextPart.has(i)||t.nextPart.set(i,{nextPart:new Map,validators:[]}),t=t.nextPart.get(i)}),t},Q0=n=>n.isThemeGetter,Z0=(n,e)=>e?n.map(([t,i])=>{const r=i.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,l])=>[e+o,l])):s);return[t,r]}):n,eb=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,i=new Map;const r=(s,o)=>{t.set(s,o),e++,e>n&&(e=0,i=t,t=new Map)};return{get(s){let o=t.get(s);if(o!==void 0)return o;if((o=i.get(s))!==void 0)return r(s,o),o},set(s,o){t.has(s)?t.set(s,o):r(s,o)}}},tf="!",tb=n=>{const{separator:e,experimentalParseClassName:t}=n,i=e.length===1,r=e[0],s=e.length,o=l=>{const a=[];let c=0,h=0,u;for(let b=0;b<l.length;b++){let x=l[b];if(c===0){if(x===r&&(i||l.slice(b,b+s)===e)){a.push(l.slice(h,b)),h=b+s;continue}if(x==="/"){u=b;continue}}x==="["?c++:x==="]"&&c--}const f=a.length===0?l:l.substring(h),d=f.startsWith(tf),p=d?f.substring(1):f,m=u&&u>h?u-h:void 0;return{modifiers:a,hasImportantModifier:d,baseClassName:p,maybePostfixModifierPosition:m}};return t?l=>t({className:l,parseClassName:o}):o},nb=n=>{if(n.length<=1)return n;const e=[];let t=[];return n.forEach(i=>{i[0]==="["?(e.push(...t.sort(),i),t=[]):t.push(i)}),e.push(...t.sort()),e},ib=n=>({cache:eb(n.cacheSize),parseClassName:tb(n),...J0(n)}),rb=/\s+/,sb=(n,e)=>{const{parseClassName:t,getClassGroupId:i,getConflictingClassGroupIds:r}=e,s=[],o=n.trim().split(rb);let l="";for(let a=o.length-1;a>=0;a-=1){const c=o[a],{modifiers:h,hasImportantModifier:u,baseClassName:f,maybePostfixModifierPosition:d}=t(c);let p=!!d,m=i(p?f.substring(0,d):f);if(!m){if(!p){l=c+(l.length>0?" "+l:l);continue}if(m=i(f),!m){l=c+(l.length>0?" "+l:l);continue}p=!1}const b=nb(h).join(":"),x=u?b+tf:b,v=x+m;if(s.includes(v))continue;s.push(v);const w=r(m,p);for(let C=0;C<w.length;++C){const S=w[C];s.push(x+S)}l=c+(l.length>0?" "+l:l)}return l};function ob(){let n=0,e,t,i="";for(;n<arguments.length;)(e=arguments[n++])&&(t=nf(e))&&(i&&(i+=" "),i+=t);return i}const nf=n=>{if(typeof n=="string")return n;let e,t="";for(let i=0;i<n.length;i++)n[i]&&(e=nf(n[i]))&&(t&&(t+=" "),t+=e);return t};function lb(n,...e){let t,i,r,s=o;function o(a){const c=e.reduce((h,u)=>u(h),n());return t=ib(c),i=t.cache.get,r=t.cache.set,s=l,l(a)}function l(a){const c=i(a);if(c)return c;const h=sb(a,t);return r(a,h),h}return function(){return s(ob.apply(null,arguments))}}const ve=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},rf=/^\[(?:([a-z-]+):)?(.+)\]$/i,ab=/^\d+\/\d+$/,cb=new Set(["px","full","screen"]),hb=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ub=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,fb=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,db=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,pb=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Wt=n=>ni(n)||cb.has(n)||ab.test(n),Zt=n=>Si(n,"length",Sb),ni=n=>!!n&&!Number.isNaN(Number(n)),bo=n=>Si(n,"number",ni),Ri=n=>!!n&&Number.isInteger(Number(n)),mb=n=>n.endsWith("%")&&ni(n.slice(0,-1)),ie=n=>rf.test(n),en=n=>hb.test(n),gb=new Set(["length","size","percentage"]),bb=n=>Si(n,gb,sf),xb=n=>Si(n,"position",sf),yb=new Set(["image","url"]),vb=n=>Si(n,yb,Cb),wb=n=>Si(n,"",kb),Di=()=>!0,Si=(n,e,t)=>{const i=rf.exec(n);return i?i[1]?typeof e=="string"?i[1]===e:e.has(i[1]):t(i[2]):!1},Sb=n=>ub.test(n)&&!fb.test(n),sf=()=>!1,kb=n=>db.test(n),Cb=n=>pb.test(n),Ab=()=>{const n=ve("colors"),e=ve("spacing"),t=ve("blur"),i=ve("brightness"),r=ve("borderColor"),s=ve("borderRadius"),o=ve("borderSpacing"),l=ve("borderWidth"),a=ve("contrast"),c=ve("grayscale"),h=ve("hueRotate"),u=ve("invert"),f=ve("gap"),d=ve("gradientColorStops"),p=ve("gradientColorStopPositions"),m=ve("inset"),b=ve("margin"),x=ve("opacity"),v=ve("padding"),w=ve("saturate"),C=ve("scale"),S=ve("sepia"),M=ve("skew"),A=ve("space"),O=ve("translate"),N=()=>["auto","contain","none"],W=()=>["auto","hidden","clip","visible","scroll"],z=()=>["auto",ie,e],R=()=>[ie,e],Q=()=>["",Wt,Zt],$=()=>["auto",ni,ie],J=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],E=()=>["solid","dashed","dotted","double","none"],D=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],_=()=>["start","end","center","between","around","evenly","stretch"],V=()=>["","0",ie],te=()=>["auto","avoid","all","avoid-page","page","left","right","column"],oe=()=>[ni,ie];return{cacheSize:500,separator:":",theme:{colors:[Di],spacing:[Wt,Zt],blur:["none","",en,ie],brightness:oe(),borderColor:[n],borderRadius:["none","","full",en,ie],borderSpacing:R(),borderWidth:Q(),contrast:oe(),grayscale:V(),hueRotate:oe(),invert:V(),gap:R(),gradientColorStops:[n],gradientColorStopPositions:[mb,Zt],inset:z(),margin:z(),opacity:oe(),padding:R(),saturate:oe(),scale:oe(),sepia:V(),skew:oe(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",ie]}],container:["container"],columns:[{columns:[en]}],"break-after":[{"break-after":te()}],"break-before":[{"break-before":te()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...J(),ie]}],overflow:[{overflow:W()}],"overflow-x":[{"overflow-x":W()}],"overflow-y":[{"overflow-y":W()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ri,ie]}],basis:[{basis:z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ie]}],grow:[{grow:V()}],shrink:[{shrink:V()}],order:[{order:["first","last","none",Ri,ie]}],"grid-cols":[{"grid-cols":[Di]}],"col-start-end":[{col:["auto",{span:["full",Ri,ie]},ie]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[Di]}],"row-start-end":[{row:["auto",{span:[Ri,ie]},ie]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ie]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ie]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",..._()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",..._(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[..._(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[A]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[A]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ie,e]}],"min-w":[{"min-w":[ie,e,"min","max","fit"]}],"max-w":[{"max-w":[ie,e,"none","full","min","max","fit","prose",{screen:[en]},en]}],h:[{h:[ie,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ie,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ie,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ie,e,"auto","min","max","fit"]}],"font-size":[{text:["base",en,Zt]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",bo]}],"font-family":[{font:[Di]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ie]}],"line-clamp":[{"line-clamp":["none",ni,bo]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Wt,ie]}],"list-image":[{"list-image":["none",ie]}],"list-style-type":[{list:["none","disc","decimal",ie]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...E(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Wt,Zt]}],"underline-offset":[{"underline-offset":["auto",Wt,ie]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ie]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ie]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...J(),xb]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",bb]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},vb]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[d]}],"gradient-via":[{via:[d]}],"gradient-to":[{to:[d]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...E(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:E()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...E()]}],"outline-offset":[{"outline-offset":[Wt,ie]}],"outline-w":[{outline:[Wt,Zt]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:Q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Wt,Zt]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",en,wb]}],"shadow-color":[{shadow:[Di]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...D(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":D()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[i]}],contrast:[{contrast:[a]}],"drop-shadow":[{"drop-shadow":["","none",en,ie]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[u]}],saturate:[{saturate:[w]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[a]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ie]}],duration:[{duration:oe()}],ease:[{ease:["linear","in","out","in-out",ie]}],delay:[{delay:oe()}],animate:[{animate:["none","spin","ping","pulse","bounce",ie]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[Ri,ie]}],"translate-x":[{"translate-x":[O]}],"translate-y":[{"translate-y":[O]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ie]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ie]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ie]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[Wt,Zt,bo]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Mb=lb(Ab);function Xt(...n){return Mb(Zu(n))}const Eb=K0("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),fe=y.forwardRef(({className:n,variant:e,size:t,asChild:i=!1,...r},s)=>{const o=i?Xm:"button";return g.jsx(o,{className:Xt(Eb({variant:e,size:t,className:n})),ref:s,...r})});fe.displayName="Button";const Us=y.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:Xt("rounded-lg border bg-card text-card-foreground shadow-sm",n),...e}));Us.displayName="Card";const fa=y.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:Xt("flex flex-col space-y-1.5 p-6",n),...e}));fa.displayName="CardHeader";const da=y.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:Xt("text-2xl font-semibold leading-none tracking-tight",n),...e}));da.displayName="CardTitle";const pa=y.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:Xt("text-sm text-muted-foreground",n),...e}));pa.displayName="CardDescription";const Gs=y.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:Xt("p-6 pt-0",n),...e}));Gs.displayName="CardContent";const Tb=y.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:Xt("flex items-center p-6 pt-0",n),...e}));Tb.displayName="CardFooter";function of(n){return n instanceof Map?n.clear=n.delete=n.set=function(){throw new Error("map is read-only")}:n instanceof Set&&(n.add=n.clear=n.delete=function(){throw new Error("set is read-only")}),Object.freeze(n),Object.getOwnPropertyNames(n).forEach(e=>{const t=n[e],i=typeof t;(i==="object"||i==="function")&&!Object.isFrozen(t)&&of(t)}),n}class vc{constructor(e){e.data===void 0&&(e.data={}),this.data=e.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function lf(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function on(n,...e){const t=Object.create(null);for(const i in n)t[i]=n[i];return e.forEach(function(i){for(const r in i)t[r]=i[r]}),t}const Rb="</span>",wc=n=>!!n.scope,Db=(n,{prefix:e})=>{if(n.startsWith("language:"))return n.replace("language:","language-");if(n.includes(".")){const t=n.split(".");return[`${e}${t.shift()}`,...t.map((i,r)=>`${i}${"_".repeat(r+1)}`)].join(" ")}return`${e}${n}`};class Nb{constructor(e,t){this.buffer="",this.classPrefix=t.classPrefix,e.walk(this)}addText(e){this.buffer+=lf(e)}openNode(e){if(!wc(e))return;const t=Db(e.scope,{prefix:this.classPrefix});this.span(t)}closeNode(e){wc(e)&&(this.buffer+=Rb)}value(){return this.buffer}span(e){this.buffer+=`<span class="${e}">`}}const Sc=(n={})=>{const e={children:[]};return Object.assign(e,n),e};class ma{constructor(){this.rootNode=Sc(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(e){this.top.children.push(e)}openNode(e){const t=Sc({scope:e});this.add(t),this.stack.push(t)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(e){return this.constructor._walk(e,this.rootNode)}static _walk(e,t){return typeof t=="string"?e.addText(t):t.children&&(e.openNode(t),t.children.forEach(i=>this._walk(e,i)),e.closeNode(t)),e}static _collapse(e){typeof e!="string"&&e.children&&(e.children.every(t=>typeof t=="string")?e.children=[e.children.join("")]:e.children.forEach(t=>{ma._collapse(t)}))}}class Ob extends ma{constructor(e){super(),this.options=e}addText(e){e!==""&&this.add(e)}startScope(e){this.openNode(e)}endScope(){this.closeNode()}__addSublanguage(e,t){const i=e.root;t&&(i.scope=`language:${t}`),this.add(i)}toHTML(){return new Nb(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function Qi(n){return n?typeof n=="string"?n:n.source:null}function af(n){return $n("(?=",n,")")}function Lb(n){return $n("(?:",n,")*")}function Pb(n){return $n("(?:",n,")?")}function $n(...n){return n.map(t=>Qi(t)).join("")}function Ib(n){const e=n[n.length-1];return typeof e=="object"&&e.constructor===Object?(n.splice(n.length-1,1),e):{}}function ga(...n){return"("+(Ib(n).capture?"":"?:")+n.map(i=>Qi(i)).join("|")+")"}function cf(n){return new RegExp(n.toString()+"|").exec("").length-1}function Bb(n,e){const t=n&&n.exec(e);return t&&t.index===0}const zb=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function ba(n,{joinWith:e}){let t=0;return n.map(i=>{t+=1;const r=t;let s=Qi(i),o="";for(;s.length>0;){const l=zb.exec(s);if(!l){o+=s;break}o+=s.substring(0,l.index),s=s.substring(l.index+l[0].length),l[0][0]==="\\"&&l[1]?o+="\\"+String(Number(l[1])+r):(o+=l[0],l[0]==="("&&t++)}return o}).map(i=>`(${i})`).join(e)}const jb=/\b\B/,hf="[a-zA-Z]\\w*",xa="[a-zA-Z_]\\w*",uf="\\b\\d+(\\.\\d+)?",ff="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",df="\\b(0b[01]+)",Hb="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",Fb=(n={})=>{const e=/^#![ ]*\//;return n.binary&&(n.begin=$n(e,/.*\b/,n.binary,/\b.*/)),on({scope:"meta",begin:e,end:/$/,relevance:0,"on:begin":(t,i)=>{t.index!==0&&i.ignoreMatch()}},n)},Zi={begin:"\\\\[\\s\\S]",relevance:0},Wb={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Zi]},$b={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Zi]},_b={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},Ks=function(n,e,t={}){const i=on({scope:"comment",begin:n,end:e,contains:[]},t);i.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const r=ga("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return i.contains.push({begin:$n(/[ ]+/,"(",r,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),i},Vb=Ks("//","$"),qb=Ks("/\\*","\\*/"),Ub=Ks("#","$"),Gb={scope:"number",begin:uf,relevance:0},Kb={scope:"number",begin:ff,relevance:0},Jb={scope:"number",begin:df,relevance:0},Yb={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[Zi,{begin:/\[/,end:/\]/,relevance:0,contains:[Zi]}]},Xb={scope:"title",begin:hf,relevance:0},Qb={scope:"title",begin:xa,relevance:0},Zb={begin:"\\.\\s*"+xa,relevance:0},ex=function(n){return Object.assign(n,{"on:begin":(e,t)=>{t.data._beginMatch=e[1]},"on:end":(e,t)=>{t.data._beginMatch!==e[1]&&t.ignoreMatch()}})};var Dr=Object.freeze({__proto__:null,APOS_STRING_MODE:Wb,BACKSLASH_ESCAPE:Zi,BINARY_NUMBER_MODE:Jb,BINARY_NUMBER_RE:df,COMMENT:Ks,C_BLOCK_COMMENT_MODE:qb,C_LINE_COMMENT_MODE:Vb,C_NUMBER_MODE:Kb,C_NUMBER_RE:ff,END_SAME_AS_BEGIN:ex,HASH_COMMENT_MODE:Ub,IDENT_RE:hf,MATCH_NOTHING_RE:jb,METHOD_GUARD:Zb,NUMBER_MODE:Gb,NUMBER_RE:uf,PHRASAL_WORDS_MODE:_b,QUOTE_STRING_MODE:$b,REGEXP_MODE:Yb,RE_STARTERS_RE:Hb,SHEBANG:Fb,TITLE_MODE:Xb,UNDERSCORE_IDENT_RE:xa,UNDERSCORE_TITLE_MODE:Qb});function tx(n,e){n.input[n.index-1]==="."&&e.ignoreMatch()}function nx(n,e){n.className!==void 0&&(n.scope=n.className,delete n.className)}function ix(n,e){e&&n.beginKeywords&&(n.begin="\\b("+n.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",n.__beforeBegin=tx,n.keywords=n.keywords||n.beginKeywords,delete n.beginKeywords,n.relevance===void 0&&(n.relevance=0))}function rx(n,e){Array.isArray(n.illegal)&&(n.illegal=ga(...n.illegal))}function sx(n,e){if(n.match){if(n.begin||n.end)throw new Error("begin & end are not supported with match");n.begin=n.match,delete n.match}}function ox(n,e){n.relevance===void 0&&(n.relevance=1)}const lx=(n,e)=>{if(!n.beforeMatch)return;if(n.starts)throw new Error("beforeMatch cannot be used with starts");const t=Object.assign({},n);Object.keys(n).forEach(i=>{delete n[i]}),n.keywords=t.keywords,n.begin=$n(t.beforeMatch,af(t.begin)),n.starts={relevance:0,contains:[Object.assign(t,{endsParent:!0})]},n.relevance=0,delete t.beforeMatch},ax=["of","and","for","in","not","or","if","then","parent","list","value"],cx="keyword";function pf(n,e,t=cx){const i=Object.create(null);return typeof n=="string"?r(t,n.split(" ")):Array.isArray(n)?r(t,n):Object.keys(n).forEach(function(s){Object.assign(i,pf(n[s],e,s))}),i;function r(s,o){e&&(o=o.map(l=>l.toLowerCase())),o.forEach(function(l){const a=l.split("|");i[a[0]]=[s,hx(a[0],a[1])]})}}function hx(n,e){return e?Number(e):ux(n)?0:1}function ux(n){return ax.includes(n.toLowerCase())}const kc={},Dn=n=>{console.error(n)},Cc=(n,...e)=>{console.log(`WARN: ${n}`,...e)},Vn=(n,e)=>{kc[`${n}/${e}`]||(console.log(`Deprecated as of ${n}. ${e}`),kc[`${n}/${e}`]=!0)},ys=new Error;function mf(n,e,{key:t}){let i=0;const r=n[t],s={},o={};for(let l=1;l<=e.length;l++)o[l+i]=r[l],s[l+i]=!0,i+=cf(e[l-1]);n[t]=o,n[t]._emit=s,n[t]._multi=!0}function fx(n){if(Array.isArray(n.begin)){if(n.skip||n.excludeBegin||n.returnBegin)throw Dn("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),ys;if(typeof n.beginScope!="object"||n.beginScope===null)throw Dn("beginScope must be object"),ys;mf(n,n.begin,{key:"beginScope"}),n.begin=ba(n.begin,{joinWith:""})}}function dx(n){if(Array.isArray(n.end)){if(n.skip||n.excludeEnd||n.returnEnd)throw Dn("skip, excludeEnd, returnEnd not compatible with endScope: {}"),ys;if(typeof n.endScope!="object"||n.endScope===null)throw Dn("endScope must be object"),ys;mf(n,n.end,{key:"endScope"}),n.end=ba(n.end,{joinWith:""})}}function px(n){n.scope&&typeof n.scope=="object"&&n.scope!==null&&(n.beginScope=n.scope,delete n.scope)}function mx(n){px(n),typeof n.beginScope=="string"&&(n.beginScope={_wrap:n.beginScope}),typeof n.endScope=="string"&&(n.endScope={_wrap:n.endScope}),fx(n),dx(n)}function gx(n){function e(o,l){return new RegExp(Qi(o),"m"+(n.case_insensitive?"i":"")+(n.unicodeRegex?"u":"")+(l?"g":""))}class t{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(l,a){a.position=this.position++,this.matchIndexes[this.matchAt]=a,this.regexes.push([a,l]),this.matchAt+=cf(l)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const l=this.regexes.map(a=>a[1]);this.matcherRe=e(ba(l,{joinWith:"|"}),!0),this.lastIndex=0}exec(l){this.matcherRe.lastIndex=this.lastIndex;const a=this.matcherRe.exec(l);if(!a)return null;const c=a.findIndex((u,f)=>f>0&&u!==void 0),h=this.matchIndexes[c];return a.splice(0,c),Object.assign(a,h)}}class i{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(l){if(this.multiRegexes[l])return this.multiRegexes[l];const a=new t;return this.rules.slice(l).forEach(([c,h])=>a.addRule(c,h)),a.compile(),this.multiRegexes[l]=a,a}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(l,a){this.rules.push([l,a]),a.type==="begin"&&this.count++}exec(l){const a=this.getMatcher(this.regexIndex);a.lastIndex=this.lastIndex;let c=a.exec(l);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const h=this.getMatcher(0);h.lastIndex=this.lastIndex+1,c=h.exec(l)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function r(o){const l=new i;return o.contains.forEach(a=>l.addRule(a.begin,{rule:a,type:"begin"})),o.terminatorEnd&&l.addRule(o.terminatorEnd,{type:"end"}),o.illegal&&l.addRule(o.illegal,{type:"illegal"}),l}function s(o,l){const a=o;if(o.isCompiled)return a;[nx,sx,mx,lx].forEach(h=>h(o,l)),n.compilerExtensions.forEach(h=>h(o,l)),o.__beforeBegin=null,[ix,rx,ox].forEach(h=>h(o,l)),o.isCompiled=!0;let c=null;return typeof o.keywords=="object"&&o.keywords.$pattern&&(o.keywords=Object.assign({},o.keywords),c=o.keywords.$pattern,delete o.keywords.$pattern),c=c||/\w+/,o.keywords&&(o.keywords=pf(o.keywords,n.case_insensitive)),a.keywordPatternRe=e(c,!0),l&&(o.begin||(o.begin=/\B|\b/),a.beginRe=e(a.begin),!o.end&&!o.endsWithParent&&(o.end=/\B|\b/),o.end&&(a.endRe=e(a.end)),a.terminatorEnd=Qi(a.end)||"",o.endsWithParent&&l.terminatorEnd&&(a.terminatorEnd+=(o.end?"|":"")+l.terminatorEnd)),o.illegal&&(a.illegalRe=e(o.illegal)),o.contains||(o.contains=[]),o.contains=[].concat(...o.contains.map(function(h){return bx(h==="self"?o:h)})),o.contains.forEach(function(h){s(h,a)}),o.starts&&s(o.starts,l),a.matcher=r(a),a}if(n.compilerExtensions||(n.compilerExtensions=[]),n.contains&&n.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return n.classNameAliases=on(n.classNameAliases||{}),s(n)}function gf(n){return n?n.endsWithParent||gf(n.starts):!1}function bx(n){return n.variants&&!n.cachedVariants&&(n.cachedVariants=n.variants.map(function(e){return on(n,{variants:null},e)})),n.cachedVariants?n.cachedVariants:gf(n)?on(n,{starts:n.starts?on(n.starts):null}):Object.isFrozen(n)?on(n):n}var xx="11.11.1";class yx extends Error{constructor(e,t){super(e),this.name="HTMLInjectionError",this.html=t}}const xo=lf,Ac=on,Mc=Symbol("nomatch"),vx=7,bf=function(n){const e=Object.create(null),t=Object.create(null),i=[];let r=!0;const s="Could not find the language '{}', did you forget to load/include a language module?",o={disableAutodetect:!0,name:"Plain text",contains:[]};let l={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:Ob};function a(E){return l.noHighlightRe.test(E)}function c(E){let D=E.className+" ";D+=E.parentNode?E.parentNode.className:"";const _=l.languageDetectRe.exec(D);if(_){const V=O(_[1]);return V||(Cc(s.replace("{}",_[1])),Cc("Falling back to no-highlight mode for this block.",E)),V?_[1]:"no-highlight"}return D.split(/\s+/).find(V=>a(V)||O(V))}function h(E,D,_){let V="",te="";typeof D=="object"?(V=E,_=D.ignoreIllegals,te=D.language):(Vn("10.7.0","highlight(lang, code, ...args) has been deprecated."),Vn("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),te=E,V=D),_===void 0&&(_=!0);const oe={code:V,language:te};$("before:highlight",oe);const me=oe.result?oe.result:u(oe.language,oe.code,_);return me.code=oe.code,$("after:highlight",me),me}function u(E,D,_,V){const te=Object.create(null);function oe(I,K){return I.keywords[K]}function me(){if(!U.keywords){Ne.addText(ue);return}let I=0;U.keywordPatternRe.lastIndex=0;let K=U.keywordPatternRe.exec(ue),se="";for(;K;){se+=ue.substring(I,K.index);const pe=We.case_insensitive?K[0].toLowerCase():K[0],$e=oe(U,pe);if($e){const[Ft,Um]=$e;if(Ne.addText(se),se="",te[pe]=(te[pe]||0)+1,te[pe]<=vx&&(vn+=Um),Ft.startsWith("_"))se+=K[0];else{const Gm=We.classNameAliases[Ft]||Ft;G(K[0],Gm)}}else se+=K[0];I=U.keywordPatternRe.lastIndex,K=U.keywordPatternRe.exec(ue)}se+=ue.substring(I),Ne.addText(se)}function P(){if(ue==="")return;let I=null;if(typeof U.subLanguage=="string"){if(!e[U.subLanguage]){Ne.addText(ue);return}I=u(U.subLanguage,ue,!0,Ei[U.subLanguage]),Ei[U.subLanguage]=I._top}else I=d(ue,U.subLanguage.length?U.subLanguage:null);U.relevance>0&&(vn+=I.relevance),Ne.__addSublanguage(I._emitter,I.language)}function F(){U.subLanguage!=null?P():me(),ue=""}function G(I,K){I!==""&&(Ne.startScope(K),Ne.addText(I),Ne.endScope())}function X(I,K){let se=1;const pe=K.length-1;for(;se<=pe;){if(!I._emit[se]){se++;continue}const $e=We.classNameAliases[I[se]]||I[se],Ft=K[se];$e?G(Ft,$e):(ue=Ft,me(),ue=""),se++}}function q(I,K){return I.scope&&typeof I.scope=="string"&&Ne.openNode(We.classNameAliases[I.scope]||I.scope),I.beginScope&&(I.beginScope._wrap?(G(ue,We.classNameAliases[I.beginScope._wrap]||I.beginScope._wrap),ue=""):I.beginScope._multi&&(X(I.beginScope,K),ue="")),U=Object.create(I,{parent:{value:U}}),U}function ee(I,K,se){let pe=Bb(I.endRe,se);if(pe){if(I["on:end"]){const $e=new vc(I);I["on:end"](K,$e),$e.isMatchIgnored&&(pe=!1)}if(pe){for(;I.endsParent&&I.parent;)I=I.parent;return I}}if(I.endsWithParent)return ee(I.parent,K,se)}function de(I){return U.matcher.regexIndex===0?(ue+=I[0],1):(po=!0,0)}function Me(I){const K=I[0],se=I.rule,pe=new vc(se),$e=[se.__beforeBegin,se["on:begin"]];for(const Ft of $e)if(Ft&&(Ft(I,pe),pe.isMatchIgnored))return de(K);return se.skip?ue+=K:(se.excludeBegin&&(ue+=K),F(),!se.returnBegin&&!se.excludeBegin&&(ue=K)),q(se,I),se.returnBegin?0:K.length}function lt(I){const K=I[0],se=D.substring(I.index),pe=ee(U,I,se);if(!pe)return Mc;const $e=U;U.endScope&&U.endScope._wrap?(F(),G(K,U.endScope._wrap)):U.endScope&&U.endScope._multi?(F(),X(U.endScope,I)):$e.skip?ue+=K:($e.returnEnd||$e.excludeEnd||(ue+=K),F(),$e.excludeEnd&&(ue=K));do U.scope&&Ne.closeNode(),!U.skip&&!U.subLanguage&&(vn+=U.relevance),U=U.parent;while(U!==pe.parent);return pe.starts&&q(pe.starts,I),$e.returnEnd?0:K.length}function at(){const I=[];for(let K=U;K!==We;K=K.parent)K.scope&&I.unshift(K.scope);I.forEach(K=>Ne.openNode(K))}let ge={};function Ye(I,K){const se=K&&K[0];if(ue+=I,se==null)return F(),0;if(ge.type==="begin"&&K.type==="end"&&ge.index===K.index&&se===""){if(ue+=D.slice(K.index,K.index+1),!r){const pe=new Error(`0 width match regex (${E})`);throw pe.languageName=E,pe.badRule=ge.rule,pe}return 1}if(ge=K,K.type==="begin")return Me(K);if(K.type==="illegal"&&!_){const pe=new Error('Illegal lexeme "'+se+'" for mode "'+(U.scope||"<unnamed>")+'"');throw pe.mode=U,pe}else if(K.type==="end"){const pe=lt(K);if(pe!==Mc)return pe}if(K.type==="illegal"&&se==="")return ue+=`
`,1;if(fo>1e5&&fo>K.index*3)throw new Error("potential infinite loop, way more iterations than matches");return ue+=se,se.length}const We=O(E);if(!We)throw Dn(s.replace("{}",E)),new Error('Unknown language: "'+E+'"');const _n=gx(We);let yn="",U=V||_n;const Ei={},Ne=new l.__emitter(l);at();let ue="",vn=0,Ht=0,fo=0,po=!1;try{if(We.__emitTokens)We.__emitTokens(D,Ne);else{for(U.matcher.considerAll();;){fo++,po?po=!1:U.matcher.considerAll(),U.matcher.lastIndex=Ht;const I=U.matcher.exec(D);if(!I)break;const K=D.substring(Ht,I.index),se=Ye(K,I);Ht=I.index+se}Ye(D.substring(Ht))}return Ne.finalize(),yn=Ne.toHTML(),{language:E,value:yn,relevance:vn,illegal:!1,_emitter:Ne,_top:U}}catch(I){if(I.message&&I.message.includes("Illegal"))return{language:E,value:xo(D),illegal:!0,relevance:0,_illegalBy:{message:I.message,index:Ht,context:D.slice(Ht-100,Ht+100),mode:I.mode,resultSoFar:yn},_emitter:Ne};if(r)return{language:E,value:xo(D),illegal:!1,relevance:0,errorRaised:I,_emitter:Ne,_top:U};throw I}}function f(E){const D={value:xo(E),illegal:!1,relevance:0,_top:o,_emitter:new l.__emitter(l)};return D._emitter.addText(E),D}function d(E,D){D=D||l.languages||Object.keys(e);const _=f(E),V=D.filter(O).filter(W).map(F=>u(F,E,!1));V.unshift(_);const te=V.sort((F,G)=>{if(F.relevance!==G.relevance)return G.relevance-F.relevance;if(F.language&&G.language){if(O(F.language).supersetOf===G.language)return 1;if(O(G.language).supersetOf===F.language)return-1}return 0}),[oe,me]=te,P=oe;return P.secondBest=me,P}function p(E,D,_){const V=D&&t[D]||_;E.classList.add("hljs"),E.classList.add(`language-${V}`)}function m(E){let D=null;const _=c(E);if(a(_))return;if($("before:highlightElement",{el:E,language:_}),E.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",E);return}if(E.children.length>0&&(l.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(E)),l.throwUnescapedHTML))throw new yx("One of your code blocks includes unescaped HTML.",E.innerHTML);D=E;const V=D.textContent,te=_?h(V,{language:_,ignoreIllegals:!0}):d(V);E.innerHTML=te.value,E.dataset.highlighted="yes",p(E,_,te.language),E.result={language:te.language,re:te.relevance,relevance:te.relevance},te.secondBest&&(E.secondBest={language:te.secondBest.language,relevance:te.secondBest.relevance}),$("after:highlightElement",{el:E,result:te,text:V})}function b(E){l=Ac(l,E)}const x=()=>{C(),Vn("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function v(){C(),Vn("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let w=!1;function C(){function E(){C()}if(document.readyState==="loading"){w||window.addEventListener("DOMContentLoaded",E,!1),w=!0;return}document.querySelectorAll(l.cssSelector).forEach(m)}function S(E,D){let _=null;try{_=D(n)}catch(V){if(Dn("Language definition for '{}' could not be registered.".replace("{}",E)),r)Dn(V);else throw V;_=o}_.name||(_.name=E),e[E]=_,_.rawDefinition=D.bind(null,n),_.aliases&&N(_.aliases,{languageName:E})}function M(E){delete e[E];for(const D of Object.keys(t))t[D]===E&&delete t[D]}function A(){return Object.keys(e)}function O(E){return E=(E||"").toLowerCase(),e[E]||e[t[E]]}function N(E,{languageName:D}){typeof E=="string"&&(E=[E]),E.forEach(_=>{t[_.toLowerCase()]=D})}function W(E){const D=O(E);return D&&!D.disableAutodetect}function z(E){E["before:highlightBlock"]&&!E["before:highlightElement"]&&(E["before:highlightElement"]=D=>{E["before:highlightBlock"](Object.assign({block:D.el},D))}),E["after:highlightBlock"]&&!E["after:highlightElement"]&&(E["after:highlightElement"]=D=>{E["after:highlightBlock"](Object.assign({block:D.el},D))})}function R(E){z(E),i.push(E)}function Q(E){const D=i.indexOf(E);D!==-1&&i.splice(D,1)}function $(E,D){const _=E;i.forEach(function(V){V[_]&&V[_](D)})}function J(E){return Vn("10.7.0","highlightBlock will be removed entirely in v12.0"),Vn("10.7.0","Please use highlightElement now."),m(E)}Object.assign(n,{highlight:h,highlightAuto:d,highlightAll:C,highlightElement:m,highlightBlock:J,configure:b,initHighlighting:x,initHighlightingOnLoad:v,registerLanguage:S,unregisterLanguage:M,listLanguages:A,getLanguage:O,registerAliases:N,autoDetection:W,inherit:Ac,addPlugin:R,removePlugin:Q}),n.debugMode=function(){r=!1},n.safeMode=function(){r=!0},n.versionString=xx,n.regex={concat:$n,lookahead:af,either:ga,optional:Pb,anyNumberOfTimes:Lb};for(const E in Dr)typeof Dr[E]=="object"&&of(Dr[E]);return Object.assign(n,Dr),n},hi=bf({});hi.newInstance=()=>bf({});var wx=hi;hi.HighlightJS=hi;hi.default=hi;const xf=Jm(wx);function Sx(n){const e="[^\\(\\)\\[\\]\\{\\}\",'`;#|\\\\\\s]+",t="(-|\\+)?\\d+([./]\\d+)?",i=t+"[+\\-]"+t+"i",r={$pattern:e,built_in:"case-lambda call/cc class define-class exit-handler field import inherit init-field interface let*-values let-values let/ec mixin opt-lambda override protect provide public rename require require-for-syntax syntax syntax-case syntax-error unit/sig unless when with-syntax and begin call-with-current-continuation call-with-input-file call-with-output-file case cond define define-syntax delay do dynamic-wind else for-each if lambda let let* let-syntax letrec letrec-syntax map or syntax-rules ' * + , ,@ - ... / ; < <= = => > >= ` abs acos angle append apply asin assoc assq assv atan boolean? caar cadr call-with-input-file call-with-output-file call-with-values car cdddar cddddr cdr ceiling char->integer char-alphabetic? char-ci<=? char-ci<? char-ci=? char-ci>=? char-ci>? char-downcase char-lower-case? char-numeric? char-ready? char-upcase char-upper-case? char-whitespace? char<=? char<? char=? char>=? char>? char? close-input-port close-output-port complex? cons cos current-input-port current-output-port denominator display eof-object? eq? equal? eqv? eval even? exact->inexact exact? exp expt floor force gcd imag-part inexact->exact inexact? input-port? integer->char integer? interaction-environment lcm length list list->string list->vector list-ref list-tail list? load log magnitude make-polar make-rectangular make-string make-vector max member memq memv min modulo negative? newline not null-environment null? number->string number? numerator odd? open-input-file open-output-file output-port? pair? peek-char port? positive? procedure? quasiquote quote quotient rational? rationalize read read-char real-part real? remainder reverse round scheme-report-environment set! set-car! set-cdr! sin sqrt string string->list string->number string->symbol string-append string-ci<=? string-ci<? string-ci=? string-ci>=? string-ci>? string-copy string-fill! string-length string-ref string-set! string<=? string<? string=? string>=? string>? string? substring symbol->string symbol? tan transcript-off transcript-on truncate values vector vector->list vector-fill! vector-length vector-ref vector-set! with-input-from-file with-output-to-file write write-char zero?"},s={className:"literal",begin:"(#t|#f|#\\\\"+e+"|#\\\\.)"},o={className:"number",variants:[{begin:t,relevance:0},{begin:i,relevance:0},{begin:"#b[0-1]+(/[0-1]+)?"},{begin:"#o[0-7]+(/[0-7]+)?"},{begin:"#x[0-9a-f]+(/[0-9a-f]+)?"}]},l=n.QUOTE_STRING_MODE,a=[n.COMMENT(";","$",{relevance:0}),n.COMMENT("#\\|","\\|#")],c={begin:e,relevance:0},h={className:"symbol",begin:"'"+e},u={endsWithParent:!0,relevance:0},f={variants:[{begin:/'/},{begin:"`"}],contains:[{begin:"\\(",end:"\\)",contains:["self",s,l,o,c,h]}]},d={className:"name",relevance:0,begin:e,keywords:r},m={variants:[{begin:"\\(",end:"\\)"},{begin:"\\[",end:"\\]"}],contains:[{begin:/lambda/,endsWithParent:!0,returnBegin:!0,contains:[d,{endsParent:!0,variants:[{begin:/\(/,end:/\)/},{begin:/\[/,end:/\]/}],contains:[c]}]},d,u]};return u.contains=[s,o,l,c,h,f,m].concat(a),{name:"Scheme",aliases:["scm"],illegal:/\S/,contains:[n.SHEBANG(),o,l,h,f,m].concat(a)}}xf.registerLanguage("scheme",Sx);const ct=({text:n,type:e})=>{const t=y.useRef(null),i=y.useRef(!1),r=y.useCallback(()=>{if(t.current&&!i.current&&(e==="input"||e==="output"))try{xf.highlightElement(t.current),i.current=!0}catch(o){console.error("Highlighting failed:",o)}},[e]);if(y.useEffect(()=>(i.current=!1,r(),()=>{i.current=!1}),[n,r]),e==="system")return g.jsx("pre",{className:"text-teal-400 font-mono text-sm",children:n});const s=e==="output"?"text-green-400":"text-zinc-200";return g.jsx("pre",{ref:t,className:`hljs language-scheme font-mono text-sm whitespace-pre-wrap ${s}`,style:{background:"transparent"},children:n})};function kx({code:n,className:e=""}){return g.jsx("div",{className:`font-mono text-sm space-y-2 code-font ${e}`,children:n.map((t,i)=>g.jsxs("div",{className:"flex items-start gap-2",children:[t.type==="input"?g.jsx("span",{className:"text-cyan-400 shrink-0 select-none",children:"Î»"}):g.jsx("span",{className:"ml-4"}),g.jsx("div",{className:"flex-1 group",children:g.jsx(ct,{text:t.content,type:t.type})})]},i))})}function yf(){return g.jsx("footer",{className:"py-6 bg-slate-900 text-white",children:g.jsx("div",{className:"container mx-auto px-4",children:g.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[g.jsxs("div",{className:"text-sm text-slate-300",children:["Dissertation by Jamie Wales Â© ",new Date().getFullYear()]}),g.jsx("div",{className:"flex items-center gap-6",children:g.jsx("a",{href:"https://github.com/jamie-wales/jaws",target:"_blank",rel:"noopener noreferrer",className:"text-slate-300 hover:text-white transition-colors",children:g.jsx(ea,{className:"h-5 w-5"})})})]})})})}function Cx(){const n=Vs(),[e,t]=y.useState(!1),i=[{type:"input",content:`(define greet
  (lambda (name)
    (string-append
      "Hello, "
      name
      "!")))`},{type:"input",content:'(greet "friend")'},{type:"output",content:'"Hello, friend!"'}];return g.jsxs("div",{className:"min-h-screen bg-white flex flex-col",children:[g.jsx("nav",{className:"border-b bg-white sticky top-0 z-30",children:g.jsx("div",{className:"container mx-auto px-4 py-3",children:g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsxs(ci,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-slate-900",children:["JAWS",g.jsx(Vt,{className:"text-cyan-600"})]}),g.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[g.jsx(Be,{to:"/editor",className:({isActive:r})=>r?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Editor"}),g.jsx(Be,{to:"/docs",className:({isActive:r})=>r?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Docs"}),g.jsx(Be,{to:"/compiler-explorer",className:({isActive:r})=>r?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Compiler Explorer"}),g.jsx(Be,{to:"/learn",className:"px-4 py-2 rounded-md font-medium bg-[#dd3f0c] text-white no-underline hover:no-underline hover:text-white hover:bg-[#dd3f0c]",children:"Learn Scheme"}),g.jsx(fe,{variant:"ghost",size:"icon",asChild:!0,children:g.jsx("a",{href:"https://github.com/jamie-wales/jaws",target:"_blank",rel:"noopener noreferrer",children:g.jsx(ea,{className:"h-5 w-5"})})})]}),g.jsx(fe,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>t(!0),children:g.jsx(ta,{className:"h-5 w-5"})})]})})}),e&&g.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 md:hidden",children:g.jsxs("div",{className:"fixed inset-y-0 right-0 w-64 bg-white p-6 shadow-xl",children:[g.jsxs("div",{className:"flex justify-between items-center mb-8",children:[g.jsxs(ci,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-slate-900",onClick:()=>t(!1),children:["JAWS",g.jsx(Vt,{className:"text-cyan-600"})]}),g.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>t(!1),children:g.jsx(na,{className:"h-5 w-5"})})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsx(Be,{to:"/editor",className:({isActive:r})=>r?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>t(!1),children:"Editor"}),g.jsx(Be,{to:"/docs",className:({isActive:r})=>r?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>t(!1),children:"Docs"}),g.jsx(Be,{to:"/compiler-explorer",className:({isActive:r})=>r?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>t(!1),children:"Compiler Explorer"}),g.jsx(Be,{to:"/learn",className:"block px-4 py-2 rounded-md font-medium w-full text-center bg-[#dd3f0c] text-white no-underline hover:no-underline hover:text-white hover:bg-[#dd3f0c]",onClick:()=>t(!1),children:"Learn Scheme"})]})]})}),g.jsx("header",{className:"bg-gradient-to-r from-slate-900 via-blue-900 to-slate-900 text-white animate-gradientFlow",children:g.jsx("div",{className:"container mx-auto px-4 py-12 md:py-24",children:g.jsxs("div",{className:"grid md:grid-cols-2 gap-8 md:gap-12",children:[g.jsxs("div",{className:"space-y-6 animate-floatIn",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("h1",{className:"text-4xl md:text-6xl font-semibold leading-tight text-white",children:"JAWS"}),g.jsx(Vt,{className:"h-8 w-8 md:h-12 md:w-12 text-[#dd3f0c]"})]}),g.jsx("p",{className:"text-lg md:text-xl font-medium tracking-wide text-cyan-400",children:"Jaws Awesomely Wrangles Scheme"})]}),g.jsx("p",{className:"text-lg md:text-xl text-slate-300",children:"Dive into Scheme programming with our modern, interactive development environment. Write, test, and learn with the power of JAWS."}),g.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-4 pt-4",children:[g.jsxs(fe,{size:"lg",className:"bg-[#dd3f0c] text-white hover:opacity-90 hover:-translate-y-1 transition-all duration-300 w-full sm:w-auto text-base",onClick:()=>n("/learn"),children:["Learn Scheme ",g.jsx(bs,{className:"ml-2 h-4 w-4"})]}),g.jsx(fe,{variant:"outline",size:"lg",className:"bg-transparent text-white hover:bg-slate-800/60 border-white hover:border-white w-full sm:w-auto text-base",onClick:()=>n("/docs"),children:"View Docs"})]})]}),g.jsx("div",{className:"bg-zinc-900 rounded-lg p-4 md:p-6 shadow-xl ring-1 ring-white/10 overflow-x-auto animate-fadeScale animation-delay-400",children:g.jsx(kx,{code:i})})]})})}),g.jsx("section",{className:"flex-1 py-12 md:py-20 bg-slate-50",children:g.jsxs("div",{className:"container mx-auto px-4",children:[g.jsx("h2",{className:"text-2xl md:text-3xl font-semibold text-slate-900 text-center mb-8 md:mb-12",children:"Deep dive into powerful features"}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8",children:[{Icon:Qm,title:"Interactive Editor",description:"Write and test code directly in your browser"},{Icon:ia,title:"Live Compilation",description:"See how your code transforms at each stage"},{Icon:Zm,title:"Rich Examples",description:"Learn from practical, runnable code examples"},{Icon:eg,title:"Community",description:"Share and learn with fellow developers"}].map((r,s)=>g.jsx(Us,{className:"bg-white border-slate-200 hover:transform hover:-translate-y-1 transition-all duration-300 animate-fadeScale",style:{animationDelay:`${s*.1}s`},children:g.jsxs(Gs,{className:"pt-6 text-center",children:[g.jsx(r.Icon,{className:"h-12 w-12 mb-4 mx-auto transition-transform duration-300 text-cyan-500"}),g.jsx("h3",{className:"text-lg md:text-xl font-semibold text-slate-900 mb-2",children:r.title}),g.jsx("p",{className:"text-base text-slate-600",children:r.description})]})},r.title))})]})}),g.jsx("section",{className:"py-12 border-t",children:g.jsx("div",{className:"container mx-auto px-4 text-center",children:g.jsxs("div",{className:"max-w-md mx-auto",children:[g.jsx("h2",{className:"text-2xl md:text-3xl font-semibold text-slate-900 mb-8",children:"Ready to dive in?"}),g.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[g.jsxs(fe,{size:"lg",className:"bg-[#dd3f0c] text-white hover:opacity-90 hover:-translate-y-1 transition-all duration-300 w-full sm:w-auto text-base",onClick:()=>n("/learn"),children:["Learn Scheme ",g.jsx(bs,{className:"ml-2 h-4 w-4"})]}),g.jsx(fe,{variant:"outline",size:"lg",className:"border-slate-800 text-slate-800 hover:bg-slate-100/60 hover:text-slate-900 w-full sm:w-auto text-base",onClick:()=>n("/docs"),children:"Browse docs"})]})]})})}),g.jsx(yf,{})]})}function Ax(){const[n,e]=y.useState(!1);return g.jsxs("div",{className:"min-h-screen bg-background",children:[g.jsx("nav",{className:"border-b bg-white sticky top-0 z-30",children:g.jsx("div",{className:"container mx-auto px-4 py-3",children:g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsxs(ci,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-slate-900",children:["JAWS",g.jsx(Vt,{className:"text-cyan-600"})]}),g.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[g.jsx(Be,{to:"/editor",className:({isActive:t})=>t?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Editor"}),g.jsx(Be,{to:"/docs",className:({isActive:t})=>t?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Docs"}),g.jsx(Be,{to:"/compiler-explorer",className:({isActive:t})=>t?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Compiler Explorer"}),g.jsx(Be,{to:"/learn",className:"px-4 py-2 rounded-md font-medium bg-[#dd3f0c] text-white no-underline hover:no-underline hover:text-white hover:bg-[#dd3f0c]",children:"Learn Scheme"}),g.jsx(fe,{variant:"ghost",size:"icon",asChild:!0,children:g.jsx("a",{href:"https://github.com/jamie-wales/jaws",target:"_blank",rel:"noopener noreferrer",children:g.jsx(ea,{className:"h-5 w-5"})})})]}),g.jsx(fe,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>e(!0),children:g.jsx(ta,{className:"h-5 w-5"})})]})})}),n&&g.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 md:hidden",children:g.jsxs("div",{className:"fixed inset-y-0 right-0 w-64 bg-white p-6 shadow-xl",children:[g.jsxs("div",{className:"flex justify-between items-center mb-8",children:[g.jsxs(ci,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-slate-900",onClick:()=>e(!1),children:["JAWS",g.jsx(Vt,{className:"text-cyan-600"})]}),g.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>e(!1),children:g.jsx(na,{className:"h-5 w-5"})})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsx(Be,{to:"/editor",className:({isActive:t})=>t?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>e(!1),children:"Editor"}),g.jsx(Be,{to:"/docs",className:({isActive:t})=>t?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>e(!1),children:"Docs"}),g.jsx(Be,{to:"/compiler-explorer",className:({isActive:t})=>t?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>e(!1),children:"Compiler Explorer"}),g.jsx(Be,{to:"/learn",className:"block px-4 py-2 rounded-md font-medium w-full text-center bg-[#dd3f0c] text-white no-underline hover:no-underline hover:text-white hover:bg-[#dd3f0c]",onClick:()=>e(!1),children:"Learn Scheme"})]})]})}),g.jsx("main",{className:"h-[calc(100vh-57px)]",children:g.jsx(d0,{})})]})}function nl(){return nl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},nl.apply(null,arguments)}function Mx(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.indexOf(i)!==-1)continue;t[i]=n[i]}return t}let il=[],vf=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?vf:il).push(t=t+n[e])})();function Ex(n){if(n<768)return!1;for(let e=0,t=il.length;;){let i=e+t>>1;if(n<il[i])t=i;else if(n>=vf[i])e=i+1;else return!0;if(e==t)return!1}}function Ec(n){return n>=127462&&n<=127487}const Tc=8205;function Tx(n,e,t=!0,i=!0){return(t?wf:Rx)(n,e,i)}function wf(n,e,t){if(e==n.length)return e;e&&Sf(n.charCodeAt(e))&&kf(n.charCodeAt(e-1))&&e--;let i=yo(n,e);for(e+=Rc(i);e<n.length;){let r=yo(n,e);if(i==Tc||r==Tc||t&&Ex(r))e+=Rc(r),i=r;else if(Ec(r)){let s=0,o=e-2;for(;o>=0&&Ec(yo(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function Rx(n,e,t){for(;e>0;){let i=wf(n,e-2,t);if(i<e)return i;e--}return 0}function yo(n,e){let t=n.charCodeAt(e);if(!kf(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return Sf(i)?(t-55296<<10)+(i-56320)+65536:t}function Sf(n){return n>=56320&&n<57344}function kf(n){return n>=55296&&n<56320}function Rc(n){return n<65536?1:2}class he{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){[e,t]=ui(this,e,t);let r=[];return this.decompose(0,e,r,2),i.length&&i.decompose(0,i.length,r,3),this.decompose(t,this.length,r,1),Mt.from(r,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=ui(this,e,t);let i=[];return this.decompose(e,t,i,0),Mt.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),r=new qi(this),s=new qi(e);for(let o=t,l=t;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(l+=r.value.length,r.done||l>=i)return!0}}iter(e=1){return new qi(this,e)}iterRange(e,t=this.length){return new Cf(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;i=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Af(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?he.empty:e.length<=32?new Te(e):Mt.from(Te.split(e,[]))}}class Te extends he{constructor(e,t=Dx(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,r){for(let s=0;;s++){let o=this.text[s],l=r+o.length;if((t?i:l)>=e)return new Nx(r,l,i,o);r=l+1,i++}}decompose(e,t,i,r){let s=e<=0&&t>=this.length?this:new Te(Dc(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let o=i.pop(),l=ss(s.text,o.text.slice(),0,s.length);if(l.length<=32)i.push(new Te(l,o.length+s.length));else{let a=l.length>>1;i.push(new Te(l.slice(0,a)),new Te(l.slice(a)))}}else i.push(s)}replace(e,t,i){if(!(i instanceof Te))return super.replace(e,t,i);[e,t]=ui(this,e,t);let r=ss(this.text,ss(i.text,Dc(this.text,0,e)),t),s=this.length+i.length-(t-e);return r.length<=32?new Te(r,s):Mt.from(Te.split(r,[]),s)}sliceString(e,t=this.length,i=`
`){[e,t]=ui(this,e,t);let r="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let l=this.text[o],a=s+l.length;s>e&&o&&(r+=i),e<a&&t>s&&(r+=l.slice(Math.max(0,e-s),t-s)),s=a+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],r=-1;for(let s of e)i.push(s),r+=s.length+1,i.length==32&&(t.push(new Te(i,r)),i=[],r=-1);return r>-1&&t.push(new Te(i,r)),t}}class Mt extends he{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,r){for(let s=0;;s++){let o=this.children[s],l=r+o.length,a=i+o.lines-1;if((t?a:l)>=e)return o.lineInner(e,t,i,r);r=l+1,i=a+1}}decompose(e,t,i,r){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let l=this.children[s],a=o+l.length;if(e<=a&&t>=o){let c=r&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!c?i.push(l):l.decompose(e-o,t-o,i,c)}o=a+1}}replace(e,t,i){if([e,t]=ui(this,e,t),i.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(e>=s&&t<=l){let a=o.replace(e-s,t-s,i),c=this.lines-o.lines+a.lines;if(a.lines<c>>4&&a.lines>c>>6){let h=this.children.slice();return h[r]=a,new Mt(h,this.length-(t-e)+i.length)}return super.replace(s,l,a)}s=l+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){[e,t]=ui(this,e,t);let r="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let l=this.children[s],a=o+l.length;o>e&&s&&(r+=i),e<a&&t>o&&(r+=l.sliceString(e-o,t-o,i)),o=a+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Mt))return 0;let i=0,[r,s,o,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,s+=t){if(r==o||s==l)return i;let a=this.children[r],c=e.children[s];if(a!=c)return i+a.scanIdentical(c,t);i+=a.length+1}}static from(e,t=e.reduce((i,r)=>i+r.length+1,-1)){let i=0;for(let d of e)i+=d.lines;if(i<32){let d=[];for(let p of e)p.flatten(d);return new Te(d,t)}let r=Math.max(32,i>>5),s=r<<1,o=r>>1,l=[],a=0,c=-1,h=[];function u(d){let p;if(d.lines>s&&d instanceof Mt)for(let m of d.children)u(m);else d.lines>o&&(a>o||!a)?(f(),l.push(d)):d instanceof Te&&a&&(p=h[h.length-1])instanceof Te&&d.lines+p.lines<=32?(a+=d.lines,c+=d.length+1,h[h.length-1]=new Te(p.text.concat(d.text),p.length+1+d.length)):(a+d.lines>r&&f(),a+=d.lines,c+=d.length+1,h.push(d))}function f(){a!=0&&(l.push(h.length==1?h[0]:Mt.from(h,c)),c=-1,a=h.length=0)}for(let d of e)u(d);return f(),l.length==1?l[0]:new Mt(l,t)}}he.empty=new Te([""],0);function Dx(n){let e=-1;for(let t of n)e+=t.length+1;return e}function ss(n,e,t=0,i=1e9){for(let r=0,s=0,o=!0;s<n.length&&r<=i;s++){let l=n[s],a=r+l.length;a>=t&&(a>i&&(l=l.slice(0,i-r)),r<t&&(l=l.slice(t-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function Dc(n,e,t){return ss(n,[""],e,t)}class qi{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Te?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,r=this.nodes[i],s=this.offsets[i],o=s>>1,l=r instanceof Te?r.text.length:r.children.length;if(o==(t>0?l:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof Te){let a=r.text[o+(t<0?-1:0)];if(this.offsets[i]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=r.children[o+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof Te?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class Cf{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new qi(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=i?r:t<0?r.slice(r.length-i):r.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Af{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:r}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(he.prototype[Symbol.iterator]=function(){return this.iter()},qi.prototype[Symbol.iterator]=Cf.prototype[Symbol.iterator]=Af.prototype[Symbol.iterator]=function(){return this});class Nx{constructor(e,t,i,r){this.from=e,this.to=t,this.number=i,this.text=r}get length(){return this.to-this.from}}function ui(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function He(n,e,t=!0,i=!0){return Tx(n,e,t,i)}function Ox(n){return n>=56320&&n<57344}function Lx(n){return n>=55296&&n<56320}function Xe(n,e){let t=n.charCodeAt(e);if(!Lx(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return Ox(i)?(t-55296<<10)+(i-56320)+65536:t}function ya(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function Et(n){return n<65536?1:2}const rl=/\r\n?|\n/;var Ge=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(Ge||(Ge={}));class Nt{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,r=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(i,r,s),r+=s):r+=o,i+=s}}iterChangedRanges(e,t=!1){sl(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];r<0?e.push(i,r):e.push(r,i)}return new Nt(e)}composeDesc(e){return this.empty?e:e.empty?this:Mf(this,e)}mapDesc(e,t=!1){return e.empty?this:ol(this,e,t)}mapPos(e,t=-1,i=Ge.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],c=r+l;if(a<0){if(c>e)return s+(e-r);s+=l}else{if(i!=Ge.Simple&&c>=e&&(i==Ge.TrackDel&&r<e&&c>e||i==Ge.TrackBefore&&r<e||i==Ge.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!l)return e==r||t<0?s:s+a;s+=a}r=c}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,t=e){for(let i=0,r=0;i<this.sections.length&&r<=t;){let s=this.sections[i++],o=this.sections[i++],l=r+s;if(o>=0&&r<=t&&l>=e)return r<e&&l>t?"cover":!0;r=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+i+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Nt(e)}static create(e){return new Nt(e)}}class Oe extends Nt{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return sl(this,(t,i,r,s,o)=>e=e.replace(r,r+(i-t),o),!1),e}mapDesc(e,t=!1){return ol(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let r=0,s=0;r<t.length;r+=2){let o=t[r],l=t[r+1];if(l>=0){t[r]=l,t[r+1]=o;let a=r>>1;for(;i.length<a;)i.push(he.empty);i.push(o?e.slice(s,s+o):he.empty)}s+=o}return new Oe(t,i)}compose(e){return this.empty?e:e.empty?this:Mf(this,e,!0)}map(e,t=!1){return e.empty?this:ol(this,e,t,!0)}iterChanges(e,t=!1){sl(this,e,t)}get desc(){return Nt.create(this.sections)}filter(e){let t=[],i=[],r=[],s=new er(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&s.len==0;){if(s.done)break e;let h=Math.min(s.len,a-l);_e(r,h,-1);let u=s.ins==-1?-1:s.off==0?s.ins:0;_e(t,h,u),u>0&&ln(i,t,s.text),s.forward(h),l+=h}let c=e[o++];for(;l<c;){if(s.done)break e;let h=Math.min(s.len,c-l);_e(t,h,-1),_e(r,h,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(h),l+=h}}return{changes:new Oe(t,i),filtered:Nt.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],r=this.sections[t+1];r<0?e.push(i):r==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let r=[],s=[],o=0,l=null;function a(h=!1){if(!h&&!r.length)return;o<t&&_e(r,t-o,-1);let u=new Oe(r,s);l=l?l.compose(u.map(l)):u,r=[],s=[],o=0}function c(h){if(Array.isArray(h))for(let u of h)c(u);else if(h instanceof Oe){if(h.length!=t)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${t})`);a(),l=l?l.compose(h.map(l)):h}else{let{from:u,to:f=u,insert:d}=h;if(u>f||u<0||f>t)throw new RangeError(`Invalid change range ${u} to ${f} (in doc of length ${t})`);let p=d?typeof d=="string"?he.of(d.split(i||rl)):d:he.empty,m=p.length;if(u==f&&m==0)return;u<o&&a(),u>o&&_e(r,u-o,-1),_e(r,f-u,m),ln(s,r,p),o=f}}return c(e),a(!l),l}static empty(e){return new Oe(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;i.length<r;)i.push(he.empty);i[r]=he.of(s.slice(1)),t.push(s[0],i[r].length)}}}return new Oe(t,i)}static createSet(e,t){return new Oe(e,t)}}function _e(n,e,t,i=!1){if(e==0&&t<=0)return;let r=n.length-2;r>=0&&t<=0&&t==n[r+1]?n[r]+=e:r>=0&&e==0&&n[r]==0?n[r+1]+=t:i?(n[r]+=e,n[r+1]+=t):n.push(e,t)}function ln(n,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<i;)n.push(he.empty);n.push(t)}}function sl(n,e,t){let i=n.inserted;for(let r=0,s=0,o=0;o<n.sections.length;){let l=n.sections[o++],a=n.sections[o++];if(a<0)r+=l,s+=l;else{let c=r,h=s,u=he.empty;for(;c+=l,h+=a,a&&i&&(u=u.append(i[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)l=n.sections[o++],a=n.sections[o++];e(r,c,s,h,u),r=c,s=h}}}function ol(n,e,t,i=!1){let r=[],s=i?[]:null,o=new er(n),l=new er(e);for(let a=-1;;){if(o.done&&l.len||l.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&l.ins==-1){let c=Math.min(o.len,l.len);_e(r,c,-1),o.forward(c),l.forward(c)}else if(l.ins>=0&&(o.ins<0||a==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!t))){let c=l.len;for(_e(r,l.ins,-1);c;){let h=Math.min(o.len,c);o.ins>=0&&a<o.i&&o.len<=h&&(_e(r,0,o.ins),s&&ln(s,r,o.text),a=o.i),o.forward(h),c-=h}l.next()}else if(o.ins>=0){let c=0,h=o.len;for(;h;)if(l.ins==-1){let u=Math.min(h,l.len);c+=u,h-=u,l.forward(u)}else if(l.ins==0&&l.len<h)h-=l.len,l.next();else break;_e(r,c,a<o.i?o.ins:0),s&&a<o.i&&ln(s,r,o.text),a=o.i,o.forward(o.len-h)}else{if(o.done&&l.done)return s?Oe.createSet(r,s):Nt.create(r);throw new Error("Mismatched change set lengths")}}}function Mf(n,e,t=!1){let i=[],r=t?[]:null,s=new er(n),o=new er(e);for(let l=!1;;){if(s.done&&o.done)return r?Oe.createSet(i,r):Nt.create(i);if(s.ins==0)_e(i,s.len,0,l),s.next();else if(o.len==0&&!o.done)_e(i,0,o.ins,l),r&&ln(r,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(s.len2,o.len),c=i.length;if(s.ins==-1){let h=o.ins==-1?-1:o.off?0:o.ins;_e(i,a,h,l),r&&h&&ln(r,i,o.text)}else o.ins==-1?(_e(i,s.off?0:s.len,a,l),r&&ln(r,i,s.textBit(a))):(_e(i,s.off?0:s.len,o.off?0:o.ins,l),r&&!o.off&&ln(r,i,o.text));l=(s.ins>a||o.ins>=0&&o.len>a)&&(l||i.length>c),s.forward2(a),o.forward(a)}}}}class er{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?he.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?he.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Tn{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let i,r;return this.empty?i=r=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),i==this.from&&r==this.to?this:new Tn(i,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return T.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return T.range(this.anchor,i)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return T.range(e.anchor,e.head)}static create(e,t,i){return new Tn(e,t,i)}}class T{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:T.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new T([this.main],0)}addRange(e,t=!0){return T.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,T.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new T(e.ranges.map(t=>Tn.fromJSON(t)),e.main)}static single(e,t=e){return new T([T.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=i:s.from<i)return T.normalized(e.slice(),t);i=s.to}return new T(e,t)}static cursor(e,t=0,i,r){return Tn.create(e,e,(t==0?0:t<0?8:16)|(i==null?7:Math.min(6,i))|(r??16777215)<<6)}static range(e,t,i,r){let s=(i??16777215)<<6|(r==null?7:Math.min(6,r));return t<e?Tn.create(t,e,48|s):Tn.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let i=e[t];e.sort((r,s)=>r.from-s.from),t=e.indexOf(i);for(let r=1;r<e.length;r++){let s=e[r],o=e[r-1];if(s.empty?s.from<=o.to:s.from<o.to){let l=o.from,a=Math.max(s.to,o.to);r<=t&&t--,e.splice(--r,2,s.anchor>s.head?T.range(a,l):T.range(l,a))}}return new T(e,t)}}function Ef(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let va=0;class j{constructor(e,t,i,r,s){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=r,this.id=va++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new j(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:wa),!!e.static,e.enables)}of(e){return new os([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new os(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new os(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function wa(n,e){return n==e||n.length==e.length&&n.every((t,i)=>t===e[i])}class os{constructor(e,t,i,r){this.dependencies=e,this.facet=t,this.type=i,this.value=r,this.id=va++}dynamicSlot(e){var t;let i=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,a=!1,c=!1,h=[];for(let u of this.dependencies)u=="doc"?a=!0:u=="selection"?c=!0:((t=e[u.id])!==null&&t!==void 0?t:1)&1||h.push(e[u.id]);return{create(u){return u.values[o]=i(u),1},update(u,f){if(a&&f.docChanged||c&&(f.docChanged||f.selection)||ll(u,h)){let d=i(u);if(l?!Nc(d,u.values[o],r):!r(d,u.values[o]))return u.values[o]=d,1}return 0},reconfigure:(u,f)=>{let d,p=f.config.address[s];if(p!=null){let m=ws(f,p);if(this.dependencies.every(b=>b instanceof j?f.facet(b)===u.facet(b):b instanceof Fe?f.field(b,!1)==u.field(b,!1):!0)||(l?Nc(d=i(u),m,r):r(d=i(u),m)))return u.values[o]=m,0}else d=i(u);return u.values[o]=d,1}}}}function Nc(n,e,t){if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(!t(n[i],e[i]))return!1;return!0}function ll(n,e){let t=!1;for(let i of e)Ui(n,i)&1&&(t=!0);return t}function Px(n,e,t){let i=t.map(a=>n[a.id]),r=t.map(a=>a.type),s=i.filter(a=>!(a&1)),o=n[e.id]>>1;function l(a){let c=[];for(let h=0;h<i.length;h++){let u=ws(a,i[h]);if(r[h]==2)for(let f of u)c.push(f);else c.push(u)}return e.combine(c)}return{create(a){for(let c of i)Ui(a,c);return a.values[o]=l(a),1},update(a,c){if(!ll(a,s))return 0;let h=l(a);return e.compare(h,a.values[o])?0:(a.values[o]=h,1)},reconfigure(a,c){let h=ll(a,i),u=c.config.facets[e.id],f=c.facet(e);if(u&&!h&&wa(t,u))return a.values[o]=f,0;let d=l(a);return e.compare(d,f)?(a.values[o]=f,0):(a.values[o]=d,1)}}}const Nr=j.define({static:!0});class Fe{constructor(e,t,i,r,s){this.id=e,this.createF=t,this.updateF=i,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let t=new Fe(va++,e.create,e.update,e.compare||((i,r)=>i===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Nr).find(i=>i.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,r)=>{let s=i.values[t],o=this.updateF(s,r);return this.compareF(s,o)?0:(i.values[t]=o,1)},reconfigure:(i,r)=>{let s=i.facet(Nr),o=r.facet(Nr),l;return(l=s.find(a=>a.field==this))&&l!=o.find(a=>a.field==this)?(i.values[t]=l.create(i),1):r.config.address[this.id]!=null?(i.values[t]=r.field(this),0):(i.values[t]=this.create(i),1)}}}init(e){return[this,Nr.of({field:this,create:e})]}get extension(){return this}}const An={lowest:4,low:3,default:2,high:1,highest:0};function Ni(n){return e=>new Tf(e,n)}const bn={highest:Ni(An.highest),high:Ni(An.high),default:Ni(An.default),low:Ni(An.low),lowest:Ni(An.lowest)};class Tf{constructor(e,t){this.inner=e,this.prec=t}}class Js{of(e){return new al(this,e)}reconfigure(e){return Js.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class al{constructor(e,t){this.compartment=e,this.inner=t}}class vs{constructor(e,t,i,r,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let r=[],s=Object.create(null),o=new Map;for(let f of Ix(e,t,o))f instanceof Fe?r.push(f):(s[f.facet.id]||(s[f.facet.id]=[])).push(f);let l=Object.create(null),a=[],c=[];for(let f of r)l[f.id]=c.length<<1,c.push(d=>f.slot(d));let h=i==null?void 0:i.config.facets;for(let f in s){let d=s[f],p=d[0].facet,m=h&&h[f]||[];if(d.every(b=>b.type==0))if(l[p.id]=a.length<<1|1,wa(m,d))a.push(i.facet(p));else{let b=p.combine(d.map(x=>x.value));a.push(i&&p.compare(b,i.facet(p))?i.facet(p):b)}else{for(let b of d)b.type==0?(l[b.id]=a.length<<1|1,a.push(b.value)):(l[b.id]=c.length<<1,c.push(x=>b.dynamicSlot(x)));l[p.id]=c.length<<1,c.push(b=>Px(b,p,d))}}let u=c.map(f=>f(l));return new vs(e,o,u,l,a,s)}}function Ix(n,e,t){let i=[[],[],[],[],[]],r=new Map;function s(o,l){let a=r.get(o);if(a!=null){if(a<=l)return;let c=i[a].indexOf(o);c>-1&&i[a].splice(c,1),o instanceof al&&t.delete(o.compartment)}if(r.set(o,l),Array.isArray(o))for(let c of o)s(c,l);else if(o instanceof al){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;t.set(o.compartment,c),s(c,l)}else if(o instanceof Tf)s(o.inner,o.prec);else if(o instanceof Fe)i[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof os)i[l].push(o),o.facet.extensions&&s(o.facet.extensions,An.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(c,l)}}return s(n,An.default),i.reduce((o,l)=>o.concat(l))}function Ui(n,e){if(e&1)return 2;let t=e>>1,i=n.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;n.status[t]=4;let r=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|r}function ws(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const Rf=j.define(),cl=j.define({combine:n=>n.some(e=>e),static:!0}),Df=j.define({combine:n=>n.length?n[0]:void 0,static:!0}),Nf=j.define(),Of=j.define(),Lf=j.define(),Pf=j.define({combine:n=>n.length?n[0]:!1});class Bt{constructor(e,t){this.type=e,this.value=t}static define(){return new Bx}}class Bx{of(e){return new Bt(this,e)}}class zx{constructor(e){this.map=e}of(e){return new ne(this,e)}}class ne{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new ne(this.type,t)}is(e){return this.type==e}static define(e={}){return new zx(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let r of e){let s=r.map(t);s&&i.push(s)}return i}}ne.reconfigure=ne.define();ne.appendConfig=ne.define();class Le{constructor(e,t,i,r,s,o){this.startState=e,this.changes=t,this.selection=i,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&Ef(i,t.newLength),s.some(l=>l.type==Le.time)||(this.annotations=s.concat(Le.time.of(Date.now())))}static create(e,t,i,r,s,o){return new Le(e,t,i,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Le.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Le.time=Bt.define();Le.userEvent=Bt.define();Le.addToHistory=Bt.define();Le.remote=Bt.define();function jx(n,e){let t=[];for(let i=0,r=0;;){let s,o;if(i<n.length&&(r==e.length||e[r]>=n[i]))s=n[i++],o=n[i++];else if(r<e.length)s=e[r++],o=e[r++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function If(n,e,t){var i;let r,s,o;return t?(r=e.changes,s=Oe.empty(e.changes.length),o=n.changes.compose(e.changes)):(r=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(i=n.selection)===null||i===void 0?void 0:i.map(r),effects:ne.mapEffects(n.effects,r).concat(ne.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function hl(n,e,t){let i=e.selection,r=ii(e.annotations);return e.userEvent&&(r=r.concat(Le.userEvent.of(e.userEvent))),{changes:e.changes instanceof Oe?e.changes:Oe.of(e.changes||[],t,n.facet(Df)),selection:i&&(i instanceof T?i:T.single(i.anchor,i.head)),effects:ii(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function Bf(n,e,t){let i=hl(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;i=If(i,hl(n,e[s],o?i.changes.newLength:n.doc.length),o)}let r=Le.create(n,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return Fx(t?Hx(r):r)}function Hx(n){let e=n.startState,t=!0;for(let r of e.facet(Nf)){let s=r(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:jx(t,s))}if(t!==!0){let r,s;if(t===!1)s=n.changes.invertedDesc,r=Oe.empty(e.doc.length);else{let o=n.changes.filter(t);r=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}n=Le.create(e,r,n.selection&&n.selection.map(s),ne.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let i=e.facet(Of);for(let r=i.length-1;r>=0;r--){let s=i[r](n);s instanceof Le?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Le?n=s[0]:n=Bf(e,ii(s),!1)}return n}function Fx(n){let e=n.startState,t=e.facet(Lf),i=n;for(let r=t.length-1;r>=0;r--){let s=t[r](n);s&&Object.keys(s).length&&(i=If(i,hl(e,s,n.changes.newLength),!0))}return i==n?n:Le.create(e,n.changes,n.selection,i.effects,i.annotations,i.scrollIntoView)}const Wx=[];function ii(n){return n==null?Wx:Array.isArray(n)?n:[n]}var ke=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(ke||(ke={}));const $x=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ul;try{ul=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function _x(n){if(ul)return ul.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>"Â€"&&(t.toUpperCase()!=t.toLowerCase()||$x.test(t)))return!0}return!1}function Vx(n){return e=>{if(!/\S/.test(e))return ke.Space;if(_x(e))return ke.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return ke.Word;return ke.Other}}class ae{constructor(e,t,i,r,s,o){this.config=e,this.doc=t,this.selection=i,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)Ui(this,l<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return Ui(this,i),ws(this,i)}update(...e){return Bf(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:r}=t;for(let l of e.effects)l.is(Js.reconfigure)?(t&&(r=new Map,t.compartments.forEach((a,c)=>r.set(c,a)),t=null),r.set(l.value.compartment,l.value.extension)):l.is(ne.reconfigure)?(t=null,i=l.value):l.is(ne.appendConfig)&&(t=null,i=ii(i).concat(l.value));let s;t?s=e.startState.values.slice():(t=vs.resolve(i,r,this),s=new ae(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(a,c)=>c.reconfigure(a,this),null).values);let o=e.startState.facet(cl)?e.newSelection:e.newSelection.asSingle();new ae(t,e.newDoc,o,s,(l,a)=>a.update(l,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:T.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),r=this.changes(i.changes),s=[i.range],o=ii(i.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),c=this.changes(a.changes),h=c.map(r);for(let f=0;f<l;f++)s[f]=s[f].map(h);let u=r.mapDesc(c,!0);s.push(a.range.map(u)),r=r.compose(h),o=ne.mapEffects(o,h).concat(ne.mapEffects(ii(a.effects),u))}return{changes:r,selection:T.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Oe?e:Oe.of(e,this.doc.length,this.facet(ae.lineSeparator))}toText(e){return he.of(e.split(this.facet(ae.lineSeparator)||rl))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(Ui(this,t),ws(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let r=e[i];r instanceof Fe&&this.config.address[r.id]!=null&&(t[i]=r.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i){for(let s in i)if(Object.prototype.hasOwnProperty.call(e,s)){let o=i[s],l=e[s];r.push(o.init(a=>o.spec.fromJSON(l,a)))}}return ae.create({doc:e.doc,selection:T.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=vs.resolve(e.extensions||[],new Map),i=e.doc instanceof he?e.doc:he.of((e.doc||"").split(t.staticFacet(ae.lineSeparator)||rl)),r=e.selection?e.selection instanceof T?e.selection:T.single(e.selection.anchor,e.selection.head):T.single(0);return Ef(r,i.length),t.staticFacet(cl)||(r=r.asSingle()),new ae(t,i,r,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(ae.tabSize)}get lineBreak(){return this.facet(ae.lineSeparator)||`
`}get readOnly(){return this.facet(Pf)}phrase(e,...t){for(let i of this.facet(ae.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,r)=>{if(r=="$")return"$";let s=+(r||1);return!s||s>t.length?i:t[s-1]})),e}languageDataAt(e,t,i=-1){let r=[];for(let s of this.facet(Rf))for(let o of s(this,t,i))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return Vx(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,l=e-i;for(;o>0;){let a=He(t,o,!1);if(s(t.slice(a,o))!=ke.Word)break;o=a}for(;l<r;){let a=He(t,l);if(s(t.slice(l,a))!=ke.Word)break;l=a}return o==l?null:T.range(o+i,l+i)}}ae.allowMultipleSelections=cl;ae.tabSize=j.define({combine:n=>n.length?n[0]:4});ae.lineSeparator=Df;ae.readOnly=Pf;ae.phrases=j.define({compare(n,e){let t=Object.keys(n),i=Object.keys(e);return t.length==i.length&&t.every(r=>n[r]==e[r])}});ae.languageData=Rf;ae.changeFilter=Nf;ae.transactionFilter=Of;ae.transactionExtender=Lf;Js.reconfigure=ne.define();function zt(n,e,t={}){let i={};for(let r of n)for(let s of Object.keys(r)){let o=r[s],l=i[s];if(l===void 0)i[s]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(t,s))i[s]=t[s](l,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)i[r]===void 0&&(i[r]=e[r]);return i}class Pn{eq(e){return this==e}range(e,t=e){return fl.create(e,t,this)}}Pn.prototype.startSide=Pn.prototype.endSide=0;Pn.prototype.point=!1;Pn.prototype.mapMode=Ge.TrackDel;let fl=class zf{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new zf(e,t,i)}};function dl(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Sa{constructor(e,t,i,r){this.from=e,this.to=t,this.value=i,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,r=0){let s=i?this.to:this.from;for(let o=r,l=s.length;;){if(o==l)return o;let a=o+l>>1,c=s[a]-e||(i?this.value[a].endSide:this.value[a].startSide)-t;if(a==o)return c>=0?o:l;c>=0?l=a:o=a+1}}between(e,t,i,r){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let i=[],r=[],s=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let c=this.value[a],h=this.from[a]+e,u=this.to[a]+e,f,d;if(h==u){let p=t.mapPos(h,c.startSide,c.mapMode);if(p==null||(f=d=p,c.startSide!=c.endSide&&(d=t.mapPos(h,c.endSide),d<f)))continue}else if(f=t.mapPos(h,c.startSide),d=t.mapPos(u,c.endSide),f>d||f==d&&c.startSide>0&&c.endSide<=0)continue;(d-f||c.endSide-c.startSide)<0||(o<0&&(o=f),c.point&&(l=Math.max(l,d-f)),i.push(c),r.push(f-o),s.push(d-o))}return{mapped:i.length?new Sa(r,s,i,l):null,pos:o}}}class ce{constructor(e,t,i,r){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=r}static create(e,t,i,r){return new ce(e,t,i,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(i&&(t=t.slice().sort(dl)),this.isEmpty)return t.length?ce.of(t):this;let l=new jf(this,null,-1).goto(0),a=0,c=[],h=new Kt;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let u=t[a++];h.addInner(u.from,u.to,u.value)||c.push(u)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!o||r>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&h.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||r>l.to||s<l.from||o(l.from,l.to,l.value))&&(h.addInner(l.from,l.to,l.value)||c.push(fl.create(l.from,l.to,l.value))),l.next());return h.finishInner(this.nextLayer.isEmpty&&!c.length?ce.empty:this.nextLayer.update({add:c,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],r=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],c=e.touchesRange(l,l+a.length);if(c===!1)r=Math.max(r,a.maxPoint),t.push(a),i.push(e.mapPos(l));else if(c===!0){let{mapped:h,pos:u}=a.map(l,e);h&&(r=Math.max(r,h.maxPoint),t.push(h),i.push(u))}}let s=this.nextLayer.map(e);return t.length==0?s:new ce(i,t,s||ce.empty,r)}between(e,t,i){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return tr.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return tr.from(e).goto(t)}static compare(e,t,i,r,s=-1){let o=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=s),l=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=s),a=Oc(o,l,i),c=new Oi(o,a,s),h=new Oi(l,a,s);i.iterGaps((u,f,d)=>Lc(c,u,h,f,d,r)),i.empty&&i.length==0&&Lc(c,0,h,0,0,r)}static eq(e,t,i=0,r){r==null&&(r=999999999);let s=e.filter(h=>!h.isEmpty&&t.indexOf(h)<0),o=t.filter(h=>!h.isEmpty&&e.indexOf(h)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=Oc(s,o),a=new Oi(s,l,0).goto(i),c=new Oi(o,l,0).goto(i);for(;;){if(a.to!=c.to||!pl(a.active,c.active)||a.point&&(!c.point||!a.point.eq(c.point)))return!1;if(a.to>r)return!0;a.next(),c.next()}}static spans(e,t,i,r,s=-1){let o=new Oi(e,null,s).goto(t),l=t,a=o.openStart;for(;;){let c=Math.min(o.to,i);if(o.point){let h=o.activeForPoint(o.to),u=o.pointFrom<t?h.length+1:o.point.startSide<0?h.length:Math.min(h.length,a);r.point(l,c,o.point,h,u,o.pointRank),a=Math.min(o.openEnd(c),h.length)}else c>l&&(r.span(l,c,o.active,a),a=o.openEnd(c));if(o.to>i)return a+(o.point&&o.to>i?1:0);l=o.to,o.next()}}static of(e,t=!1){let i=new Kt;for(let r of e instanceof fl?[e]:t?qx(e):e)i.add(r.from,r.to,r.value);return i.finish()}static join(e){if(!e.length)return ce.empty;let t=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let r=e[i];r!=ce.empty;r=r.nextLayer)t=new ce(r.chunkPos,r.chunk,t,Math.max(r.maxPoint,t.maxPoint));return t}}ce.empty=new ce([],[],null,-1);function qx(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let i=n[t];if(dl(e,i)>0)return n.slice().sort(dl);e=i}return n}ce.empty.nextLayer=ce.empty;class Kt{finishChunk(e){this.chunks.push(new Sa(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new Kt)).add(e,t,i)}addInner(e,t,i){let r=e-this.lastTo||i.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(ce.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=ce.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Oc(n,e,t){let i=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=i.get(s.chunk[o]);l!=null&&(t?t.mapPos(l):l)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(l,l+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class jf{constructor(e,t,i,r=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class tr{constructor(e){this.heap=e}static from(e,t=null,i=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&r.push(new jf(o,t,i,s));return r.length==1?r[0]:new tr(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)vo(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)vo(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),vo(this.heap,0)}}}function vo(n,e){for(let t=n[e];;){let i=(e<<1)+1;if(i>=n.length)break;let r=n[i];if(i+1<n.length&&r.compare(n[i+1])>=0&&(r=n[i+1],i++),t.compare(r)<0)break;n[i]=t,n[e]=r,e=i}}class Oi{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=tr.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Or(this.active,e),Or(this.activeTo,e),Or(this.activeRank,e),this.minActive=Pc(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:r,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||r-this.activeTo[t])>0;)t++;Lr(this.active,t,i),Lr(this.activeTo,t,r),Lr(this.activeRank,t,s),e&&Lr(e,t,this.cursor.from),this.minActive=Pc(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&Or(i,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let r=i.length-1;r>=0&&i[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function Lc(n,e,t,i,r,s){n.goto(e),t.goto(i);let o=i+r,l=i,a=i-e;for(;;){let c=n.to+a-t.to,h=c||n.endSide-t.endSide,u=h<0?n.to+a:t.to,f=Math.min(u,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&pl(n.activeForPoint(n.to),t.activeForPoint(t.to))||s.comparePoint(l,f,n.point,t.point):f>l&&!pl(n.active,t.active)&&s.compareRange(l,f,n.active,t.active),u>o)break;(c||n.openEnd!=t.openEnd)&&s.boundChange&&s.boundChange(u),l=u,h<=0&&n.next(),h>=0&&t.next()}}function pl(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function Or(n,e){for(let t=e,i=n.length-1;t<i;t++)n[t]=n[t+1];n.pop()}function Lr(n,e,t){for(let i=n.length-1;i>=e;i--)n[i+1]=n[i];n[e]=t}function Pc(n,e){let t=-1,i=1e9;for(let r=0;r<e.length;r++)(e[r]-i||n[r].endSide-n[t].endSide)<0&&(t=r,i=e[r]);return t}function ki(n,e,t=n.length){let i=0;for(let r=0;r<t&&r<n.length;)n.charCodeAt(r)==9?(i+=e-i%e,r++):(i++,r=He(n,r));return i}function ml(n,e,t,i){for(let r=0,s=0;;){if(s>=e)return r;if(r==n.length)break;s+=n.charCodeAt(r)==9?t-s%t:1,r=He(n,r)}return i===!0?-1:n.length}const gl="Í¼",Ic=typeof Symbol>"u"?"__"+gl:Symbol.for(gl),bl=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Bc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class fn{constructor(e,t){this.rules=[];let{finish:i}=t||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,l,a,c){let h=[],u=/^@(\w+)\b/.exec(o[0]),f=u&&u[1]=="keyframes";if(u&&l==null)return a.push(o[0]+";");for(let d in l){let p=l[d];if(/&/.test(d))s(d.split(/,\s*/).map(m=>o.map(b=>m.replace(/&/,b))).reduce((m,b)=>m.concat(b)),p,a);else if(p&&typeof p=="object"){if(!u)throw new RangeError("The value of a property ("+d+") should be a primitive value.");s(r(d),p,h,f)}else p!=null&&h.push(d.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+p+";")}(h.length||f)&&a.push((i&&!u&&!c?o.map(i):o).join(", ")+" {"+h.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Bc[Ic]||1;return Bc[Ic]=e+1,gl+e.toString(36)}static mount(e,t,i){let r=e[bl],s=i&&i.nonce;r?s&&r.setNonce(s):r=new Ux(e,s),r.mount(Array.isArray(t)?t:[t],e)}}let zc=new Map;class Ux{constructor(e,t){let i=e.ownerDocument||e,r=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let s=zc.get(i);if(s)return e[bl]=s;this.sheet=new r.CSSStyleSheet,zc.set(i,this)}else this.styleTag=i.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[bl]=this}mount(e,t){let i=this.sheet,r=0,s=0;for(let o=0;o<e.length;o++){let l=e[o],a=this.modules.indexOf(l);if(a<s&&a>-1&&(this.modules.splice(a,1),s--,a=-1),a==-1){if(this.modules.splice(s++,0,l),i)for(let c=0;c<l.rules.length;c++)i.insertRule(l.rules[c],r++)}else{for(;s<a;)r+=this.modules[s++].rules.length;r+=l.rules.length,s++}}if(i)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let a=0;a<this.modules.length;a++)o+=this.modules[a].getRules()+`
`;this.styleTag.textContent=o;let l=t.head||t;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var dn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},nr={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Gx=typeof navigator<"u"&&/Mac/.test(navigator.platform),Kx=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ze=0;ze<10;ze++)dn[48+ze]=dn[96+ze]=String(ze);for(var ze=1;ze<=24;ze++)dn[ze+111]="F"+ze;for(var ze=65;ze<=90;ze++)dn[ze]=String.fromCharCode(ze+32),nr[ze]=String.fromCharCode(ze);for(var wo in dn)nr.hasOwnProperty(wo)||(nr[wo]=dn[wo]);function Jx(n){var e=Gx&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Kx&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?nr:dn)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function be(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=t[i];typeof r=="string"?n.setAttribute(i,r):r!=null&&(n[i]=r)}e++}for(;e<arguments.length;e++)Hf(n,arguments[e]);return n}function Hf(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)Hf(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}function ir(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function xl(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function ls(n,e){if(!e.anchorNode)return!1;try{return xl(n,e.anchorNode)}catch{return!1}}function fi(n){return n.nodeType==3?Bn(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function Gi(n,e,t,i){return t?jc(n,e,t,i,-1)||jc(n,e,t,i,1):!1}function In(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function Ss(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function jc(n,e,t,i,r){for(;;){if(n==t&&e==i)return!0;if(e==(r<0?0:Lt(n))){if(n.nodeName=="DIV")return!1;let s=n.parentNode;if(!s||s.nodeType!=1)return!1;e=In(n)+(r<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(r<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=r<0?Lt(n):0}else return!1}}function Lt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function wr(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function Yx(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function Ff(n,e){let t=e.width/n.offsetWidth,i=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-n.offsetHeight)<1)&&(i=1),{scaleX:t,scaleY:i}}function Xx(n,e,t,i,r,s,o,l){let a=n.ownerDocument,c=a.defaultView||window;for(let h=n,u=!1;h&&!u;)if(h.nodeType==1){let f,d=h==a.body,p=1,m=1;if(d)f=Yx(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(u=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let v=h.getBoundingClientRect();({scaleX:p,scaleY:m}=Ff(h,v)),f={left:v.left,right:v.left+h.clientWidth*p,top:v.top,bottom:v.top+h.clientHeight*m}}let b=0,x=0;if(r=="nearest")e.top<f.top?(x=e.top-(f.top+o),t>0&&e.bottom>f.bottom+x&&(x=e.bottom-f.bottom+o)):e.bottom>f.bottom&&(x=e.bottom-f.bottom+o,t<0&&e.top-x<f.top&&(x=e.top-(f.top+o)));else{let v=e.bottom-e.top,w=f.bottom-f.top;x=(r=="center"&&v<=w?e.top+v/2-w/2:r=="start"||r=="center"&&t<0?e.top-o:e.bottom-w+o)-f.top}if(i=="nearest"?e.left<f.left?(b=e.left-(f.left+s),t>0&&e.right>f.right+b&&(b=e.right-f.right+s)):e.right>f.right&&(b=e.right-f.right+s,t<0&&e.left<f.left+b&&(b=e.left-(f.left+s))):b=(i=="center"?e.left+(e.right-e.left)/2-(f.right-f.left)/2:i=="start"==l?e.left-s:e.right-(f.right-f.left)+s)-f.left,b||x)if(d)c.scrollBy(b,x);else{let v=0,w=0;if(x){let C=h.scrollTop;h.scrollTop+=x/m,w=(h.scrollTop-C)*m}if(b){let C=h.scrollLeft;h.scrollLeft+=b/p,v=(h.scrollLeft-C)*p}e={left:e.left-v,top:e.top-w,right:e.right-v,bottom:e.bottom-w},v&&Math.abs(v-b)<1&&(i="nearest"),w&&Math.abs(w-x)<1&&(r="nearest")}if(d)break;(e.top<f.top||e.bottom>f.bottom||e.left<f.left||e.right>f.right)&&(e={left:Math.max(e.left,f.left),right:Math.min(e.right,f.right),top:Math.max(e.top,f.top),bottom:Math.min(e.bottom,f.bottom)}),h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function Qx(n){let e=n.ownerDocument,t,i;for(let r=n.parentNode;r&&!(r==e.body||t&&i);)if(r.nodeType==1)!i&&r.scrollHeight>r.clientHeight&&(i=r),!t&&r.scrollWidth>r.clientWidth&&(t=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:t,y:i}}class Zx{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:i}=e;this.set(t,Math.min(e.anchorOffset,t?Lt(t):0),i,Math.min(e.focusOffset,i?Lt(i):0))}set(e,t,i,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=r}}let qn=null;function Wf(n){if(n.setActive)return n.setActive();if(qn)return n.focus(qn);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(qn==null?{get preventScroll(){return qn={preventScroll:!0},!0}}:void 0),!qn){qn=!1;for(let t=0;t<e.length;){let i=e[t++],r=e[t++],s=e[t++];i.scrollTop!=r&&(i.scrollTop=r),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let Hc;function Bn(n,e,t=e){let i=Hc||(Hc=document.createRange());return i.setEnd(n,t),i.setStart(n,e),i}function ri(n,e,t,i){let r={key:e,code:e,keyCode:t,which:t,cancelable:!0};i&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=i);let s=new KeyboardEvent("keydown",r);s.synthetic=!0,n.dispatchEvent(s);let o=new KeyboardEvent("keyup",r);return o.synthetic=!0,n.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function ey(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function $f(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function ty(n,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(i=Math.min(i,Lt(t));;)if(i){if(t.nodeType!=1)return!1;let r=t.childNodes[i-1];r.contentEditable=="false"?i--:(t=r,i=Lt(t))}else{if(t==n)return!0;i=In(t),t=t.parentNode}}function _f(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function Vf(n,e){for(let t=n,i=e;;){if(t.nodeType==3&&i>0)return{node:t,offset:i};if(t.nodeType==1&&i>0){if(t.contentEditable=="false")return null;t=t.childNodes[i-1],i=Lt(t)}else if(t.parentNode&&!Ss(t))i=In(t),t=t.parentNode;else return null}}function qf(n,e){for(let t=n,i=e;;){if(t.nodeType==3&&i<t.nodeValue.length)return{node:t,offset:i};if(t.nodeType==1&&i<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[i],i=0}else if(t.parentNode&&!Ss(t))i=In(t)+1,t=t.parentNode;else return null}}class Ve{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new Ve(e.parentNode,In(e),t)}static after(e,t){return new Ve(e.parentNode,In(e)+1,t)}}const ka=[];class ye{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let i=this.dom,r=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=r?r.nextSibling:i.firstChild)){let l=ye.get(s);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,t),o.flags&=-8}if(s=r?r.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&s!=o.dom&&(t.written=!0),o.dom.parentNode==i)for(;s&&s!=o.dom;)s=Fc(s);else i.insertBefore(o.dom,s);r=o.dom}for(s=r?r.nextSibling:i.firstChild,s&&t&&t.node==i&&(t.written=!0);s;)s=Fc(s)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,t),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let r=Lt(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!ye.get(i);)i=i.nextSibling;if(!i)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==i)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,i=0){let r=-1,s=-1,o=-1,l=-1;for(let a=0,c=i,h=i;a<this.children.length;a++){let u=this.children[a],f=c+u.length;if(c<e&&f>t)return u.domBoundsAround(e,t,c);if(f>=e&&r==-1&&(r=a,s=c),c>t&&u.dom.parentNode==this.dom){o=a,l=h;break}h=f,c=f+u.breakAfter}return{from:s,to:l<0?i+this.length:l,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=ka){this.markDirty();for(let r=e;r<t;r++){let s=this.children[r];s.parent==this&&i.indexOf(s)<0&&s.destroy()}i.length<250?this.children.splice(e,t-e,...i):this.children=[].concat(this.children.slice(0,e),i,this.children.slice(t));for(let r=0;r<i.length;r++)i[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Uf(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,i,r,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}ye.prototype.breakAfter=0;function Fc(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Uf{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Gf(n,e,t,i,r,s,o,l,a){let{children:c}=n,h=c.length?c[e]:null,u=s.length?s[s.length-1]:null,f=u?u.breakAfter:o;if(!(e==i&&h&&!o&&!f&&s.length<2&&h.merge(t,r,s.length?u:null,t==0,l,a))){if(i<c.length){let d=c[i];d&&(r<d.length||d.breakAfter&&(u!=null&&u.breakAfter))?(e==i&&(d=d.split(r),r=0),!f&&u&&d.merge(0,r,u,!0,0,a)?s[s.length-1]=d:((r||d.children.length&&!d.children[0].length)&&d.merge(0,r,null,!1,0,a),s.push(d))):d!=null&&d.breakAfter&&(u?u.breakAfter=1:o=1),i++}for(h&&(h.breakAfter=o,t>0&&(!o&&s.length&&h.merge(t,h.length,s[0],!1,l,0)?h.breakAfter=s.shift().breakAfter:(t<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(t,h.length,null,!1,l,0),e++));e<i&&s.length;)if(c[i-1].become(s[s.length-1]))i--,s.pop(),a=s.length?0:l;else if(c[e].become(s[0]))e++,s.shift(),l=s.length?0:a;else break;!s.length&&e&&i<c.length&&!c[e-1].breakAfter&&c[i].merge(0,0,c[e-1],!1,l,a)&&e--,(e<i||s.length)&&n.replaceChildren(e,i,s)}}function Kf(n,e,t,i,r,s){let o=n.childCursor(),{i:l,off:a}=o.findPos(t,1),{i:c,off:h}=o.findPos(e,-1),u=e-t;for(let f of i)u+=f.length;n.length+=u,Gf(n,c,h,l,a,i,0,r,s)}let Qe=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},yl=typeof document<"u"?document:{documentElement:{style:{}}};const vl=/Edge\/(\d+)/.exec(Qe.userAgent),Jf=/MSIE \d/.test(Qe.userAgent),wl=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Qe.userAgent),Ys=!!(Jf||wl||vl),Wc=!Ys&&/gecko\/(\d+)/i.test(Qe.userAgent),So=!Ys&&/Chrome\/(\d+)/.exec(Qe.userAgent),ny="webkitFontSmoothing"in yl.documentElement.style,Yf=!Ys&&/Apple Computer/.test(Qe.vendor),$c=Yf&&(/Mobile\/\w+/.test(Qe.userAgent)||Qe.maxTouchPoints>2);var H={mac:$c||/Mac/.test(Qe.platform),windows:/Win/.test(Qe.platform),linux:/Linux|X11/.test(Qe.platform),ie:Ys,ie_version:Jf?yl.documentMode||6:wl?+wl[1]:vl?+vl[1]:0,gecko:Wc,gecko_version:Wc?+(/Firefox\/(\d+)/.exec(Qe.userAgent)||[0,0])[1]:0,chrome:!!So,chrome_version:So?+So[1]:0,ios:$c,android:/Android\b/.test(Qe.userAgent),safari:Yf,webkit_version:ny?+(/\bAppleWebKit\/(\d+)/.exec(Qe.userAgent)||[0,0])[1]:0,tabSize:yl.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const iy=256;class yt extends ye{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return this.flags&8||i&&(!(i instanceof yt)||this.length-(t-e)+i.length>iy||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new yt(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Ve(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return ry(this.dom,e,t)}}class Jt extends ye{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let r of t)r.setParent(this)}setAttrs(e){if($f(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,i,r,s,o){return i&&(!(i instanceof Jt&&i.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(Kf(this,e,t,i?i.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],i=0,r=-1,s=0;for(let l of this.children){let a=i+l.length;a>e&&t.push(i<e?l.split(e-i):l),r<0&&i>=e&&(r=s),i=a,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new Jt(this.mark,t,o)}domAtPos(e){return Xf(this,e)}coordsAt(e,t){return Zf(this,e,t)}}function ry(n,e,t){let i=n.nodeValue.length;e>i&&(e=i);let r=e,s=e,o=0;e==0&&t<0||e==i&&t>=0?H.chrome||H.gecko||(e?(r--,o=1):s<i&&(s++,o=-1)):t<0?r--:s<i&&s++;let l=Bn(n,r,s).getClientRects();if(!l.length)return null;let a=l[(o?o<0:t>=0)?0:l.length-1];return H.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,c=>c.width)||a),o?wr(a,o<0):a||null}class an extends ye{static create(e,t,i){return new an(e,t,i)}constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}split(e){let t=an.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,i,r,s,o){return i&&(!(i instanceof an)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e instanceof an&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return he.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,i=t&&t.state.doc,r=this.posAtStart;return i?i.slice(r,r+this.length):he.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Ve.before(this.dom):Ve.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);if(i)return i;let r=this.dom.getClientRects(),s=null;if(!r.length)return null;let o=this.side?this.side<0:e>0;for(let l=o?r.length-1:0;s=r[l],!(e>0?l==0:l==r.length-1||s.top<s.bottom);l+=o?-1:1);return wr(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class di extends ye{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof di&&e.side==this.side}split(){return new di(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Ve.before(this.dom):Ve.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return he.empty}get isHidden(){return!0}}yt.prototype.children=an.prototype.children=di.prototype.children=ka;function Xf(n,e){let t=n.dom,{children:i}=n,r=0;for(let s=0;r<i.length;r++){let o=i[r],l=s+o.length;if(!(l==s&&o.getSide()<=0)){if(e>s&&e<l&&o.dom.parentNode==t)return o.domAtPos(e-s);if(e<=s)break;s=l}}for(let s=r;s>0;s--){let o=i[s-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let s=r;s<i.length;s++){let o=i[s];if(o.dom.parentNode==t)return o.domAtPos(0)}return new Ve(t,0)}function Qf(n,e,t){let i,{children:r}=n;t>0&&e instanceof Jt&&r.length&&(i=r[r.length-1])instanceof Jt&&i.mark.eq(e.mark)?Qf(i,e.children[0],t-1):(r.push(e),e.setParent(n)),n.length+=e.length}function Zf(n,e,t){let i=null,r=-1,s=null,o=-1;function l(c,h){for(let u=0,f=0;u<c.children.length&&f<=h;u++){let d=c.children[u],p=f+d.length;p>=h&&(d.children.length?l(d,h-f):(!s||s.isHidden&&(t>0||oy(s,d)))&&(p>h||f==p&&d.getSide()>0)?(s=d,o=h-f):(f<h||f==p&&d.getSide()<0&&!d.isHidden)&&(i=d,r=h-f)),f=p}}l(n,e);let a=(t<0?i:s)||i||s;return a?a.coordsAt(Math.max(0,a==i?r:o),t):sy(n)}function sy(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=fi(e);return t[t.length-1]||null}function oy(n,e){let t=n.coordsAt(0,1),i=e.coordsAt(0,1);return t&&i&&i.top<t.bottom}function Sl(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const _c=Object.create(null);function ks(n,e,t){if(n==e)return!0;n||(n=_c),e||(e=_c);let i=Object.keys(n),r=Object.keys(e);if(i.length-(t&&i.indexOf(t)>-1?1:0)!=r.length-(t&&r.indexOf(t)>-1?1:0))return!1;for(let s of i)if(s!=t&&(r.indexOf(s)==-1||n[s]!==e[s]))return!1;return!0}function kl(n,e,t){let i=!1;if(e)for(let r in e)t&&r in t||(i=!0,r=="style"?n.style.cssText="":n.removeAttribute(r));if(t)for(let r in t)e&&e[r]==t[r]||(i=!0,r=="style"?n.style.cssText=t[r]:n.setAttribute(r,t[r]));return i}function ly(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let i=n.attributes[t];e[i.name]=i.value}return e}class Qt{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Ke=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(Ke||(Ke={}));class Y extends Pn{constructor(e,t,i,r){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Sr(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return t+=i&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new pn(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,r;if(e.isBlockGap)i=-5e8,r=4e8;else{let{start:s,end:o}=ed(e,t);i=(s?t?-3e8:-1:5e8)-1,r=(o?t?2e8:1:-6e8)+1}return new pn(e,i,r,t,e.widget||null,!0)}static line(e){return new kr(e)}static set(e,t=!1){return ce.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Y.none=ce.empty;class Sr extends Y{constructor(e){let{start:t,end:i}=ed(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,i;return this==e||e instanceof Sr&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&ks(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Sr.prototype.point=!1;class kr extends Y{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof kr&&this.spec.class==e.spec.class&&ks(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}kr.prototype.mapMode=Ge.TrackBefore;kr.prototype.point=!0;class pn extends Y{constructor(e,t,i,r,s,o){super(t,i,s,e),this.block=r,this.isReplace=o,this.mapMode=r?t<=0?Ge.TrackBefore:Ge.TrackAfter:Ge.TrackDel}get type(){return this.startSide!=this.endSide?Ke.WidgetRange:this.startSide<=0?Ke.WidgetBefore:Ke.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof pn&&ay(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}pn.prototype.point=!0;function ed(n,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=n;return t==null&&(t=n.inclusive),i==null&&(i=n.inclusive),{start:t??e,end:i??e}}function ay(n,e){return n==e||!!(n&&e&&n.compare(e))}function as(n,e,t,i=0){let r=t.length-1;r>=0&&t[r]+i>=n?t[r]=Math.max(t[r],e):t.push(n,e)}class De extends ye{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,r,s,o){if(i){if(!(i instanceof De))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),Kf(this,e,t,i?i.children.slice():[],s,o),!0}split(e){let t=new De;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:r}=this.childPos(e);r&&(t.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)t.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){ks(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Qf(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=Sl(t,this.attrs||{})),i&&(this.attrs=Sl({class:i},this.attrs||{}))}domAtPos(e){return Xf(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var i;this.dom?this.flags&4&&($f(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(kl(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&ye.get(r)instanceof Jt;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((i=ye.get(r))===null||i===void 0?void 0:i.isEditable)==!1&&(!H.ios||!this.children.some(s=>s instanceof yt))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let i of this.children){if(!(i instanceof yt)||/[^ -~]/.test(i.text))return null;let r=fi(i.dom);if(r.length!=1)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let i=Zf(this,e,t);if(!this.children.length&&i&&this.parent){let{heightOracle:r}=this.parent.view.viewState,s=i.bottom-i.top;if(Math.abs(s-r.lineHeight)<2&&r.textHeight<s){let o=(s-r.textHeight)/2;return{top:i.top+o,bottom:i.bottom-o,left:i.left,right:i.left}}}return i}become(e){return e instanceof De&&this.children.length==0&&e.children.length==0&&ks(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let i=0,r=0;i<e.children.length;i++){let s=e.children[i],o=r+s.length;if(o>=t){if(s instanceof De)return s;if(o>t)break}r=o+s.breakAfter}return null}}class Ut extends ye{constructor(e,t,i){super(),this.widget=e,this.length=t,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,r,s,o){return i&&(!(i instanceof Ut)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?Ve.before(this.dom):Ve.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new Ut(this.widget,t,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return ka}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):he.empty}domBoundsAround(){return null}become(e){return e instanceof Ut&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);return i||(this.widget instanceof Cl?null:wr(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:i}=this.deco;return t==i?!1:e<0?t<0:i>0}}class Cl extends Qt{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Ki{constructor(e,t,i,r){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Ut&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new De),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Pr(new di(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Ut)&&this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-i)),this.getLine().append(Pr(new yt(this.text.slice(this.textOff,this.textOff+r)),t),i),this.atCursorPos=!0,this.textOff+=r,e-=r,i=0}}span(e,t,i,r){this.buildText(t-e,i,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,i,r,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof pn){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=t-e;if(i instanceof pn)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Ut(i.widget||pi.block,l,i));else{let a=an.create(i.widget||pi.inline,l,l?0:i.startSide),c=this.atCursorPos&&!a.isEditable&&s<=r.length&&(e<t||i.startSide>0),h=!a.isEditable&&(e<t||s>r.length||i.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!c&&!a.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),c&&(u.append(Pr(new di(1),r),s),s=r.length+Math.max(0,s-r.length)),u.append(Pr(a,r),s),this.atCursorPos=h,this.pendingBuffer=h?e<t||s>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,i,r,s){let o=new Ki(e,t,i,s);return o.openEnd=ce.spans(r,t,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Pr(n,e){for(let t of e)n=new Jt(t,[n],n.length);return n}class pi extends Qt{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}pi.inline=new pi("span");pi.block=new pi("div");var Se=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(Se||(Se={}));const zn=Se.LTR,Ca=Se.RTL;function td(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const cy=td("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),hy=td("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Al=Object.create(null),St=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);Al[e]=t,Al[t]=-e}function nd(n){return n<=247?cy[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?hy[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const uy=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class cn{get dir(){return this.level%2?Ca:zn}constructor(e,t,i){this.from=e,this.to=t,this.level=i}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,i,r){let s=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=t&&l.to>=t){if(l.level==i)return o;(s<0||(r!=0?r<0?l.from<t:l.to>t:e[s].level>l.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function id(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let i=n[t],r=e[t];if(i.from!=r.from||i.to!=r.to||i.direction!=r.direction||!id(i.inner,r.inner))return!1}return!0}const xe=[];function fy(n,e,t,i,r){for(let s=0;s<=i.length;s++){let o=s?i[s-1].to:e,l=s<i.length?i[s].from:t,a=s?256:r;for(let c=o,h=a,u=a;c<l;c++){let f=nd(n.charCodeAt(c));f==512?f=h:f==8&&u==4&&(f=16),xe[c]=f==4?2:f,f&7&&(u=f),h=f}for(let c=o,h=a,u=a;c<l;c++){let f=xe[c];if(f==128)c<l-1&&h==xe[c+1]&&h&24?f=xe[c]=h:xe[c]=256;else if(f==64){let d=c+1;for(;d<l&&xe[d]==64;)d++;let p=c&&h==8||d<t&&xe[d]==8?u==1?1:8:256;for(let m=c;m<d;m++)xe[m]=p;c=d-1}else f==8&&u==1&&(xe[c]=1);h=f,f&7&&(u=f)}}}function dy(n,e,t,i,r){let s=r==1?2:1;for(let o=0,l=0,a=0;o<=i.length;o++){let c=o?i[o-1].to:e,h=o<i.length?i[o].from:t;for(let u=c,f,d,p;u<h;u++)if(d=Al[f=n.charCodeAt(u)])if(d<0){for(let m=l-3;m>=0;m-=3)if(St[m+1]==-d){let b=St[m+2],x=b&2?r:b&4?b&1?s:r:0;x&&(xe[u]=xe[St[m]]=x),l=m;break}}else{if(St.length==189)break;St[l++]=u,St[l++]=f,St[l++]=a}else if((p=xe[u])==2||p==1){let m=p==r;a=m?0:1;for(let b=l-3;b>=0;b-=3){let x=St[b+2];if(x&2)break;if(m)St[b+2]|=2;else{if(x&4)break;St[b+2]|=4}}}}}function py(n,e,t,i){for(let r=0,s=i;r<=t.length;r++){let o=r?t[r-1].to:n,l=r<t.length?t[r].from:e;for(let a=o;a<l;){let c=xe[a];if(c==256){let h=a+1;for(;;)if(h==l){if(r==t.length)break;h=t[r++].to,l=r<t.length?t[r].from:e}else if(xe[h]==256)h++;else break;let u=s==1,f=(h<e?xe[h]:i)==1,d=u==f?u?1:2:i;for(let p=h,m=r,b=m?t[m-1].to:n;p>a;)p==b&&(p=t[--m].from,b=m?t[m-1].to:n),xe[--p]=d;a=h}else s=c,a++}}}function Ml(n,e,t,i,r,s,o){let l=i%2?2:1;if(i%2==r%2)for(let a=e,c=0;a<t;){let h=!0,u=!1;if(c==s.length||a<s[c].from){let m=xe[a];m!=l&&(h=!1,u=m==16)}let f=!h&&l==1?[]:null,d=h?i:i+1,p=a;e:for(;;)if(c<s.length&&p==s[c].from){if(u)break e;let m=s[c];if(!h)for(let b=m.to,x=c+1;;){if(b==t)break e;if(x<s.length&&s[x].from==b)b=s[x++].to;else{if(xe[b]==l)break e;break}}if(c++,f)f.push(m);else{m.from>a&&o.push(new cn(a,m.from,d));let b=m.direction==zn!=!(d%2);El(n,b?i+1:i,r,m.inner,m.from,m.to,o),a=m.to}p=m.to}else{if(p==t||(h?xe[p]!=l:xe[p]==l))break;p++}f?Ml(n,a,p,i+1,r,f,o):a<p&&o.push(new cn(a,p,d)),a=p}else for(let a=t,c=s.length;a>e;){let h=!0,u=!1;if(!c||a>s[c-1].to){let m=xe[a-1];m!=l&&(h=!1,u=m==16)}let f=!h&&l==1?[]:null,d=h?i:i+1,p=a;e:for(;;)if(c&&p==s[c-1].to){if(u)break e;let m=s[--c];if(!h)for(let b=m.from,x=c;;){if(b==e)break e;if(x&&s[x-1].to==b)b=s[--x].from;else{if(xe[b-1]==l)break e;break}}if(f)f.push(m);else{m.to<a&&o.push(new cn(m.to,a,d));let b=m.direction==zn!=!(d%2);El(n,b?i+1:i,r,m.inner,m.from,m.to,o),a=m.from}p=m.from}else{if(p==e||(h?xe[p-1]!=l:xe[p-1]==l))break;p--}f?Ml(n,p,a,i+1,r,f,o):p<a&&o.push(new cn(p,a,d)),a=p}}function El(n,e,t,i,r,s,o){let l=e%2?2:1;fy(n,r,s,i,l),dy(n,r,s,i,l),py(r,s,i,l),Ml(n,r,s,e,t,i,o)}function my(n,e,t){if(!n)return[new cn(0,0,e==Ca?1:0)];if(e==zn&&!t.length&&!uy.test(n))return rd(n.length);if(t.length)for(;n.length>xe.length;)xe[xe.length]=256;let i=[],r=e==zn?0:1;return El(n,r,r,t,0,n.length,i),i}function rd(n){return[new cn(0,n,0)]}let sd="";function gy(n,e,t,i,r){var s;let o=i.head-n.from,l=cn.find(e,o,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc),a=e[l],c=a.side(r,t);if(o==c){let f=l+=r?1:-1;if(f<0||f>=e.length)return null;a=e[l=f],o=a.side(!r,t),c=a.side(r,t)}let h=He(n.text,o,a.forward(r,t));(h<a.from||h>a.to)&&(h=c),sd=n.text.slice(Math.min(o,h),Math.max(o,h));let u=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return u&&h==c&&u.level+(r?0:1)<a.level?T.cursor(u.side(!r,t)+n.from,u.forward(r,t)?1:-1,u.level):T.cursor(h+n.from,a.forward(r,t)?-1:1,a.level)}function by(n,e,t){for(let i=e;i<t;i++){let r=nd(n.charCodeAt(i));if(r==1)return zn;if(r==2||r==4)return Ca}return zn}const od=j.define(),ld=j.define(),ad=j.define(),cd=j.define(),Tl=j.define(),hd=j.define(),ud=j.define(),Aa=j.define(),Ma=j.define(),fd=j.define({combine:n=>n.some(e=>e)}),dd=j.define({combine:n=>n.some(e=>e)}),pd=j.define();class si{constructor(e,t="nearest",i="nearest",r=5,s=5,o=!1){this.range=e,this.y=t,this.x=i,this.yMargin=r,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new si(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new si(T.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Ir=ne.define({map:(n,e)=>n.map(e)}),md=ne.define();function et(n,e,t){let i=n.facet(cd);i.length?i[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const $t=j.define({combine:n=>n.length?n[0]:!0});let xy=0;const Xn=j.define({combine(n){return n.filter((e,t)=>{for(let i=0;i<t;i++)if(n[i].plugin==e.plugin)return!1;return!0})}});class Re{constructor(e,t,i,r,s){this.id=e,this.create=t,this.domEventHandlers=i,this.domEventObservers=r,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(Xn.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(Xn.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:i,eventObservers:r,provide:s,decorations:o}=t||{};return new Re(xy++,e,i,r,l=>{let a=[];return o&&a.push(rr.of(c=>{let h=c.plugin(l);return h?o(h):Y.none})),s&&a.push(s(l)),a})}static fromClass(e,t){return Re.define((i,r)=>new e(i,r),t)}}class ko{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(et(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){et(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){et(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const gd=j.define(),Ea=j.define(),rr=j.define(),bd=j.define(),Ta=j.define(),xd=j.define();function Vc(n,e){let t=n.state.facet(xd);if(!t.length)return t;let i=t.map(s=>s instanceof Function?s(n):s),r=[];return ce.spans(i,e.from,e.to,{point(){},span(s,o,l,a){let c=s-e.from,h=o-e.from,u=r;for(let f=l.length-1;f>=0;f--,a--){let d=l[f].spec.bidiIsolate,p;if(d==null&&(d=by(e.text,c,h)),a>0&&u.length&&(p=u[u.length-1]).to==c&&p.direction==d)p.to=h,u=p.inner;else{let m={from:c,to:h,direction:d,inner:[]};u.push(m),u=m.inner}}}}),r}const yd=j.define();function Ra(n){let e=0,t=0,i=0,r=0;for(let s of n.state.facet(yd)){let o=s(n);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(r=Math.max(r,o.bottom)))}return{left:e,right:t,top:i,bottom:r}}const ji=j.define();class dt{constructor(e,t,i,r){this.fromA=e,this.toA=t,this.fromB=i,this.toB=r}join(e){return new dt(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>i.toA)){if(r.toA<i.fromA)break;i=i.join(r),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let r=0,s=0,o=0,l=0;;r++){let a=r==e.length?null:e[r],c=o-l,h=a?a.fromB:1e9;for(;s<t.length&&t[s]<h;){let u=t[s],f=t[s+1],d=Math.max(l,u),p=Math.min(h,f);if(d<=p&&new dt(d+c,p+c,d,p).addToSet(i),f>h)break;s+=2}if(!a)return i;new dt(a.fromA,a.toA,a.fromB,a.toB).addToSet(i),o=a.toA,l=a.toB}}}class Cs{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=Oe.empty(this.startState.doc.length);for(let s of i)this.changes=this.changes.compose(s.changes);let r=[];this.changes.iterChangedRanges((s,o,l,a)=>r.push(new dt(s,o,l,a))),this.changedRanges=r}static create(e,t,i){return new Cs(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class qc extends ye{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Y.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new De],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new dt(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:c,toA:h})=>h<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?r=this.domChanged.newSel.head:!Ay(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let s=r>-1?vy(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:h}=this.hasComposition;i=new dt(c,h,e.changes.mapPos(c,-1),e.changes.mapPos(h,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(H.ie||H.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,l=this.updateDeco(),a=ky(o,l,e.changes);return i=dt.extendWithRanges(i,a),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,i);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=H.chrome||H.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||r.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Ut&&o.widget instanceof Cl&&s.push(o.dom);r.updateGaps(s)}updateChildren(e,t,i){let r=i?i.range.addToSet(e.slice()):e,s=this.childCursor(t);for(let o=r.length-1;;o--){let l=o>=0?r[o]:null;if(!l)break;let{fromA:a,toA:c,fromB:h,toB:u}=l,f,d,p,m;if(i&&i.range.fromB<u&&i.range.toB>h){let C=Ki.build(this.view.state.doc,h,i.range.fromB,this.decorations,this.dynamicDecorationMap),S=Ki.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);d=C.breakAtStart,p=C.openStart,m=S.openEnd;let M=this.compositionView(i);S.breakAtStart?M.breakAfter=1:S.content.length&&M.merge(M.length,M.length,S.content[0],!1,S.openStart,0)&&(M.breakAfter=S.content[0].breakAfter,S.content.shift()),C.content.length&&M.merge(0,0,C.content[C.content.length-1],!0,0,C.openEnd)&&C.content.pop(),f=C.content.concat(M).concat(S.content)}else({content:f,breakAtStart:d,openStart:p,openEnd:m}=Ki.build(this.view.state.doc,h,u,this.decorations,this.dynamicDecorationMap));let{i:b,off:x}=s.findPos(c,1),{i:v,off:w}=s.findPos(a,-1);Gf(this,v,w,b,x,f,d,p,m)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let i of t.effects)i.is(md)&&(this.editContextFormatting=i.value)}compositionView(e){let t=new yt(e.text.nodeValue);t.flags|=8;for(let{deco:r}of e.marks)t=new Jt(r,[t],t.length);let i=new De;return i.append(t,0),i}fixCompositionDOM(e){let t=(s,o)=>{o.flags|=8|(o.children.some(a=>a.flags&7)?1:0),this.markedForComposition.add(o);let l=ye.get(s);l&&l!=o&&(l.dom=null),o.setDOM(s)},i=this.childPos(e.range.fromB,1),r=this.children[i.i];t(e.line,r);for(let s=e.marks.length-1;s>=-1;s--)i=r.childPos(i.off,1),r=r.children[i.i],t(s>=0?e.marks[s].node:e.text,r)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,r=i==this.dom,s=!r&&!(this.view.state.facet($t)||this.dom.tabIndex>-1)&&ls(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(r||t||s))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(l.anchor)),c=l.empty?a:this.moveToLine(this.domAtPos(l.head));if(H.gecko&&l.empty&&!this.hasComposition&&yy(a)){let u=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(u,a.node.childNodes[a.offset]||null)),a=c=new Ve(u,0),o=!0}let h=this.view.observer.selectionRange;(o||!h.focusNode||(!Gi(a.node,a.offset,h.anchorNode,h.anchorOffset)||!Gi(c.node,c.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,l))&&(this.view.observer.ignore(()=>{H.android&&H.chrome&&this.dom.contains(h.focusNode)&&Cy(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let u=ir(this.view.root);if(u)if(l.empty){if(H.gecko){let f=wy(a.node,a.offset);if(f&&f!=3){let d=(f==1?Vf:qf)(a.node,a.offset);d&&(a=new Ve(d.node,d.offset))}}u.collapse(a.node,a.offset),l.bidiLevel!=null&&u.caretBidiLevel!==void 0&&(u.caretBidiLevel=l.bidiLevel)}else if(u.extend){u.collapse(a.node,a.offset);try{u.extend(c.node,c.offset)}catch{}}else{let f=document.createRange();l.anchor>l.head&&([a,c]=[c,a]),f.setEnd(c.node,c.offset),f.setStart(a.node,a.offset),u.removeAllRanges(),u.addRange(f)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(a,c)),this.impreciseAnchor=a.precise?null:new Ve(h.anchorNode,h.anchorOffset),this.impreciseHead=c.precise?null:new Ve(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&Gi(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,i=ir(e.root),{anchorNode:r,anchorOffset:s}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let o=De.find(this,t.head);if(!o)return;let l=o.posAtStart;if(t.head==l||t.head==l+o.length)return;let a=this.coordsAt(t.head,-1),c=this.coordsAt(t.head,1);if(!a||!c||a.bottom>c.top)return;let h=this.domAtPos(t.head+t.assoc);i.collapse(h.node,h.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let u=e.observer.selectionRange;e.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=t.from&&i.collapse(r,s)}moveToLine(e){let t=this.dom,i;if(e.node!=t)return e;for(let r=e.offset;!i&&r<t.childNodes.length;r++){let s=ye.get(t.childNodes[r]);s instanceof De&&(i=s.domAtPos(0))}for(let r=e.offset-1;!i&&r>=0;r--){let s=ye.get(t.childNodes[r]);s instanceof De&&(i=s.domAtPos(s.length))}return i?new Ve(i.node,i.offset,!0):e}nearest(e){for(let t=e;t;){let i=ye.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(i<r.length||r instanceof De)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){let i=null,r=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let l=this.children[o],a=s-l.breakAfter,c=a-l.length;if(a<e)break;if(c<=e&&(c<e||l.covers(-1))&&(a>e||l.covers(1))&&(!i||l instanceof De&&!(i instanceof De&&t>=0)))i=l,r=c;else if(i&&c==e&&a==e&&l instanceof Ut&&Math.abs(t)<2){if(l.deco.startSide<0)break;o&&(i=null)}s=c}return i?i.coordsAt(e-r,t):null}coordsForChar(e){let{i:t,off:i}=this.childPos(e,1),r=this.children[t];if(!(r instanceof De))return null;for(;r.children.length;){let{i:l,off:a}=r.childPos(i,1);for(;;l++){if(l==r.children.length)return null;if((r=r.children[l]).length)break}i=a}if(!(r instanceof yt))return null;let s=He(r.text,i);if(s==i)return null;let o=Bn(r.dom,i,s).getClientRects();for(let l=0;l<o.length;l++){let a=o[l];if(l==o.length-1||a.top<a.bottom&&a.left<a.right)return a}return null}measureVisibleLineHeights(e){let t=[],{from:i,to:r}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==Se.LTR;for(let c=0,h=0;h<this.children.length;h++){let u=this.children[h],f=c+u.length;if(f>r)break;if(c>=i){let d=u.dom.getBoundingClientRect();if(t.push(d.height),o){let p=u.dom.lastChild,m=p?fi(p):[];if(m.length){let b=m[m.length-1],x=a?b.right-d.left:d.right-b.left;x>l&&(l=x,this.minWidth=s,this.minWidthFrom=c,this.minWidthTo=f)}}}c=f+u.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?Se.RTL:Se.LTR}measureTextSize(){for(let s of this.children)if(s instanceof De){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),t,i,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=fi(e.firstChild)[0];t=e.getBoundingClientRect().height,i=s?s.width/27:7,r=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:i,textHeight:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Uf(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,r=0;;r++){let s=r==t.viewports.length?null:t.viewports[r],o=s?s.from-1:this.length;if(o>i){let l=(t.lineBlockAt(o).bottom-t.lineBlockAt(i).top)/this.view.scaleY;e.push(Y.replace({widget:new Cl(l),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return Y.set(e)}updateDeco(){let e=1,t=this.view.state.facet(rr).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),i=!1,r=this.view.state.facet(bd).map((s,o)=>{let l=typeof s=="function";return l&&(i=!0),l?s(this.view):s});for(r.length&&(this.dynamicDecorationMap[e++]=i,t.push(ce.join(r))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(pd))try{if(c(this.view,e.range,e))return!0}catch(h){et(this.view.state,h,"scroll handler")}let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!i)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,r.left),top:Math.min(i.top,r.top),right:Math.max(i.right,r.right),bottom:Math.max(i.bottom,r.bottom)});let s=Ra(this.view),o={left:i.left-s.left,top:i.top-s.top,right:i.right+s.right,bottom:i.bottom+s.bottom},{offsetWidth:l,offsetHeight:a}=this.view.scrollDOM;Xx(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,l),-l),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==Se.LTR)}}function yy(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function vd(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let i=Vf(t.focusNode,t.focusOffset),r=qf(t.focusNode,t.focusOffset),s=i||r;if(r&&i&&r.node!=i.node){let l=ye.get(r.node);if(!l||l instanceof yt&&l.text!=r.node.nodeValue)s=r;else if(n.docView.lastCompositionAfterCursor){let a=ye.get(i.node);!a||a instanceof yt&&a.text!=i.node.nodeValue||(s=r)}}if(n.docView.lastCompositionAfterCursor=s!=i,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function vy(n,e,t){let i=vd(n,t);if(!i)return null;let{node:r,from:s,to:o}=i,l=r.nodeValue;if(/[\n\r]/.test(l)||n.state.doc.sliceString(i.from,i.to)!=l)return null;let a=e.invertedDesc,c=new dt(a.mapPos(s),a.mapPos(o),s,o),h=[];for(let u=r.parentNode;;u=u.parentNode){let f=ye.get(u);if(f instanceof Jt)h.push({node:u,deco:f.mark});else{if(f instanceof De||u.nodeName=="DIV"&&u.parentNode==n.contentDOM)return{range:c,text:r,marks:h,line:u};if(u!=n.contentDOM)h.push({node:u,deco:new Sr({inclusive:!0,attributes:ly(u),tagName:u.tagName.toLowerCase()})});else return null}}}function wy(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let Sy=class{constructor(){this.changes=[]}compareRange(e,t){as(e,t,this.changes)}comparePoint(e,t){as(e,t,this.changes)}boundChange(e){as(e,e,this.changes)}};function ky(n,e,t){let i=new Sy;return ce.compare(n,e,t,i),i.changes}function Cy(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function Ay(n,e){let t=!1;return e&&n.iterChangedRanges((i,r)=>{i<e.to&&r>e.from&&(t=!0)}),t}function My(n,e,t=1){let i=n.charCategorizer(e),r=n.doc.lineAt(e),s=e-r.from;if(r.length==0)return T.cursor(e);s==0?t=1:s==r.length&&(t=-1);let o=s,l=s;t<0?o=He(r.text,s,!1):l=He(r.text,s);let a=i(r.text.slice(o,l));for(;o>0;){let c=He(r.text,o,!1);if(i(r.text.slice(c,o))!=a)break;o=c}for(;l<r.length;){let c=He(r.text,l);if(i(r.text.slice(l,c))!=a)break;l=c}return T.range(o+r.from,l+r.from)}function Ey(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function Ty(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function Co(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function Uc(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function Gc(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function Rl(n,e,t){let i,r,s,o,l=!1,a,c,h,u;for(let p=n.firstChild;p;p=p.nextSibling){let m=fi(p);for(let b=0;b<m.length;b++){let x=m[b];r&&Co(r,x)&&(x=Uc(Gc(x,r.bottom),r.top));let v=Ey(e,x),w=Ty(t,x);if(v==0&&w==0)return p.nodeType==3?Kc(p,e,t):Rl(p,e,t);if(!i||o>w||o==w&&s>v){i=p,r=x,s=v,o=w;let C=w?t<x.top?-1:1:v?e<x.left?-1:1:0;l=!C||(C>0?b<m.length-1:b>0)}v==0?t>x.bottom&&(!h||h.bottom<x.bottom)?(a=p,h=x):t<x.top&&(!u||u.top>x.top)&&(c=p,u=x):h&&Co(h,x)?h=Gc(h,x.bottom):u&&Co(u,x)&&(u=Uc(u,x.top))}}if(h&&h.bottom>=t?(i=a,r=h):u&&u.top<=t&&(i=c,r=u),!i)return{node:n,offset:0};let f=Math.max(r.left,Math.min(r.right,e));if(i.nodeType==3)return Kc(i,f,t);if(l&&i.contentEditable!="false")return Rl(i,f,t);let d=Array.prototype.indexOf.call(n.childNodes,i)+(e>=(r.left+r.right)/2?1:0);return{node:n,offset:d}}function Kc(n,e,t){let i=n.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<i;l++){let a=Bn(n,l,l+1).getClientRects();for(let c=0;c<a.length;c++){let h=a[c];if(h.top==h.bottom)continue;o||(o=e-h.left);let u=(h.top>t?h.top-t:t-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&u<s){let f=e>=(h.left+h.right)/2,d=f;if((H.chrome||H.gecko)&&Bn(n,l).getBoundingClientRect().left==h.right&&(d=!f),u<=0)return{node:n,offset:l+(d?1:0)};r=l+(d?1:0),s=u}}}return{node:n,offset:r>-1?r:o>0?n.nodeValue.length:0}}function wd(n,e,t,i=-1){var r,s;let o=n.contentDOM.getBoundingClientRect(),l=o.top+n.viewState.paddingTop,a,{docHeight:c}=n.viewState,{x:h,y:u}=e,f=u-l;if(f<0)return 0;if(f>c)return n.state.doc.length;for(let C=n.viewState.heightOracle.textHeight/2,S=!1;a=n.elementAtHeight(f),a.type!=Ke.Text;)for(;f=i>0?a.bottom+C:a.top-C,!(f>=0&&f<=c);){if(S)return t?null:0;S=!0,i=-i}u=l+f;let d=a.from;if(d<n.viewport.from)return n.viewport.from==0?0:t?null:Jc(n,o,a,h,u);if(d>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:t?null:Jc(n,o,a,h,u);let p=n.dom.ownerDocument,m=n.root.elementFromPoint?n.root:p,b=m.elementFromPoint(h,u);b&&!n.contentDOM.contains(b)&&(b=null),b||(h=Math.max(o.left+1,Math.min(o.right-1,h)),b=m.elementFromPoint(h,u),b&&!n.contentDOM.contains(b)&&(b=null));let x,v=-1;if(b&&((r=n.docView.nearest(b))===null||r===void 0?void 0:r.isEditable)!=!1){if(p.caretPositionFromPoint){let C=p.caretPositionFromPoint(h,u);C&&({offsetNode:x,offset:v}=C)}else if(p.caretRangeFromPoint){let C=p.caretRangeFromPoint(h,u);C&&({startContainer:x,startOffset:v}=C,(!n.contentDOM.contains(x)||H.safari&&Ry(x,v,h)||H.chrome&&Dy(x,v,h))&&(x=void 0))}x&&(v=Math.min(Lt(x),v))}if(!x||!n.docView.dom.contains(x)){let C=De.find(n.docView,d);if(!C)return f>a.top+a.height/2?a.to:a.from;({node:x,offset:v}=Rl(C.dom,h,u))}let w=n.docView.nearest(x);if(!w)return null;if(w.isWidget&&((s=w.dom)===null||s===void 0?void 0:s.nodeType)==1){let C=w.dom.getBoundingClientRect();return e.y<C.top||e.y<=C.bottom&&e.x<=(C.left+C.right)/2?w.posAtStart:w.posAtEnd}else return w.localPosFromDOM(x,v)+w.posAtStart}function Jc(n,e,t,i,r){let s=Math.round((i-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let l=n.viewState.heightOracle.textHeight,a=Math.floor((r-t.top-(n.defaultLineHeight-l)*.5)/l);s+=a*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+ml(o,s,n.state.tabSize)}function Ry(n,e,t){let i;if(n.nodeType!=3||e!=(i=n.nodeValue.length))return!1;for(let r=n.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return Bn(n,i-1,i).getBoundingClientRect().left>t}function Dy(n,e,t){if(e!=0)return!1;for(let r=n;;){let s=r.parentNode;if(!s||s.nodeType!=1||s.firstChild!=r)return!1;if(s.classList.contains("cm-line"))break;r=s}let i=n.nodeType==1?n.getBoundingClientRect():Bn(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return t-i.left>5}function Dl(n,e,t){let i=n.lineBlockAt(e);if(Array.isArray(i.type)){let r;for(let s of i.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!r||s.type==Ke.Text&&(r.type!=s.type||(t<0?s.from<e:s.to>e)))&&(r=s)}}return r||i}return i}function Ny(n,e,t,i){let r=Dl(n,e.head,e.assoc||-1),s=!i||r.type!=Ke.Text||!(n.lineWrapping||r.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let o=n.dom.getBoundingClientRect(),l=n.textDirectionAt(r.from),a=n.posAtCoords({x:t==(l==Se.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(a!=null)return T.cursor(a,t?-1:1)}return T.cursor(t?r.to:r.from,t?-1:1)}function Yc(n,e,t,i){let r=n.state.doc.lineAt(e.head),s=n.bidiSpans(r),o=n.textDirectionAt(r.from);for(let l=e,a=null;;){let c=gy(r,s,o,l,t),h=sd;if(!c){if(r.number==(t?n.state.doc.lines:1))return l;h=`
`,r=n.state.doc.line(r.number+(t?1:-1)),s=n.bidiSpans(r),c=n.visualLineSide(r,!t)}if(a){if(!a(h))return l}else{if(!i)return c;a=i(h)}l=c}}function Oy(n,e,t){let i=n.state.charCategorizer(e),r=i(t);return s=>{let o=i(s);return r==ke.Space&&(r=o),r==o}}function Ly(n,e,t,i){let r=e.head,s=t?1:-1;if(r==(t?n.state.doc.length:0))return T.cursor(r,e.assoc);let o=e.goalColumn,l,a=n.contentDOM.getBoundingClientRect(),c=n.coordsAtPos(r,e.assoc||-1),h=n.documentTop;if(c)o==null&&(o=c.left-a.left),l=s<0?c.top:c.bottom;else{let d=n.viewState.lineBlockAt(r);o==null&&(o=Math.min(a.right-a.left,n.defaultCharacterWidth*(r-d.from))),l=(s<0?d.top:d.bottom)+h}let u=a.left+o,f=i??n.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=l+(f+d)*s,m=wd(n,{x:u,y:p},!1,s);if(p<a.top||p>a.bottom||(s<0?m<r:m>r)){let b=n.docView.coordsForChar(m),x=!b||p<b.top?-1:1;return T.cursor(m,x,void 0,o)}}}function cs(n,e,t){for(;;){let i=0;for(let r of n)r.between(e-1,e+1,(s,o,l)=>{if(e>s&&e<o){let a=i||t||(e-s<o-e?-1:1);e=a<0?s:o,i=a}});if(!i)return e}}function Ao(n,e,t){let i=cs(n.state.facet(Ta).map(r=>r(n)),t.from,e.head>t.from?-1:1);return i==t.from?t:T.cursor(i,i<t.from?1:-1)}const Hi="ï¿¿";class Py{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(ae.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Hi}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let r=e;;){this.findPointBefore(i,r);let s=this.text.length;this.readNode(r);let o=r.nextSibling;if(o==t)break;let l=ye.get(r),a=ye.get(o);(l&&a?l.breakAfter:(l?l.breakAfter:Ss(r))||Ss(o)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>s)&&this.lineBreak(),r=o}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,l;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(l=r.exec(t))&&(s=l.index,o=l[0].length),this.append(t.slice(i,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=o-1);i=s+o}}readNode(e){if(e.cmIgnore)return;let t=ye.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let r=i.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(Iy(e,i.node,i.offset)?t:0))}}function Iy(n,e,t){for(;;){if(!e||t<Lt(e))return!1;if(e==n)return!0;t=In(e)+1,e=e.parentNode}}class Xc{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class By{constructor(e,t,i,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,i,0))){let l=s||o?[]:Hy(e),a=new Py(l,e.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=Fy(l,this.bounds.from)}else{let l=e.observer.selectionRange,a=s&&s.node==l.focusNode&&s.offset==l.focusOffset||!xl(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),c=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!xl(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset),h=e.viewport;if((H.ios||H.chrome)&&e.state.selection.main.empty&&a!=c&&(h.from>0||h.to<e.state.doc.length)){let u=Math.min(a,c),f=Math.max(a,c),d=h.from-u,p=h.to-f;(d==0||d==1||u==0)&&(p==0||p==-1||f==e.state.doc.length)&&(a=0,c=e.state.doc.length)}this.newSel=T.single(c,a)}}}function Sd(n,e){let t,{newSel:i}=e,r=n.state.selection.main,s=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:l}=e.bounds,a=r.from,c=null;(s===8||H.android&&e.text.length<l-o)&&(a=r.to,c="end");let h=jy(n.state.doc.sliceString(o,l,Hi),e.text,a-o,c);h&&(H.chrome&&s==13&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==Hi+Hi&&h.toB--,t={from:o+h.from,to:o+h.toA,insert:he.of(e.text.slice(h.from,h.toB).split(Hi))})}else i&&(!n.hasFocus&&n.state.facet($t)||i.main.eq(r))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!r.empty&&i&&i.main.empty?t={from:r.from,to:r.to,insert:n.state.doc.slice(r.from,r.to)}:(H.mac||H.android)&&t&&t.from==t.to&&t.from==r.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=T.single(i.main.anchor-1,i.main.head-1)),t={from:t.from,to:t.to,insert:he.of([t.insert.toString().replace("."," ")])}):t&&t.from>=r.from&&t.to<=r.to&&(t.from!=r.from||t.to!=r.to)&&r.to-r.from-(t.to-t.from)<=4?t={from:r.from,to:r.to,insert:n.state.doc.slice(r.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,r.to))}:H.chrome&&t&&t.from==t.to&&t.from==r.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(i&&(i=T.single(i.main.anchor-1,i.main.head-1)),t={from:r.from,to:r.to,insert:he.of([" "])}),t)return Da(n,t,i,s);if(i&&!i.main.eq(r)){let o=!1,l="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),l=n.inputState.lastSelectionOrigin),n.dispatch({selection:i,scrollIntoView:o,userEvent:l}),!0}else return!1}function Da(n,e,t,i=-1){if(H.ios&&n.inputState.flushIOSKey(e))return!0;let r=n.state.selection.main;if(H.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&n.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&ri(n.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&ri(n.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&ri(n.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,l=()=>o||(o=zy(n,e,t));return n.state.facet(hd).some(a=>a(n,e.from,e.to,s,l))||n.dispatch(l()),!0}function zy(n,e,t){let i,r=n.state,s=r.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let l=s.from<e.from?r.sliceDoc(s.from,e.from):"",a=s.to>e.to?r.sliceDoc(e.to,s.to):"";i=r.replaceSelection(n.state.toText(l+e.insert.sliceString(0,void 0,n.state.lineBreak)+a))}else{let l=r.changes(e),a=t&&t.main.to<=l.newLength?t.main:void 0;if(r.selection.ranges.length>1&&n.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let c=n.state.sliceDoc(e.from,e.to),h,u=t&&vd(n,t.main.head);if(u){let p=e.insert.length-(e.to-e.from);h={from:u.from,to:u.to-p}}else h=n.state.doc.lineAt(s.head);let f=s.to-e.to,d=s.to-s.from;i=r.changeByRange(p=>{if(p.from==s.from&&p.to==s.to)return{changes:l,range:a||p.map(l)};let m=p.to-f,b=m-c.length;if(p.to-p.from!=d||n.state.sliceDoc(b,m)!=c||p.to>=h.from&&p.from<=h.to)return{range:p};let x=r.changes({from:b,to:m,insert:e.insert}),v=p.to-s.to;return{changes:x,range:a?T.range(Math.max(0,a.anchor+v),Math.max(0,a.head+v)):p.map(x)}})}else i={changes:l,selection:a&&r.selection.replaceRange(a)}}let o="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,o+=".compose",n.inputState.compositionFirstChange&&(o+=".start",n.inputState.compositionFirstChange=!1)),r.update(i,{userEvent:o,scrollIntoView:!0})}function jy(n,e,t,i){let r=Math.min(n.length,e.length),s=0;for(;s<r&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&n.length==e.length)return null;let o=n.length,l=e.length;for(;o>0&&l>0&&n.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(i=="end"){let a=Math.max(0,s-Math.min(o,l));t-=o+a-s}if(o<s&&n.length<e.length){let a=t<=s&&t>=o?s-t:0;s-=a,l=s+(l-o),o=s}else if(l<s){let a=t<=s&&t>=l?s-t:0;s-=a,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}function Hy(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:r,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new Xc(t,i)),(r!=t||s!=i)&&e.push(new Xc(r,s))),e}function Fy(n,e){if(n.length==0)return null;let t=n[0].pos,i=n.length==2?n[1].pos:t;return t>-1&&i>-1?T.single(t+e,i+e):null}class Wy{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,H.safari&&e.contentDOM.addEventListener("input",()=>null),H.gecko&&iv(e.contentDOM.ownerDocument)}handleEvent(e){!Jy(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let i=this.handlers[e];if(i){for(let r of i.observers)r(this.view,t);for(let r of i.handlers){if(t.defaultPrevented)break;if(r(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=$y(e),i=this.handlers,r=this.view.contentDOM;for(let s in t)if(s!="scroll"){let o=!t[s].handlers.length,l=i[s];l&&o!=!l.handlers.length&&(r.removeEventListener(s,this.handleEvent),l=null),l||r.addEventListener(s,this.handleEvent,{passive:o})}for(let s in i)s!="scroll"&&!t[s]&&r.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&Cd.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),H.android&&H.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return H.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=kd.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||_y.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,ri(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:H.safari&&!H.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Qc(n,e){return(t,i)=>{try{return e.call(n,i,t)}catch(r){et(t.state,r)}}}function $y(n){let e=Object.create(null);function t(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of n){let r=i.spec,s=r&&r.plugin.domEventHandlers,o=r&&r.plugin.domEventObservers;if(s)for(let l in s){let a=s[l];a&&t(l).handlers.push(Qc(i.value,a))}if(o)for(let l in o){let a=o[l];a&&t(l).observers.push(Qc(i.value,a))}}for(let i in vt)t(i).handlers.push(vt[i]);for(let i in mt)t(i).observers.push(mt[i]);return e}const kd=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],_y="dthko",Cd=[16,17,18,20,91,92,224,225],Br=6;function zr(n){return Math.max(0,n)*.7+8}function Vy(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class qy{constructor(e,t,i,r){this.view=e,this.startEvent=t,this.style=i,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=Qx(e.contentDOM),this.atoms=e.state.facet(Ta).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(ae.allowMultipleSelections)&&Uy(e,t),this.dragging=Ky(e,t)&&Ed(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Vy(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,i=0,r=0,s=0,o=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:l}=this.scrollParents.y.getBoundingClientRect());let a=Ra(this.view);e.clientX-a.left<=r+Br?t=-zr(r-e.clientX):e.clientX+a.right>=o-Br&&(t=zr(e.clientX-o)),e.clientY-a.top<=s+Br?i=-zr(s-e.clientY):e.clientY+a.bottom>=l-Br&&(i=zr(e.clientY-l)),this.setScrollSpeed(t,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let i=0;i<e.ranges.length;i++){let r=e.ranges[i],s=null;if(r.empty){let o=cs(this.atoms,r.from,0);o!=r.from&&(s=T.cursor(o,-1))}else{let o=cs(this.atoms,r.from,-1),l=cs(this.atoms,r.to,1);(o!=r.from||l!=r.to)&&(s=T.range(r.from==r.anchor?o:l,r.from==r.head?o:l))}s&&(t||(t=e.ranges.slice()),t[i]=s)}return t?T.create(t,e.mainIndex):e}select(e){let{view:t}=this,i=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Uy(n,e){let t=n.state.facet(od);return t.length?t[0](e):H.mac?e.metaKey:e.ctrlKey}function Gy(n,e){let t=n.state.facet(ld);return t.length?t[0](e):H.mac?!e.altKey:!e.ctrlKey}function Ky(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let i=ir(n.root);if(!i||i.rangeCount==0)return!0;let r=i.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function Jy(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=ye.get(t))&&i.ignoreEvent(e))return!1;return!0}const vt=Object.create(null),mt=Object.create(null),Ad=H.ie&&H.ie_version<15||H.ios&&H.webkit_version<604;function Yy(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),Md(n,t.value)},50)}function Xs(n,e,t){for(let i of n.facet(e))t=i(t,n);return t}function Md(n,e){e=Xs(n.state,Aa,e);let{state:t}=n,i,r=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(Nl!=null&&t.selection.ranges.every(a=>a.empty)&&Nl==s.toString()){let a=-1;i=t.changeByRange(c=>{let h=t.doc.lineAt(c.from);if(h.from==a)return{range:c};a=h.from;let u=t.toText((o?s.line(r++).text:e)+t.lineBreak);return{changes:{from:h.from,insert:u},range:T.cursor(c.from+u.length)}})}else o?i=t.changeByRange(a=>{let c=s.line(r++);return{changes:{from:a.from,to:a.to,insert:c.text},range:T.cursor(a.from+c.length)}}):i=t.replaceSelection(s);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}mt.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};vt.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);mt.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};mt.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};vt.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let i of n.state.facet(ad))if(t=i(n,e),t)break;if(!t&&e.button==0&&(t=Zy(n,e)),t){let i=!n.hasFocus;n.inputState.startMouseSelection(new qy(n,e,t,i)),i&&n.observer.ignore(()=>{Wf(n.contentDOM);let s=n.root.activeElement;s&&!s.contains(n.contentDOM)&&s.blur()});let r=n.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function Zc(n,e,t,i){if(i==1)return T.cursor(e,t);if(i==2)return My(n.state,e,t);{let r=De.find(n.docView,e),s=n.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,l=r?r.posAtEnd:s.to;return l<n.state.doc.length&&l==s.to&&l++,T.range(o,l)}}let eh=(n,e,t)=>e>=t.top&&e<=t.bottom&&n>=t.left&&n<=t.right;function Xy(n,e,t,i){let r=De.find(n.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&eh(t,i,o))return-1;let l=r.coordsAt(s,1);return l&&eh(t,i,l)?1:o&&o.bottom>=i?-1:1}function th(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Xy(n,t,e.clientX,e.clientY)}}const Qy=H.ie&&H.ie_version<=11;let nh=null,ih=0,rh=0;function Ed(n){if(!Qy)return n.detail;let e=nh,t=rh;return nh=n,rh=Date.now(),ih=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(ih+1)%3:1}function Zy(n,e){let t=th(n,e),i=Ed(e),r=n.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),r=r.map(s.changes))},get(s,o,l){let a=th(n,s),c,h=Zc(n,a.pos,a.bias,i);if(t.pos!=a.pos&&!o){let u=Zc(n,t.pos,t.bias,i),f=Math.min(u.from,h.from),d=Math.max(u.to,h.to);h=f<h.from?T.range(f,d):T.range(d,f)}return o?r.replaceRange(r.main.extend(h.from,h.to)):l&&i==1&&r.ranges.length>1&&(c=ev(r,a.pos))?c:l?r.addRange(h):T.create([h])}}}function ev(n,e){for(let t=0;t<n.ranges.length;t++){let{from:i,to:r}=n.ranges[t];if(i<=e&&r>=e)return T.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}vt.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let r=n.docView.nearest(e.target);if(r&&r.isWidget){let s=r.posAtStart,o=s+r.length;(s>=t.to||o<=t.from)&&(t=T.range(s,o))}}let{inputState:i}=n;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Xs(n.state,Ma,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};vt.dragend=n=>(n.inputState.draggedContent=null,!1);function sh(n,e,t,i){if(t=Xs(n.state,Aa,t),!t)return;let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=n.inputState,o=i&&s&&Gy(n,e)?{from:s.from,to:s.to}:null,l={from:r,insert:t},a=n.state.changes(o?[o,l]:l);n.focus(),n.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}vt.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let i=Array(t.length),r=0,s=()=>{++r==t.length&&sh(n,e,i.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(i[o]=l.result),s()},l.readAsText(t[o])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return sh(n,e,i,!0),!0}return!1};vt.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=Ad?null:e.clipboardData;return t?(Md(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(Yy(n),!1)};function tv(n,e){let t=n.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function nv(n){let e=[],t=[],i=!1;for(let r of n.selection.ranges)r.empty||(e.push(n.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>r&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),r=o.number}i=!0}return{text:Xs(n,Ma,e.join(n.lineBreak)),ranges:t,linewise:i}}let Nl=null;vt.copy=vt.cut=(n,e)=>{let{text:t,ranges:i,linewise:r}=nv(n.state);if(!t&&!r)return!1;Nl=r?t:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=Ad?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(tv(n,t),!1)};const Td=Bt.define();function Rd(n,e){let t=[];for(let i of n.facet(ud)){let r=i(n,e);r&&t.push(r)}return t.length?n.update({effects:t,annotations:Td.of(!0)}):null}function Dd(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=Rd(n.state,e);t?n.dispatch(t):n.update([])}},10)}mt.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),Dd(n)};mt.blur=n=>{n.observer.clearSelectionRange(),Dd(n)};mt.compositionstart=mt.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};mt.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,H.chrome&&H.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};mt.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};vt.beforeinput=(n,e)=>{var t,i;if(e.inputType=="insertReplacementText"&&n.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let l=o[0],a=n.posAtDOM(l.startContainer,l.startOffset),c=n.posAtDOM(l.endContainer,l.endOffset);return Da(n,{from:a,to:c,insert:n.state.toText(s)},null),!0}}let r;if(H.chrome&&H.android&&(r=kd.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let s=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return H.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),H.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>mt.compositionend(n,e),20),!1};const oh=new Set;function iv(n){oh.has(n)||(oh.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const lh=["pre-wrap","normal","pre-line","break-spaces"];let mi=!1;function ah(){mi=!1}class rv{constructor(e){this.lineWrapping=e,this.doc=he.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return lh.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let r=e[i];r<0?i++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,i,r,s,o){let l=lh.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=t,this.charWidth=i,this.textHeight=r,this.lineLength=s,a){this.heightSamples={};for(let c=0;c<o.length;c++){let h=o[c];h<0?c++:this.heightSamples[Math.floor(h*10)]=!0}}return a}}class sv{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Tt{constructor(e,t,i,r,s){this.from=e,this.length=t,this.top=i,this.height=r,this._content=s}get type(){return typeof this._content=="number"?Ke.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof pn?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Tt(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var we=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(we||(we={}));const hs=.001;class Je{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>hs&&(mi=!0),this.height=e)}replace(e,t,i){return Je.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,r){let s=this,o=i.doc;for(let l=r.length-1;l>=0;l--){let{fromA:a,toA:c,fromB:h,toB:u}=r[l],f=s.lineAt(a,we.ByPosNoHeight,i.setDoc(t),0,0),d=f.to>=c?f:s.lineAt(c,we.ByPosNoHeight,i,0,0);for(u+=d.to-c,c=d.to;l>0&&f.from<=r[l-1].toA;)a=r[l-1].fromA,h=r[l-1].fromB,l--,a<f.from&&(f=s.lineAt(a,we.ByPosNoHeight,i,0,0));h+=f.from-a,a=f.from;let p=Na.build(i.setDoc(o),e,h,u);s=As(s,s.replace(a,c,p))}return s.updateHeight(i,0)}static empty(){return new rt(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,r=0,s=0;for(;;)if(t==i)if(r>s*2){let l=e[t-1];l.break?e.splice(--t,1,l.left,null,l.right):e.splice(--t,1,l.left,l.right),i+=1+l.break,r-=l.size}else if(s>r*2){let l=e[i];l.break?e.splice(i,1,l.left,null,l.right):e.splice(i,1,l.left,l.right),i+=2+l.break,s-=l.size}else break;else if(r<s){let l=e[t++];l&&(r+=l.size)}else{let l=e[--i];l&&(s+=l.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,i++),new ov(Je.of(e.slice(0,t)),o,Je.of(e.slice(i)))}}function As(n,e){return n==e?n:(n.constructor!=e.constructor&&(mi=!0),e)}Je.prototype.size=1;class Nd extends Je{constructor(e,t,i){super(e,t),this.deco=i}blockAt(e,t,i,r){return new Tt(r,this.length,i,this.height,this.deco||0)}lineAt(e,t,i,r,s){return this.blockAt(0,i,r,s)}forEachLine(e,t,i,r,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,i,r,s))}updateHeight(e,t=0,i=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class rt extends Nd{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,i,r){return new Tt(r,this.length,i,this.height,this.breaks)}replace(e,t,i){let r=i[0];return i.length==1&&(r instanceof rt||r instanceof Ie&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof Ie?r=new rt(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):Je.of(i)}updateHeight(e,t=0,i=!1,r){return r&&r.from<=t&&r.more?this.setHeight(r.heights[r.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Ie extends Je{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,s=r-i+1,o,l=0;if(e.lineWrapping){let a=Math.min(this.height,e.lineHeight*s);o=a/s,this.length>s+1&&(l=(this.height-a)/(this.length-s-1))}else o=this.height/s;return{firstLine:i,lastLine:r,perLine:o,perChar:l}}blockAt(e,t,i,r){let{firstLine:s,lastLine:o,perLine:l,perChar:a}=this.heightMetrics(t,r);if(t.lineWrapping){let c=r+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),h=t.doc.lineAt(c),u=l+h.length*a,f=Math.max(i,e-u/2);return new Tt(h.from,h.length,f,u,0)}else{let c=Math.max(0,Math.min(o-s,Math.floor((e-i)/l))),{from:h,length:u}=t.doc.line(s+c);return new Tt(h,u,i+l*c,l,0)}}lineAt(e,t,i,r,s){if(t==we.ByHeight)return this.blockAt(e,i,r,s);if(t==we.ByPosNoHeight){let{from:d,to:p}=i.doc.lineAt(e);return new Tt(d,p-d,0,0,0)}let{firstLine:o,perLine:l,perChar:a}=this.heightMetrics(i,s),c=i.doc.lineAt(e),h=l+c.length*a,u=c.number-o,f=r+l*u+a*(c.from-s-u);return new Tt(c.from,c.length,Math.max(r,Math.min(f,r+this.height-h)),h,0)}forEachLine(e,t,i,r,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:l,perLine:a,perChar:c}=this.heightMetrics(i,s);for(let h=e,u=r;h<=t;){let f=i.doc.lineAt(h);if(h==e){let p=f.number-l;u+=a*p+c*(e-s-p)}let d=a+c*f.length;o(new Tt(f.from,f.length,u,d,0)),u+=d,h=f.to+1}}replace(e,t,i){let r=this.length-t;if(r>0){let s=i[i.length-1];s instanceof Ie?i[i.length-1]=new Ie(s.length+r):i.push(null,new Ie(r-1))}if(e>0){let s=i[0];s instanceof Ie?i[0]=new Ie(e+s.length):i.unshift(new Ie(e-1),null)}return Je.of(i)}decomposeLeft(e,t){t.push(new Ie(e-1),null)}decomposeRight(e,t){t.push(null,new Ie(this.length-e-1))}updateHeight(e,t=0,i=!1,r){let s=t+this.length;if(r&&r.from<=t+this.length&&r.more){let o=[],l=Math.max(t,r.from),a=-1;for(r.from>t&&o.push(new Ie(r.from-t-1).updateHeight(e,t));l<=s&&r.more;){let h=e.doc.lineAt(l).length;o.length&&o.push(null);let u=r.heights[r.index++];a==-1?a=u:Math.abs(u-a)>=hs&&(a=-2);let f=new rt(h,u);f.outdated=!1,o.push(f),l+=h+1}l<=s&&o.push(null,new Ie(s-l).updateHeight(e,l));let c=Je.of(o);return(a<0||Math.abs(c.height-this.height)>=hs||Math.abs(a-this.heightMetrics(e,t).perLine)>=hs)&&(mi=!0),As(this,c)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class ov extends Je{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,r){let s=i+this.left.height;return e<s?this.left.blockAt(e,t,i,r):this.right.blockAt(e,t,s,r+this.left.length+this.break)}lineAt(e,t,i,r,s){let o=r+this.left.height,l=s+this.left.length+this.break,a=t==we.ByHeight?e<o:e<l,c=a?this.left.lineAt(e,t,i,r,s):this.right.lineAt(e,t,i,o,l);if(this.break||(a?c.to<l:c.from>l))return c;let h=t==we.ByPosNoHeight?we.ByPosNoHeight:we.ByPos;return a?c.join(this.right.lineAt(l,h,i,o,l)):this.left.lineAt(l,h,i,r,s).join(c)}forEachLine(e,t,i,r,s,o){let l=r+this.left.height,a=s+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,i,r,s,o),t>=a&&this.right.forEachLine(e,t,i,l,a,o);else{let c=this.lineAt(a,we.ByPos,i,r,s);e<c.from&&this.left.forEachLine(e,c.from-1,i,r,s,o),c.to>=e&&c.from<=t&&o(c),t>c.to&&this.right.forEachLine(c.to+1,t,i,l,a,o)}}replace(e,t,i){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,i));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let l of i)s.push(l);if(e>0&&ch(s,o-1),t<this.length){let l=s.length;this.decomposeRight(t,s),ch(s,l)}return Je.of(s)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,r=i+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Je.of(this.break?[e,null,t]:[e,t]):(this.left=As(this.left,e),this.right=As(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,r){let{left:s,right:o}=this,l=t+s.length+this.break,a=null;return r&&r.from<=t+s.length&&r.more?a=s=s.updateHeight(e,t,i,r):s.updateHeight(e,t,i),r&&r.from<=l+o.length&&r.more?a=o=o.updateHeight(e,l,i,r):o.updateHeight(e,l,i),a?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function ch(n,e){let t,i;n[e]==null&&(t=n[e-1])instanceof Ie&&(i=n[e+1])instanceof Ie&&n.splice(e-1,3,new Ie(t.length+1+i.length))}const lv=5;class Na{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof rt?r.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new rt(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let r=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let o=t-e;i.block?this.addBlock(new Nd(o,r,i)):(o||s||r>=lv)&&this.addLineDeco(r,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new rt(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new Ie(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof rt)return e;let t=new rt(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,i){let r=this.ensureLine();r.length+=i,r.collapsed+=i,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=t,this.writtenTo=this.pos=this.pos+i}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof rt)&&!this.isCovered?this.nodes.push(new rt(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let r of this.nodes)r instanceof rt&&r.updateHeight(this.oracle,i),i+=r?r.length:1;return this.nodes}static build(e,t,i,r){let s=new Na(i,e);return ce.spans(t,i,r,s,0),s.finish(i)}}function av(n,e,t){let i=new cv;return ce.compare(n,e,t,i,0),i.changes}class cv{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,r){(e<t||i&&i.heightRelevant||r&&r.heightRelevant)&&as(e,t,this.changes,5)}}function hv(n,e){let t=n.getBoundingClientRect(),i=n.ownerDocument,r=i.defaultView||window,s=Math.max(0,t.left),o=Math.min(r.innerWidth,t.right),l=Math.max(0,t.top),a=Math.min(r.innerHeight,t.bottom);for(let c=n.parentNode;c&&c!=i.body;)if(c.nodeType==1){let h=c,u=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&u.overflow!="visible"){let f=h.getBoundingClientRect();s=Math.max(s,f.left),o=Math.min(o,f.right),l=Math.max(l,f.top),a=Math.min(c==n.parentNode?r.innerHeight:a,f.bottom)}c=u.position=="absolute"||u.position=="fixed"?h.offsetParent:h.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:l-(t.top+e),bottom:Math.max(l,a)-(t.top+e)}}function uv(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function fv(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Mo{constructor(e,t,i,r){this.from=e,this.to=t,this.size=i,this.displaySize=r}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=t[i];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e,t){return Y.replace({widget:new dv(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class dv extends Qt{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class hh{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=uh,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Se.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(Ea).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new rv(t),this.stateDeco=e.facet(rr).filter(i=>typeof i!="function"),this.heightMap=Je.empty().applyChanges(this.stateDeco,he.empty,this.heightOracle.setDoc(e.doc),[new dt(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Y.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let r=i?t.head:t.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new jr(s,o))}}return this.viewports=e.sort((i,r)=>i.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?uh:new Oa(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Fi(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(rr).filter(h=>typeof h!="function");let r=e.changedRanges,s=dt.extendWithRanges(r,av(i,this.stateDeco,e?e.changes:Oe.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);ah(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||mi)&&(e.flags|=2),l?(this.scrollAnchorPos=e.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let a=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let c=a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(dd)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),r=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?Se.RTL:Se.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),l=t.getBoundingClientRect(),a=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let c=0,h=0;if(l.width&&l.height){let{scaleX:C,scaleY:S}=Ff(t,l);(C>.005&&Math.abs(this.scaleX-C)>.005||S>.005&&Math.abs(this.scaleY-S)>.005)&&(this.scaleX=C,this.scaleY=S,c|=16,o=a=!0)}let u=(parseInt(i.paddingTop)||0)*this.scaleY,f=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=u||this.paddingBottom!=f)&&(this.paddingTop=u,this.paddingBottom=f,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=_f(e.scrollDOM);let p=(this.printing?fv:hv)(t,this.paddingTop),m=p.top-this.pixelViewport.top,b=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let x=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(x!=this.inView&&(this.inView=x,x&&(a=!0)),!this.inView&&!this.scrollTarget&&!uv(e.dom))return 0;let v=l.width;if((this.contentDOMWidth!=v||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),a){let C=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(C)&&(o=!0),o||r.lineWrapping&&Math.abs(v-this.contentDOMWidth)>r.charWidth){let{lineHeight:S,charWidth:M,textHeight:A}=e.docView.measureTextSize();o=S>0&&r.refresh(s,S,M,A,v/M,C),o&&(e.docView.minWidth=0,c|=16)}m>0&&b>0?h=Math.max(m,b):m<0&&b<0&&(h=Math.min(m,b)),ah();for(let S of this.viewports){let M=S.from==this.viewport.from?C:e.docView.measureVisibleLineHeights(S);this.heightMap=(o?Je.empty().applyChanges(this.stateDeco,he.empty,this.heightOracle,[new dt(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,o,new sv(S.from,M))}mi&&(c|=2)}let w=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return w&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),c|=this.updateForViewport()),(c&2||w)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,a=new jr(r.lineAt(o-i*1e3,we.ByHeight,s,0,0).from,r.lineAt(l+(1-i)*1e3,we.ByHeight,s,0,0).to);if(t){let{head:c}=t.range;if(c<a.from||c>a.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=r.lineAt(c,we.ByPos,s,0,0),f;t.y=="center"?f=(u.top+u.bottom)/2-h/2:t.y=="start"||t.y=="nearest"&&c<a.from?f=u.top:f=u.bottom-h,a=new jr(r.lineAt(f-1e3/2,we.ByHeight,s,0,0).from,r.lineAt(f+h+1e3/2,we.ByHeight,s,0,0).to)}}return a}mapViewport(e,t){let i=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new jr(this.heightMap.lineAt(i,we.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,we.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,we.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,we.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||r<=o-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||s>=l+Math.max(10,Math.min(i,250)))&&r>o-2*1e3&&s<l+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let r of e)t.touchesRange(r.from,r.to)||i.push(new Mo(t.mapPos(r.from),t.mapPos(r.to),r.size,r.displaySize));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,r=i?1e4:2e3,s=r>>1,o=r<<1;if(this.defaultTextDirection!=Se.LTR&&!i)return[];let l=[],a=(h,u,f,d)=>{if(u-h<s)return;let p=this.state.selection.main,m=[p.from];p.empty||m.push(p.to);for(let x of m)if(x>h&&x<u){a(h,x-10,f,d),a(x+10,u,f,d);return}let b=mv(e,x=>x.from>=f.from&&x.to<=f.to&&Math.abs(x.from-h)<s&&Math.abs(x.to-u)<s&&!m.some(v=>x.from<v&&x.to>v));if(!b){if(u<f.to&&t&&i&&t.visibleRanges.some(w=>w.from<=u&&w.to>=u)){let w=t.moveToLineBoundary(T.cursor(u),!1,!0).head;w>h&&(u=w)}let x=this.gapSize(f,h,u,d),v=i||x<2e6?x:2e6;b=new Mo(h,u,x,v)}l.push(b)},c=h=>{if(h.length<o||h.type!=Ke.Text)return;let u=pv(h.from,h.to,this.stateDeco);if(u.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(i){let m=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,b,x;if(f!=null){let v=Fr(u,f),w=((this.visibleBottom-this.visibleTop)/2+m)/h.height;b=v-w,x=v+w}else b=(this.visibleTop-h.top-m)/h.height,x=(this.visibleBottom-h.top+m)/h.height;d=Hr(u,b),p=Hr(u,x)}else{let m=u.total*this.heightOracle.charWidth,b=r*this.heightOracle.charWidth,x=0;if(m>2e6)for(let M of e)M.from>=h.from&&M.from<h.to&&M.size!=M.displaySize&&M.from*this.heightOracle.charWidth+x<this.pixelViewport.left&&(x=M.size-M.displaySize);let v=this.pixelViewport.left+x,w=this.pixelViewport.right+x,C,S;if(f!=null){let M=Fr(u,f),A=((w-v)/2+b)/m;C=M-A,S=M+A}else C=(v-b)/m,S=(w+b)/m;d=Hr(u,C),p=Hr(u,S)}d>h.from&&a(h.from,d,h,u),p<h.to&&a(p,h.to,h,u)};for(let h of this.viewportLines)Array.isArray(h.type)?h.type.forEach(c):c(h);return l}gapSize(e,t,i,r){let s=Fr(r,i)-Fr(r,t);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){Mo.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Y.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let i=[];ce.spans(t,this.viewport.from,this.viewport.to,{span(s,o){i.push({from:s,to:o})},point(){}},20);let r=0;if(i.length!=this.visibleRanges.length)r=12;else for(let s=0;s<i.length&&!(r&8);s++){let o=this.visibleRanges[s],l=i[s];(o.from!=l.from||o.to!=l.to)&&(r|=4,e&&e.mapPos(o.from,-1)==l.from&&e.mapPos(o.to,1)==l.to||(r|=8))}return this.visibleRanges=i,r}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Fi(this.heightMap.lineAt(e,we.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Fi(this.heightMap.lineAt(this.scaler.fromDOM(e),we.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Fi(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class jr{constructor(e,t){this.from=e,this.to=t}}function pv(n,e,t){let i=[],r=n,s=0;return ce.spans(t,n,e,{span(){},point(o,l){o>r&&(i.push({from:r,to:o}),s+=o-r),r=l}},20),r<e&&(i.push({from:r,to:e}),s+=e-r),{total:s,ranges:i}}function Hr({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(n*t);for(let r=0;;r++){let{from:s,to:o}=e[r],l=o-s;if(i<=l)return s+i;i-=l}}function Fr(n,e){let t=0;for(let{from:i,to:r}of n.ranges){if(e<=r){t+=e-i;break}t+=r-i}return t/n.total}function mv(n,e){for(let t of n)if(e(t))return t}const uh={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};class Oa{constructor(e,t,i){let r=0,s=0,o=0;this.viewports=i.map(({from:l,to:a})=>{let c=t.lineAt(l,we.ByPos,e,0,0).top,h=t.lineAt(a,we.ByPos,e,0,0).bottom;return r+=h-c,{from:l,to:a,top:c,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let l of this.viewports)l.domTop=o+(l.top-s)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),s=l.bottom}toDOM(e){for(let t=0,i=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return r+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,r=s.domBottom}}fromDOM(e){for(let t=0,i=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return i+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,r=s.domBottom}}eq(e){return e instanceof Oa?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,i)=>t.from==e.viewports[i].from&&t.to==e.viewports[i].to):!1}}function Fi(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),i=e.toDOM(n.bottom);return new Tt(n.from,n.length,t,i-t,Array.isArray(n._content)?n._content.map(r=>Fi(r,e)):n._content)}const Wr=j.define({combine:n=>n.join(" ")}),Ol=j.define({combine:n=>n.indexOf(!0)>-1}),Ll=fn.newName(),Od=fn.newName(),Ld=fn.newName(),Pd={"&light":"."+Od,"&dark":"."+Ld};function Pl(n,e,t){return new fn(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,r=>{if(r=="&")return n;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):n+" "+i}})}const gv=Pl("."+Ll,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Pd),bv={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Eo=H.ie&&H.ie_version<=11;class xv{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new Zx,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(H.ie&&H.ie_version<=11||H.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(H.chrome&&H.chrome_version<126)&&(this.editContext=new vv(e),e.state.facet($t)&&(e.contentDOM.editContext=this.editContext.editContext)),Eo&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,r=this.selectionRange;if(i.state.facet($t)?i.root.activeElement!=this.dom:!ls(this.dom,r))return;let s=r.anchorNode&&i.docView.nearest(r.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(H.ie&&H.ie_version<=11||H.android&&H.chrome)&&!i.state.selection.main.empty&&r.focusNode&&Gi(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=ir(e.root);if(!t)return!1;let i=H.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&yv(this.view,t)||t;if(!i||this.selectionRange.eq(i))return!1;let r=ls(this.dom,i);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&ty(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,bv),Eo&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Eo&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let r=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&ri(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,i=-1,r=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(r=!0),t==-1?{from:t,to:i}=o:(t=Math.min(o.from,t),i=Math.max(o.to,i)))}return{from:t,to:i,typeOver:r}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),r=this.selectionChanged&&ls(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new By(this.view,e,t,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let i=this.view.state,r=Sd(this.view,t);return this.view.state==i&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let i=fh(t,e.previousSibling||e.target.previousSibling,-1),r=fh(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet($t)!=e.state.facet($t)&&(e.view.contentDOM.editContext=e.state.facet($t)?this.editContext.editContext:null))}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function fh(n,e,t){for(;e;){let i=ye.get(e);if(i&&i.parent==n)return i;let r=e.parentNode;e=r!=n.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function dh(n,e){let t=e.startContainer,i=e.startOffset,r=e.endContainer,s=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor);return Gi(o.node,o.offset,r,s)&&([t,i,r,s]=[r,s,t,i]),{anchorNode:t,anchorOffset:i,focusNode:r,focusOffset:s}}function yv(n,e){if(e.getComposedRanges){let r=e.getComposedRanges(n.root)[0];if(r)return dh(n,r)}let t=null;function i(r){r.preventDefault(),r.stopImmediatePropagation(),t=r.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",i,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",i,!0),t?dh(n,t):null}class vv{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let r=e.state.selection.main,{anchor:s,head:o}=r,l=this.toEditorPos(i.updateRangeStart),a=this.toEditorPos(i.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:l,drifted:!1});let c={from:l,to:a,insert:he.of(i.text.split(`
`))};if(c.from==this.from&&s<this.from?c.from=s:c.to==this.to&&s>this.to&&(c.to=s),c.from==c.to&&!c.insert.length){let h=T.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));h.main.eq(r)||e.dispatch({selection:h,userEvent:"select"});return}if((H.mac||H.android)&&c.from==o-1&&/^\. ?$/.test(i.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:l,to:a,insert:he.of([i.text.replace("."," ")])}),this.pendingContextChange=c,!e.state.readOnly){let h=this.to-this.from+(c.to-c.from+c.insert.length);Da(e,c,T.single(this.toEditorPos(i.selectionStart,h),this.toEditorPos(i.selectionEnd,h)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=i=>{let r=[],s=null;for(let o=this.toEditorPos(i.rangeStart),l=this.toEditorPos(i.rangeEnd);o<l;o++){let a=e.coordsForChar(o);s=a&&new DOMRect(a.left,a.top,a.right-a.left,a.bottom-a.top)||s||new DOMRect,r.push(s)}t.updateCharacterBounds(i.rangeStart,r)},this.handlers.textformatupdate=i=>{let r=[];for(let s of i.getTextFormats()){let o=s.underlineStyle,l=s.underlineThickness;if(o!="None"&&l!="None"){let a=this.toEditorPos(s.rangeStart),c=this.toEditorPos(s.rangeEnd);if(a<c){let h=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${l=="Thin"?1:2}px`;r.push(Y.mark({attributes:{style:h}}).range(a,c))}}}e.dispatch({effects:md.of(Y.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(e.state)}};for(let i in this.handlers)t.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let r=ir(i.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,i=!1,r=this.pendingContextChange;return e.changes.iterChanges((s,o,l,a,c)=>{if(i)return;let h=c.length-(o-s);if(r&&o>=r.to)if(r.from==s&&r.to==o&&r.insert.eq(c)){r=this.pendingContextChange=null,t+=h,this.to+=h;return}else r=null,this.revertPending(e.state);if(s+=t,o+=t,o<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+c.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),c.toString()),this.to+=h}t+=h}),r&&!i&&this.revertPending(e.state),!i}update(e){let t=this.pendingContextChange,i=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(i.from,i.to)&&e.transactions.some(r=>!r.isUserEvent("input.type")&&r.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),r=this.toContextPos(t.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(i,r)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let i=this.composing;return i&&i.drifted?i.editorBase+(e-i.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}let B=class Il{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(r=>r.forEach(s=>i(s,this)))||(r=>this.update(r)),this.dispatch=this.dispatch.bind(this),this._root=e.root||ey(e.parent)||document,this.viewState=new hh(e.state||ae.create(e)),e.scrollTo&&e.scrollTo.is(Ir)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Xn).map(r=>new ko(r));for(let r of this.plugins)r.update(this);this.observer=new xv(this),this.inputState=new Wy(this),this.inputState.ensureHandlers(this.plugins),this.docView=new qc(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof Le?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,r,s=this.state;for(let f of e){if(f.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=f.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,l=0,a=null;e.some(f=>f.annotation(Td))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,a=Rd(s,o),a||(l=1));let c=this.observer.delayedAndroidKey,h=null;if(c?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(ae.phrases)!=this.state.facet(ae.phrases))return this.setState(s);r=Cs.create(this,s,e),r.flags|=l;let u=this.viewState.scrollTarget;try{this.updateState=2;for(let f of e){if(u&&(u=u.map(f.changes)),f.scrollIntoView){let{main:d}=f.state.selection;u=new si(d.empty?d:T.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of f.effects)d.is(Ir)&&(u=d.value.clip(this.state))}this.viewState.update(r,u),this.bidiCache=Ms.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(ji)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(Wr)!=r.state.facet(Wr)&&(this.viewState.mustMeasureContent=!0),(t||i||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!r.empty)for(let f of this.state.facet(Tl))try{f(r)}catch(d){et(this.state,d,"update listener")}(a||h)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),h&&!Sd(this,h)&&c.force&&ri(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new hh(e),this.plugins=e.facet(Xn).map(i=>new ko(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new qc(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Xn),i=e.state.facet(Xn);if(t!=i){let r=[];for(let s of i){let o=t.indexOf(s);if(o<0)r.push(new ko(s));else{let l=this.plugins[o];l.mustUpdate=e,r.push(l)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);t!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(i){et(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,i=this.scrollDOM,r=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if(_f(i))s=-1,o=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(r);s=d.from,o=d.top}this.updateState=1;let a=this.viewState.measure(this);if(!a&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];a&4||([this.measureRequests,c]=[c,this.measureRequests]);let h=c.map(d=>{try{return d.read(this)}catch(p){return et(this.state,p),ph}}),u=Cs.create(this,this.state,[]),f=!1;u.flags|=a,t?t.flags|=a:t=u,this.updateState=2,u.empty||(this.updatePlugins(u),this.inputState.update(u),this.updateAttrs(),f=this.docView.update(u),f&&this.docViewUpdate());for(let d=0;d<c.length;d++)if(h[d]!=ph)try{let p=c[d];p.write&&p.write(h[d],this)}catch(p){et(this.state,p)}if(f&&this.docView.updateSelection(!0),!u.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(p>1||p<-1){r=r+p,i.scrollTop=r/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let l of this.state.facet(Tl))l(t)}get themeClasses(){return Ll+" "+(this.state.facet(Ol)?Ld:Od)+" "+this.state.facet(Wr)}updateAttrs(){let e=mh(this,gd,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet($t)?"true":"false",class:"cm-content",style:`${H.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),mh(this,Ea,t);let i=this.observer.ignore(()=>{let r=kl(this.contentDOM,this.contentAttrs,t),s=kl(this.dom,this.editorAttrs,e);return r||s});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let r of i.effects)if(r.is(Il.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(ji);let e=this.state.facet(Il.cspNonce);fn.mount(this.root,this.styleModules.concat(gv).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return Ao(this,e,Yc(this,e,t,i))}moveByGroup(e,t){return Ao(this,e,Yc(this,e,t,i=>Oy(this,e.head,i)))}visualLineSide(e,t){let i=this.bidiSpans(e),r=this.textDirectionAt(e.from),s=i[t?i.length-1:0];return T.cursor(s.side(t,r)+e.from,s.forward(!t,r)?1:-1)}moveToLineBoundary(e,t,i=!0){return Ny(this,e,t,i)}moveVertically(e,t,i){return Ao(this,e,Ly(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),wd(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[cn.find(s,e-r.from,-1,t)];return wr(i,o.dir==Se.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(fd)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>wv)return rd(e.length);let t=this.textDirectionAt(e.from),i;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||id(s.isolates,i=Vc(this,e))))return s.order;i||(i=Vc(this,e));let r=my(e.text,t,i);return this.bidiCache.push(new Ms(e.from,e.to,t,i,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||H.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Wf(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Ir.of(new si(typeof e=="number"?T.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return Ir.of(new si(T.cursor(i.from),"start","start",i.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Re.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Re.define(()=>({}),{eventObservers:e})}static theme(e,t){let i=fn.newName(),r=[Wr.of(i),ji.of(Pl(`.${i}`,e))];return t&&t.dark&&r.push(Ol.of(!0)),r}static baseTheme(e){return bn.lowest(ji.of(Pl("."+Ll,e,Pd)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),r=i&&ye.get(i)||ye.get(e);return((t=r==null?void 0:r.rootView)===null||t===void 0?void 0:t.view)||null}};B.styleModule=ji;B.inputHandler=hd;B.clipboardInputFilter=Aa;B.clipboardOutputFilter=Ma;B.scrollHandler=pd;B.focusChangeEffect=ud;B.perLineTextDirection=fd;B.exceptionSink=cd;B.updateListener=Tl;B.editable=$t;B.mouseSelectionStyle=ad;B.dragMovesSelection=ld;B.clickAddsSelectionRange=od;B.decorations=rr;B.outerDecorations=bd;B.atomicRanges=Ta;B.bidiIsolatedRanges=xd;B.scrollMargins=yd;B.darkTheme=Ol;B.cspNonce=j.define({combine:n=>n.length?n[0]:""});B.contentAttributes=Ea;B.editorAttributes=gd;B.lineWrapping=B.contentAttributes.of({class:"cm-lineWrapping"});B.announce=ne.define();const wv=4096,ph={};class Ms{constructor(e,t,i,r,s,o){this.from=e,this.to=t,this.dir=i,this.isolates=r,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let i=[],r=e.length?e[e.length-1].dir:Se.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!t.touchesRange(o.from,o.to)&&i.push(new Ms(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function mh(n,e,t){for(let i=n.state.facet(e),r=i.length-1;r>=0;r--){let s=i[r],o=typeof s=="function"?s(n):s;o&&Sl(o,t)}return t}const Sv=H.mac?"mac":H.windows?"win":H.linux?"linux":"key";function kv(n,e){const t=n.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let r,s,o,l;for(let a=0;a<t.length-1;++a){const c=t[a];if(/^(cmd|meta|m)$/i.test(c))l=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(i="Alt-"+i),s&&(i="Ctrl-"+i),l&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function $r(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const Cv=bn.default(B.domEventHandlers({keydown(n,e){return Bd(Id(e.state),n,e,"editor")}})),Cr=j.define({enables:Cv}),gh=new WeakMap;function Id(n){let e=n.facet(Cr),t=gh.get(e);return t||gh.set(e,t=Ev(e.reduce((i,r)=>i.concat(r),[]))),t}function Av(n,e,t){return Bd(Id(n.state),e,n,t)}let rn=null;const Mv=4e3;function Ev(n,e=Sv){let t=Object.create(null),i=Object.create(null),r=(o,l)=>{let a=i[o];if(a==null)i[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,l,a,c,h)=>{var u,f;let d=t[o]||(t[o]=Object.create(null)),p=l.split(/ (?!$)/).map(x=>kv(x,e));for(let x=1;x<p.length;x++){let v=p.slice(0,x).join(" ");r(v,!0),d[v]||(d[v]={preventDefault:!0,stopPropagation:!1,run:[w=>{let C=rn={view:w,prefix:v,scope:o};return setTimeout(()=>{rn==C&&(rn=null)},Mv),!0}]})}let m=p.join(" ");r(m,!1);let b=d[m]||(d[m]={preventDefault:!1,stopPropagation:!1,run:((f=(u=d._any)===null||u===void 0?void 0:u.run)===null||f===void 0?void 0:f.slice())||[]});a&&b.run.push(a),c&&(b.preventDefault=!0),h&&(b.stopPropagation=!0)};for(let o of n){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of l){let h=t[c]||(t[c]=Object.create(null));h._any||(h._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:u}=o;for(let f in h)h[f].run.push(d=>u(d,Bl))}let a=o[e]||o.key;if(a)for(let c of l)s(c,a,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(c,"Shift-"+a,o.shift,o.preventDefault,o.stopPropagation)}return t}let Bl=null;function Bd(n,e,t,i){Bl=e;let r=Jx(e),s=Xe(r,0),o=Et(s)==r.length&&r!=" ",l="",a=!1,c=!1,h=!1;rn&&rn.view==t&&rn.scope==i&&(l=rn.prefix+" ",Cd.indexOf(e.keyCode)<0&&(c=!0,rn=null));let u=new Set,f=b=>{if(b){for(let x of b.run)if(!u.has(x)&&(u.add(x),x(t)))return b.stopPropagation&&(h=!0),!0;b.preventDefault&&(b.stopPropagation&&(h=!0),c=!0)}return!1},d=n[i],p,m;return d&&(f(d[l+$r(r,e,!o)])?a=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(H.windows&&e.ctrlKey&&e.altKey)&&(p=dn[e.keyCode])&&p!=r?(f(d[l+$r(p,e,!0)])||e.shiftKey&&(m=nr[e.keyCode])!=r&&m!=p&&f(d[l+$r(m,e,!1)]))&&(a=!0):o&&e.shiftKey&&f(d[l+$r(r,e,!0)])&&(a=!0),!a&&f(d._any)&&(a=!0)),c&&(a=!0),a&&h&&e.stopPropagation(),Bl=null,a}class Ar{constructor(e,t,i,r,s){this.className=e,this.left=t,this.top=i,this.width=r,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,i){if(i.empty){let r=e.coordsAtPos(i.head,i.assoc||1);if(!r)return[];let s=zd(e);return[new Ar(t,r.left-s.left,r.top-s.top,null,r.bottom-r.top)]}else return Tv(e,t,i)}}function zd(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Se.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function bh(n,e,t,i){let r=n.coordsAtPos(e,t*2);if(!r)return i;let s=n.dom.getBoundingClientRect(),o=(r.top+r.bottom)/2,l=n.posAtCoords({x:s.left+1,y:o}),a=n.posAtCoords({x:s.right-1,y:o});return l==null||a==null?i:{from:Math.max(i.from,Math.min(l,a)),to:Math.min(i.to,Math.max(l,a))}}function Tv(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let i=Math.max(t.from,n.viewport.from),r=Math.min(t.to,n.viewport.to),s=n.textDirection==Se.LTR,o=n.contentDOM,l=o.getBoundingClientRect(),a=zd(n),c=o.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),u=l.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),f=l.right-(h?parseInt(h.paddingRight):0),d=Dl(n,i,1),p=Dl(n,r,-1),m=d.type==Ke.Text?d:null,b=p.type==Ke.Text?p:null;if(m&&(n.lineWrapping||d.widgetLineBreaks)&&(m=bh(n,i,1,m)),b&&(n.lineWrapping||p.widgetLineBreaks)&&(b=bh(n,r,-1,b)),m&&b&&m.from==b.from&&m.to==b.to)return v(w(t.from,t.to,m));{let S=m?w(t.from,null,m):C(d,!1),M=b?w(null,t.to,b):C(p,!0),A=[];return(m||d).to<(b||p).from-(m&&b?1:0)||d.widgetLineBreaks>1&&S.bottom+n.defaultLineHeight/2<M.top?A.push(x(u,S.bottom,f,M.top)):S.bottom<M.top&&n.elementAtHeight((S.bottom+M.top)/2).type==Ke.Text&&(S.bottom=M.top=(S.bottom+M.top)/2),v(S).concat(A).concat(v(M))}function x(S,M,A,O){return new Ar(e,S-a.left,M-a.top,A-S,O-M)}function v({top:S,bottom:M,horizontal:A}){let O=[];for(let N=0;N<A.length;N+=2)O.push(x(A[N],S,A[N+1],M));return O}function w(S,M,A){let O=1e9,N=-1e9,W=[];function z($,J,E,D,_){let V=n.coordsAtPos($,$==A.to?-2:2),te=n.coordsAtPos(E,E==A.from?2:-2);!V||!te||(O=Math.min(V.top,te.top,O),N=Math.max(V.bottom,te.bottom,N),_==Se.LTR?W.push(s&&J?u:V.left,s&&D?f:te.right):W.push(!s&&D?u:te.left,!s&&J?f:V.right))}let R=S??A.from,Q=M??A.to;for(let $ of n.visibleRanges)if($.to>R&&$.from<Q)for(let J=Math.max($.from,R),E=Math.min($.to,Q);;){let D=n.state.doc.lineAt(J);for(let _ of n.bidiSpans(D)){let V=_.from+D.from,te=_.to+D.from;if(V>=E)break;te>J&&z(Math.max(V,J),S==null&&V<=R,Math.min(te,E),M==null&&te>=Q,_.dir)}if(J=D.to+1,J>=E)break}return W.length==0&&z(R,S==null,Q,M==null,n.textDirection),{top:O,bottom:N,horizontal:W}}function C(S,M){let A=l.top+(M?S.top:S.bottom);return{top:A,bottom:A,horizontal:[]}}}function Rv(n,e){return n.constructor==e.constructor&&n.eq(e)}class Dv{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(us)!=e.state.facet(us)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,i=e.facet(us);for(;t<i.length&&i[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,i)=>!Rv(t,this.drawn[i]))){let t=this.dom.firstChild,i=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[i].constructor&&r.update(t,this.drawn[i])?(t=t.nextSibling,i++):this.dom.insertBefore(r.draw(),t);for(;t;){let r=t.nextSibling;t.remove(),t=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const us=j.define();function jd(n){return[Re.define(e=>new Dv(e,n)),us.of(n)]}const sr=j.define({combine(n){return zt(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function Nv(n={}){return[sr.of(n),Ov,Lv,Pv,dd.of(!0)]}function Hd(n){return n.startState.facet(sr)!=n.state.facet(sr)}const Ov=jd({above:!0,markers(n){let{state:e}=n,t=e.facet(sr),i=[];for(let r of e.selection.ranges){let s=r==e.selection.main;if(r.empty||t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=r.empty?r:T.cursor(r.head,r.head>r.anchor?-1:1);for(let a of Ar.forRange(n,o,l))i.push(a)}}return i},update(n,e){n.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=Hd(n);return t&&xh(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){xh(e.state,n)},class:"cm-cursorLayer"});function xh(n,e){e.style.animationDuration=n.facet(sr).cursorBlinkRate+"ms"}const Lv=jd({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:Ar.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||Hd(n)},class:"cm-selectionLayer"}),Pv=bn.highest(B.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),Fd=ne.define({map(n,e){return n==null?null:e.mapPos(n)}}),Wi=Fe.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,i)=>i.is(Fd)?i.value:t,n)}}),Iv=Re.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(Wi);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(Wi)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(Wi),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let i=n.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-i.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(Wi)!=n&&this.view.dispatch({effects:Fd.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Bv(){return[Wi,Iv]}function yh(n,e,t,i,r){e.lastIndex=0;for(let s=n.iterRange(t,i),o=t,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=e.exec(s.value);)r(o+l.index,l)}function zv(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let i=[];for(let{from:r,to:s}of t)r=Math.max(n.state.doc.lineAt(r).from,r-e),s=Math.min(n.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}class jv{constructor(e){const{regexp:t,decoration:i,decorate:r,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,r)this.addMatch=(l,a,c,h)=>r(h,c,c+l[0].length,l,a);else if(typeof i=="function")this.addMatch=(l,a,c,h)=>{let u=i(l,a,c);u&&h(c,c+l[0].length,u)};else if(i)this.addMatch=(l,a,c,h)=>h(c,c+l[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let t=new Kt,i=t.add.bind(t);for(let{from:r,to:s}of zv(e,this.maxLength))yh(e.state.doc,this.regexp,r,s,(o,l)=>this.addMatch(l,e,o,i));return t.finish()}updateDeco(e,t){let i=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((s,o,l,a)=>{a>=e.view.viewport.from&&l<=e.view.viewport.to&&(i=Math.min(l,i),r=Math.max(a,r))}),e.viewportMoved||r-i>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),i,r):t}updateRange(e,t,i,r){for(let s of e.visibleRanges){let o=Math.max(s.from,i),l=Math.min(s.to,r);if(l>=o){let a=e.state.doc.lineAt(o),c=a.to<l?e.state.doc.lineAt(l):a,h=Math.max(s.from,a.from),u=Math.min(s.to,c.to);if(this.boundary){for(;o>a.from;o--)if(this.boundary.test(a.text[o-1-a.from])){h=o;break}for(;l<c.to;l++)if(this.boundary.test(c.text[l-c.from])){u=l;break}}let f=[],d,p=(m,b,x)=>f.push(x.range(m,b));if(a==c)for(this.regexp.lastIndex=h-a.from;(d=this.regexp.exec(a.text))&&d.index<u-a.from;)this.addMatch(d,e,d.index+a.from,p);else yh(e.state.doc,this.regexp,h,u,(m,b)=>this.addMatch(b,e,m,p));t=t.update({filterFrom:h,filterTo:u,filter:(m,b)=>m<h||b>u,add:f})}}return t}}const zl=/x/.unicode!=null?"gu":"g",Hv=new RegExp(`[\0-\b
--ÂŸÂ­Øœâ€‹â€Žâ€\u2028\u2029â€­â€®â¦â§â©\uFEFFï¿¹-ï¿¼]`,zl),Fv={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let To=null;function Wv(){var n;if(To==null&&typeof document<"u"&&document.body){let e=document.body.style;To=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return To||!1}const fs=j.define({combine(n){let e=zt(n,{render:null,specialChars:Hv,addSpecialChars:null});return(e.replaceTabs=!Wv())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,zl)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,zl)),e}});function $v(n={}){return[fs.of(n),_v()]}let vh=null;function _v(){return vh||(vh=Re.fromClass(class{constructor(n){this.view=n,this.decorations=Y.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(fs)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new jv({regexp:n.specialChars,decoration:(e,t,i)=>{let{doc:r}=t.state,s=Xe(e[0],0);if(s==9){let o=r.lineAt(i),l=t.state.tabSize,a=ki(o.text,l,i-o.from);return Y.replace({widget:new Gv((l-a%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=Y.replace({widget:new Uv(n,s)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(fs);n.startState.facet(fs)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const Vv="â€¢";function qv(n){return n>=32?Vv:n==10?"â¤":String.fromCharCode(9216+n)}class Uv extends Qt{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=qv(this.code),i=e.state.phrase("Control character")+" "+(Fv[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,i,t);if(r)return r;let s=document.createElement("span");return s.textContent=t,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class Gv extends Qt{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function Kv(){return Yv}const Jv=Y.line({class:"cm-activeLine"}),Yv=Re.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let i of n.state.selection.ranges){let r=n.lineBlockAt(i.head);r.from>e&&(t.push(Jv.range(r.from)),e=r.from)}return Y.set(t)}},{decorations:n=>n.decorations});class Xv extends Qt{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?fi(e.firstChild):[];if(!t.length)return null;let i=window.getComputedStyle(e.parentNode),r=wr(t[0],i.direction!="rtl"),s=parseInt(i.lineHeight);return r.bottom-r.top>s*1.5?{left:r.left,right:r.right,top:r.top,bottom:r.top+s}:r}ignoreEvent(){return!1}}function Qv(n){let e=Re.fromClass(class{constructor(t){this.view=t,this.placeholder=n?Y.set([Y.widget({widget:new Xv(n),side:1}).range(0)]):Y.none}get decorations(){return this.view.state.doc.length?Y.none:this.placeholder}},{decorations:t=>t.decorations});return typeof n=="string"?[e,B.contentAttributes.of({"aria-placeholder":n})]:e}const jl=2e3;function Zv(n,e,t){let i=Math.min(e.line,t.line),r=Math.max(e.line,t.line),s=[];if(e.off>jl||t.off>jl||e.col<0||t.col<0){let o=Math.min(e.off,t.off),l=Math.max(e.off,t.off);for(let a=i;a<=r;a++){let c=n.doc.line(a);c.length<=l&&s.push(T.range(c.from+o,c.to+l))}}else{let o=Math.min(e.col,t.col),l=Math.max(e.col,t.col);for(let a=i;a<=r;a++){let c=n.doc.line(a),h=ml(c.text,o,n.tabSize,!0);if(h<0)s.push(T.cursor(c.to));else{let u=ml(c.text,l,n.tabSize);s.push(T.range(c.from+h,c.from+u))}}}return s}function ew(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function wh(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),i=n.state.doc.lineAt(t),r=t-i.from,s=r>jl?-1:r==i.length?ew(n,e.clientX):ki(i.text,n.state.tabSize,t-i.from);return{line:i.number,col:s,off:r}}function tw(n,e){let t=wh(n,e),i=n.state.selection;return t?{update(r){if(r.docChanged){let s=r.changes.mapPos(r.startState.doc.line(t.line).from),o=r.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},i=i.map(r.changes)}},get(r,s,o){let l=wh(n,r);if(!l)return i;let a=Zv(n.state,t,l);return a.length?o?T.create(a.concat(i.ranges)):T.create(a):i}}:null}function nw(n){let e=t=>t.altKey&&t.button==0;return B.mouseSelectionStyle.of((t,i)=>e(i)?tw(t,i):null)}const iw={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},rw={style:"cursor: crosshair"};function sw(n={}){let[e,t]=iw[n.key||"Alt"],i=Re.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventObservers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)},mousemove(r){this.set(t(r))}}});return[i,B.contentAttributes.of(r=>{var s;return!((s=r.plugin(i))===null||s===void 0)&&s.isDown?rw:null})]}const Li="-10000px";class Wd{constructor(e,t,i,r){this.facet=t,this.createTooltipView=i,this.removeTooltipView=r,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=i(o,s))}update(e,t){var i;let r=e.state.facet(this.facet),s=r.filter(a=>a);if(r===this.input){for(let a of this.tooltipViews)a.update&&a.update(e);return!1}let o=[],l=t?[]:null;for(let a=0;a<s.length;a++){let c=s[a],h=-1;if(c){for(let u=0;u<this.tooltips.length;u++){let f=this.tooltips[u];f&&f.create==c.create&&(h=u)}if(h<0)o[a]=this.createTooltipView(c,a?o[a-1]:null),l&&(l[a]=!!c.above);else{let u=o[a]=this.tooltipViews[h];l&&(l[a]=t[h]),u.update&&u.update(e)}}}for(let a of this.tooltipViews)o.indexOf(a)<0&&(this.removeTooltipView(a),(i=a.destroy)===null||i===void 0||i.call(a));return t&&(l.forEach((a,c)=>t[c]=a),t.length=l.length),this.input=r,this.tooltips=s,this.tooltipViews=o,!0}}function ow(n){let e=n.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const Ro=j.define({combine:n=>{var e,t,i;return{position:H.ios?"absolute":((e=n.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=n.find(r=>r.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||ow}}}),Sh=new WeakMap,La=Re.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(Ro);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Wd(n,Pa,(t,i)=>this.createTooltip(t,i),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,i=n.state.facet(Ro);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),i=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",t.dom.appendChild(r)}return t.dom.style.position=this.position,t.dom.style.top=Li,t.dom.style.left="0px",this.container.insertBefore(t.dom,i),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(n=i.destroy)===null||n===void 0||n.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(H.gecko)t=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==Li&&s.style.left=="0px"){let o=s.getBoundingClientRect();t=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(t||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(n=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:e}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),r=Ra(this.view);return{visible:{left:i.left+r.left,top:i.top+r.top,right:i.right-r.right,bottom:i.bottom-r.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,o)=>{let l=this.manager.tooltipViews[o];return l.getCoords?l.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(Ro).tooltipSpace(this.view),scaleX:n,scaleY:e,makeAbsolute:t}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{visible:t,space:i,scaleX:r,scaleY:s}=n,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],c=this.manager.tooltipViews[l],{dom:h}=c,u=n.pos[l],f=n.size[l];if(!u||a.clip!==!1&&(u.bottom<=Math.max(t.top,i.top)||u.top>=Math.min(t.bottom,i.bottom)||u.right<Math.max(t.left,i.left)-.1||u.left>Math.min(t.right,i.right)+.1)){h.style.top=Li;continue}let d=a.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,m=f.right-f.left,b=(e=Sh.get(c))!==null&&e!==void 0?e:f.bottom-f.top,x=c.offset||aw,v=this.view.textDirection==Se.LTR,w=f.width>i.right-i.left?v?i.left:i.right-f.width:v?Math.max(i.left,Math.min(u.left-(d?14:0)+x.x,i.right-m)):Math.min(Math.max(i.left,u.left-m+(d?14:0)-x.x),i.right-m),C=this.above[l];!a.strictSide&&(C?u.top-b-p-x.y<i.top:u.bottom+b+p+x.y>i.bottom)&&C==i.bottom-u.bottom>u.top-i.top&&(C=this.above[l]=!C);let S=(C?u.top-i.top:i.bottom-u.bottom)-p;if(S<b&&c.resize!==!1){if(S<this.view.defaultLineHeight){h.style.top=Li;continue}Sh.set(c,b),h.style.height=(b=S)/s+"px"}else h.style.height&&(h.style.height="");let M=C?u.top-b-p-x.y:u.bottom+p+x.y,A=w+m;if(c.overlap!==!0)for(let O of o)O.left<A&&O.right>w&&O.top<M+b&&O.bottom>M&&(M=C?O.top-b-2-p:O.bottom+p+2);if(this.position=="absolute"?(h.style.top=(M-n.parent.top)/s+"px",kh(h,(w-n.parent.left)/r)):(h.style.top=M/s+"px",kh(h,w/r)),d){let O=u.left+(v?x.x:-x.x)-(w+14-7);d.style.left=O/r+"px"}c.overlap!==!0&&o.push({left:w,top:M,right:A,bottom:M+b}),h.classList.toggle("cm-tooltip-above",C),h.classList.toggle("cm-tooltip-below",!C),c.positioned&&c.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Li}},{eventObservers:{scroll(){this.maybeMeasure()}}});function kh(n,e){let t=parseInt(n.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(n.style.left=e+"px")}const lw=B.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),aw={x:0,y:0},Pa=j.define({enables:[La,lw]}),Es=j.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class Qs{static create(e){return new Qs(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Wd(e,Es,(t,i)=>this.createHostedView(t,i),t=>t.dom.remove())}createHostedView(e,t){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let i of this.manager.tooltipViews){let r=i[e];if(r!==void 0){if(t===void 0)t=r;else if(t!==r)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const cw=Pa.compute([Es],n=>{let e=n.facet(Es);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var i;return(i=t.end)!==null&&i!==void 0?i:t.pos})),create:Qs.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class hw{constructor(e,t,i,r,s){this.view=e,this.source=t,this.field=i,this.setHover=r,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,i=e.docView.nearest(t.target);if(!i)return;let r,s=1;if(i instanceof an)r=i.posAtStart;else{if(r=e.posAtCoords(t),r==null)return;let l=e.coordsAtPos(r);if(!l||t.y<l.top||t.y>l.bottom||t.x<l.left-e.defaultCharacterWidth||t.x>l.right+e.defaultCharacterWidth)return;let a=e.bidiSpans(e.state.doc.lineAt(r)).find(h=>h.from<=r&&h.to>=r),c=a&&a.dir==Se.RTL?-1:1;s=t.x<l.left?-c:c}let o=this.source(e,r,s);if(o!=null&&o.then){let l=this.pending={pos:r};o.then(a=>{this.pending==l&&(this.pending=null,a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])}))},a=>et(e.state,a,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(La),t=e?e.manager.tooltips.findIndex(i=>i.create==Qs.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:s}=this;if(r.length&&s&&!uw(s.dom,e)||this.pending){let{pos:o}=r[0]||this.pending,l=(i=(t=r[0])===null||t===void 0?void 0:t.end)!==null&&i!==void 0?i:o;(o==l?this.view.posAtCoords(this.lastMove)!=o:!fw(this.view,o,l,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=i=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const _r=4;function uw(n,e){let{left:t,right:i,top:r,bottom:s}=n.getBoundingClientRect(),o;if(o=n.querySelector(".cm-tooltip-arrow")){let l=o.getBoundingClientRect();r=Math.min(l.top,r),s=Math.max(l.bottom,s)}return e.clientX>=t-_r&&e.clientX<=i+_r&&e.clientY>=r-_r&&e.clientY<=s+_r}function fw(n,e,t,i,r,s){let o=n.scrollDOM.getBoundingClientRect(),l=n.documentTop+n.documentPadding.top+n.contentHeight;if(o.left>i||o.right<i||o.top>r||Math.min(o.bottom,l)<r)return!1;let a=n.posAtCoords({x:i,y:r},!1);return a>=e&&a<=t}function dw(n,e={}){let t=ne.define(),i=Fe.define({create(){return[]},update(r,s){if(r.length&&(e.hideOnChange&&(s.docChanged||s.selection)?r=[]:e.hideOn&&(r=r.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let l of r){let a=s.changes.mapPos(l.pos,-1,Ge.TrackDel);if(a!=null){let c=Object.assign(Object.create(null),l);c.pos=a,c.end!=null&&(c.end=s.changes.mapPos(c.end)),o.push(c)}}r=o}for(let o of s.effects)o.is(t)&&(r=o.value),o.is(pw)&&(r=[]);return r},provide:r=>Es.from(r)});return{active:i,extension:[i,Re.define(r=>new hw(r,n,i,t,e.hoverTime||300)),cw]}}function $d(n,e){let t=n.plugin(La);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}const pw=ne.define(),Ch=j.define({combine(n){let e,t;for(let i of n)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function or(n,e){let t=n.plugin(_d),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const _d=Re.fromClass(class{constructor(n){this.input=n.state.facet(lr),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(Ch);this.top=new Vr(n,!0,e.topContainer),this.bottom=new Vr(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(Ch);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Vr(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Vr(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(lr);if(t!=this.input){let i=t.filter(a=>a),r=[],s=[],o=[],l=[];for(let a of i){let c=this.specs.indexOf(a),h;c<0?(h=a(n.view),l.push(h)):(h=this.panels[c],h.update&&h.update(n)),r.push(h),(h.top?s:o).push(h)}this.specs=i,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let i of this.panels)i.update&&i.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>B.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});let Vr=class{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Ah(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Ah(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}};function Ah(n){let e=n.nextSibling;return n.remove(),e}const lr=j.define({enables:_d});class Yt extends Pn{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Yt.prototype.elementClass="";Yt.prototype.toDOM=void 0;Yt.prototype.mapMode=Ge.TrackBefore;Yt.prototype.startSide=Yt.prototype.endSide=-1;Yt.prototype.point=!0;const ds=j.define(),mw=j.define(),gw={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>ce.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Ji=j.define();function bw(n){return[Vd(),Ji.of({...gw,...n})]}const Mh=j.define({combine:n=>n.some(e=>e)});function Vd(n){return[xw]}const xw=Re.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(Ji).map(e=>new Th(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(Mh),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(Mh)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let t=ce.iter(this.view.state.facet(ds),this.view.viewport.from),i=[],r=this.gutters.map(s=>new yw(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(s.type)){let o=!0;for(let l of s.type)if(l.type==Ke.Text&&o){Hl(t,i,l.from);for(let a of r)a.line(this.view,l,i);o=!1}else if(l.widget)for(let a of r)a.widget(this.view,l)}else if(s.type==Ke.Text){Hl(t,i,s.from);for(let o of r)o.line(this.view,s,i)}else if(s.widget)for(let o of r)o.widget(this.view,s);for(let s of r)s.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(Ji),t=n.state.facet(Ji),i=n.docChanged||n.heightChanged||n.viewportChanged||!ce.eq(n.startState.facet(ds),n.state.facet(ds),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(n)&&(i=!0);else{i=!0;let r=[];for(let s of t){let o=e.indexOf(s);o<0?r.push(new Th(this.view,s)):(this.gutters[o].update(n),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)this.dom.appendChild(s.dom);this.gutters=r}return i}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>B.scrollMargins.of(e=>{let t=e.plugin(n);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==Se.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function Eh(n){return Array.isArray(n)?n:[n]}function Hl(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class yw{constructor(e,t,i){this.gutter=e,this.height=i,this.i=0,this.cursor=ce.iter(e.markers,t.from)}addElement(e,t,i){let{gutter:r}=this,s=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==r.elements.length){let l=new qd(e,o,s,i);r.elements.push(l),r.dom.appendChild(l.dom)}else r.elements[this.i].update(e,o,s,i);this.height=t.bottom,this.i++}line(e,t,i){let r=[];Hl(this.cursor,r,t.from),i.length&&(r=r.concat(i));let s=this.gutter.config.lineMarker(e,t,r);s&&r.unshift(s);let o=this.gutter;r.length==0&&!o.config.renderEmptyElements||this.addElement(e,t,r)}widget(e,t){let i=this.gutter.config.widgetMarker(e,t.widget,t),r=i?[i]:null;for(let s of e.state.facet(mw)){let o=s(e,t.widget,t);o&&(r||(r=[])).push(o)}r&&this.addElement(e,t,r)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Th{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,r=>{let s=r.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let a=s.getBoundingClientRect();o=(a.top+a.bottom)/2}else o=r.clientY;let l=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[i](e,l,r)&&r.preventDefault()});this.markers=Eh(t.markers(e)),t.initialSpacer&&(this.spacer=new qd(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Eh(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let i=e.view.viewport;return!ce.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class qd{constructor(e,t,i,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,r)}update(e,t,i,r){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),vw(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let i="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let l=o,a=s<t.length?t[s++]:null,c=!1;if(a){let h=a.elementClass;h&&(i+=" "+h);for(let u=o;u<this.markers.length;u++)if(this.markers[u].compare(a)){l=u,c=!0;break}}else l=this.markers.length;for(;o<l;){let h=this.markers[o++];if(h.toDOM){h.destroy(r);let u=r.nextSibling;r.remove(),r=u}}if(!a)break;a.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(a.toDOM(e),r)),c&&o++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function vw(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const ww=j.define(),Sw=j.define(),Qn=j.define({combine(n){return zt(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let r in t){let s=i[r],o=t[r];i[r]=s?(l,a,c)=>s(l,a,c)||o(l,a,c):o}return i}})}});class Do extends Yt{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function No(n,e){return n.state.facet(Qn).formatNumber(e,n.state)}const kw=Ji.compute([Qn],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(ww)},lineMarker(e,t,i){return i.some(r=>r.toDOM)?null:new Do(No(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,i)=>{for(let r of e.state.facet(Sw)){let s=r(e,t,i);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(Qn)!=e.state.facet(Qn),initialSpacer(e){return new Do(No(e,Rh(e.state.doc.lines)))},updateSpacer(e,t){let i=No(t.view,Rh(t.view.state.doc.lines));return i==e.number?e:new Do(i)},domEventHandlers:n.facet(Qn).domEventHandlers}));function Cw(n={}){return[Qn.of(n),Vd(),kw]}function Rh(n){let e=9;for(;e<n;)e=e*10+9;return e}const Aw=new class extends Yt{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Mw=ds.compute(["selection"],n=>{let e=[],t=-1;for(let i of n.selection.ranges){let r=n.doc.lineAt(i.head).from;r>t&&(t=r,e.push(Aw.range(r)))}return ce.of(e)});function Ew(){return Mw}const Tw=1024;let Rw=0;class Oo{constructor(e,t){this.from=e,this.to=t}}class le{constructor(e={}){this.id=Rw++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=nt.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}le.closedBy=new le({deserialize:n=>n.split(" ")});le.openedBy=new le({deserialize:n=>n.split(" ")});le.group=new le({deserialize:n=>n.split(" ")});le.isolate=new le({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});le.contextHash=new le({perNode:!0});le.lookAhead=new le({perNode:!0});le.mounted=new le({perNode:!0});class Ts{constructor(e,t,i){this.tree=e,this.overlay=t,this.parser=i}static get(e){return e&&e.props&&e.props[le.mounted.id]}}const Dw=Object.create(null);class nt{constructor(e,t,i,r=0){this.name=e,this.props=t,this.id=i,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):Dw,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new nt(e.name||"",t,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(le.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let r of i.split(" "))t[r]=e[i];return i=>{for(let r=i.prop(le.group),s=-1;s<(r?r.length:0);s++){let o=t[s<0?i.name:r[s]];if(o)return o}}}}nt.none=new nt("",Object.create(null),0,8);class Ia{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let r=null;for(let s of e){let o=s(i);o&&(r||(r=Object.assign({},i.props)),r[o[0].id]=o[1])}t.push(r?new nt(i.name,r,i.id,i.flags):i)}return new Ia(t)}}const qr=new WeakMap,Dh=new WeakMap;var je;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(je||(je={}));class Ce{constructor(e,t,i,r,s){if(this.type=e,this.children=t,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=Ts.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let r=i.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Wl(this.topNode,e)}cursorAt(e,t=0,i=0){let r=qr.get(this)||this.topNode,s=new Wl(r);return s.moveTo(e,t),qr.set(this,s._tree),s}get topNode(){return new pt(this,0,0,null)}resolve(e,t=0){let i=ar(qr.get(this)||this.topNode,e,t,!1);return qr.set(this,i),i}resolveInner(e,t=0){let i=ar(Dh.get(this)||this.topNode,e,t,!0);return Dh.set(this,i),i}resolveStack(e,t=0){return Lw(this,e,t)}iterate(e){let{enter:t,leave:i,from:r=0,to:s=this.length}=e,o=e.mode||0,l=(o&je.IncludeAnonymous)>0;for(let a=this.cursor(o|je.IncludeAnonymous);;){let c=!1;if(a.from<=s&&a.to>=r&&(!l&&a.type.isAnonymous||t(a)!==!1)){if(a.firstChild())continue;c=!0}for(;c&&i&&(l||!a.type.isAnonymous)&&i(a),!a.nextSibling();){if(!a.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:ja(nt.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,r)=>new Ce(this.type,t,i,r,this.propValues),e.makeTree||((t,i,r)=>new Ce(nt.none,t,i,r)))}static build(e){return Pw(e)}}Ce.empty=new Ce(nt.none,[],[],0);class Ba{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ba(this.buffer,this.index)}}class mn{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return nt.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],r=this.set.types[t],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,i,r,s){let{buffer:o}=this,l=-1;for(let a=e;a!=t&&!(Ud(s,r,o[a+1],o[a+2])&&(l=a,i>0));a=o[a+3]);return l}slice(e,t,i){let r=this.buffer,s=new Uint16Array(t-e),o=0;for(let l=e,a=0;l<t;){s[a++]=r[l++],s[a++]=r[l++]-i;let c=s[a++]=r[l++]-i;s[a++]=r[l++]-e,o=Math.max(o,c)}return new mn(s,o,this.set)}}function Ud(n,e,t,i){switch(n){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function ar(n,e,t,i){for(var r;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!i&&n instanceof pt&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=i?0:je.IgnoreOverlays;if(i)for(let o=n,l=o.parent;l;o=l,l=o.parent)o instanceof pt&&o.index<0&&((r=l.enter(e,t,s))===null||r===void 0?void 0:r.from)!=o.from&&(n=l);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class Gd{cursor(e=0){return new Wl(this,e)}getChild(e,t=null,i=null){let r=Nh(this,e,t,i);return r.length?r[0]:null}getChildren(e,t=null,i=null){return Nh(this,e,t,i)}resolve(e,t=0){return ar(this,e,t,!1)}resolveInner(e,t=0){return ar(this,e,t,!0)}matchContext(e){return Fl(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),i=this;for(;t;){let r=t.lastChild;if(!r||r.to!=t.to)break;r.type.isError&&r.from==r.to?(i=t,t=r.prevSibling):t=r}return i}get node(){return this}get next(){return this.parent}}class pt extends Gd{constructor(e,t,i,r){super(),this._tree=e,this.from=t,this.index=i,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,r,s=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,c=t>0?l.length:-1;e!=c;e+=t){let h=l[e],u=a[e]+o.from;if(Ud(r,i,u,u+h.length)){if(h instanceof mn){if(s&je.ExcludeBuffers)continue;let f=h.findChild(0,h.buffer.length,t,i-u,r);if(f>-1)return new hn(new Nw(o,h,e,u),null,f)}else if(s&je.IncludeAnonymous||!h.type.isAnonymous||za(h)){let f;if(!(s&je.IgnoreMounts)&&(f=Ts.get(h))&&!f.overlay)return new pt(f.tree,u,e,o);let d=new pt(h,u,e,o);return s&je.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?h.children.length-1:0,t,i,r)}}}if(s&je.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let r;if(!(i&je.IgnoreOverlays)&&(r=Ts.get(this._tree))&&r.overlay){let s=e-this.from;for(let{from:o,to:l}of r.overlay)if((t>0?o<=s:o<s)&&(t<0?l>=s:l>s))return new pt(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Nh(n,e,t,i){let r=n.cursor(),s=[];if(!r.firstChild())return s;if(t!=null){for(let o=!1;!o;)if(o=r.type.is(t),!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}function Fl(n,e,t=e.length-1){for(let i=n;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class Nw{constructor(e,t,i,r){this.parent=e,this.buffer=t,this.index=i,this.start=r}}class hn extends Gd{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,i){super(),this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,t,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,i);return s<0?null:new hn(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&je.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new hn(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new hn(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new hn(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1];e.push(i.slice(r,s,o)),t.push(0)}return new Ce(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Kd(n){if(!n.length)return null;let e=0,t=n[0];for(let s=1;s<n.length;s++){let o=n[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let i=t instanceof pt&&t.index<0?null:t.parent,r=n.slice();return i?r[e]=i:r.splice(e,1),new Ow(r,t)}class Ow{constructor(e,t){this.heads=e,this.node=t}get next(){return Kd(this.heads)}}function Lw(n,e,t){let i=n.resolveInner(e,t),r=null;for(let s=i instanceof pt?i:i.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(r||(r=[i])).push(o.resolve(e,t)),s=o}else{let o=Ts.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let l=new pt(o.tree,o.overlay[0].from+s.from,-1,s);(r||(r=[i])).push(ar(l,e,t,!1))}}return r?Kd(r):i}class Wl{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof pt)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=i+r.buffer[e+1],this.to=i+r.buffer[e+2],!0}yield(e){return e?e instanceof pt?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&je.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&je.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&je.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:i}=r)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let s=t+e,o=e<0?-1:i._tree.children.length;s!=o;s+=e){let l=i._tree.children[s];if(this.mode&je.IncludeAnonymous||l instanceof mn||!l.type.isAnonymous||za(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;t=o,i=s+1;break e}r=this.stack[--s]}for(let r=i;r<this.stack.length;r++)t=new hn(this.buffer,t,this.stack[r]);return this.bufferNode=new hn(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&t&&t(this),r=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,r=!0}}}matchContext(e){if(!this.buffer)return Fl(this.node.parent,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return Fl(this._tree,e,r);let o=i[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function za(n){return n.children.some(e=>e instanceof mn||!e.type.isAnonymous||za(e))}function Pw(n){var e;let{buffer:t,nodeSet:i,maxBufferLength:r=Tw,reused:s=[],minRepeatType:o=i.types.length}=n,l=Array.isArray(t)?new Ba(t,t.length):t,a=i.types,c=0,h=0;function u(S,M,A,O,N,W){let{id:z,start:R,end:Q,size:$}=l,J=h,E=c;for(;$<0;)if(l.next(),$==-1){let oe=s[z];A.push(oe),O.push(R-S);return}else if($==-3){c=z;return}else if($==-4){h=z;return}else throw new RangeError(`Unrecognized record size: ${$}`);let D=a[z],_,V,te=R-S;if(Q-R<=r&&(V=b(l.pos-M,N))){let oe=new Uint16Array(V.size-V.skip),me=l.pos-V.size,P=oe.length;for(;l.pos>me;)P=x(V.start,oe,P);_=new mn(oe,Q-V.start,i),te=V.start-S}else{let oe=l.pos-$;l.next();let me=[],P=[],F=z>=o?z:-1,G=0,X=Q;for(;l.pos>oe;)F>=0&&l.id==F&&l.size>=0?(l.end<=X-r&&(p(me,P,R,G,l.end,X,F,J,E),G=me.length,X=l.end),l.next()):W>2500?f(R,oe,me,P):u(R,oe,me,P,F,W+1);if(F>=0&&G>0&&G<me.length&&p(me,P,R,G,R,X,F,J,E),me.reverse(),P.reverse(),F>-1&&G>0){let q=d(D,E);_=ja(D,me,P,0,me.length,0,Q-R,q,q)}else _=m(D,me,P,Q-R,J-Q,E)}A.push(_),O.push(te)}function f(S,M,A,O){let N=[],W=0,z=-1;for(;l.pos>M;){let{id:R,start:Q,end:$,size:J}=l;if(J>4)l.next();else{if(z>-1&&Q<z)break;z<0&&(z=$-r),N.push(R,Q,$),W++,l.next()}}if(W){let R=new Uint16Array(W*4),Q=N[N.length-2];for(let $=N.length-3,J=0;$>=0;$-=3)R[J++]=N[$],R[J++]=N[$+1]-Q,R[J++]=N[$+2]-Q,R[J++]=J;A.push(new mn(R,N[2]-Q,i)),O.push(Q-S)}}function d(S,M){return(A,O,N)=>{let W=0,z=A.length-1,R,Q;if(z>=0&&(R=A[z])instanceof Ce){if(!z&&R.type==S&&R.length==N)return R;(Q=R.prop(le.lookAhead))&&(W=O[z]+R.length+Q)}return m(S,A,O,N,W,M)}}function p(S,M,A,O,N,W,z,R,Q){let $=[],J=[];for(;S.length>O;)$.push(S.pop()),J.push(M.pop()+A-N);S.push(m(i.types[z],$,J,W-N,R-W,Q)),M.push(N-A)}function m(S,M,A,O,N,W,z){if(W){let R=[le.contextHash,W];z=z?[R].concat(z):[R]}if(N>25){let R=[le.lookAhead,N];z=z?[R].concat(z):[R]}return new Ce(S,M,A,O,z)}function b(S,M){let A=l.fork(),O=0,N=0,W=0,z=A.end-r,R={size:0,start:0,skip:0};e:for(let Q=A.pos-S;A.pos>Q;){let $=A.size;if(A.id==M&&$>=0){R.size=O,R.start=N,R.skip=W,W+=4,O+=4,A.next();continue}let J=A.pos-$;if($<0||J<Q||A.start<z)break;let E=A.id>=o?4:0,D=A.start;for(A.next();A.pos>J;){if(A.size<0)if(A.size==-3)E+=4;else break e;else A.id>=o&&(E+=4);A.next()}N=D,O+=$,W+=E}return(M<0||O==S)&&(R.size=O,R.start=N,R.skip=W),R.size>4?R:void 0}function x(S,M,A){let{id:O,start:N,end:W,size:z}=l;if(l.next(),z>=0&&O<o){let R=A;if(z>4){let Q=l.pos-(z-4);for(;l.pos>Q;)A=x(S,M,A)}M[--A]=R,M[--A]=W-S,M[--A]=N-S,M[--A]=O}else z==-3?c=O:z==-4&&(h=O);return A}let v=[],w=[];for(;l.pos>0;)u(n.start||0,n.bufferStart||0,v,w,-1,0);let C=(e=n.length)!==null&&e!==void 0?e:v.length?w[0]+v[0].length:0;return new Ce(a[n.topID],v.reverse(),w.reverse(),C)}const Oh=new WeakMap;function ps(n,e){if(!n.isAnonymous||e instanceof mn||e.type!=n)return 1;let t=Oh.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=n||!(i instanceof Ce)){t=1;break}t+=ps(n,i)}Oh.set(e,t)}return t}function ja(n,e,t,i,r,s,o,l,a){let c=0;for(let p=i;p<r;p++)c+=ps(n,e[p]);let h=Math.ceil(c*1.5/8),u=[],f=[];function d(p,m,b,x,v){for(let w=b;w<x;){let C=w,S=m[w],M=ps(n,p[w]);for(w++;w<x;w++){let A=ps(n,p[w]);if(M+A>=h)break;M+=A}if(w==C+1){if(M>h){let A=p[C];d(A.children,A.positions,0,A.children.length,m[C]+v);continue}u.push(p[C])}else{let A=m[w-1]+p[w-1].length-S;u.push(ja(n,p,m,C,w,S,A,null,a))}f.push(S+v-s)}}return d(e,t,i,r,0),(l||a)(u,f,o)}class Nn{constructor(e,t,i,r,s=!1,o=!1){this.from=e,this.to=t,this.tree=i,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let r=[new Nn(0,e.length,e,0,!1,i)];for(let s of t)s.to>e.length&&r.push(s);return r}static applyChanges(e,t,i=128){if(!t.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let l=0,a=0,c=0;;l++){let h=l<t.length?t[l]:null,u=h?h.fromA:1e9;if(u-a>=i)for(;o&&o.from<u;){let f=o;if(a>=f.from||u<=f.to||c){let d=Math.max(f.from,a)-c,p=Math.min(f.to,u)-c;f=d>=p?null:new Nn(d,p,f.tree,f.offset+c,l>0,!!h)}if(f&&r.push(f),o.to>u)break;o=s<e.length?e[s++]:null}if(!h)break;a=h.toA,c=h.toA-h.toB}return r}}class Jd{startParse(e,t,i){return typeof e=="string"&&(e=new Iw(e)),i=i?i.length?i.map(r=>new Oo(r.from,r.to)):[new Oo(0,0)]:[new Oo(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let r=this.startParse(e,t,i);for(;;){let s=r.advance();if(s)return s}}}class Iw{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new le({perNode:!0});let Bw=0;class ht{constructor(e,t,i,r){this.name=e,this.set=t,this.base=i,this.modified=r,this.id=Bw++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let i=typeof e=="string"?e:"?";if(e instanceof ht&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let r=new ht(i,[],null,[]);if(r.set.push(r),t)for(let s of t.set)r.set.push(s);return r}static defineModifier(e){let t=new Rs(e);return i=>i.modified.indexOf(t)>-1?i:Rs.get(i.base||i,i.modified.concat(t).sort((r,s)=>r.id-s.id))}}let zw=0;class Rs{constructor(e){this.name=e,this.instances=[],this.id=zw++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(l=>l.base==e&&jw(t,l.modified));if(i)return i;let r=[],s=new ht(e.name,r,e,t);for(let l of t)l.instances.push(s);let o=Hw(t);for(let l of e.set)if(!l.modified.length)for(let a of o)r.push(Rs.get(l,a));return s}}function jw(n,e){return n.length==e.length&&n.every((t,i)=>t==e[i])}function Hw(n){let e=[[]];for(let t=0;t<n.length;t++)for(let i=0,r=e.length;i<r;i++)e.push(e[i].concat(n[t]));return e.sort((t,i)=>i.length-t.length)}function Fw(n){let e=Object.create(null);for(let t in n){let i=n[t];Array.isArray(i)||(i=[i]);for(let r of t.split(" "))if(r){let s=[],o=2,l=r;for(let u=0;;){if(l=="..."&&u>0&&u+3==r.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!f)throw new RangeError("Invalid path: "+r);if(s.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),u+=f[0].length,u==r.length)break;let d=r[u++];if(u==r.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+r);l=r.slice(u)}let a=s.length-1,c=s[a];if(!c)throw new RangeError("Invalid path: "+r);let h=new Ds(i,o,a>0?s.slice(0,a):null);e[c]=h.sort(e[c])}}return Yd.add(e)}const Yd=new le;class Ds{constructor(e,t,i,r){this.tags=e,this.mode=t,this.context=i,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Ds.empty=new Ds([],2,null);function Xd(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:i,all:r=null}=e||{};return{style:s=>{let o=r;for(let l of s)for(let a of l.set){let c=t[a.id];if(c){o=o?o+" "+c:c;break}}return o},scope:i}}function Ww(n,e){let t=null;for(let i of n){let r=i.style(e);r&&(t=t?t+" "+r:r)}return t}function $w(n,e,t,i=0,r=n.length){let s=new _w(i,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),i,r,"",s.highlighters),s.flush(r)}class _w{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,r,s){let{type:o,from:l,to:a}=e;if(l>=i||a<=t)return;o.isTop&&(s=this.highlighters.filter(d=>!d.scope||d.scope(o)));let c=r,h=Vw(e)||Ds.empty,u=Ww(s,h.tags);if(u&&(c&&(c+=" "),c+=u,h.mode==1&&(r+=(r?" ":"")+u)),this.startSpan(Math.max(t,l),c),h.opaque)return;let f=e.tree&&e.tree.prop(le.mounted);if(f&&f.overlay){let d=e.node.enter(f.overlay[0].from+l,1),p=this.highlighters.filter(b=>!b.scope||b.scope(f.tree.type)),m=e.firstChild();for(let b=0,x=l;;b++){let v=b<f.overlay.length?f.overlay[b]:null,w=v?v.from+l:a,C=Math.max(t,x),S=Math.min(i,w);if(C<S&&m)for(;e.from<S&&(this.highlightRange(e,C,S,r,s),this.startSpan(Math.min(S,e.to),c),!(e.to>=w||!e.nextSibling())););if(!v||w>i)break;x=v.to+l,x>t&&(this.highlightRange(d.cursor(),Math.max(t,v.from+l),Math.min(i,x),"",p),this.startSpan(Math.min(i,x),c))}m&&e.parent()}else if(e.firstChild()){f&&(r="");do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,r,s),this.startSpan(Math.min(i,e.to),c)}while(e.nextSibling());e.parent()}}}function Vw(n){let e=n.type.prop(Yd);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const L=ht.define,Ur=L(),tn=L(),Lh=L(tn),Ph=L(tn),nn=L(),Gr=L(nn),Lo=L(nn),At=L(),wn=L(At),kt=L(),Ct=L(),$l=L(),Pi=L($l),Kr=L(),k={comment:Ur,lineComment:L(Ur),blockComment:L(Ur),docComment:L(Ur),name:tn,variableName:L(tn),typeName:Lh,tagName:L(Lh),propertyName:Ph,attributeName:L(Ph),className:L(tn),labelName:L(tn),namespace:L(tn),macroName:L(tn),literal:nn,string:Gr,docString:L(Gr),character:L(Gr),attributeValue:L(Gr),number:Lo,integer:L(Lo),float:L(Lo),bool:L(nn),regexp:L(nn),escape:L(nn),color:L(nn),url:L(nn),keyword:kt,self:L(kt),null:L(kt),atom:L(kt),unit:L(kt),modifier:L(kt),operatorKeyword:L(kt),controlKeyword:L(kt),definitionKeyword:L(kt),moduleKeyword:L(kt),operator:Ct,derefOperator:L(Ct),arithmeticOperator:L(Ct),logicOperator:L(Ct),bitwiseOperator:L(Ct),compareOperator:L(Ct),updateOperator:L(Ct),definitionOperator:L(Ct),typeOperator:L(Ct),controlOperator:L(Ct),punctuation:$l,separator:L($l),bracket:Pi,angleBracket:L(Pi),squareBracket:L(Pi),paren:L(Pi),brace:L(Pi),content:At,heading:wn,heading1:L(wn),heading2:L(wn),heading3:L(wn),heading4:L(wn),heading5:L(wn),heading6:L(wn),contentSeparator:L(At),list:L(At),quote:L(At),emphasis:L(At),strong:L(At),link:L(At),monospace:L(At),strikethrough:L(At),inserted:L(),deleted:L(),changed:L(),invalid:L(),meta:Kr,documentMeta:L(Kr),annotation:L(Kr),processingInstruction:L(Kr),definition:ht.defineModifier("definition"),constant:ht.defineModifier("constant"),function:ht.defineModifier("function"),standard:ht.defineModifier("standard"),local:ht.defineModifier("local"),special:ht.defineModifier("special")};for(let n in k){let e=k[n];e instanceof ht&&(e.name=n)}Xd([{tag:k.link,class:"tok-link"},{tag:k.heading,class:"tok-heading"},{tag:k.emphasis,class:"tok-emphasis"},{tag:k.strong,class:"tok-strong"},{tag:k.keyword,class:"tok-keyword"},{tag:k.atom,class:"tok-atom"},{tag:k.bool,class:"tok-bool"},{tag:k.url,class:"tok-url"},{tag:k.labelName,class:"tok-labelName"},{tag:k.inserted,class:"tok-inserted"},{tag:k.deleted,class:"tok-deleted"},{tag:k.literal,class:"tok-literal"},{tag:k.string,class:"tok-string"},{tag:k.number,class:"tok-number"},{tag:[k.regexp,k.escape,k.special(k.string)],class:"tok-string2"},{tag:k.variableName,class:"tok-variableName"},{tag:k.local(k.variableName),class:"tok-variableName tok-local"},{tag:k.definition(k.variableName),class:"tok-variableName tok-definition"},{tag:k.special(k.variableName),class:"tok-variableName2"},{tag:k.definition(k.propertyName),class:"tok-propertyName tok-definition"},{tag:k.typeName,class:"tok-typeName"},{tag:k.namespace,class:"tok-namespace"},{tag:k.className,class:"tok-className"},{tag:k.macroName,class:"tok-macroName"},{tag:k.propertyName,class:"tok-propertyName"},{tag:k.operator,class:"tok-operator"},{tag:k.comment,class:"tok-comment"},{tag:k.meta,class:"tok-meta"},{tag:k.invalid,class:"tok-invalid"},{tag:k.punctuation,class:"tok-punctuation"}]);var Po;const Zn=new le;function qw(n){return j.define({combine:n?e=>e.concat(n):void 0})}const Uw=new le;class bt{constructor(e,t,i=[],r=""){this.data=e,this.name=r,ae.prototype.hasOwnProperty("tree")||Object.defineProperty(ae.prototype,"tree",{get(){return qe(this)}}),this.parser=t,this.extension=[gn.of(this),ae.languageData.of((s,o,l)=>{let a=Ih(s,o,l),c=a.type.prop(Zn);if(!c)return[];let h=s.facet(c),u=a.type.prop(Uw);if(u){let f=a.resolve(o-a.from,l);for(let d of u)if(d.test(f,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(h)}}return h})].concat(i)}isActiveAt(e,t,i=-1){return Ih(e,t,i).type.prop(Zn)==this.data}findRegions(e){let t=e.facet(gn);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],r=(s,o)=>{if(s.prop(Zn)==this.data){i.push({from:o,to:o+s.length});return}let l=s.prop(le.mounted);if(l){if(l.tree.prop(Zn)==this.data){if(l.overlay)for(let a of l.overlay)i.push({from:a.from+o,to:a.to+o});else i.push({from:o,to:o+s.length});return}else if(l.overlay){let a=i.length;if(r(l.tree,l.overlay[0].from+o),i.length>a)return}}for(let a=0;a<s.children.length;a++){let c=s.children[a];c instanceof Ce&&r(c,s.positions[a]+o)}};return r(qe(e),0),i}get allowsNesting(){return!0}}bt.setState=ne.define();function Ih(n,e,t){let i=n.facet(gn),r=qe(n).topNode;if(!i||i.allowsNesting)for(let s=r;s;s=s.enter(e,t,je.ExcludeBuffers))s.type.isTop&&(r=s);return r}function qe(n){let e=n.field(bt.state,!1);return e?e.tree:Ce.empty}class Gw{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let Ii=null;class gi{constructor(e,t,i=[],r,s,o,l,a){this.parser=e,this.state=t,this.fragments=i,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new gi(e,t,[],Ce.empty,0,i,[],null)}startParse(){return this.parser.startParse(new Gw(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Ce.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(Nn.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Nn.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Ii;Ii=this;try{return e()}finally{Ii=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Bh(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:r,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((c,h,u,f)=>a.push({fromA:c,toA:h,fromB:u,toB:f})),i=Nn.applyChanges(i,a),r=Ce.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let c of this.skipped){let h=e.mapPos(c.from,1),u=e.mapPos(c.to,-1);h<u&&l.push({from:h,to:u})}}}return new gi(this.parser,t,i,r,s,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:r,to:s}=this.skipped[i];r<e.to&&s>e.from&&(this.fragments=Bh(this.fragments,r,s),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Jd{createParse(t,i,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let a=Ii;if(a){for(let c of r)a.tempSkipped.push(c);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=o,new Ce(nt.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Ii}}function Bh(n,e,t){return Nn.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class bi{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new bi(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=gi.create(e.facet(gn).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new bi(i)}}bt.state=Fe.define({create:bi.init,update(n,e){for(let t of e.effects)if(t.is(bt.setState))return t.value;return e.startState.facet(gn)!=e.state.facet(gn)?bi.init(e.state):n.apply(e)}});let Qd=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(Qd=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Io=typeof navigator<"u"&&(!((Po=navigator.scheduling)===null||Po===void 0)&&Po.isInputPending)?()=>navigator.scheduling.isInputPending():null,Kw=Re.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(bt.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(bt.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=Qd(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:r}}=this.view,s=i.field(bt.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Io?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<r&&i.doc.length>r+1e3,a=s.context.work(()=>Io&&Io()||Date.now()>o,r+(l?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:bt.setState.of(new bi(s.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>et(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),gn=j.define({combine(n){return n.length?n[0]:null},enables:n=>[bt.state,Kw,B.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]}),Jw=j.define(),Zs=j.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function jn(n){let e=n.facet(Zs);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function cr(n,e){let t="",i=n.tabSize,r=n.facet(Zs)[0];if(r=="	"){for(;e>=i;)t+="	",e-=i;r=" "}for(let s=0;s<e;s++)t+=r;return t}function Ha(n,e){n instanceof ae&&(n=new eo(n));for(let i of n.state.facet(Jw)){let r=i(n,e);if(r!==void 0)return r}let t=qe(n.state);return t.length>=e?Yw(n,t,e):null}class eo{constructor(e,t={}){this.state=e,this.options=t,this.unit=jn(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=i.from&&r<=i.to?s&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:i.text.slice(r-i.from),from:r}:{text:i.text.slice(0,r-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:r}=this.lineAt(e,t);return i.slice(e-r,Math.min(i.length,e+100-r))}column(e,t=1){let{text:i,from:r}=this.lineAt(e,t),s=this.countColumn(i,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,t=e.length){return ki(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:r}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Zd=new le;function Yw(n,e,t){let i=e.resolveStack(t),r=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(r!=i.node){let s=[];for(let o=r;o&&!(o.from<i.node.from||o.to>i.node.to||o.from==i.node.from&&o.type==i.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)i={node:s[o],next:i}}return ep(i,n,t)}function ep(n,e,t){for(let i=n;i;i=i.next){let r=Qw(i.node);if(r)return r(Fa.create(e,t,i))}return 0}function Xw(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function Qw(n){let e=n.type.prop(Zd);if(e)return e;let t=n.firstChild,i;if(t&&(i=t.type.prop(le.closedBy))){let r=n.lastChild,s=r&&i.indexOf(r.name)>-1;return o=>n1(o,!0,1,void 0,s&&!Xw(o)?r.from:void 0)}return n.parent==null?Zw:null}function Zw(){return 0}class Fa extends eo{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.context=i}get node(){return this.context.node}static create(e,t,i){return new Fa(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(t.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(e1(i,e))break;t=this.state.doc.lineAt(i.from)}return this.lineIndent(t.from)}continue(){return ep(this.context.next,this.base,this.pos)}}function e1(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function t1(n){let e=n.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let r=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==i)return null;if(!a.type.isSkipped){if(a.from>=o)return null;let c=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+c}}l=a.to}}function n1(n,e,t,i,r){let s=n.textAfter,o=s.match(/^\s*/)[0].length,l=i&&s.slice(o,o+i.length)==i||r==n.pos+o,a=t1(n);return a?l?n.column(a.from):n.column(a.to):n.baseIndent+(l?0:n.unit*t)}const i1=200;function r1(){return ae.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:i}=n.newSelection.main,r=t.lineAt(i);if(i>r.from+i1)return n;let s=t.sliceString(r.from,i);if(!e.some(c=>c.test(s)))return n;let{state:o}=n,l=-1,a=[];for(let{head:c}of o.selection.ranges){let h=o.doc.lineAt(c);if(h.from==l)continue;l=h.from;let u=Ha(o,h.from);if(u==null)continue;let f=/^\s*/.exec(h.text)[0],d=cr(o,u);f!=d&&a.push({from:h.from,to:h.from+f.length,insert:d})}return a.length?[n,{changes:a,sequential:!0}]:n})}const s1=j.define(),o1=new le;function l1(n,e,t){let i=qe(n);if(i.length<t)return null;let r=i.resolveStack(t,1),s=null;for(let o=r;o;o=o.next){let l=o.node;if(l.to<=t||l.from>t)continue;if(s&&l.from<e)break;let a=l.type.prop(o1);if(a&&(l.to<i.length-50||i.length==n.doc.length||!a1(l))){let c=a(l,n);c&&c.from<=t&&c.from>=e&&c.to>t&&(s=c)}}return s}function a1(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function Ns(n,e,t){for(let i of n.facet(s1)){let r=i(n,e,t);if(r)return r}return l1(n,e,t)}function tp(n,e){let t=e.mapPos(n.from,1),i=e.mapPos(n.to,-1);return t>=i?void 0:{from:t,to:i}}const to=ne.define({map:tp}),Mr=ne.define({map:tp});function np(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(i=>i.from<=t&&i.to>=t)||e.push(n.lineBlockAt(t));return e}const Hn=Fe.define({create(){return Y.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is(to)&&!c1(n,t.value.from,t.value.to)){let{preparePlaceholder:i}=e.state.facet(sp),r=i?Y.replace({widget:new g1(i(e.state,t.value))}):zh;n=n.update({add:[r.range(t.value.from,t.value.to)]})}else t.is(Mr)&&(n=n.update({filter:(i,r)=>t.value.from!=i||t.value.to!=r,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:i}=e.selection.main;n.between(i,i,(r,s)=>{r<i&&s>i&&(t=!0)}),t&&(n=n.update({filterFrom:i,filterTo:i,filter:(r,s)=>s<=i||r>=i}))}return n},provide:n=>B.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(i,r)=>{t.push(i,r)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let i=n[t++],r=n[t++];if(typeof i!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(zh.range(i,r))}return Y.set(e,!0)}});function Os(n,e,t){var i;let r=null;return(i=n.field(Hn,!1))===null||i===void 0||i.between(e,t,(s,o)=>{(!r||r.from>s)&&(r={from:s,to:o})}),r}function c1(n,e,t){let i=!1;return n.between(e,e,(r,s)=>{r==e&&s==t&&(i=!0)}),i}function ip(n,e){return n.field(Hn,!1)?e:e.concat(ne.appendConfig.of(op()))}const h1=n=>{for(let e of np(n)){let t=Ns(n.state,e.from,e.to);if(t)return n.dispatch({effects:ip(n.state,[to.of(t),rp(n,t)])}),!0}return!1},u1=n=>{if(!n.state.field(Hn,!1))return!1;let e=[];for(let t of np(n)){let i=Os(n.state,t.from,t.to);i&&e.push(Mr.of(i),rp(n,i,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function rp(n,e,t=!0){let i=n.state.doc.lineAt(e.from).number,r=n.state.doc.lineAt(e.to).number;return B.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${i} ${n.state.phrase("to")} ${r}.`)}const f1=n=>{let{state:e}=n,t=[];for(let i=0;i<e.doc.length;){let r=n.lineBlockAt(i),s=Ns(e,r.from,r.to);s&&t.push(to.of(s)),i=(s?n.lineBlockAt(s.to):r).to+1}return t.length&&n.dispatch({effects:ip(n.state,t)}),!!t.length},d1=n=>{let e=n.state.field(Hn,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(i,r)=>{t.push(Mr.of({from:i,to:r}))}),n.dispatch({effects:t}),!0},p1=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:h1},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:u1},{key:"Ctrl-Alt-[",run:f1},{key:"Ctrl-Alt-]",run:d1}],m1={placeholderDOM:null,preparePlaceholder:null,placeholderText:"â€¦"},sp=j.define({combine(n){return zt(n,m1)}});function op(n){return[Hn,y1]}function lp(n,e){let{state:t}=n,i=t.facet(sp),r=o=>{let l=n.lineBlockAt(n.posAtDOM(o.target)),a=Os(n.state,l.from,l.to);a&&n.dispatch({effects:Mr.of(a)}),o.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(n,r,e);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}const zh=Y.replace({widget:new class extends Qt{toDOM(n){return lp(n,null)}}});class g1 extends Qt{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return lp(e,this.value)}}const b1={openText:"âŒ„",closedText:"â€º",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Bo extends Yt{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function x1(n={}){let e={...b1,...n},t=new Bo(e,!0),i=new Bo(e,!1),r=Re.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(gn)!=o.state.facet(gn)||o.startState.field(Hn,!1)!=o.state.field(Hn,!1)||qe(o.startState)!=qe(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new Kt;for(let a of o.viewportLineBlocks){let c=Os(o.state,a.from,a.to)?i:Ns(o.state,a.from,a.to)?t:null;c&&l.add(a.from,a.from,c)}return l.finish()}}),{domEventHandlers:s}=e;return[r,bw({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(r))===null||l===void 0?void 0:l.markers)||ce.empty},initialSpacer(){return new Bo(e,!1)},domEventHandlers:{...s,click:(o,l,a)=>{if(s.click&&s.click(o,l,a))return!0;let c=Os(o.state,l.from,l.to);if(c)return o.dispatch({effects:Mr.of(c)}),!0;let h=Ns(o.state,l.from,l.to);return h?(o.dispatch({effects:to.of(h)}),!0):!1}}}),op()]}const y1=B.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Ci{constructor(e,t){this.specs=e;let i;function r(l){let a=fn.newName();return(i||(i=Object.create(null)))["."+a]=l,a}const s=typeof t.all=="string"?t.all:t.all?r(t.all):void 0,o=t.scope;this.scope=o instanceof bt?l=>l.prop(Zn)==o.data:o?l=>l==o:void 0,this.style=Xd(e.map(l=>({tag:l.tag,class:l.class||r(Object.assign({},l,{tag:null}))})),{all:s}).style,this.module=i?new fn(i):null,this.themeType=t.themeType}static define(e,t){return new Ci(e,t||{})}}const _l=j.define(),ap=j.define({combine(n){return n.length?[n[0]]:null}});function zo(n){let e=n.facet(_l);return e.length?e:n.facet(ap)}function Wa(n,e){let t=[w1],i;return n instanceof Ci&&(n.module&&t.push(B.styleModule.of(n.module)),i=n.themeType),e!=null&&e.fallback?t.push(ap.of(n)):i?t.push(_l.computeN([B.darkTheme],r=>r.facet(B.darkTheme)==(i=="dark")?[n]:[])):t.push(_l.of(n)),t}class v1{constructor(e){this.markCache=Object.create(null),this.tree=qe(e.state),this.decorations=this.buildDeco(e,zo(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=qe(e.state),i=zo(e.state),r=i!=zo(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!r&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return Y.none;let i=new Kt;for(let{from:r,to:s}of e.visibleRanges)$w(this.tree,t,(o,l,a)=>{i.add(o,l,this.markCache[a]||(this.markCache[a]=Y.mark({class:a})))},r,s);return i.finish()}}const w1=bn.high(Re.fromClass(v1,{decorations:n=>n.decorations})),S1=Ci.define([{tag:k.meta,color:"#404740"},{tag:k.link,textDecoration:"underline"},{tag:k.heading,textDecoration:"underline",fontWeight:"bold"},{tag:k.emphasis,fontStyle:"italic"},{tag:k.strong,fontWeight:"bold"},{tag:k.strikethrough,textDecoration:"line-through"},{tag:k.keyword,color:"#708"},{tag:[k.atom,k.bool,k.url,k.contentSeparator,k.labelName],color:"#219"},{tag:[k.literal,k.inserted],color:"#164"},{tag:[k.string,k.deleted],color:"#a11"},{tag:[k.regexp,k.escape,k.special(k.string)],color:"#e40"},{tag:k.definition(k.variableName),color:"#00f"},{tag:k.local(k.variableName),color:"#30a"},{tag:[k.typeName,k.namespace],color:"#085"},{tag:k.className,color:"#167"},{tag:[k.special(k.variableName),k.macroName],color:"#256"},{tag:k.definition(k.propertyName),color:"#00c"},{tag:k.comment,color:"#940"},{tag:k.invalid,color:"#f00"}]),k1=B.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),cp=1e4,hp="()[]{}",up=j.define({combine(n){return zt(n,{afterCursor:!0,brackets:hp,maxScanDistance:cp,renderMatch:M1})}}),C1=Y.mark({class:"cm-matchingBracket"}),A1=Y.mark({class:"cm-nonmatchingBracket"});function M1(n){let e=[],t=n.matched?C1:A1;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const E1=Fe.define({create(){return Y.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],i=e.state.facet(up);for(let r of e.state.selection.ranges){if(!r.empty)continue;let s=Rt(e.state,r.head,-1,i)||r.head>0&&Rt(e.state,r.head-1,1,i)||i.afterCursor&&(Rt(e.state,r.head,1,i)||r.head<e.state.doc.length&&Rt(e.state,r.head+1,-1,i));s&&(t=t.concat(i.renderMatch(s,e.state)))}return Y.set(t,!0)},provide:n=>B.decorations.from(n)}),T1=[E1,k1];function R1(n={}){return[up.of(n),T1]}const D1=new le;function Vl(n,e,t){let i=n.prop(e<0?le.openedBy:le.closedBy);if(i)return i;if(n.name.length==1){let r=t.indexOf(n.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function ql(n){let e=n.type.prop(D1);return e?e(n.node):n}function Rt(n,e,t,i={}){let r=i.maxScanDistance||cp,s=i.brackets||hp,o=qe(n),l=o.resolveInner(e,t);for(let a=l;a;a=a.parent){let c=Vl(a.type,t,s);if(c&&a.from<a.to){let h=ql(a);if(h&&(t>0?e>=h.from&&e<h.to:e>h.from&&e<=h.to))return N1(n,e,t,a,h,c,s)}}return O1(n,e,t,o,l.type,r,s)}function N1(n,e,t,i,r,s,o){let l=i.parent,a={from:r.from,to:r.to},c=0,h=l==null?void 0:l.cursor();if(h&&(t<0?h.childBefore(i.from):h.childAfter(i.to)))do if(t<0?h.to<=i.from:h.from>=i.to){if(c==0&&s.indexOf(h.type.name)>-1&&h.from<h.to){let u=ql(h);return{start:a,end:u?{from:u.from,to:u.to}:void 0,matched:!0}}else if(Vl(h.type,t,o))c++;else if(Vl(h.type,-t,o)){if(c==0){let u=ql(h);return{start:a,end:u&&u.from<u.to?{from:u.from,to:u.to}:void 0,matched:!1}}c--}}while(t<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function O1(n,e,t,i,r,s,o){let l=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},h=n.doc.iterRange(e,t>0?n.doc.length:0),u=0;for(let f=0;!h.next().done&&f<=s;){let d=h.value;t<0&&(f+=d.length);let p=e+f*t;for(let m=t>0?0:d.length-1,b=t>0?d.length:-1;m!=b;m+=t){let x=o.indexOf(d[m]);if(!(x<0||i.resolveInner(p+m,1).type!=r))if(x%2==0==t>0)u++;else{if(u==1)return{start:c,end:{from:p+m,to:p+m+1},matched:x>>1==a>>1};u--}}t>0&&(f+=d.length)}return h.done?{start:c,matched:!1}:null}function jh(n,e,t,i=0,r=0){e==null&&(e=n.search(/[^\s\u00a0]/),e==-1&&(e=n.length));let s=r;for(let o=i;o<e;o++)n.charCodeAt(o)==9?s+=t-s%t:s++;return s}class fp{constructor(e,t,i,r){this.string=e,this.tabSize=t,this.indentUnit=i,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),i;if(typeof e=="string"?i=t==e:i=t&&(e instanceof RegExp?e.test(t):e(t)),i)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=jh(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:jh(this.string,null,this.tabSize)}match(e,t,i){if(typeof e=="string"){let r=o=>i?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function L1(n){return{name:n.name||"",token:n.token,blankLine:n.blankLine||(()=>{}),startState:n.startState||(()=>!0),copyState:n.copyState||P1,indent:n.indent||(()=>null),languageData:n.languageData||{},tokenTable:n.tokenTable||Va,mergeTokens:n.mergeTokens!==!1}}function P1(n){if(typeof n!="object")return n;let e={};for(let t in n){let i=n[t];e[t]=i instanceof Array?i.slice():i}return e}const Hh=new WeakMap;class $a extends bt{constructor(e){let t=qw(e.languageData),i=L1(e),r,s=new class extends Jd{createParse(o,l,a){return new B1(r,o,l,a)}};super(t,s,[],e.name),this.topNode=H1(t,this),r=this,this.streamParser=i,this.stateAfter=new le({perNode:!0}),this.tokenTable=e.tokenTable?new gp(i.tokenTable):j1}static define(e){return new $a(e)}getIndent(e){let t,{overrideIndentation:i}=e.options;i&&(t=Hh.get(e.state),t!=null&&t<e.pos-1e4&&(t=void 0));let r=_a(this,e.node.tree,e.node.from,e.node.from,t??e.pos),s,o;if(r?(o=r.state,s=r.pos+1):(o=this.streamParser.startState(e.unit),s=e.node.from),e.pos-s>1e4)return null;for(;s<e.pos;){let a=e.state.doc.lineAt(s),c=Math.min(e.pos,a.to);if(a.length){let h=i?i(a.from):-1,u=new fp(a.text,e.state.tabSize,e.unit,h<0?void 0:h);for(;u.pos<c-a.from;)pp(this.streamParser.token,u,o)}else this.streamParser.blankLine(o,e.unit);if(c==e.pos)break;s=a.to+1}let l=e.lineAt(e.pos);return i&&t==null&&Hh.set(e.state,l.from),this.streamParser.indent(o,/^\s*(.*)/.exec(l.text)[1],e)}get allowsNesting(){return!1}}function _a(n,e,t,i,r){let s=t>=i&&t+e.length<=r&&e.prop(n.stateAfter);if(s)return{state:n.streamParser.copyState(s),pos:t+e.length};for(let o=e.children.length-1;o>=0;o--){let l=e.children[o],a=t+e.positions[o],c=l instanceof Ce&&a<r&&_a(n,l,a,i,r);if(c)return c}return null}function dp(n,e,t,i,r){if(r&&t<=0&&i>=e.length)return e;!r&&t==0&&e.type==n.topNode&&(r=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],l=e.children[s],a;if(o<i&&l instanceof Ce){if(!(a=dp(n,l,t-o,i-o,r)))break;return r?new Ce(e.type,e.children.slice(0,s).concat(a),e.positions.slice(0,s+1),o+a.length):a}}return null}function I1(n,e,t,i,r){for(let s of e){let o=s.from+(s.openStart?25:0),l=s.to-(s.openEnd?25:0),a=o<=t&&l>t&&_a(n,s.tree,0-s.offset,t,l),c;if(a&&a.pos<=i&&(c=dp(n,s.tree,t+s.offset,a.pos+s.offset,!1)))return{state:a.state,tree:c}}return{state:n.streamParser.startState(r?jn(r):4),tree:Ce.empty}}class B1{constructor(e,t,i,r){this.lang=e,this.input=t,this.fragments=i,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=gi.get(),o=r[0].from,{state:l,tree:a}=I1(e,i,o,this.to,s==null?void 0:s.state);this.state=l,this.parsedPos=this.chunkStart=o+a.length;for(let c=0;c<a.children.length;c++)this.chunks.push(a.children[c]),this.chunkPos.push(a.positions[c]);s&&this.parsedPos<s.viewport.from-1e5&&r.some(c=>c.from<=s.viewport.from&&c.to>=s.viewport.from)&&(this.state=this.lang.streamParser.startState(jn(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=gi.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),i=Math.min(t,this.chunkStart+2048);for(e&&(i=Math.min(i,e.viewport.to));this.parsedPos<i;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let i=t.indexOf(`
`);i>-1&&(t=t.slice(0,i))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),i=e+t.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=i||(t=t.slice(0,s-(i-t.length)),r++,r==this.ranges.length))break;let o=this.ranges[r].from,l=this.lineAfter(o);t+=l,i=o+l.length}return{line:t,end:i}}skipGapsTo(e,t,i){for(;;){let r=this.ranges[this.rangeIndex].to,s=e+t;if(i>0?r>s:r>=s)break;let o=this.ranges[++this.rangeIndex].from;t+=o-r}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,i,r){let s=4;if(this.ranges.length>1){r=this.skipGapsTo(t,r,1),t+=r;let l=this.chunk.length;r=this.skipGapsTo(i,r,-1),i+=r,s+=this.chunk.length-l}let o=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&s==4&&o>=0&&this.chunk[o]==e&&this.chunk[o+2]==t?this.chunk[o+2]=i:this.chunk.push(e,t,i,s),r}parseLine(e){let{line:t,end:i}=this.nextLine(),r=0,{streamParser:s}=this.lang,o=new fp(t,e?e.state.tabSize:4,e?jn(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let l=pp(s.token,o,this.state);if(l&&(r=this.emitToken(this.lang.tokenTable.resolve(l),this.parsedPos+o.start,this.parsedPos+o.pos,r)),o.start>1e4)break}this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Ce.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:z1,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Ce(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Ce(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function pp(n,e,t){e.start=e.pos;for(let i=0;i<10;i++){let r=n(e,t);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}const Va=Object.create(null),hr=[nt.none],z1=new Ia(hr),Fh=[],Wh=Object.create(null),mp=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])mp[n]=bp(Va,e);class gp{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),mp)}resolve(e){return e?this.table[e]||(this.table[e]=bp(this.extra,e)):0}}const j1=new gp(Va);function jo(n,e){Fh.indexOf(n)>-1||(Fh.push(n),console.warn(e))}function bp(n,e){let t=[];for(let l of e.split(" ")){let a=[];for(let c of l.split(".")){let h=n[c]||k[c];h?typeof h=="function"?a.length?a=a.map(h):jo(c,`Modifier ${c} used at start of tag`):a.length?jo(c,`Tag ${c} used as modifier`):a=Array.isArray(h)?h:[h]:jo(c,`Unknown highlighting tag ${c}`)}for(let c of a)t.push(c)}if(!t.length)return 0;let i=e.replace(/ /g,"_"),r=i+" "+t.map(l=>l.id),s=Wh[r];if(s)return s.id;let o=Wh[r]=nt.define({id:hr.length,name:i,props:[Fw({[i]:t})]});return hr.push(o),o.id}function H1(n,e){let t=nt.define({id:hr.length,name:"Document",props:[Zn.add(()=>n),Zd.add(()=>i=>e.getIndent(i))],top:!0});return hr.push(t),t}Se.RTL,Se.LTR;const F1=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),i=Ua(n.state,t.from);return i.line?W1(n):i.block?_1(n):!1};function qa(n,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let r=n(e,t);return r?(i(t.update(r)),!0):!1}}const W1=qa(U1,0),$1=qa(xp,0),_1=qa((n,e)=>xp(n,e,q1(e)),0);function Ua(n,e){let t=n.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const Bi=50;function V1(n,{open:e,close:t},i,r){let s=n.sliceDoc(i-Bi,i),o=n.sliceDoc(r,r+Bi),l=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(o)[0].length,c=s.length-l;if(s.slice(c-e.length,c)==e&&o.slice(a,a+t.length)==t)return{open:{pos:i-l,margin:l&&1},close:{pos:r+a,margin:a&&1}};let h,u;r-i<=2*Bi?h=u=n.sliceDoc(i,r):(h=n.sliceDoc(i,i+Bi),u=n.sliceDoc(r-Bi,r));let f=/^\s*/.exec(h)[0].length,d=/\s*$/.exec(u)[0].length,p=u.length-d-t.length;return h.slice(f,f+e.length)==e&&u.slice(p,p+t.length)==t?{open:{pos:i+f+e.length,margin:/\s/.test(h.charAt(f+e.length))?1:0},close:{pos:r-d-t.length,margin:/\s/.test(u.charAt(p-1))?1:0}}:null}function q1(n){let e=[];for(let t of n.selection.ranges){let i=n.doc.lineAt(t.from),r=t.to<=i.to?i:n.doc.lineAt(t.to);r.from>i.from&&r.from==t.to&&(r=t.to==i.to+1?i:n.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=r.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:r.to})}return e}function xp(n,e,t=e.selection.ranges){let i=t.map(s=>Ua(e,s.from).block);if(!i.every(s=>s))return null;let r=t.map((s,o)=>V1(e,i[o],s.from,s.to));if(n!=2&&!r.every(s=>s))return{changes:e.changes(t.map((s,o)=>r[o]?[]:[{from:s.from,insert:i[o].open+" "},{from:s.to,insert:" "+i[o].close}]))};if(n!=1&&r.some(s=>s)){let s=[];for(let o=0,l;o<r.length;o++)if(l=r[o]){let a=i[o],{open:c,close:h}=l;s.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:h.pos-h.margin,to:h.pos+a.close.length})}return{changes:s}}return null}function U1(n,e,t=e.selection.ranges){let i=[],r=-1;for(let{from:s,to:o}of t){let l=i.length,a=1e9,c=Ua(e,s).line;if(c){for(let h=s;h<=o;){let u=e.doc.lineAt(h);if(u.from>r&&(s==o||o>u.from)){r=u.from;let f=/^\s*/.exec(u.text)[0].length,d=f==u.length,p=u.text.slice(f,f+c.length)==c?f:-1;f<u.text.length&&f<a&&(a=f),i.push({line:u,comment:p,token:c,indent:f,empty:d,single:!1})}h=u.to+1}if(a<1e9)for(let h=l;h<i.length;h++)i[h].indent<i[h].line.text.length&&(i[h].indent=a);i.length==l+1&&(i[l].single=!0)}}if(n!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:a,indent:c,empty:h,single:u}of i)(u||!h)&&s.push({from:l.from+c,insert:a+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:l,token:a}of i)if(l>=0){let c=o.from+l,h=c+a.length;o.text[h-o.from]==" "&&h++,s.push({from:c,to:h})}return{changes:s}}return null}const Ul=Bt.define(),G1=Bt.define(),K1=j.define(),yp=j.define({combine(n){return zt(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(i,r)=>e(i,r)||t(i,r)})}}),vp=Fe.define({create(){return Dt.empty},update(n,e){let t=e.state.facet(yp),i=e.annotation(Ul);if(i){let a=tt.fromTransaction(e,i.selection),c=i.side,h=c==0?n.undone:n.done;return a?h=Ls(h,h.length,t.minDepth,a):h=kp(h,e.startState.selection),new Dt(c==0?i.rest:h,c==0?h:i.rest)}let r=e.annotation(G1);if((r=="full"||r=="before")&&(n=n.isolate()),e.annotation(Le.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let s=tt.fromTransaction(e),o=e.annotation(Le.time),l=e.annotation(Le.userEvent);return s?n=n.addChanges(s,o,l,t,e):e.selection&&(n=n.addSelection(e.startState.selection,o,l,t.newGroupDelay)),(r=="full"||r=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Dt(n.done.map(tt.fromJSON),n.undone.map(tt.fromJSON))}});function J1(n={}){return[vp,yp.of(n),B.domEventHandlers({beforeinput(e,t){let i=e.inputType=="historyUndo"?wp:e.inputType=="historyRedo"?Gl:null;return i?(e.preventDefault(),i(t)):!1}})]}function no(n,e){return function({state:t,dispatch:i}){if(!e&&t.readOnly)return!1;let r=t.field(vp,!1);if(!r)return!1;let s=r.pop(n,t,e);return s?(i(s),!0):!1}}const wp=no(0,!1),Gl=no(1,!1),Y1=no(0,!0),X1=no(1,!0);class tt{constructor(e,t,i,r,s){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new tt(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new tt(e.changes&&Oe.fromJSON(e.changes),[],e.mapped&&Nt.fromJSON(e.mapped),e.startSelection&&T.fromJSON(e.startSelection),e.selectionsAfter.map(T.fromJSON))}static fromTransaction(e,t){let i=ut;for(let r of e.startState.facet(K1)){let s=r(e);s.length&&(i=i.concat(s))}return!i.length&&e.changes.empty?null:new tt(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,ut)}static selection(e){return new tt(void 0,ut,void 0,void 0,e)}}function Ls(n,e,t,i){let r=e+1>t+20?e-t-1:0,s=n.slice(r,e);return s.push(i),s}function Q1(n,e){let t=[],i=!1;return n.iterChangedRanges((r,s)=>t.push(r,s)),e.iterChangedRanges((r,s,o,l)=>{for(let a=0;a<t.length;){let c=t[a++],h=t[a++];l>=c&&o<=h&&(i=!0)}}),i}function Z1(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,i)=>t.empty!=e.ranges[i].empty).length===0}function Sp(n,e){return n.length?e.length?n.concat(e):n:e}const ut=[],eS=200;function kp(n,e){if(n.length){let t=n[n.length-1],i=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-eS));return i.length&&i[i.length-1].eq(e)?n:(i.push(e),Ls(n,n.length-1,1e9,t.setSelAfter(i)))}else return[tt.selection([e])]}function tS(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Ho(n,e){if(!n.length)return n;let t=n.length,i=ut;for(;t;){let r=nS(n[t-1],e,i);if(r.changes&&!r.changes.empty||r.effects.length){let s=n.slice(0,t);return s[t-1]=r,s}else e=r.mapped,t--,i=r.selectionsAfter}return i.length?[tt.selection(i)]:ut}function nS(n,e,t){let i=Sp(n.selectionsAfter.length?n.selectionsAfter.map(l=>l.map(e)):ut,t);if(!n.changes)return tt.selection(i);let r=n.changes.map(e),s=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(s):s;return new tt(r,ne.mapEffects(n.effects,e),o,n.startSelection.map(s),i)}const iS=/^(input\.type|delete)($|\.)/;class Dt{constructor(e,t,i=0,r=void 0){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=r}isolate(){return this.prevTime?new Dt(this.done,this.undone):this}addChanges(e,t,i,r,s){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!i||iS.test(i))&&(!l.selectionsAfter.length&&t-this.prevTime<r.newGroupDelay&&r.joinToEvent(s,Q1(l.changes,e.changes))||i=="input.type.compose")?o=Ls(o,o.length-1,r.minDepth,new tt(e.changes.compose(l.changes),Sp(ne.mapEffects(e.effects,l.changes),l.effects),l.mapped,l.startSelection,ut)):o=Ls(o,o.length,r.minDepth,e),new Dt(o,ut,t,i)}addSelection(e,t,i,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:ut;return s.length>0&&t-this.prevTime<r&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&Z1(s[s.length-1],e)?this:new Dt(kp(this.done,e),this.undone,t,i)}addMapping(e){return new Dt(Ho(this.done,e),Ho(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1],o=s.selectionsAfter[0]||t.selection;if(i&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Ul.of({side:e,rest:tS(r),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let l=r.length==1?ut:r.slice(0,r.length-1);return s.mapped&&(l=Ho(l,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Ul.of({side:e,rest:l,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Dt.empty=new Dt(ut,ut);const rS=[{key:"Mod-z",run:wp,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Gl,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Gl,preventDefault:!0},{key:"Mod-u",run:Y1,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:X1,preventDefault:!0}];function Ai(n,e){return T.create(n.ranges.map(e),n.mainIndex)}function jt(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function wt({state:n,dispatch:e},t){let i=Ai(n.selection,t);return i.eq(n.selection,!0)?!1:(e(jt(n,i)),!0)}function io(n,e){return T.cursor(e?n.to:n.from)}function Cp(n,e){return wt(n,t=>t.empty?n.moveByChar(t,e):io(t,e))}function Ue(n){return n.textDirectionAt(n.state.selection.main.head)==Se.LTR}const Ap=n=>Cp(n,!Ue(n)),Mp=n=>Cp(n,Ue(n));function Ep(n,e){return wt(n,t=>t.empty?n.moveByGroup(t,e):io(t,e))}const sS=n=>Ep(n,!Ue(n)),oS=n=>Ep(n,Ue(n));function lS(n,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function ro(n,e,t){let i=qe(n).resolveInner(e.head),r=t?le.closedBy:le.openedBy;for(let a=e.head;;){let c=t?i.childAfter(a):i.childBefore(a);if(!c)break;lS(n,c,r)?i=c:a=t?c.to:c.from}let s=i.type.prop(r),o,l;return s&&(o=t?Rt(n,i.from,1):Rt(n,i.to,-1))&&o.matched?l=t?o.end.to:o.end.from:l=t?i.to:i.from,T.cursor(l,t?-1:1)}const aS=n=>wt(n,e=>ro(n.state,e,!Ue(n))),cS=n=>wt(n,e=>ro(n.state,e,Ue(n)));function Tp(n,e){return wt(n,t=>{if(!t.empty)return io(t,e);let i=n.moveVertically(t,e);return i.head!=t.head?i:n.moveToLineBoundary(t,e)})}const Rp=n=>Tp(n,!1),Dp=n=>Tp(n,!0);function Np(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,i=0,r;if(e){for(let s of n.state.facet(B.scrollMargins)){let o=s(n);o!=null&&o.top&&(t=Math.max(o==null?void 0:o.top,t)),o!=null&&o.bottom&&(i=Math.max(o==null?void 0:o.bottom,i))}r=n.scrollDOM.clientHeight-t-i}else r=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:i,selfScroll:e,height:Math.max(n.defaultLineHeight,r-5)}}function Op(n,e){let t=Np(n),{state:i}=n,r=Ai(i.selection,o=>o.empty?n.moveVertically(o,e,t.height):io(o,e));if(r.eq(i.selection))return!1;let s;if(t.selfScroll){let o=n.coordsAtPos(i.selection.main.head),l=n.scrollDOM.getBoundingClientRect(),a=l.top+t.marginTop,c=l.bottom-t.marginBottom;o&&o.top>a&&o.bottom<c&&(s=B.scrollIntoView(r.main.head,{y:"start",yMargin:o.top-a}))}return n.dispatch(jt(i,r),{effects:s}),!0}const $h=n=>Op(n,!1),Kl=n=>Op(n,!0);function xn(n,e,t){let i=n.lineBlockAt(e.head),r=n.moveToLineBoundary(e,t);if(r.head==e.head&&r.head!=(t?i.to:i.from)&&(r=n.moveToLineBoundary(e,t,!1)),!t&&r.head==i.from&&i.length){let s=/^\s*/.exec(n.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(r=T.cursor(i.from+s))}return r}const hS=n=>wt(n,e=>xn(n,e,!0)),uS=n=>wt(n,e=>xn(n,e,!1)),fS=n=>wt(n,e=>xn(n,e,!Ue(n))),dS=n=>wt(n,e=>xn(n,e,Ue(n))),pS=n=>wt(n,e=>T.cursor(n.lineBlockAt(e.head).from,1)),mS=n=>wt(n,e=>T.cursor(n.lineBlockAt(e.head).to,-1));function gS(n,e,t){let i=!1,r=Ai(n.selection,s=>{let o=Rt(n,s.head,-1)||Rt(n,s.head,1)||s.head>0&&Rt(n,s.head-1,1)||s.head<n.doc.length&&Rt(n,s.head+1,-1);if(!o||!o.end)return s;i=!0;let l=o.start.from==s.head?o.end.to:o.end.from;return T.cursor(l)});return i?(e(jt(n,r)),!0):!1}const bS=({state:n,dispatch:e})=>gS(n,e);function gt(n,e){let t=Ai(n.state.selection,i=>{let r=e(i);return T.range(i.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(jt(n.state,t)),!0)}function Lp(n,e){return gt(n,t=>n.moveByChar(t,e))}const Pp=n=>Lp(n,!Ue(n)),Ip=n=>Lp(n,Ue(n));function Bp(n,e){return gt(n,t=>n.moveByGroup(t,e))}const xS=n=>Bp(n,!Ue(n)),yS=n=>Bp(n,Ue(n)),vS=n=>gt(n,e=>ro(n.state,e,!Ue(n))),wS=n=>gt(n,e=>ro(n.state,e,Ue(n)));function zp(n,e){return gt(n,t=>n.moveVertically(t,e))}const jp=n=>zp(n,!1),Hp=n=>zp(n,!0);function Fp(n,e){return gt(n,t=>n.moveVertically(t,e,Np(n).height))}const _h=n=>Fp(n,!1),Vh=n=>Fp(n,!0),SS=n=>gt(n,e=>xn(n,e,!0)),kS=n=>gt(n,e=>xn(n,e,!1)),CS=n=>gt(n,e=>xn(n,e,!Ue(n))),AS=n=>gt(n,e=>xn(n,e,Ue(n))),MS=n=>gt(n,e=>T.cursor(n.lineBlockAt(e.head).from)),ES=n=>gt(n,e=>T.cursor(n.lineBlockAt(e.head).to)),qh=({state:n,dispatch:e})=>(e(jt(n,{anchor:0})),!0),Uh=({state:n,dispatch:e})=>(e(jt(n,{anchor:n.doc.length})),!0),Gh=({state:n,dispatch:e})=>(e(jt(n,{anchor:n.selection.main.anchor,head:0})),!0),Kh=({state:n,dispatch:e})=>(e(jt(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),TS=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),RS=({state:n,dispatch:e})=>{let t=so(n).map(({from:i,to:r})=>T.range(i,Math.min(r+1,n.doc.length)));return e(n.update({selection:T.create(t),userEvent:"select"})),!0},DS=({state:n,dispatch:e})=>{let t=Ai(n.selection,i=>{let r=qe(n),s=r.resolveStack(i.from,1);if(i.empty){let o=r.resolveStack(i.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:l}=o;if((l.from<i.from&&l.to>=i.to||l.to>i.to&&l.from<=i.from)&&o.next)return T.range(l.to,l.from)}return i});return t.eq(n.selection)?!1:(e(jt(n,t)),!0)},NS=({state:n,dispatch:e})=>{let t=n.selection,i=null;return t.ranges.length>1?i=T.create([t.main]):t.main.empty||(i=T.create([T.cursor(t.main.head)])),i?(e(jt(n,i)),!0):!1};function Er(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:i}=n,r=i.changeByRange(s=>{let{from:o,to:l}=s;if(o==l){let a=e(s);a<o?(t="delete.backward",a=Jr(n,a,!1)):a>o&&(t="delete.forward",a=Jr(n,a,!0)),o=Math.min(o,a),l=Math.max(l,a)}else o=Jr(n,o,!1),l=Jr(n,l,!0);return o==l?{range:s}:{changes:{from:o,to:l},range:T.cursor(o,o<s.head?-1:1)}});return r.changes.empty?!1:(n.dispatch(i.update(r,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?B.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function Jr(n,e,t){if(n instanceof B)for(let i of n.state.facet(B.atomicRanges).map(r=>r(n)))i.between(e,e,(r,s)=>{r<e&&s>e&&(e=t?s:r)});return e}const Wp=(n,e,t)=>Er(n,i=>{let r=i.from,{state:s}=n,o=s.doc.lineAt(r),l,a;if(t&&!e&&r>o.from&&r<o.from+200&&!/[^ \t]/.test(l=o.text.slice(0,r-o.from))){if(l[l.length-1]=="	")return r-1;let c=ki(l,s.tabSize),h=c%jn(s)||jn(s);for(let u=0;u<h&&l[l.length-1-u]==" ";u++)r--;a=r}else a=He(o.text,r-o.from,e,e)+o.from,a==r&&o.number!=(e?s.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(a-o.from,r-o.from))&&(a=He(o.text,a-o.from,!1,!1)+o.from);return a}),Jl=n=>Wp(n,!1,!0),$p=n=>Wp(n,!0,!1),_p=(n,e)=>Er(n,t=>{let i=t.head,{state:r}=n,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let l=null;;){if(i==(e?s.to:s.from)){i==t.head&&s.number!=(e?r.doc.lines:1)&&(i+=e?1:-1);break}let a=He(s.text,i-s.from,e)+s.from,c=s.text.slice(Math.min(i,a)-s.from,Math.max(i,a)-s.from),h=o(c);if(l!=null&&h!=l)break;(c!=" "||i!=t.head)&&(l=h),i=a}return i}),Vp=n=>_p(n,!1),OS=n=>_p(n,!0),LS=n=>Er(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),PS=n=>Er(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),IS=n=>Er(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),BS=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:he.of(["",""])},range:T.cursor(i.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},zS=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>{if(!i.empty||i.from==0||i.from==n.doc.length)return{range:i};let r=i.from,s=n.doc.lineAt(r),o=r==s.from?r-1:He(s.text,r-s.from,!1)+s.from,l=r==s.to?r+1:He(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:n.doc.slice(r,l).append(n.doc.slice(o,r))},range:T.cursor(l)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function so(n){let e=[],t=-1;for(let i of n.selection.ranges){let r=n.doc.lineAt(i.from),s=n.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=n.doc.lineAt(i.to-1)),t>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(i)}else e.push({from:r.from,to:s.to,ranges:[i]});t=s.number+1}return e}function qp(n,e,t){if(n.readOnly)return!1;let i=[],r=[];for(let s of so(n)){if(t?s.to==n.doc.length:s.from==0)continue;let o=n.doc.lineAt(t?s.to+1:s.from-1),l=o.length+1;if(t){i.push({from:s.to,to:o.to},{from:s.from,insert:o.text+n.lineBreak});for(let a of s.ranges)r.push(T.range(Math.min(n.doc.length,a.anchor+l),Math.min(n.doc.length,a.head+l)))}else{i.push({from:o.from,to:s.from},{from:s.to,insert:n.lineBreak+o.text});for(let a of s.ranges)r.push(T.range(a.anchor-l,a.head-l))}}return i.length?(e(n.update({changes:i,scrollIntoView:!0,selection:T.create(r,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const jS=({state:n,dispatch:e})=>qp(n,e,!1),HS=({state:n,dispatch:e})=>qp(n,e,!0);function Up(n,e,t){if(n.readOnly)return!1;let i=[];for(let r of so(n))t?i.push({from:r.from,insert:n.doc.slice(r.from,r.to)+n.lineBreak}):i.push({from:r.to,insert:n.lineBreak+n.doc.slice(r.from,r.to)});return e(n.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const FS=({state:n,dispatch:e})=>Up(n,e,!1),WS=({state:n,dispatch:e})=>Up(n,e,!0),$S=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(so(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),i=Ai(e.selection,r=>{let s;if(n.lineWrapping){let o=n.lineBlockAt(r.head),l=n.coordsAtPos(r.head,r.assoc||1);l&&(s=o.bottom+n.documentTop-l.bottom+n.defaultLineHeight/2)}return n.moveVertically(r,!0,s)}).map(t);return n.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function _S(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=qe(n).resolveInner(e),i=t.childBefore(e),r=t.childAfter(e),s;return i&&r&&i.to<=e&&r.from>=e&&(s=i.type.prop(le.closedBy))&&s.indexOf(r.name)>-1&&n.doc.lineAt(i.to).from==n.doc.lineAt(r.from).from&&!/\S/.test(n.sliceDoc(i.to,r.from))?{from:i.to,to:r.from}:null}const Jh=Gp(!1),VS=Gp(!0);function Gp(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(r=>{let{from:s,to:o}=r,l=e.doc.lineAt(s),a=!n&&s==o&&_S(e,s);n&&(s=o=(o<=l.to?l:e.doc.lineAt(o)).to);let c=new eo(e,{simulateBreak:s,simulateDoubleBreak:!!a}),h=Ha(c,s);for(h==null&&(h=ki(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:s,to:o}=a:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let u=["",cr(e,h)];return a&&u.push(cr(e,c.lineIndent(l.from,-1))),{changes:{from:s,to:o,insert:he.of(u)},range:T.cursor(s+1+u[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function Ga(n,e){let t=-1;return n.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let l=n.doc.lineAt(o);l.number>t&&(i.empty||i.to>l.from)&&(e(l,r,i),t=l.number),o=l.to+1}let s=n.changes(r);return{changes:r,range:T.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const qS=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),i=new eo(n,{overrideIndentation:s=>{let o=t[s];return o??-1}}),r=Ga(n,(s,o,l)=>{let a=Ha(i,s.from);if(a==null)return;/\S/.test(s.text)||(a=0);let c=/^\s*/.exec(s.text)[0],h=cr(n,a);(c!=h||l.from<s.from+c.length)&&(t[s.from]=a,o.push({from:s.from,to:s.from+c.length,insert:h}))});return r.changes.empty||e(n.update(r,{userEvent:"indent"})),!0},Kp=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Ga(n,(t,i)=>{i.push({from:t.from,insert:n.facet(Zs)})}),{userEvent:"input.indent"})),!0),Jp=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Ga(n,(t,i)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let s=ki(r,n.tabSize),o=0,l=cr(n,Math.max(0,s-jn(n)));for(;o<r.length&&o<l.length&&r.charCodeAt(o)==l.charCodeAt(o);)o++;i.push({from:t.from+o,to:t.from+r.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),US=n=>(n.setTabFocusMode(),!0),GS=[{key:"Ctrl-b",run:Ap,shift:Pp,preventDefault:!0},{key:"Ctrl-f",run:Mp,shift:Ip},{key:"Ctrl-p",run:Rp,shift:jp},{key:"Ctrl-n",run:Dp,shift:Hp},{key:"Ctrl-a",run:pS,shift:MS},{key:"Ctrl-e",run:mS,shift:ES},{key:"Ctrl-d",run:$p},{key:"Ctrl-h",run:Jl},{key:"Ctrl-k",run:LS},{key:"Ctrl-Alt-h",run:Vp},{key:"Ctrl-o",run:BS},{key:"Ctrl-t",run:zS},{key:"Ctrl-v",run:Kl}],KS=[{key:"ArrowLeft",run:Ap,shift:Pp,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:sS,shift:xS,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:fS,shift:CS,preventDefault:!0},{key:"ArrowRight",run:Mp,shift:Ip,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:oS,shift:yS,preventDefault:!0},{mac:"Cmd-ArrowRight",run:dS,shift:AS,preventDefault:!0},{key:"ArrowUp",run:Rp,shift:jp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:qh,shift:Gh},{mac:"Ctrl-ArrowUp",run:$h,shift:_h},{key:"ArrowDown",run:Dp,shift:Hp,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Uh,shift:Kh},{mac:"Ctrl-ArrowDown",run:Kl,shift:Vh},{key:"PageUp",run:$h,shift:_h},{key:"PageDown",run:Kl,shift:Vh},{key:"Home",run:uS,shift:kS,preventDefault:!0},{key:"Mod-Home",run:qh,shift:Gh},{key:"End",run:hS,shift:SS,preventDefault:!0},{key:"Mod-End",run:Uh,shift:Kh},{key:"Enter",run:Jh,shift:Jh},{key:"Mod-a",run:TS},{key:"Backspace",run:Jl,shift:Jl},{key:"Delete",run:$p},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Vp},{key:"Mod-Delete",mac:"Alt-Delete",run:OS},{mac:"Mod-Backspace",run:PS},{mac:"Mod-Delete",run:IS}].concat(GS.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),JS=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:aS,shift:vS},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cS,shift:wS},{key:"Alt-ArrowUp",run:jS},{key:"Shift-Alt-ArrowUp",run:FS},{key:"Alt-ArrowDown",run:HS},{key:"Shift-Alt-ArrowDown",run:WS},{key:"Escape",run:NS},{key:"Mod-Enter",run:VS},{key:"Alt-l",mac:"Ctrl-l",run:RS},{key:"Mod-i",run:DS,preventDefault:!0},{key:"Mod-[",run:Jp},{key:"Mod-]",run:Kp},{key:"Mod-Alt-\\",run:qS},{key:"Shift-Mod-k",run:$S},{key:"Shift-Mod-\\",run:bS},{key:"Mod-/",run:F1},{key:"Alt-A",run:$1},{key:"Ctrl-m",mac:"Shift-Alt-m",run:US}].concat(KS),YS={key:"Tab",run:Kp,shift:Jp},Yh=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class xi{constructor(e,t,i=0,r=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,r),this.bufferStart=i,this.normalize=s?l=>s(Yh(l)):Yh,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Xe(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=ya(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Et(e);let r=this.normalize(t);if(r.length)for(let s=0,o=i;;s++){let l=r.charCodeAt(s),a=this.match(l,o,this.bufferPos+this.bufferStart);if(s==r.length-1){if(a)return this.value=a,this;break}o==i&&s<t.length&&t.charCodeAt(s)==l&&o++}}}match(e,t,i){let r=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],l=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?r={from:this.matches[s+1],to:i}:(this.matches[s]++,l=!0)),l||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:t,to:i}:this.matches.push(1,t)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(xi.prototype[Symbol.iterator]=function(){return this});const Yp={from:-1,to:-1,match:/.*/.exec("")},Ka="gm"+(/x/.unicode==null?"":"u");class Xp{constructor(e,t,i,r=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=Yp,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new Qp(e,t,i,r,s);this.re=new RegExp(t,Ka+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=Ps(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,r=i+t[0].length;if(this.matchPos=Ps(this.text,r+(i==r?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<r||i>this.value.to)&&(!this.test||this.test(i,r,t)))return this.value={from:i,to:r,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Fo=new WeakMap;class oi{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let r=Fo.get(e);if(!r||r.from>=i||r.to<=t){let l=new oi(t,e.sliceString(t,i));return Fo.set(e,l),l}if(r.from==t&&r.to==i)return r;let{text:s,from:o}=r;return o>t&&(s=e.sliceString(t,o)+s,o=t),r.to<i&&(s+=e.sliceString(r.to,i)),Fo.set(e,new oi(o,s)),new oi(t,s.slice(t-o,i-o))}}class Qp{constructor(e,t,i,r,s){this.text=e,this.to=s,this.done=!1,this.value=Yp,this.matchPos=Ps(e,r),this.re=new RegExp(t,Ka+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=oi.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let i=this.flat.from+t.index,r=i+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,r,t)))return this.value={from:i,to:r,match:t},this.matchPos=Ps(this.text,r+(i==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=oi.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(Xp.prototype[Symbol.iterator]=Qp.prototype[Symbol.iterator]=function(){return this});function XS(n){try{return new RegExp(n,Ka),!0}catch{return!1}}function Ps(n,e){if(e>=n.length)return e;let t=n.lineAt(e),i;for(;e<t.to&&(i=t.text.charCodeAt(e-t.from))>=56320&&i<57344;)e++;return e}function Yl(n){let e=String(n.state.doc.lineAt(n.state.selection.main.head).number),t=be("input",{class:"cm-textfield",name:"line",value:e}),i=be("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),n.dispatch({effects:Yi.of(!1)}),n.focus()):s.keyCode==13&&(s.preventDefault(),r())},onsubmit:s=>{s.preventDefault(),r()}},be("label",n.state.phrase("Go to line"),": ",t)," ",be("button",{class:"cm-button",type:"submit"},n.state.phrase("go")),be("button",{name:"close",onclick:()=>{n.dispatch({effects:Yi.of(!1)}),n.focus()},"aria-label":n.state.phrase("close"),type:"button"},["Ã—"]));function r(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!s)return;let{state:o}=n,l=o.doc.lineAt(o.selection.main.head),[,a,c,h,u]=s,f=h?+h.slice(1):0,d=c?+c:l.number;if(c&&u){let b=d/100;a&&(b=b*(a=="-"?-1:1)+l.number/o.doc.lines),d=Math.round(o.doc.lines*b)}else c&&a&&(d=d*(a=="-"?-1:1)+l.number);let p=o.doc.line(Math.max(1,Math.min(o.doc.lines,d))),m=T.cursor(p.from+Math.max(0,Math.min(f,p.length)));n.dispatch({effects:[Yi.of(!1),B.scrollIntoView(m.from,{y:"center"})],selection:m}),n.focus()}return{dom:i}}const Yi=ne.define(),Xh=Fe.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(Yi)&&(n=t.value);return n},provide:n=>lr.from(n,e=>e?Yl:null)}),QS=n=>{let e=or(n,Yl);if(!e){let t=[Yi.of(!0)];n.state.field(Xh,!1)==null&&t.push(ne.appendConfig.of([Xh,ZS])),n.dispatch({effects:t}),e=or(n,Yl)}return e&&e.dom.querySelector("input").select(),!0},ZS=B.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),ek={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},tk=j.define({combine(n){return zt(n,ek,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function nk(n){return[lk,ok]}const ik=Y.mark({class:"cm-selectionMatch"}),rk=Y.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function Qh(n,e,t,i){return(t==0||n(e.sliceDoc(t-1,t))!=ke.Word)&&(i==e.doc.length||n(e.sliceDoc(i,i+1))!=ke.Word)}function sk(n,e,t,i){return n(e.sliceDoc(t,t+1))==ke.Word&&n(e.sliceDoc(i-1,i))==ke.Word}const ok=Re.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(tk),{state:t}=n,i=t.selection;if(i.ranges.length>1)return Y.none;let r=i.main,s,o=null;if(r.empty){if(!e.highlightWordAroundCursor)return Y.none;let a=t.wordAt(r.head);if(!a)return Y.none;o=t.charCategorizer(r.head),s=t.sliceDoc(a.from,a.to)}else{let a=r.to-r.from;if(a<e.minSelectionLength||a>200)return Y.none;if(e.wholeWords){if(s=t.sliceDoc(r.from,r.to),o=t.charCategorizer(r.head),!(Qh(o,t,r.from,r.to)&&sk(o,t,r.from,r.to)))return Y.none}else if(s=t.sliceDoc(r.from,r.to),!s)return Y.none}let l=[];for(let a of n.visibleRanges){let c=new xi(t.doc,s,a.from,a.to);for(;!c.next().done;){let{from:h,to:u}=c.value;if((!o||Qh(o,t,h,u))&&(r.empty&&h<=r.from&&u>=r.to?l.push(rk.range(h,u)):(h>=r.to||u<=r.from)&&l.push(ik.range(h,u)),l.length>e.maxMatches))return Y.none}}return Y.set(l)}},{decorations:n=>n.decorations}),lk=B.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),ak=({state:n,dispatch:e})=>{let{selection:t}=n,i=T.create(t.ranges.map(r=>n.wordAt(r.head)||T.cursor(r.head)),t.mainIndex);return i.eq(t)?!1:(e(n.update({selection:i})),!0)};function ck(n,e){let{main:t,ranges:i}=n.selection,r=n.wordAt(t.head),s=r&&r.from==t.from&&r.to==t.to;for(let o=!1,l=new xi(n.doc,e,i[i.length-1].to);;)if(l.next(),l.done){if(o)return null;l=new xi(n.doc,e,0,Math.max(0,i[i.length-1].from-1)),o=!0}else{if(o&&i.some(a=>a.from==l.value.from))continue;if(s){let a=n.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const hk=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(s=>s.from===s.to))return ak({state:n,dispatch:e});let i=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(s=>n.sliceDoc(s.from,s.to)!=i))return!1;let r=ck(n,i);return r?(e(n.update({selection:n.selection.addRange(T.range(r.from,r.to),!1),effects:B.scrollIntoView(r.to)})),!0):!1},Mi=j.define({combine(n){return zt(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Sk(e),scrollToMatch:e=>B.scrollIntoView(e)})}});class Zp{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||XS(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new pk(this):new fk(this)}getCursor(e,t=0,i){let r=e.doc?e:ae.create({doc:e});return i==null&&(i=r.doc.length),this.regexp?Kn(this,r,t,i):Gn(this,r,t,i)}}class em{constructor(e){this.spec=e}}function Gn(n,e,t,i){return new xi(e.doc,n.unquoted,t,i,n.caseSensitive?void 0:r=>r.toLowerCase(),n.wholeWord?uk(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function uk(n,e){return(t,i,r,s)=>((s>t||s+r.length<i)&&(s=Math.max(0,t-2),r=n.sliceString(s,Math.min(n.length,i+2))),(e(Is(r,t-s))!=ke.Word||e(Bs(r,t-s))!=ke.Word)&&(e(Bs(r,i-s))!=ke.Word||e(Is(r,i-s))!=ke.Word))}class fk extends em{constructor(e){super(e)}nextMatch(e,t,i){let r=Gn(this.spec,e,i,e.doc.length).nextOverlapping();if(r.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);r=Gn(this.spec,e,0,s).nextOverlapping()}return r.done||r.value.from==t&&r.value.to==i?null:r.value}prevMatchInRange(e,t,i){for(let r=i;;){let s=Math.max(t,r-1e4-this.spec.unquoted.length),o=Gn(this.spec,e,s,r),l=null;for(;!o.nextOverlapping().done;)l=o.value;if(l)return l;if(s==t)return null;r-=1e4}}prevMatch(e,t,i){let r=this.prevMatchInRange(e,0,t);return r||(r=this.prevMatchInRange(e,Math.max(0,i-this.spec.unquoted.length),e.doc.length)),r&&(r.from!=t||r.to!=i)?r:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let i=Gn(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=t)return null;r.push(i.value)}return r}highlight(e,t,i,r){let s=Gn(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}function Kn(n,e,t,i){return new Xp(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?dk(e.charCategorizer(e.selection.main.head)):void 0},t,i)}function Is(n,e){return n.slice(He(n,e,!1),e)}function Bs(n,e){return n.slice(e,He(n,e))}function dk(n){return(e,t,i)=>!i[0].length||(n(Is(i.input,i.index))!=ke.Word||n(Bs(i.input,i.index))!=ke.Word)&&(n(Bs(i.input,i.index+i[0].length))!=ke.Word||n(Is(i.input,i.index+i[0].length))!=ke.Word)}class pk extends em{nextMatch(e,t,i){let r=Kn(this.spec,e,i,e.doc.length).next();return r.done&&(r=Kn(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,i){for(let r=1;;r++){let s=Math.max(t,i-r*1e4),o=Kn(this.spec,e,s,i),l=null;for(;!o.next().done;)l=o.value;if(l&&(s==t||l.from>s+10))return l;if(s==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,i)=>{if(i=="&")return e.match[0];if(i=="$")return"$";for(let r=i.length;r>0;r--){let s=+i.slice(0,r);if(s>0&&s<e.match.length)return e.match[s]+i.slice(r)}return t})}matchAll(e,t){let i=Kn(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=t)return null;r.push(i.value)}return r}highlight(e,t,i,r){let s=Kn(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}const ur=ne.define(),Ja=ne.define(),un=Fe.define({create(n){return new Wo(Xl(n).create(),null)},update(n,e){for(let t of e.effects)t.is(ur)?n=new Wo(t.value.create(),n.panel):t.is(Ja)&&(n=new Wo(n.query,t.value?Ya:null));return n},provide:n=>lr.from(n,e=>e.panel)});class Wo{constructor(e,t){this.query=e,this.panel=t}}const mk=Y.mark({class:"cm-searchMatch"}),gk=Y.mark({class:"cm-searchMatch cm-searchMatch-selected"}),bk=Re.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(un))}update(n){let e=n.state.field(un);(e!=n.startState.field(un)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return Y.none;let{view:t}=this,i=new Kt;for(let r=0,s=t.visibleRanges,o=s.length;r<o;r++){let{from:l,to:a}=s[r];for(;r<o-1&&a>s[r+1].from-2*250;)a=s[++r].to;n.highlight(t.state,l,a,(c,h)=>{let u=t.state.selection.ranges.some(f=>f.from==c&&f.to==h);i.add(c,h,u?gk:mk)})}return i.finish()}},{decorations:n=>n.decorations});function Tr(n){return e=>{let t=e.state.field(un,!1);return t&&t.query.spec.valid?n(e,t):im(e)}}const zs=Tr((n,{query:e})=>{let{to:t}=n.state.selection.main,i=e.nextMatch(n.state,t,t);if(!i)return!1;let r=T.single(i.from,i.to),s=n.state.facet(Mi);return n.dispatch({selection:r,effects:[Xa(n,i),s.scrollToMatch(r.main,n)],userEvent:"select.search"}),nm(n),!0}),js=Tr((n,{query:e})=>{let{state:t}=n,{from:i}=t.selection.main,r=e.prevMatch(t,i,i);if(!r)return!1;let s=T.single(r.from,r.to),o=n.state.facet(Mi);return n.dispatch({selection:s,effects:[Xa(n,r),o.scrollToMatch(s.main,n)],userEvent:"select.search"}),nm(n),!0}),xk=Tr((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:T.create(t.map(i=>T.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),yk=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:r}=t.main,s=[],o=0;for(let l=new xi(n.doc,n.sliceDoc(i,r));!l.next().done;){if(s.length>1e3)return!1;l.value.from==i&&(o=s.length),s.push(T.range(l.value.from,l.value.to))}return e(n.update({selection:T.create(s,o),userEvent:"select.search.matches"})),!0},Zh=Tr((n,{query:e})=>{let{state:t}=n,{from:i,to:r}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,i,i);if(!s)return!1;let o=s,l=[],a,c,h=[];o.from==i&&o.to==r&&(c=t.toText(e.getReplacement(o)),l.push({from:o.from,to:o.to,insert:c}),o=e.nextMatch(t,o.from,o.to),h.push(B.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(i).number)+".")));let u=n.state.changes(l);return o&&(a=T.single(o.from,o.to).map(u),h.push(Xa(n,o)),h.push(t.facet(Mi).scrollToMatch(a.main,n))),n.dispatch({changes:u,selection:a,effects:h,userEvent:"input.replace"}),!0}),vk=Tr((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(r=>{let{from:s,to:o}=r;return{from:s,to:o,insert:e.getReplacement(r)}});if(!t.length)return!1;let i=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:B.announce.of(i),userEvent:"input.replace.all"}),!0});function Ya(n){return n.state.facet(Mi).createPanel(n)}function Xl(n,e){var t,i,r,s,o;let l=n.selection.main,a=l.empty||l.to>l.from+100?"":n.sliceDoc(l.from,l.to);if(e&&!a)return e;let c=n.facet(Mi);return new Zp({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:c.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:c.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:c.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:c.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function tm(n){let e=or(n,Ya);return e&&e.dom.querySelector("[main-field]")}function nm(n){let e=tm(n);e&&e==n.root.activeElement&&e.select()}const im=n=>{let e=n.state.field(un,!1);if(e&&e.panel){let t=tm(n);if(t&&t!=n.root.activeElement){let i=Xl(n.state,e.query.spec);i.valid&&n.dispatch({effects:ur.of(i)}),t.focus(),t.select()}}else n.dispatch({effects:[Ja.of(!0),e?ur.of(Xl(n.state,e.query.spec)):ne.appendConfig.of(Ck)]});return!0},rm=n=>{let e=n.state.field(un,!1);if(!e||!e.panel)return!1;let t=or(n,Ya);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:Ja.of(!1)}),!0},wk=[{key:"Mod-f",run:im,scope:"editor search-panel"},{key:"F3",run:zs,shift:js,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:zs,shift:js,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:rm,scope:"editor search-panel"},{key:"Mod-Shift-l",run:yk},{key:"Mod-Alt-g",run:QS},{key:"Mod-d",run:hk,preventDefault:!0}];class Sk{constructor(e){this.view=e;let t=this.query=e.state.field(un).query.spec;this.commit=this.commit.bind(this),this.searchField=be("input",{value:t.search,placeholder:it(e,"Find"),"aria-label":it(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=be("input",{value:t.replace,placeholder:it(e,"Replace"),"aria-label":it(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=be("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=be("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=be("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function i(r,s,o){return be("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=be("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,i("next",()=>zs(e),[it(e,"next")]),i("prev",()=>js(e),[it(e,"previous")]),i("select",()=>xk(e),[it(e,"all")]),be("label",null,[this.caseField,it(e,"match case")]),be("label",null,[this.reField,it(e,"regexp")]),be("label",null,[this.wordField,it(e,"by word")]),...e.state.readOnly?[]:[be("br"),this.replaceField,i("replace",()=>Zh(e),[it(e,"replace")]),i("replaceAll",()=>vk(e),[it(e,"replace all")])],be("button",{name:"close",onclick:()=>rm(e),"aria-label":it(e,"close"),type:"button"},["Ã—"])])}commit(){let e=new Zp({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:ur.of(e)}))}keydown(e){Av(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?js:zs)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),Zh(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(ur)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Mi).top}}function it(n,e){return n.state.phrase(e)}const Yr=30,Xr=/[\s\.,:;?!]/;function Xa(n,{from:e,to:t}){let i=n.state.doc.lineAt(e),r=n.state.doc.lineAt(t).to,s=Math.max(i.from,e-Yr),o=Math.min(r,t+Yr),l=n.state.sliceDoc(s,o);if(s!=i.from){for(let a=0;a<Yr;a++)if(!Xr.test(l[a+1])&&Xr.test(l[a])){l=l.slice(a);break}}if(o!=r){for(let a=l.length-1;a>l.length-Yr;a--)if(!Xr.test(l[a-1])&&Xr.test(l[a])){l=l.slice(0,a);break}}return B.announce.of(`${n.state.phrase("current match")}. ${l} ${n.state.phrase("on line")} ${i.number}.`)}const kk=B.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Ck=[un,bn.low(bk),kk];class sm{constructor(e,t,i,r){this.state=e,this.pos=t,this.explicit=i,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=qe(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),r=t.text.slice(i-t.from,this.pos-t.from),s=r.search(om(e,!1));return s<0?null:{from:i+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function eu(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Ak(n){let e=Object.create(null),t=Object.create(null);for(let{label:r}of n){e[r[0]]=!0;for(let s=1;s<r.length;s++)t[r[s]]=!0}let i=eu(e)+eu(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function Mk(n){let e=n.map(r=>typeof r=="string"?{label:r}:r),[t,i]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:Ak(e);return r=>{let s=r.matchBefore(i);return s||r.explicit?{from:s?s.from:r.pos,options:e,validFor:t}:null}}class tu{constructor(e,t,i,r){this.completion=e,this.source=t,this.match=i,this.score=r}}function On(n){return n.selection.main.from}function om(n,e){var t;let{source:i}=n,r=e&&i[0]!="^",s=i[i.length-1]!="$";return!r&&!s?n:new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const lm=Bt.define();function Ek(n,e,t,i){let{main:r}=n.selection,s=t-r.from,o=i-r.from;return Object.assign(Object.assign({},n.changeByRange(l=>{if(l!=r&&t!=i&&n.sliceDoc(l.from+s,l.from+o)!=n.sliceDoc(t,i))return{range:l};let a=n.toText(e);return{changes:{from:l.from+s,to:i==r.from?l.to:l.from+o,insert:a},range:T.cursor(l.from+s+a.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const nu=new WeakMap;function Tk(n){if(!Array.isArray(n))return n;let e=nu.get(n);return e||nu.set(n,e=Mk(n)),e}const Hs=ne.define(),fr=ne.define();class Rk{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let i=Xe(e,t),r=Et(i);this.chars.push(i);let s=e.slice(t,t+r),o=s.toUpperCase();this.folded.push(Xe(o==s?s.toLowerCase():o,0)),t+=r}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:r,precise:s,byWord:o}=this;if(t.length==1){let v=Xe(e,0),w=Et(v),C=w==e.length?0:-100;if(v!=t[0])if(v==i[0])C+=-200;else return null;return this.ret(C,[0,w])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,c=0;if(l<0){for(let v=0,w=Math.min(e.length,200);v<w&&c<a;){let C=Xe(e,v);(C==t[c]||C==i[c])&&(r[c++]=v),v+=Et(C)}if(c<a)return null}let h=0,u=0,f=!1,d=0,p=-1,m=-1,b=/[a-z]/.test(e),x=!0;for(let v=0,w=Math.min(e.length,200),C=0;v<w&&u<a;){let S=Xe(e,v);l<0&&(h<a&&S==t[h]&&(s[h++]=v),d<a&&(S==t[d]||S==i[d]?(d==0&&(p=v),m=v+1,d++):d=0));let M,A=S<255?S>=48&&S<=57||S>=97&&S<=122?2:S>=65&&S<=90?1:0:(M=ya(S))!=M.toLowerCase()?1:M!=M.toUpperCase()?2:0;(!v||A==1&&b||C==0&&A!=0)&&(t[u]==S||i[u]==S&&(f=!0)?o[u++]=v:o.length&&(x=!1)),C=A,v+=Et(S)}return u==a&&o[0]==0&&x?this.result(-100+(f?-200:0),o,e):d==a&&p==0?this.ret(-200-e.length+(m==e.length?0:-100),[0,m]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):d==a?this.ret(-900-e.length,[p,m]):u==a?this.result(-100+(f?-200:0)+-700+(x?0:-1100),o,e):t.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,i){let r=[],s=0;for(let o of t){let l=o+(this.astral?Et(Xe(i,o)):1);s&&r[s-1]==o?r[s-1]=l:(r[s++]=o,r[s++]=l)}return this.ret(e-i.length,r)}}class Dk{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),i=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,t.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const Pe=j.define({combine(n){return zt(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Nk,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>i=>iu(e(i),t(i)),optionClass:(e,t)=>i=>iu(e(i),t(i)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function iu(n,e){return n?e?n+" "+e:n:e}function Nk(n,e,t,i,r,s){let o=n.textDirection==Se.RTL,l=o,a=!1,c="top",h,u,f=e.left-r.left,d=r.right-e.right,p=i.right-i.left,m=i.bottom-i.top;if(l&&f<Math.min(p,d)?l=!1:!l&&d<Math.min(p,f)&&(l=!0),p<=(l?f:d))h=Math.max(r.top,Math.min(t.top,r.bottom-m))-e.top,u=Math.min(400,l?f:d);else{a=!0,u=Math.min(400,(o?e.right:r.right-e.left)-30);let v=r.bottom-e.bottom;v>=m||v>e.top?h=t.bottom-e.top:(c="bottom",h=e.bottom-t.top)}let b=(e.bottom-e.top)/s.offsetHeight,x=(e.right-e.left)/s.offsetWidth;return{style:`${c}: ${h/b}px; max-width: ${u/x}px`,class:"cm-completionInfo-"+(a?o?"left-narrow":"right-narrow":l?"left":"right")}}function Ok(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,r,s){let o=document.createElement("span");o.className="cm-completionLabel";let l=t.displayLabel||t.label,a=0;for(let c=0;c<s.length;){let h=s[c++],u=s[c++];h>a&&o.appendChild(document.createTextNode(l.slice(a,h)));let f=o.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(l.slice(h,u))),f.className="cm-completionMatchedText",a=u}return a<l.length&&o.appendChild(document.createTextNode(l.slice(a))),o},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function $o(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let r=Math.floor(e/t);return{from:r*t,to:(r+1)*t}}let i=Math.floor((n-e)/t);return{from:n-(i+1)*t,to:n-i*t}}class Lk{constructor(e,t,i){this.view=e,this.stateField=t,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let r=e.state.field(t),{options:s,selected:o}=r.open,l=e.state.facet(Pe);this.optionContent=Ok(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=$o(s.length,o,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=e.state.field(t).open;for(let h=a.target,u;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(u=/-(\d+)$/.exec(h.id))&&+u[1]<c.length){this.applyCompletion(e,c[+u[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(Pe).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:fr.of(null)})}),this.showOptions(s,r.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let i=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=r){let{options:s,selected:o,disabled:l}=i.open;(!r.open||r.open.options!=s)&&(this.range=$o(s.length,o,e.state.facet(Pe).maxRenderedOptions),this.showOptions(s,i.id)),this.updateSel(),l!=((t=r.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of t.split(" "))i&&this.dom.classList.add(i);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=$o(t.options.length,t.selected,this.view.state.facet(Pe).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:i}=t.options[t.selected],{info:r}=i;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(i);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,i)}).catch(o=>et(this.view.state,o,"completion info")):this.addInfoPane(s,i)}}addInfoPane(e,t){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:s}=e;i.appendChild(r),this.infoDestroy=s||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,r=this.range.from;i;i=i.nextSibling,r++)i.nodeName!="LI"||!i.id?r--:r==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return t&&Ik(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return r.top>Math.min(s.bottom,t.bottom)-10||r.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(Pe).positionInfo(this.view,t,r,i,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,i){const r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions")),r.addEventListener("mousedown",o=>{o.target==r&&o.preventDefault()});let s=null;for(let o=i.from;o<i.to;o++){let{completion:l,match:a}=e[o],{section:c}=l;if(c){let f=typeof c=="string"?c:c.name;if(f!=s&&(o>i.from||i.from==0))if(s=f,typeof c!="string"&&c.header)r.appendChild(c.header(c));else{let d=r.appendChild(document.createElement("completion-section"));d.textContent=f}}const h=r.appendChild(document.createElement("li"));h.id=t+"-"+o,h.setAttribute("role","option");let u=this.optionClass(l);u&&(h.className=u);for(let f of this.optionContent){let d=f(l,this.view.state,this.view,a);d&&h.appendChild(d)}}return i.from&&r.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function Pk(n,e){return t=>new Lk(t,n,e)}function Ik(n,e){let t=n.getBoundingClientRect(),i=e.getBoundingClientRect(),r=t.height/n.offsetHeight;i.top<t.top?n.scrollTop-=(t.top-i.top)/r:i.bottom>t.bottom&&(n.scrollTop+=(i.bottom-t.bottom)/r)}function ru(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function Bk(n,e){let t=[],i=null,r=c=>{t.push(c);let{section:h}=c.completion;if(h){i||(i=[]);let u=typeof h=="string"?h:h.name;i.some(f=>f.name==u)||i.push(typeof h=="string"?{name:u}:h)}},s=e.facet(Pe);for(let c of n)if(c.hasResult()){let h=c.result.getMatch;if(c.result.filter===!1)for(let u of c.result.options)r(new tu(u,c.source,h?h(u):[],1e9-t.length));else{let u=e.sliceDoc(c.from,c.to),f,d=s.filterStrict?new Dk(u):new Rk(u);for(let p of c.result.options)if(f=d.match(p.label)){let m=p.displayLabel?h?h(p,f.matched):[]:f.matched;r(new tu(p,c.source,m,f.score+(p.boost||0)))}}}if(i){let c=Object.create(null),h=0,u=(f,d)=>{var p,m;return((p=f.rank)!==null&&p!==void 0?p:1e9)-((m=d.rank)!==null&&m!==void 0?m:1e9)||(f.name<d.name?-1:1)};for(let f of i.sort(u))h-=1e5,c[f.name]=h;for(let f of t){let{section:d}=f.completion;d&&(f.score+=c[typeof d=="string"?d:d.name])}}let o=[],l=null,a=s.compareCompletions;for(let c of t.sort((h,u)=>u.score-h.score||a(h.completion,u.completion))){let h=c.completion;!l||l.label!=h.label||l.detail!=h.detail||l.type!=null&&h.type!=null&&l.type!=h.type||l.apply!=h.apply||l.boost!=h.boost?o.push(c):ru(c.completion)>ru(l)&&(o[o.length-1]=c),l=c.completion}return o}class ei{constructor(e,t,i,r,s,o){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=r,this.selected=s,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new ei(this.options,su(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,i,r,s,o){if(r&&!o&&e.some(c=>c.isPending))return r.setDisabled();let l=Bk(e,t);if(!l.length)return r&&e.some(c=>c.isPending)?r.setDisabled():null;let a=t.facet(Pe).selectOnOpen?0:-1;if(r&&r.selected!=a&&r.selected!=-1){let c=r.options[r.selected].completion;for(let h=0;h<l.length;h++)if(l[h].completion==c){a=h;break}}return new ei(l,su(i,a),{pos:e.reduce((c,h)=>h.hasResult()?Math.min(c,h.from):c,1e8),create:$k,above:s.aboveCursor},r?r.timestamp:Date.now(),a,!1)}map(e){return new ei(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new ei(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Fs{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new Fs(Fk,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(Pe),s=(i.override||t.languageDataAt("autocomplete",On(t)).map(Tk)).map(a=>(this.active.find(h=>h.source==a)||new ft(a,this.active.some(h=>h.state!=0)?1:0)).update(e,i));s.length==this.active.length&&s.every((a,c)=>a==this.active[c])&&(s=this.active);let o=this.open,l=e.effects.some(a=>a.is(Qa));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(a=>a.hasResult()&&e.changes.touchesRange(a.from,a.to))||!zk(s,this.active)||l?o=ei.build(s,t,this.id,o,i,l):o&&o.disabled&&!s.some(a=>a.isPending)&&(o=null),!o&&s.every(a=>!a.isPending)&&s.some(a=>a.hasResult())&&(s=s.map(a=>a.hasResult()?new ft(a.source,0):a));for(let a of e.effects)a.is(cm)&&(o=o&&o.setSelected(a.value,this.id));return s==this.active&&o==this.open?this:new Fs(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?jk:Hk}}function zk(n,e){if(n==e)return!0;for(let t=0,i=0;;){for(;t<n.length&&!n[t].hasResult();)t++;for(;i<e.length&&!e[i].hasResult();)i++;let r=t==n.length,s=i==e.length;if(r||s)return r==s;if(n[t++].result!=e[i++].result)return!1}}const jk={"aria-autocomplete":"list"},Hk={};function su(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const Fk=[];function am(n,e){if(n.isUserEvent("input.complete")){let i=n.annotation(lm);if(i&&e.activateOnCompletion(i))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class ft{constructor(e,t,i=!1){this.source=e,this.state=t,this.explicit=i}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let i=am(e,t),r=this;(i&8||i&16&&this.touches(e))&&(r=new ft(r.source,0)),i&4&&r.state==0&&(r=new ft(this.source,1)),r=r.updateFor(e,i);for(let s of e.effects)if(s.is(Hs))r=new ft(r.source,1,s.value);else if(s.is(fr))r=new ft(r.source,0);else if(s.is(Qa))for(let o of s.value)o.source==r.source&&(r=o);return r}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(On(e.state))}}class li extends ft{constructor(e,t,i,r,s,o){super(e,3,t),this.limit=i,this.result=r,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,t){var i;if(!(t&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),l=On(e.state);if(l>o||!r||t&2&&(On(e.startState)==this.from||l<this.limit))return new ft(this.source,t&4?1:0);let a=e.changes.mapPos(this.limit);return Wk(r.validFor,e.state,s,o)?new li(this.source,this.explicit,a,r,s,o):r.update&&(r=r.update(r,s,o,new sm(e.state,l,!1)))?new li(this.source,this.explicit,a,r,r.from,(i=r.to)!==null&&i!==void 0?i:On(e.state)):new ft(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new li(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new ft(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function Wk(n,e,t,i){if(!n)return!1;let r=e.sliceDoc(t,i);return typeof n=="function"?n(r,t,i,e):om(n,!0).test(r)}const Qa=ne.define({map(n,e){return n.map(t=>t.map(e))}}),cm=ne.define(),Ze=Fe.define({create(){return Fs.start()},update(n,e){return n.update(e)},provide:n=>[Pa.from(n,e=>e.tooltip),B.contentAttributes.from(n,e=>e.attrs)]});function Za(n,e){const t=e.completion.apply||e.completion.label;let i=n.state.field(Ze).active.find(r=>r.source==e.source);return i instanceof li?(typeof t=="string"?n.dispatch(Object.assign(Object.assign({},Ek(n.state,t,i.from,i.to)),{annotations:lm.of(e.completion)})):t(n,e.completion,i.from,i.to),!0):!1}const $k=Pk(Ze,Za);function Qr(n,e="option"){return t=>{let i=t.state.field(Ze,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<t.state.facet(Pe).interactionDelay)return!1;let r=1,s;e=="page"&&(s=$d(t,i.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,l=i.open.selected>-1?i.open.selected+r*(n?1:-1):n?0:o-1;return l<0?l=e=="page"?0:o-1:l>=o&&(l=e=="page"?o-1:0),t.dispatch({effects:cm.of(l)}),!0}}const _k=n=>{let e=n.state.field(Ze,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(Pe).interactionDelay?!1:Za(n,e.open.options[e.open.selected])},ou=n=>n.state.field(Ze,!1)?(n.dispatch({effects:Hs.of(!0)}),!0):!1,Vk=n=>{let e=n.state.field(Ze,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:fr.of(null)}),!0)};class qk{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const Uk=50,Gk=1e3,Kk=Re.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(Ze).active)e.isPending&&this.startQuery(e)}update(n){let e=n.state.field(Ze),t=n.state.facet(Pe);if(!n.selectionSet&&!n.docChanged&&n.startState.field(Ze)==e)return;let i=n.transactions.some(s=>{let o=am(s,t);return o&8||(s.selection||s.docChanged)&&!(o&3)});for(let s=0;s<this.running.length;s++){let o=this.running[s];if(i||o.context.abortOnDocChange&&n.docChanged||o.updates.length+n.transactions.length>Uk&&Date.now()-o.time>Gk){for(let l of o.context.abortListeners)try{l()}catch(a){et(this.view.state,a)}o.context.abortListeners=null,this.running.splice(s--,1)}else o.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(s=>s.effects.some(o=>o.is(Hs)))&&(this.pendingStart=!0);let r=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(o=>o.active.source==s.source))?setTimeout(()=>this.startUpdate(),r):-1,this.composing!=0)for(let s of n.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(Ze);for(let t of e.active)t.isPending&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Pe).updateSyncTime))}startQuery(n){let{state:e}=this.view,t=On(e),i=new sm(e,t,n.explicit,this.view),r=new qk(n,i);this.running.push(r),Promise.resolve(n.source(i)).then(s=>{r.context.aborted||(r.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:fr.of(null)}),et(this.view.state,s)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Pe).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Pe),i=this.view.state.field(Ze);for(let r=0;r<this.running.length;r++){let s=this.running[r];if(s.done===void 0)continue;if(this.running.splice(r--,1),s.done){let l=On(s.updates.length?s.updates[0].startState:this.view.state),a=Math.min(l,s.done.from+(s.active.explicit?0:1)),c=new li(s.active.source,s.active.explicit,a,s.done,s.done.from,(n=s.done.to)!==null&&n!==void 0?n:l);for(let h of s.updates)c=c.update(h,t);if(c.hasResult()){e.push(c);continue}}let o=i.active.find(l=>l.source==s.active.source);if(o&&o.isPending)if(s.done==null){let l=new ft(s.active.source,0);for(let a of s.updates)l=l.update(a,t);l.isPending||e.push(l)}else this.startQuery(o)}(e.length||i.open&&i.open.disabled)&&this.view.dispatch({effects:Qa.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(Ze,!1);if(e&&e.tooltip&&this.view.state.facet(Pe).closeOnBlur){let t=e.open&&$d(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:fr.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Hs.of(!1)}),20),this.composing=0}}}),Jk=typeof navigator=="object"&&/Win/.test(navigator.platform),Yk=bn.highest(B.domEventHandlers({keydown(n,e){let t=e.state.field(Ze,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!(Jk&&n.altKey)||n.metaKey)return!1;let i=t.open.options[t.open.selected],r=t.active.find(o=>o.source==i.source),s=i.completion.commitCharacters||r.result.commitCharacters;return s&&s.indexOf(n.key)>-1&&Za(e,i),!1}})),Xk=B.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"Â·Â·Â·"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'Æ’'"}},".cm-completionIcon-class":{"&:after":{content:"'â—‹'"}},".cm-completionIcon-interface":{"&:after":{content:"'â—Œ'"}},".cm-completionIcon-variable":{"&:after":{content:"'ð‘¥'"}},".cm-completionIcon-constant":{"&:after":{content:"'ð¶'"}},".cm-completionIcon-type":{"&:after":{content:"'ð‘¡'"}},".cm-completionIcon-enum":{"&:after":{content:"'âˆª'"}},".cm-completionIcon-property":{"&:after":{content:"'â–¡'"}},".cm-completionIcon-keyword":{"&:after":{content:"'ðŸ”‘ï¸Ž'"}},".cm-completionIcon-namespace":{"&:after":{content:"'â–¢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),dr={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Rn=ne.define({map(n,e){let t=e.mapPos(n,-1,Ge.TrackAfter);return t??void 0}}),ec=new class extends Pn{};ec.startSide=1;ec.endSide=-1;const hm=Fe.define({create(){return ce.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:i=>i>=t.from&&i<=t.to})}for(let t of e.effects)t.is(Rn)&&(n=n.update({add:[ec.range(t.value,t.value+1)]}));return n}});function Qk(){return[eC,hm]}const _o="()[]{}<>Â«Â»Â»Â«ï¼»ï¼½ï½›ï½";function um(n){for(let e=0;e<_o.length;e+=2)if(_o.charCodeAt(e)==n)return _o.charAt(e+1);return ya(n<128?n:n+1)}function fm(n,e){return n.languageDataAt("closeBrackets",e)[0]||dr}const Zk=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),eC=B.inputHandler.of((n,e,t,i)=>{if((Zk?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let r=n.state.selection.main;if(i.length>2||i.length==2&&Et(Xe(i,0))==1||e!=r.from||t!=r.to)return!1;let s=iC(n.state,i);return s?(n.dispatch(s),!0):!1}),tC=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let i=fm(n,n.selection.main.head).brackets||dr.brackets,r=null,s=n.changeByRange(o=>{if(o.empty){let l=rC(n.doc,o.head);for(let a of i)if(a==l&&oo(n.doc,o.head)==um(Xe(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:T.cursor(o.head-a.length)}}return{range:r=o}});return r||e(n.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!r},nC=[{key:"Backspace",run:tC}];function iC(n,e){let t=fm(n,n.selection.main.head),i=t.brackets||dr.brackets;for(let r of i){let s=um(Xe(r,0));if(e==r)return s==r?lC(n,r,i.indexOf(r+r+r)>-1,t):sC(n,r,s,t.before||dr.before);if(e==s&&dm(n,n.selection.main.from))return oC(n,r,s)}return null}function dm(n,e){let t=!1;return n.field(hm).between(0,n.doc.length,i=>{i==e&&(t=!0)}),t}function oo(n,e){let t=n.sliceString(e,e+2);return t.slice(0,Et(Xe(t,0)))}function rC(n,e){let t=n.sliceString(e-2,e);return Et(Xe(t,0))==t.length?t:t.slice(1)}function sC(n,e,t,i){let r=null,s=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:Rn.of(o.to+e.length),range:T.range(o.anchor+e.length,o.head+e.length)};let l=oo(n.doc,o.head);return!l||/\s/.test(l)||i.indexOf(l)>-1?{changes:{insert:e+t,from:o.head},effects:Rn.of(o.head+e.length),range:T.cursor(o.head+e.length)}:{range:r=o}});return r?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function oC(n,e,t){let i=null,r=n.changeByRange(s=>s.empty&&oo(n.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:T.cursor(s.head+t.length)}:i={range:s});return i?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function lC(n,e,t,i){let r=i.stringPrefixes||dr.stringPrefixes,s=null,o=n.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:Rn.of(l.to+e.length),range:T.range(l.anchor+e.length,l.head+e.length)};let a=l.head,c=oo(n.doc,a),h;if(c==e){if(lu(n,a))return{changes:{insert:e+e,from:a},effects:Rn.of(a+e.length),range:T.cursor(a+e.length)};if(dm(n,a)){let f=t&&n.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+f.length,insert:f},range:T.cursor(a+f.length)}}}else{if(t&&n.sliceDoc(a-2*e.length,a)==e+e&&(h=au(n,a-2*e.length,r))>-1&&lu(n,h))return{changes:{insert:e+e+e+e,from:a},effects:Rn.of(a+e.length),range:T.cursor(a+e.length)};if(n.charCategorizer(a)(c)!=ke.Word&&au(n,a,r)>-1&&!aC(n,a,e,r))return{changes:{insert:e+e,from:a},effects:Rn.of(a+e.length),range:T.cursor(a+e.length)}}return{range:s=l}});return s?null:n.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function lu(n,e){let t=qe(n).resolveInner(e+1);return t.parent&&t.from==e}function aC(n,e,t,i){let r=qe(n).resolveInner(e,-1),s=i.reduce((o,l)=>Math.max(o,l.length),0);for(let o=0;o<5;o++){let l=n.sliceDoc(r.from,Math.min(r.to,r.from+t.length+s)),a=l.indexOf(t);if(!a||a>-1&&i.indexOf(l.slice(0,a))>-1){let h=r.firstChild;for(;h&&h.from==r.from&&h.to-h.from>t.length+a;){if(n.sliceDoc(h.to-t.length,h.to)==t)return!1;h=h.firstChild}return!0}let c=r.to==e&&r.parent;if(!c)break;r=c}return!1}function au(n,e,t){let i=n.charCategorizer(e);if(i(n.sliceDoc(e-1,e))!=ke.Word)return e;for(let r of t){let s=e-r.length;if(n.sliceDoc(s,e)==r&&i(n.sliceDoc(s-1,s))!=ke.Word)return s}return-1}function pm(n={}){return[Yk,Ze,Pe.of(n),Kk,cC,Xk]}const mm=[{key:"Ctrl-Space",run:ou},{mac:"Alt-`",run:ou},{key:"Escape",run:Vk},{key:"ArrowDown",run:Qr(!0)},{key:"ArrowUp",run:Qr(!1)},{key:"PageDown",run:Qr(!0,"page")},{key:"PageUp",run:Qr(!1,"page")},{key:"Enter",run:_k}],cC=bn.highest(Cr.computeN([Pe],n=>n.facet(Pe).defaultKeymap?[mm]:[]));class cu{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class Mn{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let r=i.facet(pr).markerFilter;r&&(e=r(e,i));let s=e.slice().sort((h,u)=>h.from-u.from||h.to-u.to),o=new Kt,l=[],a=0;for(let h=0;;){let u=h==s.length?null:s[h];if(!u&&!l.length)break;let f,d;for(l.length?(f=a,d=l.reduce((m,b)=>Math.min(m,b.to),u&&u.from>f?u.from:1e8)):(f=u.from,d=u.to,l.push(u),h++);h<s.length;){let m=s[h];if(m.from==f&&(m.to>m.from||m.to==f))l.push(m),h++,d=Math.min(m.to,d);else{d=Math.min(m.from,d);break}}let p=SC(l);if(l.some(m=>m.from==m.to||m.from==m.to-1&&i.doc.lineAt(m.from).to==m.from))o.add(f,f,Y.widget({widget:new xC(p),diagnostics:l.slice()}));else{let m=l.reduce((b,x)=>x.markClass?b+" "+x.markClass:b,"");o.add(f,d,Y.mark({class:"cm-lintRange cm-lintRange-"+p+m,diagnostics:l.slice(),inclusiveEnd:l.some(b=>b.to>d)}))}a=d;for(let m=0;m<l.length;m++)l[m].to<=a&&l.splice(m--,1)}let c=o.finish();return new Mn(c,t,yi(c))}}function yi(n,e=null,t=0){let i=null;return n.between(t,1e9,(r,s,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!i)i=new cu(r,s,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(i.diagnostic)<0)return!1;i=new cu(i.from,s,i.diagnostic)}}),i}function hC(n,e){let t=e.pos,i=e.end||t,r=n.state.facet(pr).hideOn(n,t,i);if(r!=null)return r;let s=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(o=>o.is(gm))||n.changes.touchesRange(s.from,Math.max(s.to,i)))}function uC(n,e){return n.field(ot,!1)?e:e.concat(ne.appendConfig.of(kC))}const gm=ne.define(),tc=ne.define(),bm=ne.define(),ot=Fe.define({create(){return new Mn(Y.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),i=null,r=n.panel;if(n.selected){let s=e.changes.mapPos(n.selected.from,1);i=yi(t,n.selected.diagnostic,s)||yi(t,null,s)}!t.size&&r&&e.state.facet(pr).autoPanel&&(r=null),n=new Mn(t,r,i)}for(let t of e.effects)if(t.is(gm)){let i=e.state.facet(pr).autoPanel?t.value.length?mr.open:null:n.panel;n=Mn.init(t.value,i,e.state)}else t.is(tc)?n=new Mn(n.diagnostics,t.value?mr.open:null,n.selected):t.is(bm)&&(n=new Mn(n.diagnostics,n.panel,t.value));return n},provide:n=>[lr.from(n,e=>e.panel),B.decorations.from(n,e=>e.diagnostics)]}),fC=Y.mark({class:"cm-lintRange cm-lintRange-active"});function dC(n,e,t){let{diagnostics:i}=n.state.field(ot),r,s=-1,o=-1;i.between(e-(t<0?1:0),e+(t>0?1:0),(a,c,{spec:h})=>{if(e>=a&&e<=c&&(a==c||(e>a||t>0)&&(e<c||t<0)))return r=h.diagnostics,s=a,o=c,!1});let l=n.state.facet(pr).tooltipFilter;return r&&l&&(r=l(r,n.state)),r?{pos:s,end:o,above:n.state.doc.lineAt(s).to<o,create(){return{dom:pC(n,r)}}}:null}function pC(n,e){return be("ul",{class:"cm-tooltip-lint"},e.map(t=>ym(n,t,!1)))}const mC=n=>{let e=n.state.field(ot,!1);(!e||!e.panel)&&n.dispatch({effects:uC(n.state,[tc.of(!0)])});let t=or(n,mr.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},hu=n=>{let e=n.state.field(ot,!1);return!e||!e.panel?!1:(n.dispatch({effects:tc.of(!1)}),!0)},gC=n=>{let e=n.state.field(ot,!1);if(!e)return!1;let t=n.state.selection.main,i=e.diagnostics.iter(t.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==t.from&&i.to==t.to)?!1:(n.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},bC=[{key:"Mod-Shift-m",run:mC,preventDefault:!0},{key:"F8",run:gC}],pr=j.define({combine(n){return Object.assign({sources:n.map(e=>e.source).filter(e=>e!=null)},zt(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?i=>e(i)||t(i):e:t}))}});function xm(n){let e=[];if(n)e:for(let{name:t}of n){for(let i=0;i<t.length;i++){let r=t[i];if(/[a-zA-Z]/.test(r)&&!e.some(s=>s.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function ym(n,e,t){var i;let r=t?xm(e.actions):[];return be("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},be("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,o)=>{let l=!1,a=f=>{if(f.preventDefault(),l)return;l=!0;let d=yi(n.state.field(ot).diagnostics,e);d&&s.apply(n,d.from,d.to)},{name:c}=s,h=r[o]?c.indexOf(r[o]):-1,u=h<0?c:[c.slice(0,h),be("u",c.slice(h,h+1)),c.slice(h+1)];return be("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${c}${h<0?"":` (access key "${r[o]})"`}.`},u)}),e.source&&be("div",{class:"cm-diagnosticSource"},e.source))}class xC extends Qt{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return be("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class uu{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=ym(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class mr{constructor(e){this.view=e,this.items=[];let t=r=>{if(r.keyCode==27)hu(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=xm(s.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==r.keyCode){let a=yi(this.view.state.field(ot).diagnostics,s);a&&s.actions[l].apply(e,a.from,a.to)}}else return;r.preventDefault()},i=r=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(r.target)&&this.moveSelection(s)};this.list=be("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i}),this.dom=be("div",{class:"cm-panel-lint"},this.list,be("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>hu(this.view)},"Ã—")),this.update()}get selectedIndex(){let e=this.view.state.field(ot).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(ot),i=0,r=!1,s=null,o=new Set;for(e.between(0,this.view.state.doc.length,(l,a,{spec:c})=>{for(let h of c.diagnostics){if(o.has(h))continue;o.add(h);let u=-1,f;for(let d=i;d<this.items.length;d++)if(this.items[d].diagnostic==h){u=d;break}u<0?(f=new uu(this.view,h),this.items.splice(i,0,f),r=!0):(f=this.items[u],u>i&&(this.items.splice(i,u-i),r=!0)),t&&f.diagnostic==t.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),s=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new uu(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:l,panel:a})=>{let c=a.height/this.list.offsetHeight;l.top<a.top?this.list.scrollTop-=(a.top-l.top)/c:l.bottom>a.bottom&&(this.list.scrollTop+=(l.bottom-a.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(ot),i=yi(t.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:bm.of(i)})}static open(e){return new mr(e)}}function yC(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function Zr(n){return yC(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const vC=B.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Zr("#d11")},".cm-lintRange-warning":{backgroundImage:Zr("orange")},".cm-lintRange-info":{backgroundImage:Zr("#999")},".cm-lintRange-hint":{backgroundImage:Zr("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function wC(n){return n=="error"?4:n=="warning"?3:n=="info"?2:1}function SC(n){let e="hint",t=1;for(let i of n){let r=wC(i.severity);r>t&&(t=r,e=i.severity)}return e}const kC=[ot,B.decorations.compute([ot],n=>{let{selected:e,panel:t}=n.field(ot);return!e||!t||e.from==e.to?Y.none:Y.set([fC.range(e.from,e.to)])}),dw(dC,{hideOn:hC}),vC];var fu=function(e){e===void 0&&(e={});var{crosshairCursor:t=!1}=e,i=[];e.closeBracketsKeymap!==!1&&(i=i.concat(nC)),e.defaultKeymap!==!1&&(i=i.concat(JS)),e.searchKeymap!==!1&&(i=i.concat(wk)),e.historyKeymap!==!1&&(i=i.concat(rS)),e.foldKeymap!==!1&&(i=i.concat(p1)),e.completionKeymap!==!1&&(i=i.concat(mm)),e.lintKeymap!==!1&&(i=i.concat(bC));var r=[];return e.lineNumbers!==!1&&r.push(Cw()),e.highlightActiveLineGutter!==!1&&r.push(Ew()),e.highlightSpecialChars!==!1&&r.push($v()),e.history!==!1&&r.push(J1()),e.foldGutter!==!1&&r.push(x1()),e.drawSelection!==!1&&r.push(Nv()),e.dropCursor!==!1&&r.push(Bv()),e.allowMultipleSelections!==!1&&r.push(ae.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&r.push(r1()),e.syntaxHighlighting!==!1&&r.push(Wa(S1,{fallback:!0})),e.bracketMatching!==!1&&r.push(R1()),e.closeBrackets!==!1&&r.push(Qk()),e.autocompletion!==!1&&r.push(pm()),e.rectangularSelection!==!1&&r.push(nw()),t!==!1&&r.push(sw()),e.highlightActiveLine!==!1&&r.push(Kv()),e.highlightSelectionMatches!==!1&&r.push(nk()),e.tabSize&&typeof e.tabSize=="number"&&r.push(Zs.of(" ".repeat(e.tabSize))),r.concat([Cr.of(i.flat())]).filter(Boolean)};const CC="#e5c07b",du="#e06c75",AC="#56b6c2",MC="#ffffff",ms="#abb2bf",Ql="#7d8799",EC="#61afef",TC="#98c379",pu="#d19a66",RC="#c678dd",DC="#21252b",mu="#2c313a",gu="#282c34",Vo="#353a42",NC="#3E4451",bu="#528bff",OC=B.theme({"&":{color:ms,backgroundColor:gu},".cm-content":{caretColor:bu},".cm-cursor, .cm-dropCursor":{borderLeftColor:bu},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:NC},".cm-panels":{backgroundColor:DC,color:ms},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:gu,color:Ql,border:"none"},".cm-activeLineGutter":{backgroundColor:mu},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Vo},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Vo,borderBottomColor:Vo},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:mu,color:ms}}},{dark:!0}),LC=Ci.define([{tag:k.keyword,color:RC},{tag:[k.name,k.deleted,k.character,k.propertyName,k.macroName],color:du},{tag:[k.function(k.variableName),k.labelName],color:EC},{tag:[k.color,k.constant(k.name),k.standard(k.name)],color:pu},{tag:[k.definition(k.name),k.separator],color:ms},{tag:[k.typeName,k.className,k.number,k.changed,k.annotation,k.modifier,k.self,k.namespace],color:CC},{tag:[k.operator,k.operatorKeyword,k.url,k.escape,k.regexp,k.link,k.special(k.string)],color:AC},{tag:[k.meta,k.comment],color:Ql},{tag:k.strong,fontWeight:"bold"},{tag:k.emphasis,fontStyle:"italic"},{tag:k.strikethrough,textDecoration:"line-through"},{tag:k.link,color:Ql,textDecoration:"underline"},{tag:k.heading,fontWeight:"bold",color:du},{tag:[k.atom,k.bool,k.special(k.variableName)],color:pu},{tag:[k.processingInstruction,k.string,k.inserted],color:TC},{tag:k.invalid,color:MC}]),PC=[OC,Wa(LC)];var IC=B.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),BC=function(e){e===void 0&&(e={});var{indentWithTab:t=!0,editable:i=!0,readOnly:r=!1,theme:s="light",placeholder:o="",basicSetup:l=!0}=e,a=[];switch(t&&a.unshift(Cr.of([YS])),l&&(typeof l=="boolean"?a.unshift(fu()):a.unshift(fu(l))),o&&a.unshift(Qv(o)),s){case"light":a.push(IC);break;case"dark":a.push(PC);break;case"none":break;default:a.push(s);break}return i===!1&&a.push(B.editable.of(!1)),r&&a.push(ae.readOnly.of(!0)),[...a]},zC=n=>({line:n.state.doc.lineAt(n.state.selection.main.from),lineCount:n.state.doc.lines,lineBreak:n.state.lineBreak,length:n.state.doc.length,readOnly:n.state.readOnly,tabSize:n.state.tabSize,selection:n.state.selection,selectionAsSingle:n.state.selection.asSingle().main,ranges:n.state.selection.ranges,selectionCode:n.state.sliceDoc(n.state.selection.main.from,n.state.selection.main.to),selections:n.state.selection.ranges.map(e=>n.state.sliceDoc(e.from,e.to)),selectedText:n.state.selection.ranges.some(e=>!e.empty)}),xu=Bt.define(),jC=[];function HC(n){var{value:e,selection:t,onChange:i,onStatistics:r,onCreateEditor:s,onUpdate:o,extensions:l=jC,autoFocus:a,theme:c="light",height:h=null,minHeight:u=null,maxHeight:f=null,width:d=null,minWidth:p=null,maxWidth:m=null,placeholder:b="",editable:x=!0,readOnly:v=!1,indentWithTab:w=!0,basicSetup:C=!0,root:S,initialState:M}=n,[A,O]=y.useState(),[N,W]=y.useState(),[z,R]=y.useState(),Q=B.theme({"&":{height:h,minHeight:u,maxHeight:f,width:d,minWidth:p,maxWidth:m},"& .cm-scroller":{height:"100% !important"}}),$=B.updateListener.of(D=>{if(D.docChanged&&typeof i=="function"&&!D.transactions.some(te=>te.annotation(xu))){var _=D.state.doc,V=_.toString();i(V,D)}r&&r(zC(D))}),J=BC({theme:c,editable:x,readOnly:v,placeholder:b,indentWithTab:w,basicSetup:C}),E=[$,Q,...J];return o&&typeof o=="function"&&E.push(B.updateListener.of(o)),E=E.concat(l),y.useLayoutEffect(()=>{if(A&&!z){var D={doc:e,selection:t,extensions:E},_=M?ae.fromJSON(M.json,D,M.fields):ae.create(D);if(R(_),!N){var V=new B({state:_,parent:A,root:S});W(V),s&&s(V,_)}}return()=>{N&&(R(void 0),W(void 0))}},[A,z]),y.useEffect(()=>{n.container&&O(n.container)},[n.container]),y.useEffect(()=>()=>{N&&(N.destroy(),W(void 0))},[N]),y.useEffect(()=>{a&&N&&N.focus()},[a,N]),y.useEffect(()=>{N&&N.dispatch({effects:ne.reconfigure.of(E)})},[c,l,h,u,f,d,p,m,b,x,v,w,C,i,o]),y.useEffect(()=>{if(e!==void 0){var D=N?N.state.doc.toString():"";N&&e!==D&&N.dispatch({changes:{from:0,to:D.length,insert:e||""},annotations:[xu.of(!0)]})}},[e,N]),{state:z,setState:R,view:N,setView:W,container:A,setContainer:O}}var FC=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],vm=y.forwardRef((n,e)=>{var{className:t,value:i="",selection:r,extensions:s=[],onChange:o,onStatistics:l,onCreateEditor:a,onUpdate:c,autoFocus:h,theme:u="light",height:f,minHeight:d,maxHeight:p,width:m,minWidth:b,maxWidth:x,basicSetup:v,placeholder:w,indentWithTab:C,editable:S,readOnly:M,root:A,initialState:O}=n,N=Mx(n,FC),W=y.useRef(null),{state:z,view:R,container:Q,setContainer:$}=HC({root:A,value:i,autoFocus:h,theme:u,height:f,minHeight:d,maxHeight:p,width:m,minWidth:b,maxWidth:x,basicSetup:v,placeholder:w,indentWithTab:C,editable:S,readOnly:M,selection:r,onChange:o,onStatistics:l,onCreateEditor:a,onUpdate:c,extensions:s,initialState:O});y.useImperativeHandle(e,()=>({editor:W.current,state:z,view:R}),[W,Q,z,R]);var J=y.useCallback(D=>{W.current=D,$(D)},[$]);if(typeof i!="string")throw new Error("value must be typeof string but got "+typeof i);var E=typeof u=="string"?"cm-theme-"+u:"cm-theme";return g.jsx("div",nl({ref:J,className:""+E+(t?" "+t:"")},N))});vm.displayName="CodeMirror";var WC="builtin",Sn="comment",yu="string",vu="symbol",zi="atom",wu="number",Su="bracket",$C=2;function wm(n){for(var e={},t=n.split(" "),i=0;i<t.length;++i)e[t[i]]=!0;return e}var ku=wm("Î» case-lambda call/cc class cond-expand define-class define-values exit-handler field import inherit init-field interface let*-values let-values let/ec mixin opt-lambda override protect provide public rename require require-for-syntax syntax syntax-case syntax-error unit/sig unless when with-syntax and begin call-with-current-continuation call-with-input-file call-with-output-file case cond define define-syntax define-macro defmacro delay do dynamic-wind else for-each if lambda let let* let-syntax letrec letrec-syntax map or syntax-rules abs acos angle append apply asin assoc assq assv atan boolean? caar cadr call-with-input-file call-with-output-file call-with-values car cdddar cddddr cdr ceiling char->integer char-alphabetic? char-ci<=? char-ci<? char-ci=? char-ci>=? char-ci>? char-downcase char-lower-case? char-numeric? char-ready? char-upcase char-upper-case? char-whitespace? char<=? char<? char=? char>=? char>? char? close-input-port close-output-port complex? cons cos current-input-port current-output-port denominator display eof-object? eq? equal? eqv? eval even? exact->inexact exact? exp expt #f floor force gcd imag-part inexact->exact inexact? input-port? integer->char integer? interaction-environment lcm length list list->string list->vector list-ref list-tail list? load log magnitude make-polar make-rectangular make-string make-vector max member memq memv min modulo negative? newline not null-environment null? number->string number? numerator odd? open-input-file open-output-file output-port? pair? peek-char port? positive? procedure? quasiquote quote quotient rational? rationalize read read-char real-part real? remainder reverse round scheme-report-environment set! set-car! set-cdr! sin sqrt string string->list string->number string->symbol string-append string-ci<=? string-ci<? string-ci=? string-ci>=? string-ci>? string-copy string-fill! string-length string-ref string-set! string<=? string<? string=? string>=? string>? string? substring symbol->string symbol? #t tan transcript-off transcript-on truncate values vector vector->list vector-fill! vector-length vector-ref vector-set! with-input-from-file with-output-to-file write write-char zero?"),_C=wm("define let letrec let* lambda define-macro defmacro let-syntax letrec-syntax let-values let*-values define-syntax syntax-rules define-values when unless");function VC(n,e,t){this.indent=n,this.type=e,this.prev=t}function qo(n,e,t){n.indentStack=new VC(e,t,n.indentStack)}function qC(n){n.indentStack=n.indentStack.prev}var UC=new RegExp(/^(?:[-+]i|[-+][01]+#*(?:\/[01]+#*)?i|[-+]?[01]+#*(?:\/[01]+#*)?@[-+]?[01]+#*(?:\/[01]+#*)?|[-+]?[01]+#*(?:\/[01]+#*)?[-+](?:[01]+#*(?:\/[01]+#*)?)?i|[-+]?[01]+#*(?:\/[01]+#*)?)(?=[()\s;"]|$)/i),GC=new RegExp(/^(?:[-+]i|[-+][0-7]+#*(?:\/[0-7]+#*)?i|[-+]?[0-7]+#*(?:\/[0-7]+#*)?@[-+]?[0-7]+#*(?:\/[0-7]+#*)?|[-+]?[0-7]+#*(?:\/[0-7]+#*)?[-+](?:[0-7]+#*(?:\/[0-7]+#*)?)?i|[-+]?[0-7]+#*(?:\/[0-7]+#*)?)(?=[()\s;"]|$)/i),KC=new RegExp(/^(?:[-+]i|[-+][\da-f]+#*(?:\/[\da-f]+#*)?i|[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?@[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?|[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?[-+](?:[\da-f]+#*(?:\/[\da-f]+#*)?)?i|[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?)(?=[()\s;"]|$)/i),JC=new RegExp(/^(?:[-+]i|[-+](?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)i|[-+]?(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)@[-+]?(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)|[-+]?(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)[-+](?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)?i|(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*))(?=[()\s;"]|$)/i);function YC(n){return n.match(UC)}function XC(n){return n.match(GC)}function Uo(n,e){return e===!0&&n.backUp(1),n.match(JC)}function QC(n){return n.match(KC)}function Cu(n,e){for(var t,i=!1;(t=n.next())!=null;){if(t==e.token&&!i){e.state.mode=!1;break}i=!i&&t=="\\"}}const ZC={name:"scheme",startState:function(){return{indentStack:null,indentation:0,mode:!1,sExprComment:!1,sExprQuote:!1}},token:function(n,e){if(e.indentStack==null&&n.sol()&&(e.indentation=n.indentation()),n.eatSpace())return null;var t=null;switch(e.mode){case"string":Cu(n,{token:'"',state:e}),t=yu;break;case"symbol":Cu(n,{token:"|",state:e}),t=vu;break;case"comment":for(var i,r=!1;(i=n.next())!=null;){if(i=="#"&&r){e.mode=!1;break}r=i=="|"}t=Sn;break;case"s-expr-comment":if(e.mode=!1,n.peek()=="("||n.peek()=="[")e.sExprComment=0;else{n.eatWhile(/[^\s\(\)\[\]]/),t=Sn;break}default:var s=n.next();if(s=='"')e.mode="string",t=yu;else if(s=="'")n.peek()=="("||n.peek()=="["?(typeof e.sExprQuote!="number"&&(e.sExprQuote=0),t=zi):(n.eatWhile(/[\w_\-!$%&*+\.\/:<=>?@\^~]/),t=zi);else if(s=="|")e.mode="symbol",t=vu;else if(s=="#")if(n.eat("|"))e.mode="comment",t=Sn;else if(n.eat(/[tf]/i))t=zi;else if(n.eat(";"))e.mode="s-expr-comment",t=Sn;else{var o=null,l=!1,a=!0;n.eat(/[ei]/i)?l=!0:n.backUp(1),n.match(/^#b/i)?o=YC:n.match(/^#o/i)?o=XC:n.match(/^#x/i)?o=QC:n.match(/^#d/i)?o=Uo:n.match(/^[-+0-9.]/,!1)?(a=!1,o=Uo):l||n.eat("#"),o!=null&&(a&&!l&&n.match(/^#[ei]/i),o(n)&&(t=wu))}else if(/^[-+0-9.]/.test(s)&&Uo(n,!0))t=wu;else if(s==";")n.skipToEnd(),t=Sn;else if(s=="("||s=="["){for(var c="",h=n.column(),u;(u=n.eat(/[^\s\(\[\;\)\]]/))!=null;)c+=u;c.length>0&&_C.propertyIsEnumerable(c)?qo(e,h+$C,s):(n.eatSpace(),n.eol()||n.peek()==";"?qo(e,h+1,s):qo(e,h+n.current().length,s)),n.backUp(n.current().length-1),typeof e.sExprComment=="number"&&e.sExprComment++,typeof e.sExprQuote=="number"&&e.sExprQuote++,t=Su}else s==")"||s=="]"?(t=Su,e.indentStack!=null&&e.indentStack.type==(s==")"?"(":"[")&&(qC(e),typeof e.sExprComment=="number"&&--e.sExprComment==0&&(t=Sn,e.sExprComment=!1),typeof e.sExprQuote=="number"&&--e.sExprQuote==0&&(t=zi,e.sExprQuote=!1))):(n.eatWhile(/[\w_\-!$%&*+\.\/:<=>?@\^~]/),ku&&ku.propertyIsEnumerable(n.current())?t=WC:t="variable")}return typeof e.sExprComment=="number"?Sn:typeof e.sExprQuote=="number"?zi:t},indent:function(n){return n.indentStack==null?n.indentation:n.indentStack.indent},languageData:{closeBrackets:{brackets:["(","[","{",'"']},commentTokens:{line:";;"}}},Z={dark:!0,background:"#24292e",foreground:"#d1d5da",selection:"#3392FF44",cursor:"#c8e1ff",dropdownBackground:"#24292e",dropdownBorder:"#1b1f23",activeLine:"#4d566022",lineNumber:"#444d56",lineNumberActive:"#e1e4e8",matchingBracket:"#17E5E650",keyword:"#f97583",variable:"#ffab70",function:"#79b8ff",string:"#9ecbff",constant:"#79b8ff",type:"#79b8ff",class:"#b392f0",number:"#79b8ff",comment:"#6a737d",heading:"#79b8ff",invalid:"#f97583",regexp:"#9ecbff"},eA=B.theme({"&":{color:Z.foreground,backgroundColor:Z.background},".cm-content":{caretColor:Z.cursor},".cm-cursor, .cm-dropCursor":{borderLeftColor:Z.cursor},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Z.selection},".cm-panels":{backgroundColor:Z.dropdownBackground,color:Z.foreground},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:Z.dropdownBackground,outline:`1px solid ${Z.dropdownBorder}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:Z.selection},".cm-activeLine":{backgroundColor:Z.activeLine},".cm-selectionMatch":{backgroundColor:Z.selection},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:Z.matchingBracket,outline:"none"},".cm-gutters":{backgroundColor:Z.background,color:Z.foreground,border:"none"},".cm-activeLineGutter":{backgroundColor:Z.background},".cm-lineNumbers .cm-gutterElement":{color:Z.lineNumber},".cm-lineNumbers .cm-activeLineGutter":{color:Z.lineNumberActive},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:Z.foreground},".cm-tooltip":{border:`1px solid ${Z.dropdownBorder}`,backgroundColor:Z.dropdownBackground,color:Z.foreground},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Z.foreground,borderBottomColor:Z.foreground},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{background:Z.selection,color:Z.foreground}}},{dark:Z.dark}),tA=Ci.define([{tag:k.keyword,color:Z.keyword},{tag:[k.name,k.deleted,k.character,k.macroName],color:Z.variable},{tag:[k.propertyName],color:Z.function},{tag:[k.processingInstruction,k.string,k.inserted,k.special(k.string)],color:Z.string},{tag:[k.function(k.variableName),k.labelName],color:Z.function},{tag:[k.color,k.constant(k.name),k.standard(k.name)],color:Z.constant},{tag:[k.definition(k.name),k.separator],color:Z.variable},{tag:[k.className],color:Z.class},{tag:[k.number,k.changed,k.annotation,k.modifier,k.self,k.namespace],color:Z.number},{tag:[k.typeName],color:Z.type,fontStyle:Z.type},{tag:[k.operator,k.operatorKeyword],color:Z.keyword},{tag:[k.url,k.escape,k.regexp,k.link],color:Z.regexp},{tag:[k.meta,k.comment],color:Z.comment},{tag:k.strong,fontWeight:"bold"},{tag:k.emphasis,fontStyle:"italic"},{tag:k.link,textDecoration:"underline"},{tag:k.heading,fontWeight:"bold",color:Z.heading},{tag:[k.atom,k.bool,k.special(k.variableName)],color:Z.variable},{tag:k.invalid,color:Z.invalid},{tag:k.strikethrough,textDecoration:"line-through"}]),nA=[eA,Wa(tA)],iA=[{label:"define",type:"keyword",info:"Define a variable or function"},{label:"define-syntax",type:"keyword",info:"Define a macro"},{label:"syntax-rules",type:"keyword",info:"Define macro transformation rules"},{label:"lambda",type:"keyword",info:"Create an anonymous function"},{label:"let",type:"keyword",info:"Create local bindings"},{label:"let*",type:"keyword",info:"Create sequential local bindings"},{label:"letrec",type:"keyword",info:"Create recursive local bindings"},{label:"let-values",type:"keyword",info:"Bind multiple values"},{label:"if",type:"keyword",info:"Conditional expression"},{label:"cond",type:"keyword",info:"Multiple conditional expression"},{label:"case",type:"keyword",info:"Pattern matching on values"},{label:"begin",type:"keyword",info:"Sequence of expressions"},{label:"quote",type:"keyword",info:"Quote an expression"},{label:"when",type:"keyword",info:"Conditional with multiple expressions"},{label:"unless",type:"keyword",info:"Negative conditional"},{label:"import",type:"keyword",info:"Import bindings from a module"},{label:"base",type:"keyword",info:"Base library module"},{label:"list",type:"keyword",info:"List operations module"},{label:"register-function",type:"function",info:"Register an external function"},{label:"load-library",type:"function",info:"Load an external library"},{label:"eq?",type:"function",info:"Test object identity"},{label:"eqv?",type:"function",info:"Test object equivalence"},{label:"equal?",type:"function",info:"Deep equality comparison"},{label:"list",type:"function",info:"Create a new list"},{label:"car",type:"function",info:"Get the first element of a list"},{label:"cdr",type:"function",info:"Get the rest of the list"},{label:"cons",type:"function",info:"Construct a new list"},{label:"append",type:"function",info:"Join lists together"},{label:"reverse",type:"function",info:"Reverse a list"},{label:"length",type:"function",info:"Get length of a list"},{label:"list-ref",type:"function",info:"Get element at index"},{label:"list-tail",type:"function",info:"Get sublist starting at index"},{label:"list-set!",type:"function",info:"Set element at index"},{label:"map",type:"function",info:"Apply function to list elements"},{label:"cadr",type:"function",info:"Second element"},{label:"cddr",type:"function",info:"Rest after second element"},{label:"caddr",type:"function",info:"Third element"},{label:"cdddr",type:"function",info:"Rest after third element"},{label:"cadddr",type:"function",info:"Fourth element"},{label:"+",type:"function",info:"Addition"},{label:"-",type:"function",info:"Subtraction"},{label:"*",type:"function",info:"Multiplication"},{label:"/",type:"function",info:"Division"},{label:"=",type:"function",info:"Numeric equality"},{label:"<",type:"function",info:"Less than"},{label:">",type:"function",info:"Greater than"},{label:"<=",type:"function",info:"Less than or equal"},{label:">=",type:"function",info:"Greater than or equal"},{label:"zero?",type:"function",info:"Test if number is zero"},{label:"number?",type:"function",info:"Check if value is a number"},{label:"string?",type:"function",info:"Check if value is a string"},{label:"symbol?",type:"function",info:"Check if value is a symbol"},{label:"list?",type:"function",info:"Check if value is a list"},{label:"pair?",type:"function",info:"Check if value is a pair"},{label:"null?",type:"function",info:"Check if list is empty"},{label:"procedure?",type:"function",info:"Check if value is a procedure"},{label:"boolean?",type:"function",info:"Check if value is a boolean"},{label:"port?",type:"function",info:"Check if value is a port"},{label:"string-append",type:"function",info:"Join strings together"},{label:"string-length",type:"function",info:"Get length of string"},{label:"string=?",type:"function",info:"Compare strings for equality"},{label:"string<?",type:"function",info:"String less than"},{label:"string>?",type:"function",info:"String greater than"},{label:"string-ci=?",type:"function",info:"Case-insensitive string equality"},{label:"substring",type:"function",info:"Get part of string"},{label:"string-ref",type:"function",info:"Get character at index"},{label:"string->list",type:"function",info:"Convert string to list"},{label:"list->string",type:"function",info:"Convert list to string"},{label:"string-copy",type:"function",info:"Copy string"},{label:"string-upcase",type:"function",info:"Convert to uppercase"},{label:"string-downcase",type:"function",info:"Convert to lowercase"},{label:"make-vector",type:"function",info:"Create vector of given size"},{label:"vector",type:"function",info:"Create vector from elements"},{label:"vector-ref",type:"function",info:"Get vector element"},{label:"vector-set!",type:"function",info:"Set vector element"},{label:"vector-length",type:"function",info:"Get vector length"},{label:"vector-copy",type:"function",info:"Copy vector"},{label:"vector-copy!",type:"function",info:"Copy into vector"},{label:"vector-fill!",type:"function",info:"Fill vector with value"},{label:"display",type:"function",info:"Print a value"},{label:"newline",type:"function",info:"Print a newline"},{label:"read",type:"function",info:"Read an S-expression"},{label:"write",type:"function",info:"Write an S-expression"},{label:"open-input-file",type:"function",info:"Open file for reading"},{label:"open-output-file",type:"function",info:"Open file for writing"},{label:"close-port",type:"function",info:"Close a port"},{label:"load-library",type:"function",info:"Load external library"},{label:"error",type:"function",info:"Signal an error"},{label:"eval",type:"function",info:"Evaluate expression"},{label:"apply",type:"function",info:"Apply function to arguments"},{label:"call/cc",type:"function",info:"Call with current continuation"},{label:"values",type:"function",info:"Return multiple values"},{label:"and",type:"keyword",info:"Logical AND"},{label:"or",type:"keyword",info:"Logical OR"},{label:"not",type:"function",info:"Logical NOT"},{label:"while",type:"keyword",info:"While loop"},{label:"for",type:"keyword",info:"For loop"},{label:"repeat",type:"keyword",info:"Repeat n times"},{label:"until",type:"keyword",info:"Until loop"},{label:"do-while",type:"keyword",info:"Do-while loop"},{label:"for-each-with-index",type:"keyword",info:"Iterate with index"},{label:"for-range",type:"keyword",info:"Range-based loop"},{label:"iterate",type:"keyword",info:"Iterate with step"},{label:"nested-loop",type:"keyword",info:"Nested loop construct"}];function rA(n){let e=n.matchBefore(/[\w\-+*/<>=?!]+/);return e?{from:e.from,options:iA,validFor:/^[\w\-+*/<>=?!]*$/}:null}const nc=({value:n,onChange:e,height:t="200px",fullEditor:i=!1,minHeight:r="24px",maxHeight:s="150px",onRun:o})=>{const l=Cr.of([{key:"Shift-Enter",run:()=>(o==null||o(),!0)}]);return g.jsx(vm,{value:n,height:t,minHeight:i?void 0:r,maxHeight:i?void 0:s,theme:nA,extensions:[$a.define(ZC),bn.highest(l),pm({override:[rA],defaultKeymap:!0})],onChange:e,className:`border-none w-full 
                [&_.cm-editor]:bg-transparent 
                [&_.cm-focused]:outline-none 
                [&_.cm-gutters]:bg-transparent 
                [&_.cm-gutters]:border-none 
                [&_.cm-line]:bg-transparent 
                [&_.cm-activeLine]:bg-transparent 
                [&_.cm-activeLineGutter]:bg-transparent 
                [&_.cm-scroller]:bg-transparent
                [&_.cm-editor]:bg-zinc-900
                [&_.cm-content]:bg-zinc-900
                ${i?"":"[&_.cm-editor]:min-h-[24px]"}

                /* Autocomplete styling */
                [&_.cm-tooltip]:bg-zinc-800
                [&_.cm-tooltip]:border
                [&_.cm-tooltip]:border-zinc-700
                [&_.cm-tooltip]:rounded-md
                [&_.cm-tooltip]:shadow-lg
                [&_.cm-tooltip-autocomplete]:font-mono
                [&_.cm-tooltip-autocomplete]:text-base
                [&_.cm-tooltip-autocomplete]:p-1
                [&_.cm-tooltip-autocomplete_ul]:max-h-[300px]

                /* Completion item styling */
                [&_.cm-completionLabel]:text-zinc-100
                [&_.cm-completionLabel]:font-mono
                [&_.cm-completionMatchedText]:text-[#dd3f0c]
                [&_.cm-completionMatchedText]:font-medium
                [&_.cm-completionDetail]:text-zinc-400
                [&_.cm-completionDetail]:font-mono
                [&_.cm-completionInfo]:bg-zinc-800
                [&_.cm-completionInfo]:border-zinc-700
                [&_.cm-completionInfo]:shadow-lg
                [&_.cm-completionInfo]:p-3
                [&_.cm-completionInfo]:text-zinc-100
                [&_.cm-completionInfo]:font-mono

                /* Selected completion item */
                [&_.cm-tooltip-autocomplete_.cm-completionIcon]:hidden
                [&_.cm-tooltip-autocomplete_li]:px-2
                [&_.cm-tooltip-autocomplete_li]:py-1
                [&_.cm-tooltip-autocomplete_li]:hover:bg-zinc-700/50
                [&_.cm-completionMatchedText]:bg-transparent

                /* Active completion item */
                [&_.cm-tooltip-autocomplete_li[aria-selected]]:bg-zinc-700
                [&_.cm-tooltip-autocomplete_li[aria-selected]_.cm-completionLabel]:text-white
                [&_.cm-tooltip-autocomplete_li[aria-selected]_.cm-completionMatchedText]:text-[#dd3f0c]
                [&_.cm-tooltip-autocomplete_li[aria-selected]_.cm-completionDetail]:text-zinc-300
            `,basicSetup:{lineNumbers:i,highlightActiveLineGutter:i,highlightSpecialChars:!0,history:!0,foldGutter:i,drawSelection:!0,dropCursor:!0,allowMultipleSelections:i,indentOnInput:!0,bracketMatching:!0,closeBrackets:!0,autocompletion:!0,rectangularSelection:i,crosshairCursor:i,highlightActiveLine:i,highlightSelectionMatches:i,closeBracketsKeymap:!0,defaultKeymap:!0,searchKeymap:i,historyKeymap:!0,foldKeymap:i,completionKeymap:!0,lintKeymap:i}})},sA=({value:n,onChange:e,onKeyDown:t})=>g.jsxs("div",{className:"flex items-start gap-2 text-sm w-full",onKeyDown:t,children:[g.jsx("span",{className:"text-blue-400 shrink-0 mt-[3px]",children:"Î»"}),g.jsx("div",{className:"flex-1 min-w-0 max-h-[150px] overflow-y-auto",children:g.jsx(nc,{value:n,onChange:e,height:"auto",fullEditor:!1,minHeight:"24px",maxHeight:"150px"})})]}),ic=y.forwardRef(({onCommand:n,onInputChange:e,className:t},i)=>{const[r,s]=y.useState([]),[o,l]=y.useState(""),[a,c]=y.useState(!1),h=y.useRef(null),u=y.useRef(""),f=`     â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•
     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆ   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘
â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
 â•šâ•â•â•â•â• â•šâ•â•  â•šâ•â• â•šâ•â•â•â•šâ•â•â• â•šâ•â•â•â•â•â•â•`;y.useEffect(()=>{s([{type:"system",content:f,timestamp:new Date().toLocaleTimeString(),id:d()},{type:"system",content:"Welcome to the Jaws REPL!",timestamp:new Date().toLocaleTimeString(),id:d()},{type:"system",content:`Type 'exit' to quit, '(help)' for commands.
`,timestamp:new Date().toLocaleTimeString(),id:d()}])},[]),y.useEffect(()=>{h.current&&(h.current.scrollTop=h.current.scrollHeight)},[r]);const d=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,p=async S=>{if(!S.trim()||a)return;c(!0);const M=d();u.current=M;try{const A=S.trim(),O=await n(A);u.current===M&&(s(N=>[...N,{type:"input",content:A,timestamp:new Date().toLocaleTimeString(),id:d()}]),O&&O!=="undefined"&&s(N=>[...N,{type:"output",content:O,timestamp:new Date().toLocaleTimeString(),id:d()}]))}catch(A){const O=A;u.current===M&&s(N=>[...N,{type:"input",content:S.trim(),timestamp:new Date().toLocaleTimeString(),id:d()},{type:"output",content:`Error: ${O.message}`,timestamp:new Date().toLocaleTimeString(),id:d()}])}finally{u.current===M&&(c(!1),b())}},m=()=>o,b=()=>{l(""),e==null||e("")},x=S=>{l(S),e==null||e(S)},v=()=>{u.current=d(),s([{type:"system",content:f,timestamp:new Date().toLocaleTimeString(),id:d()},{type:"system",content:"Welcome to the Jaws REPL!",timestamp:new Date().toLocaleTimeString(),id:d()},{type:"system",content:`Type 'exit' to quit, '(help)' for commands.
`,timestamp:new Date().toLocaleTimeString(),id:d()}])};y.useImperativeHandle(i,()=>({writeOutput:S=>{const M=d();u.current=M,S&&S!=="undefined"&&s(A=>[...A,{type:"output",content:S.trim(),timestamp:new Date().toLocaleTimeString(),id:d()}])},writeSystem:S=>{const M=d();u.current=M,s(A=>[...A,{type:"system",content:S,timestamp:new Date().toLocaleTimeString(),id:d()}])},writeInput:S=>{const M=d();u.current=M,s(A=>[...A,{type:"input",content:S,timestamp:new Date().toLocaleTimeString(),id:d()}])},getCurrentInput:m,clearInput:b,setInput:x,clear:v}));const w=S=>{l(S),e==null||e(S)},C=async S=>{if(S.key==="Enter"&&!S.shiftKey){S.preventDefault(),S.stopPropagation();const M=(o.match(/\(/g)||[]).length,A=(o.match(/\)/g)||[]).length;if(M!==A)return;const O=o.trim();if(!O)return;await p(O)}};return g.jsxs("div",{className:`flex flex-col min-h-0 h-full ${t}`,children:[g.jsx("div",{ref:h,className:"flex-1 p-4 overflow-y-auto code-font scrollbar-thin scrollbar-thumb-zinc-600 scrollbar-track-transparent",children:r.map(S=>g.jsx("div",{style:{opacity:0,animation:"fadeSlideIn 0.3s ease-out forwards",animationDelay:"0.2s"},className:`terminal-line ${S.type!=="system"?"mb-2":"mb-0"} group`,children:g.jsxs("div",{className:`flex items-start gap-2 rounded-lg ${S.type!=="system"?"p-2":"p-0"} transition-all duration-300 ${S.type!=="system"?"hover:bg-zinc-800/30":""}`,children:[S.type==="input"&&g.jsxs("span",{className:"text-blue-400 shrink-0 code-font",style:{opacity:0,animation:"slideFromLeft 0.3s ease-out forwards",animationDelay:"0.2s"},children:["jaws: ","|>"]}),g.jsx("div",{className:"flex-1 terminal-content code-font",children:g.jsx(ct,{text:S.content,type:S.type})}),S.type!=="system"&&g.jsx("span",{className:"text-zinc-500 shrink-0 ml-2 opacity-40 code-font",children:S.timestamp})]})},S.id))}),g.jsx("div",{className:"flex-shrink-0 border-t border-zinc-700/50",children:g.jsx("div",{className:"px-4 py-3 w-full bg-zinc-900/80",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"flex-1",children:g.jsx(sA,{onChange:w,value:o,onKeyDown:C})}),g.jsx(fe,{variant:"default",onClick:()=>p(o),className:`flex items-center justify-center h-10 w-10 min-w-10
                    bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white font-medium
                    transition-all duration-200 hover:-translate-y-1
                    disabled:opacity-50 disabled:hover:translate-y-0
                    shadow-lg`,disabled:a,children:g.jsx(ra,{className:`h-5 w-5 ${a?"animate-spin":""}`})})]})})})]})});ic.displayName="Terminal";const Jn={ast:"Interpreter not initialized or loading",macroExpanded:"Interpreter not initialized or loading",anf:"Interpreter not initialized or loading",optimizedANF:"Interpreter not initialized or loading",threeAC:"Interpreter not initialized or loading",preDependencyGraph:"Interpreter not initialized or loading",postDependencyGraph:"Interpreter not initialized or loading",error:"Interpreter not initialized or loading"};let $i=null,es=null,Sm=null;const km=()=>es||(es=(async()=>{console.log("Starting background JAWS WASM initialization...");try{await((i=5e3)=>new Promise((r,s)=>{const o=Date.now(),l=()=>{typeof window.createJawsModule=="function"?r():Date.now()-o>i?s(new Error("WASM module loader timed out.")):setTimeout(l,100)};l()}))();const e=await window.createJawsModule(),t=new e.JawsWrapper;return $i=t,console.log("JAWS WASM initialized successfully in background."),t}catch(n){throw console.error("Error initializing JAWS WASM:",n),Sm=n instanceof Error?n.message:"Failed to initialize WASM module",n}})(),es);typeof window<"u"&&km();const Cm=y.createContext({instance:null,loading:!0,error:null,evaluate:()=>"Interpreter not initialized or loading",getCompilationStages:()=>Jn}),oA=({children:n})=>{const[e,t]=y.useState($i),[i,r]=y.useState(!$i),[s,o]=y.useState(Sm);y.useEffect(()=>{if($i){t($i),r(!1);return}km().then(h=>{t(h),r(!1)},h=>{o(h instanceof Error?h.message:"Failed to initialize WASM module"),r(!1)})},[]);const l=y.useCallback(h=>{if(i)return"Interpreter loading...";if(s)return`Interpreter Error: ${s}`;if(!e)return"Interpreter not available.";try{const u=e.evaluate(h);if(u.error)return u.error.startsWith("Error: Continuation invoked")&&console.warn("Continuation Invocation during evaluate:",u.error),u.error;if(u.stdout&&u.stdout.trim()!==""){const f=u.result&&u.result!=="undefined"?`${u.result}`:"";return`${u.stdout.trim()}${f?`
${f}`:""}`}return u.result||""}catch(u){return console.error("Exception during JawsWrapper.evaluate:",u),u instanceof Error&&u.message.includes("ContinuationInvocationException")?(console.warn("Caught Continuation Invocation Exception in evaluate wrapper"),"Continuation Invoked (evaluate)"):`Runtime Error: ${u instanceof Error?u.message:"Unknown error"}`}},[e,i,s]),a=y.useCallback(h=>{if(i)return{...Jn,error:"Interpreter loading..."};if(s)return{...Jn,error:`Interpreter Error: ${s}`};if(!e)return{...Jn,error:"Interpreter not available."};try{const u=e.getAllStages(h);return u.error&&console.error("Error reported from getAllStages:",u.error),u}catch(u){if(console.error("Exception during JawsWrapper.getAllStages:",u),u instanceof Error&&u.message.includes("ContinuationInvocationException"))return console.warn("Caught Continuation Invocation Exception in getCompilationStages wrapper"),{...Jn,error:"Continuation invoked during compilation analysis"};const f=`Runtime Error: ${u instanceof Error?u.message:"Unknown error"}`;return{...Jn,error:f}}},[e,i,s]),c=y.useMemo(()=>({instance:e,loading:i,error:s,evaluate:l,getCompilationStages:a}),[e,i,s,l,a]);return g.jsx(Cm.Provider,{value:c,children:n})},lA=()=>{const n=y.useContext(Cm);if(n===void 0)throw new Error("useJaws must be used within a JawsProvider");return n},lo=()=>{const{evaluate:n,getCompilationStages:e,loading:t,error:i,instance:r}=lA();return{evaluate:n,getCompilationStages:e,loading:t,error:i,instance:r}},ao=y.createContext(null);ao.displayName="PanelGroupContext";const Ee={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},rc=10,Ln=y.useLayoutEffect,Au=Ym.useId,aA=typeof Au=="function"?Au:()=>null;let cA=0;function sc(n=null){const e=aA(),t=y.useRef(n||e||null);return t.current===null&&(t.current=""+cA++),n??t.current}function Am({children:n,className:e="",collapsedSize:t,collapsible:i,defaultSize:r,forwardedRef:s,id:o,maxSize:l,minSize:a,onCollapse:c,onExpand:h,onResize:u,order:f,style:d,tagName:p="div",...m}){const b=y.useContext(ao);if(b===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:x,expandPanel:v,getPanelSize:w,getPanelStyle:C,groupId:S,isPanelCollapsed:M,reevaluatePanelConstraints:A,registerPanel:O,resizePanel:N,unregisterPanel:W}=b,z=sc(o),R=y.useRef({callbacks:{onCollapse:c,onExpand:h,onResize:u},constraints:{collapsedSize:t,collapsible:i,defaultSize:r,maxSize:l,minSize:a},id:z,idIsFromProps:o!==void 0,order:f});y.useRef({didLogMissingDefaultSizeWarning:!1}),Ln(()=>{const{callbacks:$,constraints:J}=R.current,E={...J};R.current.id=z,R.current.idIsFromProps=o!==void 0,R.current.order=f,$.onCollapse=c,$.onExpand=h,$.onResize=u,J.collapsedSize=t,J.collapsible=i,J.defaultSize=r,J.maxSize=l,J.minSize=a,(E.collapsedSize!==J.collapsedSize||E.collapsible!==J.collapsible||E.maxSize!==J.maxSize||E.minSize!==J.minSize)&&A(R.current,E)}),Ln(()=>{const $=R.current;return O($),()=>{W($)}},[f,z,O,W]),y.useImperativeHandle(s,()=>({collapse:()=>{x(R.current)},expand:$=>{v(R.current,$)},getId(){return z},getSize(){return w(R.current)},isCollapsed(){return M(R.current)},isExpanded(){return!M(R.current)},resize:$=>{N(R.current,$)}}),[x,v,w,M,z,N]);const Q=C(R.current,r);return y.createElement(p,{...m,children:n,className:e,id:z,style:{...Q,...d},[Ee.groupId]:S,[Ee.panel]:"",[Ee.panelCollapsible]:i||void 0,[Ee.panelId]:z,[Ee.panelSize]:parseFloat(""+Q.flexGrow).toFixed(1)})}const Mm=y.forwardRef((n,e)=>y.createElement(Am,{...n,forwardedRef:e}));Am.displayName="Panel";Mm.displayName="forwardRef(Panel)";let Zl=null,gs=-1,sn=null;function hA(n,e){if(e){const t=(e&Nm)!==0,i=(e&Om)!==0,r=(e&Lm)!==0,s=(e&Pm)!==0;if(t)return r?"se-resize":s?"ne-resize":"e-resize";if(i)return r?"sw-resize":s?"nw-resize":"w-resize";if(r)return"s-resize";if(s)return"n-resize"}switch(n){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function uA(){sn!==null&&(document.head.removeChild(sn),Zl=null,sn=null,gs=-1)}function Go(n,e){var t,i;const r=hA(n,e);if(Zl!==r){if(Zl=r,sn===null&&(sn=document.createElement("style"),document.head.appendChild(sn)),gs>=0){var s;(s=sn.sheet)===null||s===void 0||s.removeRule(gs)}gs=(t=(i=sn.sheet)===null||i===void 0?void 0:i.insertRule(`*{cursor: ${r} !important;}`))!==null&&t!==void 0?t:-1}}function Em(n){return n.type==="keydown"}function Tm(n){return n.type.startsWith("pointer")}function Rm(n){return n.type.startsWith("mouse")}function co(n){if(Tm(n)){if(n.isPrimary)return{x:n.clientX,y:n.clientY}}else if(Rm(n))return{x:n.clientX,y:n.clientY};return{x:1/0,y:1/0}}function fA(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function dA(n,e,t){return n.x<e.x+e.width&&n.x+n.width>e.x&&n.y<e.y+e.height&&n.y+n.height>e.y}function pA(n,e){if(n===e)throw new Error("Cannot compare node with itself");const t={a:Tu(n),b:Tu(e)};let i;for(;t.a.at(-1)===t.b.at(-1);)n=t.a.pop(),e=t.b.pop(),i=n;re(i,"Stacking order can only be calculated for elements with a common ancestor");const r={a:Eu(Mu(t.a)),b:Eu(Mu(t.b))};if(r.a===r.b){const s=i.childNodes,o={a:t.a.at(-1),b:t.b.at(-1)};let l=s.length;for(;l--;){const a=s[l];if(a===o.a)return 1;if(a===o.b)return-1}}return Math.sign(r.a-r.b)}const mA=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function gA(n){var e;const t=getComputedStyle((e=Dm(n))!==null&&e!==void 0?e:n).display;return t==="flex"||t==="inline-flex"}function bA(n){const e=getComputedStyle(n);return!!(e.position==="fixed"||e.zIndex!=="auto"&&(e.position!=="static"||gA(n))||+e.opacity<1||"transform"in e&&e.transform!=="none"||"webkitTransform"in e&&e.webkitTransform!=="none"||"mixBlendMode"in e&&e.mixBlendMode!=="normal"||"filter"in e&&e.filter!=="none"||"webkitFilter"in e&&e.webkitFilter!=="none"||"isolation"in e&&e.isolation==="isolate"||mA.test(e.willChange)||e.webkitOverflowScrolling==="touch")}function Mu(n){let e=n.length;for(;e--;){const t=n[e];if(re(t,"Missing node"),bA(t))return t}return null}function Eu(n){return n&&Number(getComputedStyle(n).zIndex)||0}function Tu(n){const e=[];for(;n;)e.push(n),n=Dm(n);return e}function Dm(n){const{parentNode:e}=n;return e&&e instanceof ShadowRoot?e.host:e}const Nm=1,Om=2,Lm=4,Pm=8,xA=fA()==="coarse";let xt=[],ai=!1,En=new Map,ho=new Map;const gr=new Set;function yA(n,e,t,i,r){var s;const{ownerDocument:o}=e,l={direction:t,element:e,hitAreaMargins:i,setResizeHandlerState:r},a=(s=En.get(o))!==null&&s!==void 0?s:0;return En.set(o,a+1),gr.add(l),Ws(),function(){var h;ho.delete(n),gr.delete(l);const u=(h=En.get(o))!==null&&h!==void 0?h:1;if(En.set(o,u-1),Ws(),u===1&&En.delete(o),xt.includes(l)){const f=xt.indexOf(l);f>=0&&xt.splice(f,1),lc(),r("up",!0,null)}}}function vA(n){const{target:e}=n,{x:t,y:i}=co(n);ai=!0,oc({target:e,x:t,y:i}),Ws(),xt.length>0&&($s("down",n),n.preventDefault(),Im(e)||n.stopImmediatePropagation())}function Ko(n){const{x:e,y:t}=co(n);if(ai&&n.buttons===0&&(ai=!1,$s("up",n)),!ai){const{target:i}=n;oc({target:i,x:e,y:t})}$s("move",n),lc(),xt.length>0&&n.preventDefault()}function Jo(n){const{target:e}=n,{x:t,y:i}=co(n);ho.clear(),ai=!1,xt.length>0&&(n.preventDefault(),Im(e)||n.stopImmediatePropagation()),$s("up",n),oc({target:e,x:t,y:i}),lc(),Ws()}function Im(n){let e=n;for(;e;){if(e.hasAttribute(Ee.resizeHandle))return!0;e=e.parentElement}return!1}function oc({target:n,x:e,y:t}){xt.splice(0);let i=null;(n instanceof HTMLElement||n instanceof SVGElement)&&(i=n),gr.forEach(r=>{const{element:s,hitAreaMargins:o}=r,l=s.getBoundingClientRect(),{bottom:a,left:c,right:h,top:u}=l,f=xA?o.coarse:o.fine;if(e>=c-f&&e<=h+f&&t>=u-f&&t<=a+f){if(i!==null&&document.contains(i)&&s!==i&&!s.contains(i)&&!i.contains(s)&&pA(i,s)>0){let p=i,m=!1;for(;p&&!p.contains(s);){if(dA(p.getBoundingClientRect(),l)){m=!0;break}p=p.parentElement}if(m)return}xt.push(r)}})}function Yo(n,e){ho.set(n,e)}function lc(){let n=!1,e=!1;xt.forEach(i=>{const{direction:r}=i;r==="horizontal"?n=!0:e=!0});let t=0;ho.forEach(i=>{t|=i}),n&&e?Go("intersection",t):n?Go("horizontal",t):e?Go("vertical",t):uA()}let Xo=new AbortController;function Ws(){Xo.abort(),Xo=new AbortController;const n={capture:!0,signal:Xo.signal};gr.size&&(ai?(xt.length>0&&En.forEach((e,t)=>{const{body:i}=t;e>0&&(i.addEventListener("contextmenu",Jo,n),i.addEventListener("pointerleave",Ko,n),i.addEventListener("pointermove",Ko,n))}),window.addEventListener("pointerup",Jo,n),window.addEventListener("pointercancel",Jo,n)):En.forEach((e,t)=>{const{body:i}=t;e>0&&(i.addEventListener("pointerdown",vA,n),i.addEventListener("pointermove",Ko,n))}))}function $s(n,e){gr.forEach(t=>{const{setResizeHandlerState:i}=t,r=xt.includes(t);i(n,r,e)})}function wA(){const[n,e]=y.useState(0);return y.useCallback(()=>e(t=>t+1),[])}function re(n,e){if(!n)throw console.error(e),Error(e)}function Fn(n,e,t=rc){return n.toFixed(t)===e.toFixed(t)?0:n>e?1:-1}function _t(n,e,t=rc){return Fn(n,e,t)===0}function st(n,e,t){return Fn(n,e,t)===0}function SA(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){const r=n[i],s=e[i];if(!st(r,s,t))return!1}return!0}function ti({panelConstraints:n,panelIndex:e,size:t}){const i=n[e];re(i!=null,`Panel constraints not found for index ${e}`);let{collapsedSize:r=0,collapsible:s,maxSize:o=100,minSize:l=0}=i;if(Fn(t,l)<0)if(s){const a=(r+l)/2;Fn(t,a)<0?t=r:t=l}else t=l;return t=Math.min(o,t),t=parseFloat(t.toFixed(rc)),t}function _i({delta:n,initialLayout:e,panelConstraints:t,pivotIndices:i,prevLayout:r,trigger:s}){if(st(n,0))return e;const o=[...e],[l,a]=i;re(l!=null,"Invalid first pivot index"),re(a!=null,"Invalid second pivot index");let c=0;if(s==="keyboard"){{const u=n<0?a:l,f=t[u];re(f,`Panel constraints not found for index ${u}`);const{collapsedSize:d=0,collapsible:p,minSize:m=0}=f;if(p){const b=e[u];if(re(b!=null,`Previous layout not found for panel index ${u}`),st(b,d)){const x=m-b;Fn(x,Math.abs(n))>0&&(n=n<0?0-x:x)}}}{const u=n<0?l:a,f=t[u];re(f,`No panel constraints found for index ${u}`);const{collapsedSize:d=0,collapsible:p,minSize:m=0}=f;if(p){const b=e[u];if(re(b!=null,`Previous layout not found for panel index ${u}`),st(b,m)){const x=b-d;Fn(x,Math.abs(n))>0&&(n=n<0?0-x:x)}}}}{const u=n<0?1:-1;let f=n<0?a:l,d=0;for(;;){const m=e[f];re(m!=null,`Previous layout not found for panel index ${f}`);const x=ti({panelConstraints:t,panelIndex:f,size:100})-m;if(d+=x,f+=u,f<0||f>=t.length)break}const p=Math.min(Math.abs(n),Math.abs(d));n=n<0?0-p:p}{let f=n<0?l:a;for(;f>=0&&f<t.length;){const d=Math.abs(n)-Math.abs(c),p=e[f];re(p!=null,`Previous layout not found for panel index ${f}`);const m=p-d,b=ti({panelConstraints:t,panelIndex:f,size:m});if(!st(p,b)&&(c+=p-b,o[f]=b,c.toPrecision(3).localeCompare(Math.abs(n).toPrecision(3),void 0,{numeric:!0})>=0))break;n<0?f--:f++}}if(SA(r,o))return r;{const u=n<0?a:l,f=e[u];re(f!=null,`Previous layout not found for panel index ${u}`);const d=f+c,p=ti({panelConstraints:t,panelIndex:u,size:d});if(o[u]=p,!st(p,d)){let m=d-p,x=n<0?a:l;for(;x>=0&&x<t.length;){const v=o[x];re(v!=null,`Previous layout not found for panel index ${x}`);const w=v+m,C=ti({panelConstraints:t,panelIndex:x,size:w});if(st(v,C)||(m-=C-v,o[x]=C),st(m,0))break;n>0?x--:x++}}}const h=o.reduce((u,f)=>f+u,0);return st(h,100)?o:r}function kA({layout:n,panelsArray:e,pivotIndices:t}){let i=0,r=100,s=0,o=0;const l=t[0];re(l!=null,"No pivot index found"),e.forEach((u,f)=>{const{constraints:d}=u,{maxSize:p=100,minSize:m=0}=d;f===l?(i=m,r=p):(s+=m,o+=p)});const a=Math.min(r,100-s),c=Math.max(i,100-o),h=n[l];return{valueMax:a,valueMin:c,valueNow:h}}function br(n,e=document){return Array.from(e.querySelectorAll(`[${Ee.resizeHandleId}][data-panel-group-id="${n}"]`))}function Bm(n,e,t=document){const r=br(n,t).findIndex(s=>s.getAttribute(Ee.resizeHandleId)===e);return r??null}function zm(n,e,t){const i=Bm(n,e,t);return i!=null?[i,i+1]:[-1,-1]}function jm(n,e=document){var t;if(e instanceof HTMLElement&&(e==null||(t=e.dataset)===null||t===void 0?void 0:t.panelGroupId)==n)return e;const i=e.querySelector(`[data-panel-group][data-panel-group-id="${n}"]`);return i||null}function uo(n,e=document){const t=e.querySelector(`[${Ee.resizeHandleId}="${n}"]`);return t||null}function CA(n,e,t,i=document){var r,s,o,l;const a=uo(e,i),c=br(n,i),h=a?c.indexOf(a):-1,u=(r=(s=t[h])===null||s===void 0?void 0:s.id)!==null&&r!==void 0?r:null,f=(o=(l=t[h+1])===null||l===void 0?void 0:l.id)!==null&&o!==void 0?o:null;return[u,f]}function AA({committedValuesRef:n,eagerValuesRef:e,groupId:t,layout:i,panelDataArray:r,panelGroupElement:s,setLayout:o}){y.useRef({didWarnAboutMissingResizeHandle:!1}),Ln(()=>{if(!s)return;const l=br(t,s);for(let a=0;a<r.length-1;a++){const{valueMax:c,valueMin:h,valueNow:u}=kA({layout:i,panelsArray:r,pivotIndices:[a,a+1]}),f=l[a];if(f!=null){const d=r[a];re(d,`No panel data found for index "${a}"`),f.setAttribute("aria-controls",d.id),f.setAttribute("aria-valuemax",""+Math.round(c)),f.setAttribute("aria-valuemin",""+Math.round(h)),f.setAttribute("aria-valuenow",u!=null?""+Math.round(u):"")}}return()=>{l.forEach((a,c)=>{a.removeAttribute("aria-controls"),a.removeAttribute("aria-valuemax"),a.removeAttribute("aria-valuemin"),a.removeAttribute("aria-valuenow")})}},[t,i,r,s]),y.useEffect(()=>{if(!s)return;const l=e.current;re(l,"Eager values not found");const{panelDataArray:a}=l,c=jm(t,s);re(c!=null,`No group found for id "${t}"`);const h=br(t,s);re(h,`No resize handles found for group id "${t}"`);const u=h.map(f=>{const d=f.getAttribute(Ee.resizeHandleId);re(d,"Resize handle element has no handle id attribute");const[p,m]=CA(t,d,a,s);if(p==null||m==null)return()=>{};const b=x=>{if(!x.defaultPrevented)switch(x.key){case"Enter":{x.preventDefault();const v=a.findIndex(w=>w.id===p);if(v>=0){const w=a[v];re(w,`No panel data found for index ${v}`);const C=i[v],{collapsedSize:S=0,collapsible:M,minSize:A=0}=w.constraints;if(C!=null&&M){const O=_i({delta:st(C,S)?A-S:S-C,initialLayout:i,panelConstraints:a.map(N=>N.constraints),pivotIndices:zm(t,d,s),prevLayout:i,trigger:"keyboard"});i!==O&&o(O)}}break}}};return f.addEventListener("keydown",b),()=>{f.removeEventListener("keydown",b)}});return()=>{u.forEach(f=>f())}},[s,n,e,t,i,r,o])}function Ru(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Hm(n,e){const t=n==="horizontal",{x:i,y:r}=co(e);return t?i:r}function MA(n,e,t,i,r){const s=t==="horizontal",o=uo(e,r);re(o,`No resize handle element found for id "${e}"`);const l=o.getAttribute(Ee.groupId);re(l,"Resize handle element has no group id attribute");let{initialCursorPosition:a}=i;const c=Hm(t,n),h=jm(l,r);re(h,`No group element found for id "${l}"`);const u=h.getBoundingClientRect(),f=s?u.width:u.height;return(c-a)/f*100}function EA(n,e,t,i,r,s){if(Em(n)){const o=t==="horizontal";let l=0;n.shiftKey?l=100:r!=null?l=r:l=10;let a=0;switch(n.key){case"ArrowDown":a=o?0:l;break;case"ArrowLeft":a=o?-l:0;break;case"ArrowRight":a=o?l:0;break;case"ArrowUp":a=o?0:-l;break;case"End":a=100;break;case"Home":a=-100;break}return a}else return i==null?0:MA(n,e,t,i,s)}function TA({panelDataArray:n}){const e=Array(n.length),t=n.map(s=>s.constraints);let i=0,r=100;for(let s=0;s<n.length;s++){const o=t[s];re(o,`Panel constraints not found for index ${s}`);const{defaultSize:l}=o;l!=null&&(i++,e[s]=l,r-=l)}for(let s=0;s<n.length;s++){const o=t[s];re(o,`Panel constraints not found for index ${s}`);const{defaultSize:l}=o;if(l!=null)continue;const a=n.length-i,c=r/a;i++,e[s]=c,r-=c}return e}function Un(n,e,t){e.forEach((i,r)=>{const s=n[r];re(s,`Panel data not found for index ${r}`);const{callbacks:o,constraints:l,id:a}=s,{collapsedSize:c=0,collapsible:h}=l,u=t[a];if(u==null||i!==u){t[a]=i;const{onCollapse:f,onExpand:d,onResize:p}=o;p&&p(i,u),h&&(f||d)&&(d&&(u==null||_t(u,c))&&!_t(i,c)&&d(),f&&(u==null||!_t(u,c))&&_t(i,c)&&f())}})}function ts(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t])return!1;return!0}function RA({defaultSize:n,dragState:e,layout:t,panelData:i,panelIndex:r,precision:s=3}){const o=t[r];let l;return o==null?l=n!=null?n.toPrecision(s):"1":i.length===1?l="1":l=o.toPrecision(s),{flexBasis:0,flexGrow:l,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function DA(n,e=10){let t=null;return(...r)=>{t!==null&&clearTimeout(t),t=setTimeout(()=>{n(...r)},e)}}function Du(n){try{if(typeof localStorage<"u")n.getItem=e=>localStorage.getItem(e),n.setItem=(e,t)=>{localStorage.setItem(e,t)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),n.getItem=()=>null,n.setItem=()=>{}}}function Fm(n){return`react-resizable-panels:${n}`}function Wm(n){return n.map(e=>{const{constraints:t,id:i,idIsFromProps:r,order:s}=e;return r?i:s?`${s}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(",")}function $m(n,e){try{const t=Fm(n),i=e.getItem(t);if(i){const r=JSON.parse(i);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function NA(n,e,t){var i,r;const s=(i=$m(n,t))!==null&&i!==void 0?i:{},o=Wm(e);return(r=s[o])!==null&&r!==void 0?r:null}function OA(n,e,t,i,r){var s;const o=Fm(n),l=Wm(e),a=(s=$m(n,r))!==null&&s!==void 0?s:{};a[l]={expandToSizes:Object.fromEntries(t.entries()),layout:i};try{r.setItem(o,JSON.stringify(a))}catch(c){console.error(c)}}function Nu({layout:n,panelConstraints:e}){const t=[...n],i=t.reduce((s,o)=>s+o,0);if(t.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${t.map(s=>`${s}%`).join(", ")}`);if(!st(i,100)&&t.length>0)for(let s=0;s<e.length;s++){const o=t[s];re(o!=null,`No layout data found for index ${s}`);const l=100/i*o;t[s]=l}let r=0;for(let s=0;s<e.length;s++){const o=t[s];re(o!=null,`No layout data found for index ${s}`);const l=ti({panelConstraints:e,panelIndex:s,size:o});o!=l&&(r+=o-l,t[s]=l)}if(!st(r,0))for(let s=0;s<e.length;s++){const o=t[s];re(o!=null,`No layout data found for index ${s}`);const l=o+r,a=ti({panelConstraints:e,panelIndex:s,size:l});if(o!==a&&(r-=a-o,t[s]=a,st(r,0)))break}return t}const LA=100,Vi={getItem:n=>(Du(Vi),Vi.getItem(n)),setItem:(n,e)=>{Du(Vi),Vi.setItem(n,e)}},Ou={};function _m({autoSaveId:n=null,children:e,className:t="",direction:i,forwardedRef:r,id:s=null,onLayout:o=null,keyboardResizeBy:l=null,storage:a=Vi,style:c,tagName:h="div",...u}){const f=sc(s),d=y.useRef(null),[p,m]=y.useState(null),[b,x]=y.useState([]),v=wA(),w=y.useRef({}),C=y.useRef(new Map),S=y.useRef(0),M=y.useRef({autoSaveId:n,direction:i,dragState:p,id:f,keyboardResizeBy:l,onLayout:o,storage:a}),A=y.useRef({layout:b,panelDataArray:[],panelDataArrayChanged:!1});y.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),y.useImperativeHandle(r,()=>({getId:()=>M.current.id,getLayout:()=>{const{layout:P}=A.current;return P},setLayout:P=>{const{onLayout:F}=M.current,{layout:G,panelDataArray:X}=A.current,q=Nu({layout:P,panelConstraints:X.map(ee=>ee.constraints)});Ru(G,q)||(x(q),A.current.layout=q,F&&F(q),Un(X,q,w.current))}}),[]),Ln(()=>{M.current.autoSaveId=n,M.current.direction=i,M.current.dragState=p,M.current.id=f,M.current.onLayout=o,M.current.storage=a}),AA({committedValuesRef:M,eagerValuesRef:A,groupId:f,layout:b,panelDataArray:A.current.panelDataArray,setLayout:x,panelGroupElement:d.current}),y.useEffect(()=>{const{panelDataArray:P}=A.current;if(n){if(b.length===0||b.length!==P.length)return;let F=Ou[n];F==null&&(F=DA(OA,LA),Ou[n]=F);const G=[...P],X=new Map(C.current);F(n,G,X,b,a)}},[n,b,a]),y.useEffect(()=>{});const O=y.useCallback(P=>{const{onLayout:F}=M.current,{layout:G,panelDataArray:X}=A.current;if(P.constraints.collapsible){const q=X.map(lt=>lt.constraints),{collapsedSize:ee=0,panelSize:de,pivotIndices:Me}=kn(X,P,G);if(re(de!=null,`Panel size not found for panel "${P.id}"`),!_t(de,ee)){C.current.set(P.id,de);const at=Yn(X,P)===X.length-1?de-ee:ee-de,ge=_i({delta:at,initialLayout:G,panelConstraints:q,pivotIndices:Me,prevLayout:G,trigger:"imperative-api"});ts(G,ge)||(x(ge),A.current.layout=ge,F&&F(ge),Un(X,ge,w.current))}}},[]),N=y.useCallback((P,F)=>{const{onLayout:G}=M.current,{layout:X,panelDataArray:q}=A.current;if(P.constraints.collapsible){const ee=q.map(Ye=>Ye.constraints),{collapsedSize:de=0,panelSize:Me=0,minSize:lt=0,pivotIndices:at}=kn(q,P,X),ge=F??lt;if(_t(Me,de)){const Ye=C.current.get(P.id),We=Ye!=null&&Ye>=ge?Ye:ge,yn=Yn(q,P)===q.length-1?Me-We:We-Me,U=_i({delta:yn,initialLayout:X,panelConstraints:ee,pivotIndices:at,prevLayout:X,trigger:"imperative-api"});ts(X,U)||(x(U),A.current.layout=U,G&&G(U),Un(q,U,w.current))}}},[]),W=y.useCallback(P=>{const{layout:F,panelDataArray:G}=A.current,{panelSize:X}=kn(G,P,F);return re(X!=null,`Panel size not found for panel "${P.id}"`),X},[]),z=y.useCallback((P,F)=>{const{panelDataArray:G}=A.current,X=Yn(G,P);return RA({defaultSize:F,dragState:p,layout:b,panelData:G,panelIndex:X})},[p,b]),R=y.useCallback(P=>{const{layout:F,panelDataArray:G}=A.current,{collapsedSize:X=0,collapsible:q,panelSize:ee}=kn(G,P,F);return re(ee!=null,`Panel size not found for panel "${P.id}"`),q===!0&&_t(ee,X)},[]),Q=y.useCallback(P=>{const{layout:F,panelDataArray:G}=A.current,{collapsedSize:X=0,collapsible:q,panelSize:ee}=kn(G,P,F);return re(ee!=null,`Panel size not found for panel "${P.id}"`),!q||Fn(ee,X)>0},[]),$=y.useCallback(P=>{const{panelDataArray:F}=A.current;F.push(P),F.sort((G,X)=>{const q=G.order,ee=X.order;return q==null&&ee==null?0:q==null?-1:ee==null?1:q-ee}),A.current.panelDataArrayChanged=!0,v()},[v]);Ln(()=>{if(A.current.panelDataArrayChanged){A.current.panelDataArrayChanged=!1;const{autoSaveId:P,onLayout:F,storage:G}=M.current,{layout:X,panelDataArray:q}=A.current;let ee=null;if(P){const Me=NA(P,q,G);Me&&(C.current=new Map(Object.entries(Me.expandToSizes)),ee=Me.layout)}ee==null&&(ee=TA({panelDataArray:q}));const de=Nu({layout:ee,panelConstraints:q.map(Me=>Me.constraints)});Ru(X,de)||(x(de),A.current.layout=de,F&&F(de),Un(q,de,w.current))}}),Ln(()=>{const P=A.current;return()=>{P.layout=[]}},[]);const J=y.useCallback(P=>{let F=!1;const G=d.current;return G&&window.getComputedStyle(G,null).getPropertyValue("direction")==="rtl"&&(F=!0),function(q){q.preventDefault();const ee=d.current;if(!ee)return()=>null;const{direction:de,dragState:Me,id:lt,keyboardResizeBy:at,onLayout:ge}=M.current,{layout:Ye,panelDataArray:We}=A.current,{initialLayout:_n}=Me??{},yn=zm(lt,P,ee);let U=EA(q,P,de,Me,at,ee);const Ei=de==="horizontal";Ei&&F&&(U=-U);const Ne=We.map(Ht=>Ht.constraints),ue=_i({delta:U,initialLayout:_n??Ye,panelConstraints:Ne,pivotIndices:yn,prevLayout:Ye,trigger:Em(q)?"keyboard":"mouse-or-touch"}),vn=!ts(Ye,ue);(Tm(q)||Rm(q))&&S.current!=U&&(S.current=U,!vn&&U!==0?Ei?Yo(P,U<0?Nm:Om):Yo(P,U<0?Lm:Pm):Yo(P,0)),vn&&(x(ue),A.current.layout=ue,ge&&ge(ue),Un(We,ue,w.current))}},[]),E=y.useCallback((P,F)=>{const{onLayout:G}=M.current,{layout:X,panelDataArray:q}=A.current,ee=q.map(Ye=>Ye.constraints),{panelSize:de,pivotIndices:Me}=kn(q,P,X);re(de!=null,`Panel size not found for panel "${P.id}"`);const at=Yn(q,P)===q.length-1?de-F:F-de,ge=_i({delta:at,initialLayout:X,panelConstraints:ee,pivotIndices:Me,prevLayout:X,trigger:"imperative-api"});ts(X,ge)||(x(ge),A.current.layout=ge,G&&G(ge),Un(q,ge,w.current))},[]),D=y.useCallback((P,F)=>{const{layout:G,panelDataArray:X}=A.current,{collapsedSize:q=0,collapsible:ee}=F,{collapsedSize:de=0,collapsible:Me,maxSize:lt=100,minSize:at=0}=P.constraints,{panelSize:ge}=kn(X,P,G);ge!=null&&(ee&&Me&&_t(ge,q)?_t(q,de)||E(P,de):ge<at?E(P,at):ge>lt&&E(P,lt))},[E]),_=y.useCallback((P,F)=>{const{direction:G}=M.current,{layout:X}=A.current;if(!d.current)return;const q=uo(P,d.current);re(q,`Drag handle element not found for id "${P}"`);const ee=Hm(G,F);m({dragHandleId:P,dragHandleRect:q.getBoundingClientRect(),initialCursorPosition:ee,initialLayout:X})},[]),V=y.useCallback(()=>{m(null)},[]),te=y.useCallback(P=>{const{panelDataArray:F}=A.current,G=Yn(F,P);G>=0&&(F.splice(G,1),delete w.current[P.id],A.current.panelDataArrayChanged=!0,v())},[v]),oe=y.useMemo(()=>({collapsePanel:O,direction:i,dragState:p,expandPanel:N,getPanelSize:W,getPanelStyle:z,groupId:f,isPanelCollapsed:R,isPanelExpanded:Q,reevaluatePanelConstraints:D,registerPanel:$,registerResizeHandle:J,resizePanel:E,startDragging:_,stopDragging:V,unregisterPanel:te,panelGroupElement:d.current}),[O,p,i,N,W,z,f,R,Q,D,$,J,E,_,V,te]),me={display:"flex",flexDirection:i==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return y.createElement(ao.Provider,{value:oe},y.createElement(h,{...u,children:e,className:t,id:s,ref:d,style:{...me,...c},[Ee.group]:"",[Ee.groupDirection]:i,[Ee.groupId]:f}))}const Vm=y.forwardRef((n,e)=>y.createElement(_m,{...n,forwardedRef:e}));_m.displayName="PanelGroup";Vm.displayName="forwardRef(PanelGroup)";function Yn(n,e){return n.findIndex(t=>t===e||t.id===e.id)}function kn(n,e,t){const i=Yn(n,e),s=i===n.length-1?[i-1,i]:[i,i+1],o=t[i];return{...e.constraints,panelSize:o,pivotIndices:s}}function PA({disabled:n,handleId:e,resizeHandler:t,panelGroupElement:i}){y.useEffect(()=>{if(n||t==null||i==null)return;const r=uo(e,i);if(r==null)return;const s=o=>{if(!o.defaultPrevented)switch(o.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{o.preventDefault(),t(o);break}case"F6":{o.preventDefault();const l=r.getAttribute(Ee.groupId);re(l,`No group element found for id "${l}"`);const a=br(l,i),c=Bm(l,e,i);re(c!==null,`No resize element found for id "${e}"`);const h=o.shiftKey?c>0?c-1:a.length-1:c+1<a.length?c+1:0;a[h].focus();break}}};return r.addEventListener("keydown",s),()=>{r.removeEventListener("keydown",s)}},[i,n,e,t])}function qm({children:n=null,className:e="",disabled:t=!1,hitAreaMargins:i,id:r,onBlur:s,onClick:o,onDragging:l,onFocus:a,onPointerDown:c,onPointerUp:h,style:u={},tabIndex:f=0,tagName:d="div",...p}){var m,b;const x=y.useRef(null),v=y.useRef({onClick:o,onDragging:l,onPointerDown:c,onPointerUp:h});y.useEffect(()=>{v.current.onClick=o,v.current.onDragging=l,v.current.onPointerDown=c,v.current.onPointerUp=h});const w=y.useContext(ao);if(w===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:C,groupId:S,registerResizeHandle:M,startDragging:A,stopDragging:O,panelGroupElement:N}=w,W=sc(r),[z,R]=y.useState("inactive"),[Q,$]=y.useState(!1),[J,E]=y.useState(null),D=y.useRef({state:z});Ln(()=>{D.current.state=z}),y.useEffect(()=>{if(t)E(null);else{const oe=M(W);E(()=>oe)}},[t,W,M]);const _=(m=i==null?void 0:i.coarse)!==null&&m!==void 0?m:15,V=(b=i==null?void 0:i.fine)!==null&&b!==void 0?b:5;y.useEffect(()=>{if(t||J==null)return;const oe=x.current;re(oe,"Element ref not attached");let me=!1;return yA(W,oe,C,{coarse:_,fine:V},(F,G,X)=>{if(!G){R("inactive");return}switch(F){case"down":{R("drag"),me=!1,re(X,'Expected event to be defined for "down" action'),A(W,X);const{onDragging:q,onPointerDown:ee}=v.current;q==null||q(!0),ee==null||ee();break}case"move":{const{state:q}=D.current;me=!0,q!=="drag"&&R("hover"),re(X,'Expected event to be defined for "move" action'),J(X);break}case"up":{R("hover"),O();const{onClick:q,onDragging:ee,onPointerUp:de}=v.current;ee==null||ee(!1),de==null||de(),me||q==null||q();break}}})},[_,C,t,V,M,W,J,A,O]),PA({disabled:t,handleId:W,resizeHandler:J,panelGroupElement:N});const te={touchAction:"none",userSelect:"none"};return y.createElement(d,{...p,children:n,className:e,id:r,onBlur:()=>{$(!1),s==null||s()},onFocus:()=>{$(!0),a==null||a()},ref:x,role:"separator",style:{...te,...u},tabIndex:f,[Ee.groupDirection]:C,[Ee.groupId]:S,[Ee.resizeHandle]:"",[Ee.resizeHandleActive]:z==="drag"?"pointer":Q?"keyboard":void 0,[Ee.resizeHandleEnabled]:!t,[Ee.resizeHandleId]:W,[Ee.resizeHandleState]:z})}qm.displayName="PanelResizeHandle";const IA=({className:n,...e})=>g.jsx(Vm,{className:Xt("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",n),...e}),Lu=Mm,BA=({withHandle:n,className:e,...t})=>g.jsx(qm,{className:Xt("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",e),...t,children:n&&g.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:g.jsx(tg,{className:"h-2.5 w-2.5"})})});function zA(){const[n,e]=y.useState(""),[t,i]=y.useState(!1),[r,s]=y.useState(!0),[o,l]=y.useState(!1),a=y.useRef(null),c=lo();y.useEffect(()=>{var m;const p=localStorage.getItem("editorCode");p&&(e(p),i(!0),localStorage.removeItem("editorCode"),(m=a.current)==null||m.writeSystem("Example code loaded!"))},[]);const h=async p=>{try{return c.evaluate(p)}catch(m){throw new Error(m instanceof Error?m.message:"An error occurred")}},u=()=>{var p,m,b,x;try{if(!n.trim()){(p=a.current)==null||p.writeSystem("No code to run. Please write some code in the editor first.");return}(m=a.current)==null||m.writeSystem("Running code from editor...");const v=c.evaluate(n);(b=a.current)==null||b.writeOutput(v)}catch(v){(x=a.current)==null||x.writeOutput(`Error: ${v instanceof Error?v.message:"An error occurred while running editor code"}`)}},f=()=>{s(!r)},d=()=>{l(!o)};return g.jsx("div",{className:`${o?"fixed inset-0 z-50 bg-white":"h-[calc(100vh-8rem)]"}`,children:g.jsxs("div",{className:"flex flex-col gap-4 h-full p-4",children:[g.jsxs("div",{className:"flex items-center gap-3 bg-slate-50 px-4 py-2.5 border rounded-lg shadow-sm",children:[g.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Editor"}),g.jsx(fe,{variant:"ghost",size:"sm",onClick:f,className:"h-7 px-2 hover:bg-slate-200/80",title:r?"Minimize editor":"Maximize editor",children:r?g.jsx(ng,{className:"h-4 w-4"}):g.jsx(ig,{className:"h-4 w-4"})}),g.jsx(fe,{variant:"ghost",size:"sm",onClick:d,className:"h-7 px-2 hover:bg-slate-200/80",title:o?"Exit fullscreen":"Enter fullscreen",children:o?g.jsx(rg,{className:"h-4 w-4"}):g.jsx(sg,{className:"h-4 w-4"})}),g.jsx("div",{className:"flex-1"}),r&&g.jsxs(fe,{variant:"default",size:"sm",onClick:u,className:`h-8 px-4 flex items-center gap-2 bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white 
                                shadow-lg hover:-translate-y-0.5 transition-all duration-200`,title:"Load editor code",children:[g.jsx(ra,{className:"h-4 w-4"}),"Load editor code"]})]}),g.jsx("div",{className:"flex-1 min-h-0 border rounded-lg bg-zinc-900 overflow-hidden",children:g.jsxs(IA,{direction:"vertical",children:[g.jsx(Lu,{defaultSize:50,minSize:30,className:r?"":"hidden",children:g.jsx(nc,{value:n,onChange:e,height:"100%",fullEditor:!0,onRun:u})}),g.jsx(BA,{className:r?"h-2 bg-zinc-800 hover:bg-zinc-700":"hidden"}),g.jsx(Lu,{defaultSize:100,minSize:20,children:g.jsx(ic,{ref:a,onCommand:h,className:"h-full"})})]})})]})})}const Pu=[{name:"+",signature:"(+ number ...)",description:"Adds numbers together. With no arguments, returns 0.",example:"(+ 1 2 3 4)",output:"10",category:"Math"},{name:"-",signature:"(- number ...)",description:"Subtracts numbers. With one argument, negates it.",example:"(- 10 2 3)",output:"5",category:"Math"},{name:"*",signature:"(* number ...)",description:"Multiplies numbers together. With no arguments, returns 1.",example:"(* 2 3 4)",output:"24",category:"Math"},{name:"/",signature:"(/ number ...)",description:"Divides numbers. With one argument, returns its reciprocal.",example:"(/ 24 2 3)",output:"4",category:"Math"},{name:"zero?",signature:"(zero? number)",description:"Returns true if the number is equal to zero.",example:"(zero? 0)",output:"#t",category:"Predicate"},{name:"<",signature:"(< number1 number2 ...)",description:"Returns true if each number is strictly less than the next.",example:"(< 1 2 3)",output:"#t",category:"Predicate"},{name:">",signature:"(> number1 number2 ...)",description:"Returns true if each number is strictly greater than the next.",example:"(> 3 2 1)",output:"#t",category:"Predicate"},{name:"<=",signature:"(<= number1 number2 ...)",description:"Returns true if each number is less than or equal to the next.",example:"(<= 1 1 2)",output:"#t",category:"Predicate"},{name:">=",signature:"(>= number1 number2 ...)",description:"Returns true if each number is greater than or equal to the next.",example:"(>= 3 3 2)",output:"#t",category:"Predicate"},{name:"=",signature:"(= number1 number2 ...)",description:"Returns true if all numbers are equal.",example:"(= 42 42 42)",output:"#t",category:"Predicate"},{name:"list",signature:"(list obj ...)",description:"Creates a new list containing the given objects.",example:"(list 1 2 3 4)",output:"(1 2 3 4)",category:"List"},{name:"car",signature:"(car pair)",description:"Returns the first element of a pair or list.",example:"(car '(1 2 3))",output:"1",category:"List"},{name:"cdr",signature:"(cdr pair)",description:"Returns all but the first element of a list.",example:"(cdr '(1 2 3))",output:"(2 3)",category:"List"},{name:"cons",signature:"(cons obj1 obj2)",description:"Constructs a pair whose car is obj1 and cdr is obj2.",example:"(cons 1 '(2 3))",output:"(1 2 3)",category:"List"},{name:"append",signature:"(append list ...)",description:"Joins lists together into a single list.",example:"(append '(1 2) '(3 4))",output:"(1 2 3 4)",category:"List"},{name:"length",signature:"(length list)",description:"Returns the number of elements in the list.",example:"(length '(1 2 3 4))",output:"4",category:"List"},{name:"reverse",signature:"(reverse list)",description:"Returns a new list with elements in reverse order.",example:"(reverse '(1 2 3))",output:"(3 2 1)",category:"List"},{name:"list-ref",signature:"(list-ref list k)",description:"Returns the k-th element of the list (zero-based).",example:"(list-ref '(a b c d) 2)",output:"c",category:"List"},{name:"member",signature:"(member obj list)",description:"Returns the first sublist whose car is equal to obj, or #f if not found.",example:"(member 'c '(a b c d))",output:"(c d)",category:"List"},{name:"assoc",signature:"(assoc obj alist)",description:"Finds the first pair in alist whose car is equal to obj, or #f if not found.",example:"(assoc 'b '((a 1) (b 2) (c 3)))",output:"(b 2)",category:"List"},{name:"map",signature:"(map procedure list)",description:"Applies a procedure to each element in the list, returning a new list with the results.",example:"(map (lambda (x) (* x x)) '(1 2 3 4))",output:"(1 4 9 16)",category:"List"},{name:"apply",signature:"(apply proc arg ... args)",description:"Calls proc with args as arguments, spreading the last argument.",example:"(apply + 1 2 '(3 4))",output:"10",category:"Control"},{name:"eval",signature:"(eval expression)",description:"Evaluates the given Scheme expression.",example:"(eval '(+ 1 2))",output:"3",category:"Control"},{name:"null?",signature:"(null? obj)",description:"Returns true if obj is the empty list.",example:"(null? '())",output:"#t",category:"Predicate"},{name:"pair?",signature:"(pair? obj)",description:"Returns true if obj is a pair.",example:"(pair? '(a . b))",output:"#t",category:"Predicate"},{name:"list?",signature:"(list? obj)",description:"Returns true if obj is a proper list.",example:"(list? '(a b c))",output:"#t",category:"Predicate"},{name:"symbol?",signature:"(symbol? obj)",description:"Returns true if obj is a symbol.",example:"(symbol? 'abc)",output:"#t",category:"Predicate"},{name:"number?",signature:"(number? obj)",description:"Returns true if obj is a number.",example:"(number? 42)",output:"#t",category:"Predicate"},{name:"string?",signature:"(string? obj)",description:"Returns true if obj is a string.",example:'(string? "hello")',output:"#t",category:"Predicate"},{name:"boolean?",signature:"(boolean? obj)",description:"Returns true if obj is either #t or #f.",example:"(boolean? #t)",output:"#t",category:"Predicate"},{name:"procedure?",signature:"(procedure? obj)",description:"Returns true if obj is a procedure.",example:"(procedure? car)",output:"#t",category:"Predicate"},{name:"string=?",signature:"(string=? string1 string2)",description:"Returns true if the strings are the same length and contain the same characters.",example:'(string=? "hello" "hello")',output:"#t",category:"String"},{name:"string<?",signature:"(string<? string1 string2)",description:"Returns true if string1 is lexicographically less than string2.",example:'(string<? "apple" "banana")',output:"#t",category:"String"},{name:"string>?",signature:"(string>? string1 string2)",description:"Returns true if string1 is lexicographically greater than string2.",example:'(string>? "zebra" "apple")',output:"#t",category:"String"},{name:"string-length",signature:"(string-length string)",description:"Returns the number of characters in the string.",example:'(string-length "hello")',output:"5",category:"String"},{name:"string-append",signature:"(string-append str1 str2 ...)",description:"Concatenates multiple strings together.",example:'(string-append "Hello" ", " "World!")',output:'"Hello, World!"',category:"String"},{name:"substring",signature:"(substring string start end)",description:"Returns a substring from start (inclusive) to end (exclusive).",example:'(substring "abcdefg" 2 5)',output:'"cde"',category:"String"},{name:"string-ref",signature:"(string-ref string k)",description:"Returns the k-th character of the string (zero-based).",example:'(string-ref "abcdefg" 3)',output:"#\\d",category:"String"},{name:"string->list",signature:"(string->list string)",description:"Converts a string to a list of characters.",example:'(string->list "abc")',output:"(#\\a #\\b #\\c)",category:"String"},{name:"list->string",signature:"(list->string list)",description:"Converts a list of characters to a string.",example:"(list->string '(#\\h #\\i))",output:'"hi"',category:"String"},{name:"make-vector",signature:"(make-vector k [fill])",description:"Creates a vector of length k, optionally filled with the fill value.",example:"(make-vector 3 'a)",output:"#(a a a)",category:"Vector"},{name:"vector",signature:"(vector obj ...)",description:"Creates a vector containing the given objects.",example:"(vector 1 2 3)",output:"#(1 2 3)",category:"Vector"},{name:"vector-ref",signature:"(vector-ref vector k)",description:"Returns the k-th element of the vector (zero-based).",example:"(vector-ref #(a b c) 1)",output:"b",category:"Vector"},{name:"vector-set!",signature:"(vector-set! vector k obj)",description:"Sets the k-th element of the vector to obj.",example:"(define v #(a b c)) (vector-set! v 1 'x) v",output:"#(a x c)",category:"Vector"},{name:"vector-length",signature:"(vector-length vector)",description:"Returns the length of the vector.",example:"(vector-length #(a b c))",output:"3",category:"Vector"},{name:"display",signature:"(display obj [port])",description:"Outputs a value to the console or port. Strings are displayed without quotes.",example:'(display "Hello, World!")',output:"Hello, World!",category:"IO"},{name:"write",signature:"(write obj [port])",description:"Writes a value to the console or port in a way that it can be read by read.",example:'(write "Hello, World!")',output:'"Hello, World!"',category:"IO"},{name:"newline",signature:"(newline [port])",description:"Outputs a newline character to the console or port.",example:'(display "Hello") (newline) (display "World")',output:`Hello
World`,category:"IO"},{name:"read",signature:"(read [port])",description:"Reads and returns a Scheme object from the input port.",example:'(define p (open-input-string "(1 2 3)")) (read p)',output:"(1 2 3)",category:"IO"},{name:"not",signature:"(not obj)",description:"Returns true if obj is false, otherwise returns false.",example:"(not #f)",output:"#t",category:"Predicate"},{name:"eq?",signature:"(eq? obj1 obj2)",description:"Tests whether two objects are the same object (by identity).",example:"(eq? 'a 'a)",output:"#t",category:"Predicate"},{name:"equal?",signature:"(equal? obj1 obj2)",description:"Tests whether two objects are structurally equal (recursive comparison).",example:"(equal? '(1 2 3) '(1 2 3))",output:"#t",category:"Predicate"},{name:"when",signature:"(when test expr ...)",description:"If test is true, evaluates expressions in order and returns the last result.",example:"(when (> 3 2) (display 'greater) 'done)",output:`greater
done`,category:"Syntax"},{name:"unless",signature:"(unless test expr ...)",description:"If test is false, evaluates expressions in order and returns the last result.",example:"(unless (< 3 2) (display 'not-less) 'done)",output:`not-less
done`,category:"Syntax"},{name:"cond",signature:"(cond (test expr ...) ...)",description:"Evaluates each test in order until one returns true, then evaluates the corresponding expressions.",example:"(cond ((> 3 2) 'greater) ((< 3 2) 'less) (else 'equal))",output:"greater",category:"Syntax"},{name:"case",signature:"(case key ((datum ...) expr ...) ...)",description:"Evaluates key, then finds the clause with a matching datum and evaluates its expressions.",example:"(case (+ 1 1) ((1) 'one) ((2) 'two) (else 'many))",output:"two",category:"Syntax"},{name:"and",signature:"(and expr ...)",description:"Evaluates expressions from left to right, returning the first false value or the last value if all are true.",example:"(and (> 2 1) (< 2 3) 'result)",output:"result",category:"Syntax"},{name:"or",signature:"(or expr ...)",description:"Evaluates expressions from left to right, returning the first true value or #f if all are false.",example:"(or (> 2 3) (< 2 1) (= 2 2))",output:"#t",category:"Syntax"},{name:"let",signature:"(let ((var expr) ...) body ...)",description:"Creates local bindings for variables, then evaluates body expressions.",example:"(let ((x 1) (y 2)) (+ x y))",output:"3",category:"Syntax"},{name:"let*",signature:"(let* ((var expr) ...) body ...)",description:"Like let, but each binding is available to the expressions of later bindings.",example:"(let* ((x 1) (y (+ x 1))) (+ x y))",output:"3",category:"Syntax"},{name:"for-each-with-index",signature:"(for-each-with-index (element index) in list body ...)",description:"Executes body for each element in the list with its index.",example:"(for-each-with-index (e i) in '(a b c) (display e) (display i) (newline))",output:`a0
b1
c2`,category:"Control"},{name:"for-range",signature:"(for-range var from to body ...)",description:"Executes body for each value from 'from' to 'to' inclusive.",example:"(for-range i 1 3 (display i) (newline))",output:`1
2
3`,category:"Control"},{name:"while",signature:"(while condition body ...)",description:"Executes body repeatedly as long as condition is true.",example:"(let ((i 0)) (while (< i 3) (display i) (set! i (+ i 1))))",output:"012",category:"Control"},{name:"for",signature:"(for element in list body ...)",description:"Maps a lambda over the list, executing body for each element.",example:"(for x in '(1 2 3) (display (+ x 10)) (newline))",output:`11
12
13`,category:"Control"},{name:"repeat",signature:"(repeat n body ...)",description:"Executes body n times.",example:"(repeat 3 (display 'hi) (newline))",output:`hi
hi
hi`,category:"Control"}];function jA({doc:n,onTryExample:e}){const t=Vs(),i=y.useRef(null);y.useEffect(()=>{},[n.name,n.example]);const r=()=>{localStorage.setItem("compiler-explorer-code",n.example),t("/compiler-explorer")};return g.jsxs(Us,{className:"bg-white text-slate-800 border border-slate-200 shadow-lg transition-all duration-300 hover:-translate-y-1",children:[g.jsx(fa,{className:"pb-4",children:g.jsxs("div",{className:"flex items-start justify-between",children:[g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-baseline gap-3",children:[g.jsx(da,{className:"text-xl font-semibold text-slate-900 font-mono",children:n.name}),g.jsx("span",{className:"text-sm text-slate-500 font-mono",children:n.signature})]}),g.jsx(pa,{className:"text-base text-slate-600 mt-2",children:n.description})]}),g.jsx("span",{className:"text-sm font-medium px-2.5 py-0.5 rounded bg-slate-100 text-slate-600",children:n.category})]})}),g.jsxs(Gs,{className:"pt-0 space-y-4",children:[g.jsx("div",{ref:i,className:"bg-zinc-900 rounded-lg p-4 font-mono text-sm overflow-x-auto",children:g.jsx(ct,{text:n.example,type:"input"},`highlight-${n.name}-${n.category}`)}),g.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 font-mono text-sm border border-slate-200",children:[g.jsx("div",{className:"text-slate-500 mb-1 text-xs uppercase tracking-wide",children:"Output:"}),g.jsx("div",{className:"text-slate-700",children:n.output})]}),g.jsxs("div",{className:"flex flex-wrap gap-3",children:[g.jsxs(fe,{onClick:()=>e(n.example),className:`bg-[#dd3f0c] text-white hover:opacity-90 flex items-center gap-2 
                                transition-all duration-200 hover:-translate-y-1 text-base font-medium`,children:["Try It ",g.jsx(bs,{className:"h-4 w-4"})]}),g.jsxs(fe,{onClick:r,className:`bg-blue-900 text-white hover:bg-blue-800 flex items-center gap-2
                                transition-all duration-200 hover:-translate-y-1 text-base font-medium`,children:[g.jsx(ia,{className:"h-4 w-4"})," Compiler Explorer"]})]})]})]})}function HA(){const n=Vs(),[e,t]=y.useState("All"),i=lo(),r=l=>{localStorage.setItem("editorCode",l),n("/editor")},s=e==="All"?Pu:Pu.filter(l=>l.category===e),o=["All","Math","List","String","IO","Control","Vector","Predicate","Syntax"];return y.useEffect(()=>{},[e]),g.jsxs("div",{className:"min-h-screen bg-white",children:[g.jsx("div",{className:"container mx-auto px-4 py-12",children:g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"flex flex-col gap-2 animate-fadeSlideIn",children:[g.jsx("h1",{className:"text-2xl md:text-3xl font-semibold text-slate-900",children:"Standard Library Documentation"}),g.jsx("p",{className:"text-base text-slate-600",children:"Explore Scheme's standard library functions with interactive examples."}),i.loading&&g.jsx("p",{className:"text-sm text-blue-600",children:"Loading JAWS interpreter..."}),i.error&&g.jsxs("p",{className:"text-sm text-red-600",children:["Error loading interpreter: ",i.error]})]}),g.jsx("div",{className:"flex gap-2 flex-wrap",children:o.map(l=>g.jsx(fe,{onClick:()=>t(l),variant:e===l?"default":"outline",className:e===l?"bg-[#dd3f0c] text-white hover:opacity-90":"",children:l},l))}),g.jsx("div",{className:"grid gap-6",children:s.map((l,a)=>g.jsx("div",{className:"animate-fadeScale",style:{animationDelay:`${a*.1}s`},children:g.jsx(jA,{doc:l,onTryExample:r},`doc-${e}-${l.name}`)},`${e}-${l.name}-${a}`))})]})}),g.jsx(yf,{})]})}const FA=`(define factorial
  (lambda (n)
    (if (= n 0)
        1
        (* n (factorial (- n 1))))))

(factorial 5)`,WA=()=>{const[n,e]=y.useState(FA),[t,i]=y.useState({ast:"",macroExpanded:"",anf:"",optimizedANF:"",threeAC:"",preDependencyGraph:"",postDependencyGraph:"",result:""}),[r,s]=y.useState("ast"),[o,l]=y.useState(!1),a=lo();y.useEffect(()=>{const u=localStorage.getItem("compiler-explorer-code");u&&(e(u),localStorage.removeItem("compiler-explorer-code"))},[]),y.useEffect(()=>{},[t,r]);const c=()=>{if(!(!a||a.loading)){l(!0);try{const u=a.getCompilationStages(n),f=a.evaluate(n);u.error?i({...t,result:u.error}):i({ast:u.ast,macroExpanded:u.macroExpanded,anf:u.anf,optimizedANF:u.optimizedANF,threeAC:u.threeAC,preDependencyGraph:u.preDependencyGraph,postDependencyGraph:u.postDependencyGraph,result:f})}catch(u){console.error("Compilation error:",u),i({...t,result:`Error: ${u instanceof Error?u.message:String(u)}`})}finally{l(!1)}}},h=()=>{switch(r){case"ast":return g.jsx(ct,{text:t.ast,type:"input"},`highlight-ast-${t.ast.length}`);case"macro":return g.jsx(ct,{text:t.macroExpanded,type:"input"},`highlight-macro-${t.macroExpanded.length}`);case"anf":return g.jsx(ct,{text:t.anf,type:"input"},`highlight-anf-${t.anf.length}`);case"optimized":return g.jsx(ct,{text:t.optimizedANF,type:"input"},`highlight-optimized-${t.optimizedANF.length}`);case"threac":return g.jsx(ct,{text:t.threeAC,type:"input"},`highlight-threac-${t.threeAC.length}`);case"depgraph":return g.jsxs("div",{className:"grid grid-cols-2 gap-4 h-full",children:[g.jsxs("div",{className:"code-font text-blue-100 bg-zinc-800/80 rounded-lg p-4 overflow-auto border border-blue-700/30",children:[g.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-300",children:"Pre-Optimization Dependencies"}),g.jsx(ct,{text:t.preDependencyGraph,type:"input"},`highlight-pre-${t.preDependencyGraph.length}`)]}),g.jsxs("div",{className:"code-font text-blue-100 bg-zinc-800/80 rounded-lg p-4 overflow-auto border border-blue-700/30",children:[g.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-300",children:"Post-Optimization Dependencies"}),g.jsx(ct,{text:t.postDependencyGraph,type:"input"},`highlight-post-${t.postDependencyGraph.length}`)]})]});default:return g.jsx("div",{children:"Select a tab to view compilation stage"})}};return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-blue-900 flex flex-col",children:[g.jsxs("div",{className:"flex border-b border-blue-700/30 bg-slate-900/80 p-4 items-center gap-2",children:[g.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>window.location.href="/",className:"text-white hover:bg-blue-800/30",children:g.jsx(Qo,{className:"h-5 w-5"})}),g.jsxs("h1",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[g.jsx(Vt,{className:"h-5 w-5",style:{color:"#22d3ee"}}),"Scheme Compiler Explorer"]})]}),g.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-slate-900/70",children:[g.jsxs("div",{className:"p-4 flex flex-wrap items-center gap-3 border-b border-blue-700/30 bg-blue-900/20",children:[g.jsxs(fe,{onClick:c,className:"bg-green-600 hover:bg-green-700 text-white hover:-translate-y-1 transition-all duration-200 flex items-center gap-2 shadow-lg px-6 h-12 text-base",disabled:(a==null?void 0:a.loading)||o,children:[g.jsx(ra,{className:`h-5 w-5 ${a!=null&&a.loading||o?"animate-spin":""}`}),a!=null&&a.loading?"Loading...":o?"Compiling...":"Run"]}),g.jsxs("div",{className:"flex flex-wrap gap-2",children:[g.jsxs(fe,{onClick:()=>s("ast"),className:`h-12 px-4 text-base flex items-center gap-2 ${r==="ast"?"bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white":"bg-white hover:bg-white/90 text-blue-800"}`,children:[g.jsx(ia,{className:"h-5 w-5"}),"AST"]}),g.jsxs(fe,{onClick:()=>s("macro"),className:`h-12 px-4 text-base flex items-center gap-2 ${r==="macro"?"bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white":"bg-white hover:bg-white/90 text-blue-800"}`,children:[g.jsx(og,{className:"h-5 w-5"}),"Macro"]}),g.jsxs(fe,{onClick:()=>s("anf"),className:`h-12 px-4 text-base flex items-center gap-2 ${r==="anf"?"bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white":"bg-white hover:bg-white/90 text-blue-800"}`,children:[g.jsx(lg,{className:"h-5 w-5"}),"ANF"]}),g.jsxs(fe,{onClick:()=>s("optimized"),className:`h-12 px-4 text-base flex items-center gap-2 ${r==="optimised"?"bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white":"bg-white hover:bg-white/90 text-blue-800"}`,children:[g.jsx(ag,{className:"h-5 w-5"}),"Optimised"]}),g.jsxs(fe,{onClick:()=>s("threac"),className:`h-12 px-4 text-base flex items-center gap-2 ${r==="threac"?"bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white":"bg-white hover:bg-white/90 text-blue-800"}`,children:[g.jsx(cg,{className:"h-5 w-5"}),"Three-AC"]}),g.jsxs(fe,{onClick:()=>s("depgraph"),className:`h-12 px-4 text-base flex items-center gap-2 ${r==="depgraph"?"bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white":"bg-white hover:bg-white/90 text-blue-800"}`,children:[g.jsx(hg,{className:"h-5 w-5"}),"Dep. Graph"]})]})]}),g.jsx("div",{className:"border-b border-blue-700/30 p-4 h-[25%]",children:g.jsx("div",{className:"h-full bg-zinc-800/80 rounded-lg overflow-hidden shadow-lg border border-blue-700/30",children:g.jsx(nc,{value:n,onChange:e,height:"100%",fullEditor:!0})})}),g.jsx("div",{className:"flex-1 min-h-0 h-[60%] border-b border-blue-700/30 p-4",children:g.jsx("div",{className:"h-full bg-zinc-800/80 rounded-lg overflow-auto border border-blue-700/30 p-4 code-font text-blue-100",children:g.jsx("div",{children:h()},`tab-content-${r}`)})}),g.jsx("div",{className:"p-4 h-[15%] overflow-auto",children:g.jsx("div",{className:"code-font text-green-400 bg-zinc-800/80 rounded-lg p-4 h-full overflow-auto border border-blue-700/30",children:g.jsx(ct,{text:t.result,type:"output"})})})]})]})};function $A({difficulty:n}){const e={Beginner:"text-green-600 bg-green-50",Intermediate:"text-blue-600 bg-blue-50",Advanced:"text-purple-600 bg-purple-50"};return g.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${e[n]}`,children:n})}const ns=[{id:"basics",title:"Scheme Basics",description:"Learn the fundamentals of Scheme programming",sections:[{id:"intro",title:"Introduction to Scheme",content:"Scheme is a dialect of Lisp that supports multiple paradigms with a focus on functional programming. It is known for its simplicity, elegance, and powerful features such as first-class functions, lexical scoping, and proper tail recursion. Scheme was initially designed for education and research, making it an excellent language for learning programming concepts.",codeExamples:[{description:"Your first Scheme program:",code:'(display "Hello, World!")',explanation:`This example uses the display procedure to output the string "Hello, World!" to the console. It's the traditional first program in any language.`}],difficulty:"Beginner"},{id:"data-types",title:"Data Types",content:["Scheme has several basic data types including numbers, strings, symbols, and lists. Numbers include integers, floating-point, rationals, and complex. Strings are sequences of characters.","Symbols are identifiers that are typically used for variables and function names. They are unique objects in memory - when two symbols have the same name, they reference the same object.","Lists are the fundamental data structure in Scheme, represented with parentheses. They can contain elements of any type, including other lists."],codeExamples:[{description:"Working with numbers:",code:`; Integer addition
(+ 1 2)`,explanation:"In Scheme, operators like + are functions that are placed before their arguments. This expression adds 1 and 2, resulting in 3."},{description:"Multiplication:",code:`; Multiplication
(* 3 4)`,explanation:"The * function multiplies its arguments together. This expression computes 3 Ã— 4, resulting in 12."},{description:"Subtraction:",code:`; Subtraction
(- 10 5)`,explanation:"The - function subtracts the second number from the first. This computes 10 - 5, resulting in 5."},{description:"Division:",code:`; Division
(/ 10 2)`,explanation:"The / function divides the first number by the second. This calculates 10 Ã· 2, resulting in 5."},{description:"String concatenation:",code:`; Joining strings
(string-append "Hello" " " "World")`,explanation:'The string-append function joins multiple strings together. This combines "Hello", a space, and "World" to create "Hello World".'},{description:"String length:",code:`; Finding string length
(string-length "Hello")`,explanation:'The string-length function counts the number of characters in a string. "Hello" has 5 characters.'},{description:"Creating a list:",code:`; Creating a list
(define my-list (list 1 2 3))
my-list`,explanation:"This creates a list of three numbers using the list function and assigns it to the variable my-list. The second line returns the list (1 2 3)."},{description:"Getting the first element (car):",code:`; First element of a list
(define my-list (list 1 2 3))
(car my-list)`,explanation:"The car function returns the first element of a list. For the list (1 2 3), the car is 1."},{description:"Getting all but the first element (cdr):",code:`; All but first element
(define my-list (list 1 2 3))
(cdr my-list)`,explanation:"The cdr function returns the rest of a list after the first element. For the list (1 2 3), the cdr is (2 3)."}],difficulty:"Beginner"},{id:"quoting",title:"Quoting and Evaluation",content:["In Scheme, expressions are normally evaluated to produce values. However, sometimes you want to treat code as data rather than evaluating it.","Quoting is a mechanism that prevents evaluation, allowing you to use symbols and lists as literal data. The quote special form (or its shorthand, the single quote ') treats its argument as literal data instead of evaluating it.","This concept is fundamental to metaprogramming in Scheme, especially for macros which transform code before it's evaluated."],codeExamples:[{description:"Expression without quoting (evaluates):",code:`; Evaluates the expression
(+ 1 2)`,explanation:"Without quoting, this expression is evaluated normally, calling the + function with arguments 1 and 2, resulting in 3."},{description:"Same expression with quoting (doesn't evaluate):",code:`; Returns the expression as data
'(+ 1 2)`,explanation:"With quoting, the expression is treated as data instead of being evaluated. This returns the list (+ 1 2) rather than computing the sum."},{description:"Explicit quote form:",code:`; Using the quote special form
(quote (+ 1 2))`,explanation:"This is the full form of quoting. It's equivalent to '(+ 1 2) and returns the list (+ 1 2) without evaluation."},{description:"Quoting a symbol:",code:`; Symbol literal
'abc`,explanation:"Quoting a symbol name creates a symbol. Without the quote, abc would be treated as a variable name."},{description:"Quoting a list:",code:`; List literal
'(a b c)`,explanation:"This creates a list containing three symbols: a, b, and c. Without quoting, Scheme would try to call function a with arguments b and c."},{description:"Quoting a list of numbers:",code:`; List of numbers
'(1 2 3)`,explanation:"This creates a list containing the numbers 1, 2, and 3 as data. Numbers are self-evaluating, but quoting still prevents the list from being treated as a function call."},{description:"Setting up for quasiquoting:",code:`; Define variables for the next examples
(define x 5)
(define y 10)
x`,explanation:"This defines two variables, x with value 5 and y with value 10, for use in the next examples. The last line returns the value of x."},{description:"Quasiquoting with unquoting:",code:"; Quasiquote (backtick) with unquote (comma)\n`(x is ,x and y is ,y)",explanation:"Quasiquote (backtick) works like quote, but allows selective evaluation using unquote (comma). Here, the symbols x and y remain as symbols, but their values (5 and 10) are inserted at the comma positions."},{description:"Setting up for unquote-splicing:",code:`; Define a list for splicing
(define nums '(1 2 3))
nums`,explanation:"This defines a variable nums containing the list (1 2 3) for use in the next example."},{description:"Unquote-splicing example:",code:"; Using unquote-splicing (,@) for lists\n`(The numbers are: ,@nums)",explanation:"Unquote-splicing (,@) inserts each element of a list into the surrounding list. This results in (The numbers are: 1 2 3) rather than (The numbers are: (1 2 3))."}],difficulty:"Beginner"}]},{id:"functions",title:"Functions & Procedures",description:"Master function definition and usage in Scheme",sections:[{id:"defining-functions",title:"Defining Functions",content:"Functions in Scheme are defined using the define keyword. Scheme functions (also called procedures) can take any number of parameters and return a value. In Scheme, functions are first-class objects, meaning they can be passed as arguments, returned from other functions, and assigned to variables.",codeExamples:[{description:"Defining a simple function:",code:`; Define a function to square a number
(define (square x)
  (* x x))`,explanation:"This defines a function named square that takes one parameter x and returns the result of multiplying x by itself. The (define (square x) ...) syntax is shorthand for (define square (lambda (x) ...))."},{description:"Using the function:",code:`; Call the square function
(square 5)`,explanation:"This calls the square function with the argument 5. The function returns 5 Ã— 5, which is 25."}],difficulty:"Beginner"},{id:"lambda",title:"Lambda Expressions",content:"Lambda expressions allow you to create anonymous functions in Scheme. These are useful for creating functions that are used only once or as arguments to higher-order functions. The syntax is (lambda (parameters) body).",codeExamples:[{description:"Creating an anonymous function:",code:`; Anonymous function expression
(lambda (x) (* x x))`,explanation:"This creates an anonymous function that squares its argument. The function isn't called or bound to a name; it's just a value."},{description:"Using a lambda expression directly:",code:`; Applying a lambda directly
((lambda (x) (* x x)) 5)`,explanation:"This creates an anonymous squaring function and immediately applies it to the argument 5. The extra parentheses cause the lambda to be evaluated and then called with 5."},{description:"Assigning a lambda to a variable:",code:`; Defining a function with lambda
(define square (lambda (x) (* x x)))`,explanation:"This creates a lambda expression and binds it to the name square. This is equivalent to the square function definition we saw earlier, but written with the explicit lambda form."},{description:"Using the function:",code:`; Using the lambda-defined function
(square 5)`,explanation:"This calls the square function created with lambda, passing the argument 5. The function returns 25, just like the previous square function."}],difficulty:"Intermediate"},{id:"higher-order",title:"Higher-Order Functions",content:["Higher-order functions are functions that operate on other functions, either by taking functions as arguments or returning functions as results.","This concept is central to functional programming and enables powerful abstractions. Common higher-order functions in Scheme include map, filter, and fold, which apply operations to elements in lists."],codeExamples:[{description:"Defining a list for our examples:",code:`; Create a list of numbers
(define numbers '(1 2 3 4 5))
numbers`,explanation:"This creates a list of numbers from 1 to 5 and assigns it to the variable numbers. We'll use this list in the following examples."},{description:"Using map:",code:`; Map doubles each element
(map (lambda (x) (* x 2)) numbers)`,explanation:"The map function applies a given function to each element in a list. Here, we're applying an anonymous function that doubles its input to each number in our list, resulting in (2 4 6 8 10)."},{description:"Defining a predicate function:",code:`; Define a predicate for even numbers
(define (even? x) (= (remainder x 2) 0))`,explanation:"This defines a predicate function named even? that returns #t if its argument is even and #f otherwise. It works by checking if the remainder when dividing by 2 is zero."},{description:"Using filter:",code:`; Filter keeps only even numbers
(filter even? '(1 2 3 4 5 6))`,explanation:"The filter function creates a new list containing only the elements that satisfy a predicate. Here, we're keeping only the even numbers from the list, resulting in (2 4 6)."},{description:"Using fold to sum elements:",code:`; Fold/reduce to sum all elements
(fold-left + 0 '(1 2 3 4 5))`,explanation:"The fold-left function combines list elements using a binary function. Starting with an initial value (0), it applies the function (+) between the accumulator and each element. This computes 0+1+2+3+4+5=15."},{description:"Using fold to reverse a list:",code:`; Using fold to reverse a list
(fold-left (lambda (x acc) (cons x acc)) '() '(1 2 3 4))`,explanation:"This uses fold-left to build a reversed list. The lambda takes the current element `x` and the accumulated list `acc`. Starting with an empty list `'()`, for each element `x` from the input list, we `cons` `x` onto the front of our accumulated list `acc`. This effectively reverses the list, resulting in `(4 3 2 1)`."}],difficulty:"Intermediate"},{id:"variable-bindings",title:"Variable Binding Forms",content:["Scheme provides several special forms for creating local variables with different scoping rules. The basic form is let, which binds variables in parallel. Two variations are let* (sequential binding) and letrec (recursive binding).","Understanding these binding forms is essential for managing variable scope and creating complex algorithms in Scheme. Each has specific use cases where it is most appropriate."],codeExamples:[{description:"Basic let binding:",code:`; Simple parallel binding
(let ((x 5)
      (y 10))
  (+ x y))`,explanation:"The let form creates local variables with specific values. Here, x is bound to 5 and y to 10, and then we compute x + y, which is 15."},{description:"Limitation of let (parallel evaluation):",code:`; This will cause an error
; (let ((x 5)
;       (y (* x 2)))
;   (+ x y))

; Instead, we can do:
(define x 5)
(let ((y (* x 2)))
  (+ x y))`,explanation:"In let, all bindings are evaluated before any of them are available. We can't reference earlier bindings within the binding list. The commented code would fail because x isn't defined when computing y. The alternative defines x globally first."},{description:"Using let* for sequential binding:",code:`; Sequential binding with let*
(let* ((x 5)
       (y (* x 2))
       (z (+ x y)))
  z)`,explanation:"The let* form evaluates bindings in sequence, making earlier bindings available to later ones. Here, x is bound to 5, then y to 10 (5Ã—2), and z to 15 (5+10). The result is 15."},{description:"Equivalent nested lets:",code:`; Equivalent to the previous let*
(let ((x 5))
  (let ((y (* x 2)))
    (let ((z (+ x y)))
      z)))`,explanation:"This shows how let* works internally. It's equivalent to nested let forms, where each new binding is made inside the scope of the previous ones."},{description:"Using letrec for recursive definitions:",code:`; Creating mutually recursive functions
(letrec ((even? (lambda (n)
                  (if (zero? n)
                      #t
                      (odd? (- n 1)))))
         (odd? (lambda (n)
                 (if (zero? n)
                     #f
                     (even? (- n 1))))))
  (even? 4))`,explanation:"The letrec form allows bindings to reference each other, which is essential for mutually recursive functions. Here, even? calls odd? and vice versa. This determines that 4 is even by recursively checking if 0 is even (which it is by definition)."}],difficulty:"Intermediate"}]},{id:"advanced",title:"Advanced Concepts",description:"Explore powerful features of the Scheme language",sections:[{id:"macros",title:"Macros and Syntax Rules",content:["Macros are one of Scheme's most powerful features, allowing you to extend the language by creating new syntactic forms. Unlike functions, macros operate on code before it's evaluated, enabling transformations that would be impossible with functions alone.","The define-syntax and syntax-rules forms provide a pattern-based system for defining macros. Patterns specify what the macro matches, and templates specify how to transform the code."],codeExamples:[{description:"Defining a simple when macro:",code:`; Define the when macro
(define-syntax when
  (syntax-rules ()
    ((when condition body ...)
     (if condition
         (begin body ...)))))`,explanation:"This defines a when macro that executes a series of expressions only if a condition is true. The syntax-rules specify that when takes a condition followed by any number of body expressions, and transforms this into an if with a begin for the body."},{description:"Using the when macro:",code:`; Using our when macro
(when (> 5 3)
  (display "5 is greater than 3")
  (newline))`,explanation:"This uses our when macro with the condition (> 5 3) and two body expressions. Since 5 is greater than 3, both expressions will execute, displaying the text and a newline."},{description:"Defining a cond macro:",code:`; Define a simplified cond macro
(define-syntax cond
  (syntax-rules (else)
    ((cond) #f)  ; No clauses
    ((cond (else result1 result2 ...))
     (begin result1 result2 ...))
    ((cond (test result1 result2 ...) clause ...)
     (if test
         (begin result1 result2 ...)
         (cond clause ...)))))`,explanation:'This defines a cond macro for multi-way conditionals. It handles three cases: empty cond (returns #f), an else clause (executes its body), and a test clause (converts to an if-then-else where the "else" recursively processes remaining clauses).'},{description:"Using the cond macro:",code:`; Using our cond macro
(define x 5)
(cond
  ((< x 0) "negative")
  ((> x 0) "positive")
  (else "zero"))`,explanation:'This uses our cond macro to check if x is negative, positive, or zero. Since x is 5, the second clause matches, so it returns "positive".'},{description:"Implementing let* with macros:",code:`; Implementing let* as a macro
(define-syntax let*
  (syntax-rules ()
    ((let* () body ...)
     (begin body ...))
    ((let* ((name value)) body ...)
     (let ((name value))
       body ...))
    ((let* ((name1 value1) (name2 value2) rest ...) body ...)
     (let ((name1 value1))
       (let* ((name2 value2) rest ...)
         body ...)))))`,explanation:"This implements let* as a macro that transforms nested bindings into nested let expressions. It handles three cases: empty bindings (just execute the body), one binding (use a simple let), and multiple bindings (use a let for the first binding and recursively process the rest)."},{description:"Using our let* implementation:",code:`; Try our let* implementation
(let* ((a 5)
       (b (+ a 2))
       (c (* a b)))
  (+ a b c))`,explanation:"This uses our let* implementation to create three variables: a=5, b=7 (5+2), and c=35 (5Ã—7). Then it computes a+b+c, which is 5+7+35=47."},{description:"Implementing letrec with macros:",code:`; Implementing letrec as a macro
(define-syntax letrec
  (syntax-rules ()
    ((letrec ((var val) ...) body ...)
     ((lambda ()
        ; First create uninitialized variables
        (define var #f) ...
        ; Then assign them their values
        (set! var val) ...
        ; Finally, execute the body
        body ...)))))`,explanation:"This implements letrec as a macro using a lambda and define/set! combination. It first creates all variables with dummy values (#f), then sets their actual values, allowing recursive references."},{description:"Using our letrec implementation:",code:`; Using our letrec implementation
(letrec ((is-even? (lambda (n)
                    (if (zero? n)
                        #t
                        (is-odd? (- n 1)))))
         (is-odd? (lambda (n)
                   (if (zero? n)
                       #f
                       (is-even? (- n 1))))))
  (is-even? 6))`,explanation:"This uses our letrec implementation to define mutually recursive functions is-even? and is-odd?. Then it calls is-even? with 6, which recursively checks if 5 is odd, 4 is even, etc., eventually returning #t."}],difficulty:"Advanced"},{id:"recursion",title:"Recursion Patterns",content:"Scheme excels at recursive solutions due to its proper tail call optimization. This section covers common recursion patterns and techniques for efficient recursive algorithms.",codeExamples:[{description:"Defining a recursive factorial function:",code:`; Recursive factorial function
(define factorial
  (lambda (n)
    (if (<= n 1)
        1
        (* n (factorial (- n 1))))))`,explanation:"This defines a recursive function to compute the factorial of a number. If n is 0 or 1, it returns 1; otherwise, it multiplies n by the factorial of (n-1)."},{description:"Computing factorial of 5:",code:`; Calculate 5!
(factorial 5)`,explanation:"This calls our factorial function with the argument 5. It computes 5Ã—4Ã—3Ã—2Ã—1=120."},{description:"Recursive list length:",code:`; Recursive function to find list length
(define (my-length lst)
  (if (null? lst)
      0
      (+ 1 (my-length (cdr lst)))))`,explanation:"This defines a recursive function to compute the length of a list. If the list is empty, the length is 0; otherwise, it's 1 plus the length of the list's cdr (rest)."},{description:"Using the list length function:",code:`; Find length of a list
(my-length '(a b c d))`,explanation:"This calls our my-length function on a list with 4 elements. The function returns 4."}],difficulty:"Intermediate"},{id:"tail-recursion",title:"Tail Recursion Optimization",content:["Tail recursion is a special case of recursion where the recursive call is the last operation in a function. Scheme implementations are required to optimize tail-recursive calls, turning them into iterations that don't grow the call stack.","This optimization allows writing elegant recursive algorithms that are also efficient, even for large inputs or deep recursion levels. Understanding and applying tail recursion is crucial for writing efficient recursive code in Scheme."],codeExamples:[{description:"Standard recursive factorial (not tail-recursive):",code:`; Standard recursive factorial
(define (factorial n)
  (if (<= n 1)
      1
      (* n (factorial (- n 1)))))`,explanation:"This is a standard recursive factorial function. The recursive call is not in tail position because after (factorial (- n 1)) returns, there's still a multiplication to perform. This means the call stack grows with n."},{description:"Tail-recursive factorial implementation:",code:`; Tail-recursive factorial
(define (factorial-tail n)
  (define (fact-iter n acc)
    (if (<= n 1)
        acc
        (fact-iter (- n 1) (* n acc))))
  (fact-iter n 1))`,explanation:"This is a tail-recursive factorial. It uses a helper function that carries an accumulator. Since the recursive call is the last operation, Scheme optimizes it to use constant stack space regardless of n."},{description:"Using the tail-recursive factorial:",code:`; Calculate 5! using tail recursion
(factorial-tail 5)`,explanation:"This calls our tail-recursive factorial function with argument 5. It computes 5! = 120, just like the standard version, but more efficiently for large inputs."},{description:"Standard recursive sum (not tail-recursive):",code:`; Recursive sum (not tail-recursive)
(define (sum-list lst)
  (if (null? lst)
      0
      (+ (car lst) (sum-list (cdr lst)))))`,explanation:"This is a standard recursive function to sum a list. Like the standard factorial, it's not tail-recursive because there's an addition to perform after the recursive call returns."},{description:"Testing the recursive sum:",code:`; Test the recursive sum
(sum-list '(1 2 3 4 5))`,explanation:"This calls our sum-list function on a list of numbers. It computes 1+2+3+4+5=15."},{description:"Tail-recursive sum implementation:",code:`; Tail-recursive sum
(define (sum-list-tail lst)
  (define (sum-iter lst acc)
    (if (null? lst)
        acc
        (sum-iter (cdr lst) (+ (car lst) acc))))
  (sum-iter lst 0))`,explanation:"This is a tail-recursive sum function. Like the tail-recursive factorial, it uses an accumulator to carry the partial sum, making the recursive call the last operation."},{description:"Testing the tail-recursive sum:",code:`; Test the tail-recursive sum
(sum-list-tail '(1 2 3 4 5))`,explanation:"This calls our tail-recursive sum function. It computes the same result (15) as the standard version, but can handle very large lists without stack overflow."}],difficulty:"Intermediate"},{id:"continuations",title:"Continuations",content:['Continuations represent "the rest of the computation" at a given point in a program. Scheme provides first-class continuations through the call-with-current-continuation (call/cc) procedure.',"This powerful feature enables advanced control flow patterns like non-local exits, exception handling, coroutines, and even backtracking algorithms. Continuations are one of the most powerful and unique features of Scheme."],codeExamples:[{description:"Simple single-list for-each procedure:",code:`;; A simpler version of for-each for a single list.
(define (simple-for-each proc lst)
  (if (not (null? lst)) ; Check if the list is not empty
      (begin
        (proc (car lst)) ; Apply proc to the first element
        (simple-for-each proc (cdr lst))))) ; Recurse on the rest of the list
`,explanation:"This is a simplified version of for-each that only handles a single list. It applies the procedure `proc` to each element for its side effect and stops when the list is empty. It's suitable for cases like the `find-first` example where multi-list capability isn't needed."},{description:"Early return with call/cc:",code:`(define (find-first pred lst)
  (call/cc
   (lambda (return)
     (simple-for-each
      (lambda (x)
        (if (pred x)
            (return x)))
      lst)
     #f)))`,explanation:'This function uses call/cc to create an early-return mechanism. The continuation "return" captures the current execution state. When an element satisfying the predicate is found, the continuation is called with that element, immediately jumping out of the for-each loop and returning the value. If no element matches, #f is returned as a default value.'},{description:"Using the find-first function:",code:`; Find first even number
(find-first even? '(1 3 5 6 7 8 9))`,explanation:"This calls our find-first function with the even? predicate and a list of numbers. It searches through the list (1 3 5 6 7 8 9) and returns 6, the first even number it encounters. The early-return mechanism avoids unnecessary iteration through the rest of the list."},{description:"Implementing division with error handling:",code:`; Safe division with continuations
(define (divide a b)
  (call/cc
   (lambda (k)
     (if (= b 0)
         (k '(error "Division by zero"))
         (k \`(ok ,(/ a b)))))))`,explanation:'This function implements safe division using continuations for error handling. The continuation k is used to return early with an error message if b is zero. Otherwise, it returns a list containing the symbol "ok" and the result of the division. This pattern allows for structured error returns without using exceptions.'},{description:"Creating a function to handle the result:",code:`; Function to process the result
(define (handle-result result)
  (if (eq? (car result) 'error)
      (cadr result)
      (cadr result)))`,explanation:'This function processes the result returned by the divide function. It checks if the first element of the result list is the symbol "error". In either case, it returns the second element of the list, which is either the error message or the division result. Note that this implementation would typically have different behavior for error vs. success cases.'},{description:"Testing successful division:",code:`; Successful division
(handle-result (divide 10 2))`,explanation:"This tests the divide function with valid inputs 10 and 2. The divide function returns (ok 5), and handle-result extracts and returns 5."},{description:"Testing division by zero:",code:`; Division by zero
(handle-result (divide 10 0))`,explanation:'This tests the divide function with inputs that would cause division by zero. The divide function returns (error "Division by zero"), and handle-result extracts and returns the error message "Division by zero" instead of causing a runtime error.'}],difficulty:"Advanced"},{id:"vectors",title:"Vectors",content:["Vectors are another important data structure in Scheme. Unlike lists, vectors allow constant-time access to any element by index. They are useful when random access is needed or when dealing with large amounts of data.","Vectors are written with the #(...) syntax and provide operations for creation, access, and modification."],codeExamples:[{description:"Creating a vector:",code:`; Create a vector
(define v #(1 2 3 4 5))
v`,explanation:"This creates a vector with five elements and assigns it to the variable v. Vectors in Scheme use the #(...) literal syntax, which is different from the list syntax. When v is evaluated on the third line, it displays the vector as #(1 2 3 4 5)."},{description:"Finding vector length:",code:`; Get the number of elements
(vector-length v)`,explanation:"The vector-length function returns the number of elements in a vector. For our vector v with elements (1 2 3 4 5), this returns 5. Unlike lists where finding the length requires traversing the entire list, vector length is stored directly and can be accessed in constant time."},{description:"Accessing a vector element:",code:`; Access element at index 2
(vector-ref v 2)`,explanation:"The vector-ref function retrieves an element from a vector at a specified index. Indices in Scheme start at 0, so vector-ref v 2 returns the third element of v, which is 3. This is a constant-time operation, unlike list access which may require traversing the list."},{description:"Creating a vector programmatically:",code:`; Create a vector with initial value 0
(define v2 (make-vector 5 0))
v2`,explanation:"The make-vector function creates a new vector of a specified length with all elements initialized to a given value. This creates a vector of length 5 with each element set to 0, so v2 is #(0 0 0 0 0). This is useful when you need a vector of a specific size but don't know the values yet."},{description:"Modifying a vector element:",code:`; Change element at index 2 to 42
(vector-set! v2 2 42)
v2`,explanation:"The vector-set! function changes an element in a vector at a specified index. The ! in the name indicates that this function modifies its argument. After setting the element at index 2 to 42, v2 becomes #(0 0 42 0 0). Unlike lists, vectors can be efficiently modified in-place without creating a new copy."},{description:"Converting list to vector:",code:`; Convert a list to a vector
(list->vector '(a b c d))`,explanation:"The list->vector function creates a new vector containing the elements of a list. This converts the list (a b c d) to a vector #(a b c d). This conversion is useful when you need faster random access to elements or when using functions that require vectors as input."},{description:"Converting vector to list:",code:`; Convert a vector to a list
(vector->list #(a b c d))`,explanation:"The vector->list function creates a new list containing the elements of a vector. This converts the vector #(a b c d) to a list (a b c d). This conversion is useful when you need to use list-specific functions or when working with code that expects lists as input."}],difficulty:"Intermediate"}]},{id:"practical-examples",title:"Practical Scheme Examples",description:"Apply Scheme concepts to solve real-world problems",sections:[{id:"data-processing",title:"Data Processing",content:["Data processing is a common task in programming. Scheme's powerful list processing capabilities make it well-suited for manipulating and analyzing structured data.","In this section, we'll see how to use Scheme to process collections of data, perform aggregations, and transform data from one form to another."],codeExamples:[{description:"Defining some sample data:",code:`; Student records: (name score major)
(define students
  '((Alice 95 Computer-Science)
    (Bob 87 Mathematics)
    (Charlie 92 Physics)
    (Diana 97 Computer-Science)
    (Eva 85 Mathematics)))`,explanation:"We define a list of student records, where each record is a list containing a name, score, and major. This represents a typical dataset we might want to process."},{description:"Extracting specific data:",code:`; Get all student names
(define (get-names students)
  (map car students))

(get-names students)`,explanation:"This function uses map with car to extract the first element (name) from each student record. When applied to our dataset, it returns (Alice Bob Charlie Diana Eva)."},{description:"Filtering data:",code:`; Filter Computer Science students
(define (cs-students students)
  (filter (lambda (student)
            (eq? (caddr student) 'Computer-Science))
          students))

(cs-students students)`,explanation:"This function uses filter with a predicate that checks if the third element (major) of each student record is Computer-Science. It returns just the records for Alice and Diana."},{description:"Calculating averages:",code:`; Calculate average score
(define (average-score students)
  (let ((scores (map cadr students)))
    (/ (apply + scores) (length scores))))

(average-score students)`,explanation:"This function calculates the average score of all students. It extracts the scores using map with cadr, then divides the sum (computed with apply +) by the number of scores. For our dataset, it returns 91.2."},{description:"Grouping data:",code:`; Group students by major
(define (group-by-major students)
  (let ((majors (remove-duplicates (map caddr students))))
    (map (lambda (major)
           (cons major
                 (filter (lambda (student)
                           (eq? (caddr student) major))
                         students)))
         majors)))

; Helper function to remove duplicates
(define (remove-duplicates lst)
  (cond ((null? lst) '())
        ((member (car lst) (cdr lst))
         (remove-duplicates (cdr lst)))
        (else (cons (car lst)
                    (remove-duplicates (cdr lst))))))`,explanation:"This function groups students by their major. It first extracts all unique majors, then for each major, creates a pair with the major and a list of all students in that major. The result is a list of major-students pairs."},{description:"Sorting data:",code:`; Sort students by score (descending)
(define (sort-by-score students)
  (sort students
        (lambda (a b) (> (cadr a) (cadr b)))))

(sort-by-score students)`,explanation:"This function sorts the students by their scores in descending order. It uses the sort procedure with a comparison function that compares the second element (score) of each student record."}],difficulty:"Intermediate"},{id:"functional-algorithms",title:"Functional Algorithms",content:["Functional programming excels at expressing algorithms in a clear, concise manner. Scheme's functional nature makes it an excellent language for implementing classic algorithms.","In this section, we'll implement several common algorithms using Scheme's functional programming features, demonstrating how complex operations can be expressed elegantly."],codeExamples:[{description:"Fibonacci sequence (recursive):",code:`; Recursive Fibonacci implementation
(define (fib n)
  (cond ((= n 0) 0)
        ((= n 1) 1)
        (else (+ (fib (- n 1))
                 (fib (- n 2))))))

(fib 10)`,explanation:"This is a classic recursive implementation of the Fibonacci sequence. It directly follows the mathematical definition: fib(n) = fib(n-1) + fib(n-2) with base cases fib(0) = 0 and fib(1) = 1. While elegant, this implementation is inefficient for large n due to repeated calculations."},{description:"Fibonacci sequence (tail-recursive):",code:`; Tail-recursive Fibonacci
(define (fib-tail n)
  (define (fib-iter a b count)
    (if (= count 0)
        a
        (fib-iter b (+ a b) (- count 1))))
  (fib-iter 0 1 n))

(fib-tail 10)`,explanation:"This is an efficient tail-recursive implementation of Fibonacci. It uses an iterative approach with an accumulator pattern, tracking two consecutive Fibonacci numbers at each step. This version uses constant stack space and is much more efficient."},{description:"QuickSort algorithm:",code:`; QuickSort implementation
(define (quicksort lst)
  (if (or (null? lst) (null? (cdr lst)))
      lst
      (let ((pivot (car lst))
            (rest (cdr lst)))
        (append (quicksort (filter (lambda (x) (< x pivot)) rest))
                (list pivot)
                (quicksort (filter (lambda (x) (>= x pivot)) rest))))))

(quicksort '(3 1 4 1 5 9 2 6 5))`,explanation:"This implements the QuickSort algorithm in a functional style. It picks the first element as a pivot, partitions the remaining elements into those less than and greater than or equal to the pivot, recursively sorts each partition, and combines the results. The result for our input is (1 1 2 3 4 5 5 6 9)."},{description:"Binary search:",code:`; Binary search in a sorted list
(define (binary-search lst item)
  (define (search low high)
    (if (> low high)
        #f  ; Not found
        (let* ((mid (quotient (+ low high) 2))
               (mid-val (list-ref lst mid)))
          (cond ((= mid-val item) mid)  ; Found, return index
                ((< mid-val item) (search (+ mid 1) high))
                (else (search low (- mid 1)))))))
  (search 0 (- (length lst) 1)))

(binary-search '(1 3 5 7 9 11 13) 7)`,explanation:"This implements binary search, an efficient algorithm for finding an item in a sorted list. It repeatedly divides the search range in half, eliminating half of the remaining elements at each step. If the item is found, it returns its index; otherwise, it returns #f. For our example, it returns 3 (the index of 7)."},{description:"Merge sort:",code:`; Merge sort implementation
(define (merge-sort lst)
  (define (merge lst1 lst2)
    (cond ((null? lst1) lst2)
          ((null? lst2) lst1)
          ((< (car lst1) (car lst2))
           (cons (car lst1) (merge (cdr lst1) lst2)))
          (else
           (cons (car lst2) (merge lst1 (cdr lst2))))))
  
  (define (split lst)
    (if (or (null? lst) (null? (cdr lst)))
        (values lst '())
        (let-values (((first-half second-half)
                      (split (cddr lst))))
          (values (cons (car lst) first-half)
                  (cons (cadr lst) second-half)))))
  
  (if (or (null? lst) (null? (cdr lst)))
      lst
      (let-values (((first-half second-half) (split lst)))
        (merge (merge-sort first-half)
               (merge-sort second-half)))))

(merge-sort '(3 1 4 1 5 9 2 6 5))`,explanation:"This implements the merge sort algorithm. It recursively splits the list into two halves, sorts each half, and then merges the sorted halves. The merge operation takes two sorted lists and combines them into a single sorted list. Merge sort has better worst-case performance than quicksort and is stable, meaning it preserves the relative order of equal elements."}],difficulty:"Advanced"},{id:"building-dsl",title:"Building Domain-Specific Languages",content:["One of Scheme's strengths is its ability to extend the language through macros, making it ideal for creating domain-specific languages (DSLs). DSLs are specialized languages designed for a particular application domain.","By building a DSL, you can create abstractions that match the concepts in your problem domain, making your code more readable and maintainable. Scheme's macro system enables powerful DSL construction."],codeExamples:[{description:"A simple query language:",code:`; Define a simple SQL-like query language
(define-syntax select
  (syntax-rules (from where)
    ((select fields from table where condition)
     (map fields (filter condition table)))
    ((select fields from table)
     (map fields table))))

; Sample data
(define people
  '((name "Alice" age 30 city "New York")
    (name "Bob" age 25 city "Boston")
    (name "Charlie" age 35 city "New York")
    (name "Diana" age 28 city "Boston")))

; Use our DSL
(select (lambda (p) (list (cadr p) (cadddr p)))
        from people
        where (lambda (p) (> (cadddr p) 27)))`,explanation:"This example creates a simple SQL-like DSL for querying data. The select macro takes field selectors, a data source, and an optional condition. It transforms these into appropriate map and filter operations. In this example, we select the name and age of people older than 27, resulting in a list of (name age) pairs."},{description:"A DSL for mathematical expressions:",code:`; Define a mathematics DSL
(define-syntax sum
  (syntax-rules (to)
    ((sum var from start to end expr)
     (let loop ((var start) (result 0))
       (if (> var end)
           result
           (loop (+ var 1) (+ result expr)))))))

; Calculate the sum of squares from 1 to 5
(sum i from 1 to 5 (* i i))`,explanation:"This example creates a DSL for mathematical summations. The sum macro takes a variable, a range, and an expression to evaluate for each value in the range. It transforms this high-level notation into an efficient iterative computation. In this example, we calculate the sum of squares from 1 to 5, which is 1Â²+2Â²+3Â²+4Â²+5Â² = 55."},{description:"A DSL for pattern matching:",code:`
(define-syntax match
  (syntax-rules (else)
    ((match value
       (pattern1 expr1)
       (pattern2 expr2) ...)
     (let ((val value))
       (cond
        ((equal? val pattern1) expr1)
        ((equal? val pattern2) expr2) ...)))
    ((match value
       (pattern1 expr1)
       (pattern2 expr2) ...
       (else default-expr))
     (let ((val value))
       (cond
        ((equal? val pattern1) expr1)
        ((equal? val pattern2) expr2) ...
        (else default-expr))))))

(define fruit "apple")
(display
  (match fruit
    ("banana" "Yellow and sweet")
    ("orange" "Round and citrusy")
    ("apple" "Crisp and juicy")
    ("grape" "Small and grows in bunches")))

`,explanation:"This example creates a DSL for pattern matching, a common feature in functional languages. The match macro takes a value and a series of pattern-expression pairs, matching the value against each pattern in turn. This allows for clear, declarative code. We use it to implement factorial with explicit base cases, then call it with the value 5 to calculate 5! = 120."},{description:"A DSL for data validation:",code:`
(define-syntax validate
  (syntax-rules (is length > < number string)
    ((validate value is number)
     (number? value))
    ((validate value is string)
     (string? value))
    
    ;; Length comparison rules
    ((validate value length > min)
     (cond
       ((string? value) (> (string-length value) min))
       ((list? value) (> (length value) min))
       ((vector? value) (> (vector-length value) min))
       (else #f)))
    ((validate value length < max)
     (cond
       ((string? value) (< (string-length value) max))
       ((list? value) (< (length value) max))
       ((vector? value) (< (vector-length value) max))
       (else #f)))))

(define data "test")
(display (and (validate data is string)
              (validate data length > 2)
              (validate data length < 10)))

                        `,explanation:"This example creates a DSL for data validation. The validate macro provides a readable syntax for common validation tasks. It transforms these high-level descriptions into the appropriate Scheme predicates. In this example, we check if data is a string between 3 and 9 characters long."}],difficulty:"Advanced"}]},{id:"loop-constructs",title:"Loop Constructs",description:"Explore various looping mechanisms and iteration patterns in Scheme",sections:[{id:"basic-loops",title:"Basic Looping Constructs",content:["While Scheme is primarily a functional language that encourages recursion, looping constructs can make certain algorithmic patterns more readable and intuitive. Scheme's macro system allows us to define custom loop constructs that provide convenient syntactic forms for common iteration patterns.","In this section, we'll explore basic looping constructs like while, until, and do-while, which mirror similar constructs in other programming languages but with Scheme's distinctive syntax and semantics."],codeExamples:[{description:"The while loop:",code:`; Define a counter
(define counter 1)

; Count from 1 to 5 using while
(while (<= counter 5)
  (display counter)
  (display " ")
  (set! counter (+ counter 1)))`,explanation:"The while macro repeatedly executes its body as long as the condition remains true. Here we count from 1 to 5, displaying each number. Behind the scenes, this is implemented as a named let loop that conditionally recurses."},{description:"The until loop:",code:`; Define a counter
(define counter 1)

; Count from 1 to 5 using until
(until (> counter 5)
  (display counter)
  (display " ")
  (set! counter (+ counter 1)))`,explanation:"The until macro is the logical complement of while - it continues looping as long as the condition is false. This example produces the same output as the while example, but the termination condition is inverted."},{description:"The do-while loop:",code:`; Define a counter
(define counter 6)

; Try to count from 6 to 5 (impossible, but body executes once)
(do-while (< counter 5)
  (display counter)
  (display " ")
  (set! counter (+ counter 1)))`,explanation:'The do-while macro guarantees that its body executes at least once, even if the condition is false initially. In this example, even though counter is already 6 (which exceeds our limit of 5), the body still executes once, displaying "6 ".'},{description:"Implementing a simple loop:",code:`; Compute factorial using a while loop
(define (factorial n)
  (let ((result 1)
        (i 1))
    (while (<= i n)
      (set! result (* result i))
      (set! i (+ i 1)))
    result))

(factorial 5)`,explanation:"This example implements the factorial function using a while loop instead of recursion. We initialize result to 1 and i to 1, then multiply result by i for each value from 1 to n. The factorial of 5 is 120."}],difficulty:"Beginner"},{id:"list-iteration",title:"Iterating Over Lists",content:["Scheme excels at list processing, and its functional nature provides elegant ways to operate on lists. However, sometimes a more imperative style of iteration can be clearer, especially for those coming from other programming paradigms.","In this section, we'll explore macros that provide convenient syntax for iterating over lists, including for loops with various configurations and specialized iterators that expose element indices."],codeExamples:[{description:"The for loop:",code:`
; Simple list of numbers
(define numbers '(1 2 3 4 5))

; Square each number using for
(for x in numbers
  (* x x))`,explanation:"The for macro provides a simple way to iterate over a list. Here we square each number in the list. Note that for is implemented using map, so it returns a new list containing the results of applying the body expression to each element. The result is (1 4 9 16 25)."},{description:"Alternative for syntax:",code:`
; Using the alternative "as" syntax
(for numbers as x
  (* x x))`,explanation:'The for macro supports an alternative syntax where the list comes first, followed by "as" and the element variable. This can be more readable in some cases, especially with complex list expressions. The result is the same: (1 4 9 16 25).'},{description:"The for-each-with-index macro:",code:`
; Print each element with its index
(for-each-with-index (element index) in '(a b c d e)
  (display "Element at index ")
  (display index)
  (display ": ")
  (display element)
  (newline))`,explanation:"The for-each-with-index macro iterates over a list, providing both the current element and its index for each iteration. Unlike for, it does not collect return values, making it suitable for side effects like displaying output."},{description:"Processing list elements:",code:`
; Find the sum and product of a list
(define (sum-and-product numbers)
  (let ((sum 0)
        (product 1))
    (for-each-with-index (num _) in numbers
      (set! sum (+ sum num))
      (set! product (* product num)))
    (list sum product)))

(sum-and-product '(1 2 3 4 5))`,explanation:"This example uses for-each-with-index to calculate both the sum and product of a list of numbers. We use _ as a placeholder for the index since we don't need it. The result is (15 120), representing the sum and product of 1 through 5."}],difficulty:"Beginner"},{id:"numeric-iteration",title:"Numeric Iteration Patterns",content:["Many algorithms involve iterating over ranges of numbers. While this can be done with basic loops and manual counters, dedicated numeric iteration constructs make the code more concise and readable.","This section covers various forms of numeric iteration, including range-based loops, repeat loops for fixed-count iteration, and loops with custom step sizes."],codeExamples:[{description:"The repeat macro:",code:`;Display "Hello" 3 times
(repeat 3
  (display "Hello")
  (newline))`,explanation:`The repeat macro executes its body a fixed number of times. It's useful when you need to perform an operation repeatedly without needing a loop variable. Here, it displays "Hello" three times.`},{description:"The for-range macro:",code:`; Display numbers from 1 to 5
(for-range i 1 5
  (display i)
  (display " "))`,explanation:"The for-range macro provides a convenient way to iterate over a range of numbers. It takes a variable name, starting value, and ending value (inclusive). This example displays the numbers 1 through 5."},{description:"The iterate macro with custom step:",code:`;Display even numbers from 2 to 10
(iterate i from 2 to 10 by 2
  (display i)
  (display " "))`,explanation:"The iterate macro extends for-range by adding the ability to specify a custom step size. This example counts by 2s, displaying only even numbers from 2 to 10."},{description:"Computing a sum using for-range:",code:`; Calculate the sum of numbers from 1 to 10
(define (sum-range from to)
  (let ((result 0))
    (for-range i from to
      (set! result (+ result i)))
    result))

(sum-range 1 10)`,explanation:"This example uses for-range to calculate the sum of integers from 1 to 10. We initialize result to 0, then add each number in the range to it. The sum of 1 to 10 is 55."}],difficulty:"Beginner"},{id:"nested-loops",title:"Nested and Advanced Loop Patterns",content:["Many algorithms require nested loops or more complex iteration patterns. Scheme's macro system allows us to create specialized constructs that express these patterns clearly and concisely.","This section explores nested loops, fold-like accumulation patterns, and pattern-matching based control flow that combines selection and iteration."],codeExamples:[{description:"The nested-loop macro:",code:`; Print a multiplication table from 1Ã—1 to 3Ã—3
(nested-loop (outer i 1 3)
             (inner j 1 3)
  (display i)
  (display "Ã—")
  (display j)
  (display "=")
  (display (* i j))
  (newline))`,explanation:"The nested-loop macro provides a clean syntax for nested iterations, which are common in many algorithms. This example generates a small multiplication table, with the outer loop iterating over values for i and the inner loop iterating over values for j."},{description:"The fold-loop pattern:",code:`; Calculate the sum of a list using fold-loop
(define numbers '(1 2 3 4 5))

(fold-loop sum init 0 in numbers
  (+ sum element))`,explanation:"The fold-loop macro combines iteration with accumulation, similar to a fold/reduce operation. It maintains an accumulator that is updated at each step based on the current element. This example calculates the sum of a list of numbers, starting with an initial value of 0."},{description:"Implementing a custom loop macro:",code:`; Define a countdown macro
(define-syntax countdown
  (syntax-rules (from to)
    ((countdown var from start to end body ...)
     (let loop ((var start))
       (when (>= var end)
         body ...
         (loop (- var 1)))))))

; Use the countdown macro
(countdown i from 5 to 1
  (display i)
  (display " "))`,explanation:'This example shows how to implement a custom countdown macro that counts downward instead of upward. Like for-range, it uses a named let, but it decreases the loop variable and continues as long as it remains greater than or equal to the end value. This displays "5 4 3 2 1 ".'},{description:"Building a matrix with nested loops:",code:`; Create a 3Ã—3 identity matrix
(define (make-identity-matrix size)
  (let ((matrix (make-vector size)))
    (for-range i 0 (- size 1)
      (vector-set! matrix i (make-vector size 0)))
    (for-range i 0 (- size 1)
      (vector-set! (vector-ref matrix i) i 1))
    matrix))

; Display a matrix
(define (display-matrix matrix)
  (let ((size (vector-length matrix)))
    (for-range i 0 (- size 1)
      (for-range j 0 (- size 1)
        (display (vector-ref (vector-ref matrix i) j))
        (display " "))
      (newline))))

(define identity-3 (make-identity-matrix 3))
(display-matrix identity-3)`,explanation:"This example uses nested for-range loops to create and display a 3Ã—3 identity matrix (a matrix with 1s on the diagonal and 0s elsewhere). The make-identity-matrix function first creates a vector of vectors filled with zeros, then sets the diagonal elements to 1. The display-matrix function uses nested loops to print the matrix rows."}],difficulty:"Intermediate"},{id:"loop-implementation",title:"Implementing Loop Constructs",content:["Understanding how loop constructs are implemented as macros provides insight into Scheme's macro system and helps you create your own control structures. Most loops in Scheme are built on top of recursion, leveraging Scheme's tail-call optimization.","This section examines the implementation of various loop macros, showing how they transform high-level loop syntax into recursive procedures."],codeExamples:[{description:"Implementation of the while macro:",code:`; Definition of the while macro
(define-syntax while
  (syntax-rules ()
    ((while condition body ...)
     (let loop ()
       (if condition
           (begin
             body ...
             (loop))
           #f)))))`,explanation:"The while macro transforms its high-level loop syntax into a named let expression that implements a tail-recursive loop. If the condition is true, it executes the body expressions and then recurses by calling loop again. If the condition is false, it returns #f (though the return value is typically ignored)."},{description:"Implementation of the for macro:",code:`; Definition of the for macro
(define-syntax for
  (syntax-rules (in as)
    ((for element in list body ...)
     (map (lambda (element)
            body ...)
          list))
    ((for list as element body ...)
     (for element in list body ...))))`,explanation:'The for macro uses map to apply a lambda function to each element in a list. The lambda takes the element variable as its parameter and executes the body expressions. The macro supports two syntax forms: "for element in list" and "for list as element". Unlike imperative for loops, this is a functional construct that returns a new list of results.'},{description:"Implementation of the for-range macro:",code:`; Definition of the for-range macro
(define-syntax for-range
  (syntax-rules ()
    ((for-range var from to body ...)
     (let loop ((var from))
       (when (<= var to)
         body ...
         (loop (+ var 1)))))))`,explanation:"The for-range macro also uses a named let to create a recursive loop, but it manages the loop variable explicitly. It initializes var to the starting value, executes the body as long as var is less than or equal to the ending value, and increments var before each recursive call."},{description:"Implementing a custom loop macro:",code:`; Define a countdown macro
(define-syntax countdown
  (syntax-rules (from to)
    ((countdown var from start to end body ...)
     (let loop ((var start))
       (when (>= var end)
         body ...
         (loop (- var 1)))))))

; Use the countdown macro
(countdown i from 5 to 1
  (display i)
  (display " "))`,explanation:'This example shows how to implement a custom countdown macro that counts downward instead of upward. Like for-range, it uses a named let, but it decreases the loop variable and continues as long as it remains greater than or equal to the end value. This displays "5 4 3 2 1 ".'},{description:"A more complex loop implementation:",code:`; Define a "times" macro that returns a list of results
(define-syntax times
  (syntax-rules (collect)
    ((times n collect expr)
     (let loop ((i 0) (results '()))
       (if (= i n)
           (reverse results)
           (loop (+ i 1) (cons expr results)))))))

; Use the times macro to create a list of squares
(times 5 collect (* i i))`,explanation:'This example implements a "times" macro that not only repeats an operation n times but also collects the results into a list. It maintains an accumulator called results which it builds in reverse order (for efficiency), then reverses at the end. This returns (0 1 4 9 16), the squares of 0 through 4.'}],difficulty:"Advanced"}]}];function _A(){const[n,e]=y.useState(ns[0]),[t,i]=y.useState(ns[0].sections[0]),[r,s]=y.useState(!1),[o,l]=y.useState(!1),[a,c]=y.useState({[ns[0].id]:!0}),h=y.useRef(null),u=lo(),f=async w=>{if(w&&h.current){h.current.setInput(w),h.current.writeInput(w),l(!0);try{const C=await d(w);h.current.writeOutput(C)}catch(C){h.current.writeOutput(`Error: ${C instanceof Error?C.message:String(C)}`)}h.current.clearInput()}},d=async w=>u.loading?"Loading JAWS interpreter...":u.error?`Interpreter error: ${u.error}`:u.evaluate(w),p=()=>{s(!r)},m=()=>{l(!o)},b=(w,C)=>{C.stopPropagation(),c(S=>({...S,[w]:!S[w]}))},x=w=>{i(w),window.innerWidth<768&&s(!1)},v=w=>{window.innerWidth<768&&r&&(w.target.closest('[data-sidebar="true"]')||s(!1))};return g.jsx("main",{className:"min-h-[calc(100vh-57px)] h-full",onClick:v,children:g.jsxs("div",{className:"h-full bg-gradient-to-br from-slate-900 to-blue-900 flex flex-col",children:[g.jsxs("div",{className:"flex border-b border-blue-700/30 bg-slate-900/80 p-4 items-center",children:[g.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>window.location.href="/Jaws",className:"text-white hover:bg-blue-800/30 mr-2",children:g.jsx(Qo,{className:"h-5 w-5"})}),g.jsxs("h1",{className:"text-xl font-semibold text-white flex items-center gap-2 flex-1",children:[g.jsx(Vt,{className:"h-5 w-5 text-cyan-400"}),"Learn Scheme"]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx(fe,{variant:"outline",size:"sm",onClick:m,className:"md:hidden text-white border-[#dd3f0c] bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 hover:text-white",children:o?"Hide Terminal":"Show Terminal"}),g.jsx(fe,{variant:"ghost",size:"icon",onClick:p,className:"md:hidden text-white hover:bg-blue-800/30",children:r?g.jsx(na,{className:"h-5 w-5"}):g.jsx(ta,{className:"h-5 w-5"})})]})]}),g.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[g.jsxs("div",{className:`${r?"block":"hidden"} md:block md:w-80 border-r border-blue-700/30 bg-blue-950 md:flex md:flex-col z-10 absolute md:relative inset-0 h-[calc(100vh)] md:h-full overflow-hidden`,"data-sidebar":"true",children:[g.jsx("div",{className:"p-3 border-b border-blue-700/30 bg-blue-950 flex-shrink-0",children:g.jsx("h2",{className:"text-lg font-semibold text-white",children:"Curriculum"})}),g.jsx("div",{className:"h-[calc(100%-57px)] md:flex-1 overflow-y-scroll md:overflow-y-auto scrollbar-thin scrollbar-thumb-blue-500/50 scrollbar-track-transparent",children:ns.map((w,C)=>g.jsxs("div",{className:"border-b border-blue-800/30 animate-fadeScale",style:{animationDelay:`${C*.1}s`},children:[g.jsx("div",{className:`w-full text-left p-4 transition-colors ${n.id===w.id?"bg-gradient-to-r from-blue-900 to-blue-800 text-white":"text-white hover:bg-blue-800/20"}`,children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("button",{onClick:()=>{e(w),x(w.sections[0]),c(S=>({...S,[w.id]:!0}))},className:"flex-1 text-left",children:[g.jsx("h3",{className:"font-medium text-current",children:w.title}),g.jsx("p",{className:"text-sm mt-1 text-current",children:w.description})]}),g.jsx("button",{onClick:S=>b(w.id,S),className:"ml-2 p-1 rounded-full hover:bg-blue-700/30 text-white transition-colors","aria-label":a[w.id]?"Collapse chapter":"Expand chapter",children:a[w.id]?g.jsx(ug,{className:"h-5 w-5"}):g.jsx(fg,{className:"h-5 w-5"})})]})}),a[w.id]&&g.jsx("div",{className:"bg-blue-900/30 border-t border-blue-700/30",children:w.sections.map(S=>g.jsxs("button",{onClick:()=>x(S),className:`w-full text-left p-3 pl-8 text-sm transition-colors flex items-center ${t.id===S.id?"bg-blue-800/30 text-white":"text-blue-100/70 hover:bg-blue-800/30 hover:text-white"}`,children:[t.id===S.id&&g.jsx(Vt,{className:"h-3.5 w-3.5 text-[#dd3f0c] mr-1.5 flex-shrink-0"}),g.jsx("span",{className:"text-current",children:S.title})]},S.id))})]},w.id))})]}),g.jsxs("div",{className:"flex-1 flex flex-col md:flex-row h-full overflow-hidden",children:[g.jsxs("div",{className:`${o?"hidden":"block"} md:block md:w-1/2 h-full overflow-y-auto p-4 md:p-8 bg-slate-900/70 animate-fadeSlideIn`,children:[g.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[g.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-white",children:t.title}),g.jsx($A,{difficulty:t.difficulty})]}),g.jsx("div",{className:"prose prose-invert max-w-none text-white",children:Array.isArray(t.content)?t.content.map((w,C)=>g.jsx("p",{className:"text-blue-100/90",children:w},C)):g.jsx("p",{className:"text-blue-100/90",children:t.content})}),t.codeExamples&&t.codeExamples.length>0&&g.jsx("div",{className:"mt-6 space-y-6",children:t.codeExamples.map((w,C)=>g.jsx("div",{className:"animate-fadeScale",style:{animationDelay:`${C*.1+.2}s`},children:g.jsxs(Us,{className:"bg-zinc-800/80 border-blue-700/30 overflow-hidden shadow-lg",children:[g.jsxs(fa,{className:"pb-2 text-left",children:[g.jsxs(da,{className:"tracking-tight text-lg font-semibold text-white flex items-center gap-2 justify-start",children:[g.jsx(Vt,{className:"h-4 w-4",style:{color:"#22d3ee"}}),w.description]}),g.jsx(pa,{className:"text-blue-100 mt-1 text-base",children:w.explanation})]}),g.jsxs(Gs,{className:"border-t border-blue-800/30 p-4",children:[g.jsx("div",{className:"font-mono text-sm text-blue-100 overflow-x-auto",children:g.jsx(ct,{text:w.code,type:"input"})}),g.jsx("div",{className:"mt-4 flex justify-end",children:g.jsxs(fe,{className:"bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white hover:-translate-y-1 transition-all duration-200 flex items-center gap-2 shadow-lg",onClick:()=>f(w.code),disabled:u.loading,children:[u.loading?"Loading...":"Run Example"," ",g.jsx(bs,{className:"h-4 w-4"})]})})]})]})},`code-${t.id}-${C}`))})]}),g.jsxs("div",{className:`${o?"flex flex-col":"hidden"} md:block md:w-1/2 h-full border-l border-blue-700/30 bg-zinc-900`,children:[g.jsx("div",{className:"p-2 border-b border-blue-700/30 md:hidden",children:g.jsxs(fe,{variant:"ghost",size:"sm",onClick:()=>l(!1),className:"text-white hover:bg-blue-800/30",children:[g.jsx(Qo,{className:"h-4 w-4 mr-1"})," Back to Content"]})}),u.loading?g.jsx("div",{className:"flex items-center justify-center h-full text-blue-300",children:g.jsx("p",{children:"Loading JAWS interpreter..."})}):u.error?g.jsx("div",{className:"flex items-center justify-center h-full text-red-400",children:g.jsxs("p",{children:["Error loading interpreter: ",u.error]})}):g.jsx(ic,{ref:h,onCommand:d,className:"h-full"})]})]})]})]})})}function VA(){return g.jsx(H0,{basename:"/Jaws",children:g.jsx(oA,{children:g.jsxs(m0,{children:[g.jsx(Cn,{path:"/",element:g.jsx(Cx,{})}),g.jsxs(Cn,{element:g.jsx(Ax,{}),children:[g.jsx(Cn,{path:"/compiler-explorer",element:g.jsx(WA,{})}),g.jsx(Cn,{path:"/editor",element:g.jsx(zA,{})}),g.jsx(Cn,{path:"/docs",element:g.jsx(HA,{})}),g.jsx(Cn,{path:"/learn",element:g.jsx(_A,{})})]})]})})})}Iu(document.getElementById("root")).render(g.jsx(y.StrictMode,{children:g.jsx(VA,{})}));
