import{b as Ym,r as S,j as g,g as Xm,a as Ru}from"./vendor-DrbvkEHX.js";import{S as Qm,G as ea,P as _t,M as Nu,X as Ou,A as ys,T as Zm,C as Lu,B as eg,U as tg,a as ta,b as ng,c as ig,d as rg,e as sg,E as og,L as Pu,f as Iu,g as Bu,R as lg,h as zu}from"./ui-Bvg4Igkl.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var ju,rc=Ym;ju=rc.createRoot,rc.hydrateRoot;var na={};Object.defineProperty(na,"__esModule",{value:!0});na.parse=pg;na.serialize=mg;const ag=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,cg=/^[\u0021-\u003A\u003C-\u007E]*$/,hg=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,ug=/^[\u0020-\u003A\u003D-\u007E]*$/,fg=Object.prototype.toString,dg=(()=>{const n=function(){};return n.prototype=Object.create(null),n})();function pg(n,e){const t=new dg,i=n.length;if(i<2)return t;const r=(e==null?void 0:e.decode)||gg;let s=0;do{const o=n.indexOf("=",s);if(o===-1)break;const l=n.indexOf(";",s),a=l===-1?i:l;if(o>a){s=n.lastIndexOf(";",o-1)+1;continue}const c=sc(n,s,o),h=oc(n,o,c),u=n.slice(c,h);if(t[u]===void 0){let f=sc(n,o+1,a),d=oc(n,a,f);const p=r(n.slice(f,d));t[u]=p}s=a+1}while(s<i);return t}function sc(n,e,t){do{const i=n.charCodeAt(e);if(i!==32&&i!==9)return e}while(++e<t);return t}function oc(n,e,t){for(;e>t;){const i=n.charCodeAt(--e);if(i!==32&&i!==9)return e+1}return t}function mg(n,e,t){const i=(t==null?void 0:t.encode)||encodeURIComponent;if(!ag.test(n))throw new TypeError(`argument name is invalid: ${n}`);const r=i(e);if(!cg.test(r))throw new TypeError(`argument val is invalid: ${e}`);let s=n+"="+r;if(!t)return s;if(t.maxAge!==void 0){if(!Number.isInteger(t.maxAge))throw new TypeError(`option maxAge is invalid: ${t.maxAge}`);s+="; Max-Age="+t.maxAge}if(t.domain){if(!hg.test(t.domain))throw new TypeError(`option domain is invalid: ${t.domain}`);s+="; Domain="+t.domain}if(t.path){if(!ug.test(t.path))throw new TypeError(`option path is invalid: ${t.path}`);s+="; Path="+t.path}if(t.expires){if(!bg(t.expires)||!Number.isFinite(t.expires.valueOf()))throw new TypeError(`option expires is invalid: ${t.expires}`);s+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(s+="; HttpOnly"),t.secure&&(s+="; Secure"),t.partitioned&&(s+="; Partitioned"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():void 0){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${t.priority}`)}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:case"strict":s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"none":s+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${t.sameSite}`)}return s}function gg(n){if(n.indexOf("%")===-1)return n;try{return decodeURIComponent(n)}catch{return n}}function bg(n){return fg.call(n)==="[object Date]"}/**
 * react-router v7.0.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var lc="popstate";function xg(n={}){function e(i,r){let{pathname:s,search:o,hash:l}=i.location;return Qo("",{pathname:s,search:o,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:rr(r)}return vg(e,t,null,n)}function Ae(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function yn(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function yg(){return Math.random().toString(36).substring(2,10)}function ac(n,e){return{usr:n.state,key:n.key,idx:e}}function Qo(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Mi(e):e,state:t,key:e&&e.key||i||yg()}}function rr({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Mi(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function vg(n,e,t,i={}){let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,l="POP",a=null,c=h();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function h(){return(o.state||{idx:null}).idx}function u(){l="POP";let m=h(),x=m==null?null:m-c;c=m,a&&a({action:l,location:b.location,delta:x})}function f(m,x){l="PUSH";let y=Qo(b.location,m,x);c=h()+1;let C=ac(y,c),M=b.createHref(y);try{o.pushState(C,"",M)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;r.location.assign(M)}s&&a&&a({action:l,location:b.location,delta:1})}function d(m,x){l="REPLACE";let y=Qo(b.location,m,x);c=h();let C=ac(y,c),M=b.createHref(y);o.replaceState(C,"",M),s&&a&&a({action:l,location:b.location,delta:0})}function p(m){let x=r.location.origin!=="null"?r.location.origin:r.location.href,y=typeof m=="string"?m:rr(m);return y=y.replace(/ $/,"%20"),Ae(x,`No window.location.(origin|href) available to create URL for href: ${y}`),new URL(y,x)}let b={get action(){return l},get location(){return n(r,o)},listen(m){if(a)throw new Error("A history only accepts one active listener");return r.addEventListener(lc,u),a=m,()=>{r.removeEventListener(lc,u),a=null}},createHref(m){return e(r,m)},createURL:p,encodeLocation(m){let x=p(m);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:d,go(m){return o.go(m)}};return b}function Hu(n,e,t="/"){return wg(n,e,t,!1)}function wg(n,e,t,i){let r=typeof e=="string"?Mi(e):e,s=fn(r.pathname||"/",t);if(s==null)return null;let o=Fu(n);Sg(o);let l=null;for(let a=0;l==null&&a<o.length;++a){let c=Lg(s);l=Ng(o[a],c,i)}return l}function Fu(n,e=[],t=[],i=""){let r=(s,o,l)=>{let a={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};a.relativePath.startsWith("/")&&(Ae(a.relativePath.startsWith(i),`Absolute route path "${a.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),a.relativePath=a.relativePath.slice(i.length));let c=qt([i,a.relativePath]),h=t.concat(a);s.children&&s.children.length>0&&(Ae(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),Fu(s.children,e,h,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:Dg(c,s.index),routesMeta:h})};return n.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))r(s,o);else for(let a of Wu(s.path))r(s,o,a)}),e}function Wu(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=Wu(i.join("/")),l=[];return l.push(...o.map(a=>a===""?s:[s,a].join("/"))),r&&l.push(...o),l.map(a=>n.startsWith("/")&&a===""?"/":a)}function Sg(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Rg(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var kg=/^:[\w-]+$/,Cg=3,Ag=2,Mg=1,Eg=10,Tg=-2,cc=n=>n==="*";function Dg(n,e){let t=n.split("/"),i=t.length;return t.some(cc)&&(i+=Tg),e&&(i+=Ag),t.filter(r=>!cc(r)).reduce((r,s)=>r+(kg.test(s)?Cg:s===""?Mg:Eg),i)}function Rg(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function Ng(n,e,t=!1){let{routesMeta:i}=n,r={},s="/",o=[];for(let l=0;l<i.length;++l){let a=i[l],c=l===i.length-1,h=s==="/"?e:e.slice(s.length)||"/",u=vs({path:a.relativePath,caseSensitive:a.caseSensitive,end:c},h),f=a.route;if(!u&&c&&t&&!i[i.length-1].route.index&&(u=vs({path:a.relativePath,caseSensitive:a.caseSensitive,end:!1},h)),!u)return null;Object.assign(r,u.params),o.push({params:r,pathname:qt([s,u.pathname]),pathnameBase:zg(qt([s,u.pathnameBase])),route:f}),u.pathnameBase!=="/"&&(s=qt([s,u.pathnameBase]))}return o}function vs(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=Og(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:i.reduce((c,{paramName:h,isOptional:u},f)=>{if(h==="*"){let p=l[f]||"";o=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const d=l[f];return u&&!d?c[h]=void 0:c[h]=(d||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:n}}function Og(n,e=!1,t=!0){yn(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,a)=>(i.push({paramName:l,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function Lg(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return yn(!1,`The URL path "${n}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function fn(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function Pg(n,e="/"){let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?Mi(n):n;return{pathname:t?t.startsWith("/")?t:Ig(t,e):e,search:jg(i),hash:Hg(r)}}function Ig(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function xo(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Bg(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Vu(n){let e=Bg(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function $u(n,e,t,i=!1){let r;typeof n=="string"?r=Mi(n):(r={...n},Ae(!r.pathname||!r.pathname.includes("?"),xo("?","pathname","search",r)),Ae(!r.pathname||!r.pathname.includes("#"),xo("#","pathname","hash",r)),Ae(!r.search||!r.search.includes("#"),xo("#","search","hash",r)));let s=n===""||r.pathname==="",o=s?"/":r.pathname,l;if(o==null)l=t;else{let u=e.length-1;if(!i&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),u-=1;r.pathname=f.join("/")}l=u>=0?e[u]:"/"}let a=Pg(r,l),c=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&t.endsWith("/");return!a.pathname.endsWith("/")&&(c||h)&&(a.pathname+="/"),a}var qt=n=>n.join("/").replace(/\/\/+/g,"/"),zg=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),jg=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Hg=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Fg(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var _u=["POST","PUT","PATCH","DELETE"];new Set(_u);var Wg=["GET",..._u];new Set(Wg);var Ei=S.createContext(null);Ei.displayName="DataRouter";var Us=S.createContext(null);Us.displayName="DataRouterState";var qu=S.createContext({isTransitioning:!1});qu.displayName="ViewTransition";var Vg=S.createContext(new Map);Vg.displayName="Fetchers";var $g=S.createContext(null);$g.displayName="Await";var Bt=S.createContext(null);Bt.displayName="Navigation";var Ar=S.createContext(null);Ar.displayName="Location";var zt=S.createContext({outlet:null,matches:[],isDataRoute:!1});zt.displayName="Route";var ia=S.createContext(null);ia.displayName="RouteError";function _g(n,{relative:e}={}){Ae(Mr(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=S.useContext(Bt),{hash:r,pathname:s,search:o}=Er(n,{relative:e}),l=s;return t!=="/"&&(l=s==="/"?t:qt([t,s])),i.createHref({pathname:l,search:o,hash:r})}function Mr(){return S.useContext(Ar)!=null}function Vn(){return Ae(Mr(),"useLocation() may be used only in the context of a <Router> component."),S.useContext(Ar).location}var Uu="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ku(n){S.useContext(Bt).static||S.useLayoutEffect(n)}function Ti(){let{isDataRoute:n}=S.useContext(zt);return n?s0():qg()}function qg(){Ae(Mr(),"useNavigate() may be used only in the context of a <Router> component.");let n=S.useContext(Ei),{basename:e,navigator:t}=S.useContext(Bt),{matches:i}=S.useContext(zt),{pathname:r}=Vn(),s=JSON.stringify(Vu(i)),o=S.useRef(!1);return Ku(()=>{o.current=!0}),S.useCallback((a,c={})=>{if(yn(o.current,Uu),!o.current)return;if(typeof a=="number"){t.go(a);return}let h=$u(a,JSON.parse(s),r,c.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:qt([e,h.pathname])),(c.replace?t.replace:t.push)(h,c.state,c)},[e,t,s,r,n])}var Ug=S.createContext(null);function Kg(n){let e=S.useContext(zt).outlet;return e&&S.createElement(Ug.Provider,{value:n},e)}function Er(n,{relative:e}={}){let{matches:t}=S.useContext(zt),{pathname:i}=Vn(),r=JSON.stringify(Vu(t));return S.useMemo(()=>$u(n,JSON.parse(r),i,e==="path"),[n,r,i,e])}function Gg(n,e){return Gu(n,e)}function Gu(n,e,t,i){var b;Ae(Mr(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=S.useContext(Bt),{matches:s}=S.useContext(zt),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let a=o?o.pathnameBase:"/";o&&o.route;let c=Vn(),h;if(e){let m=typeof e=="string"?Mi(e):e;Ae(a==="/"||((b=m.pathname)==null?void 0:b.startsWith(a)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${a}" but pathname "${m.pathname}" was given in the \`location\` prop.`),h=m}else h=c;let u=h.pathname||"/",f=u;if(a!=="/"){let m=a.replace(/^\//,"").split("/");f="/"+u.replace(/^\//,"").split("/").slice(m.length).join("/")}let d=Hu(n,{pathname:f}),p=Zg(d&&d.map(m=>Object.assign({},m,{params:Object.assign({},l,m.params),pathname:qt([a,r.encodeLocation?r.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?a:qt([a,r.encodeLocation?r.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),s,t,i);return e&&p?S.createElement(Ar.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},p):p}function Jg(){let n=r0(),e=Fg(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),t?S.createElement("pre",{style:r},t):null,null)}var Yg=S.createElement(Jg,null),Xg=class extends S.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?S.createElement(zt.Provider,{value:this.props.routeContext},S.createElement(ia.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Qg({routeContext:n,match:e,children:t}){let i=S.useContext(Ei);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),S.createElement(zt.Provider,{value:n},t)}function Zg(n,e=[],t=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let r=n,s=t==null?void 0:t.errors;if(s!=null){let a=r.findIndex(c=>c.route.id&&(s==null?void 0:s[c.route.id])!==void 0);Ae(a>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),r=r.slice(0,Math.min(r.length,a+1))}let o=!1,l=-1;if(t)for(let a=0;a<r.length;a++){let c=r[a];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(l=a),c.route.id){let{loaderData:h,errors:u}=t,f=c.route.loader&&!h.hasOwnProperty(c.route.id)&&(!u||u[c.route.id]===void 0);if(c.route.lazy||f){o=!0,l>=0?r=r.slice(0,l+1):r=[r[0]];break}}}return r.reduceRight((a,c,h)=>{let u,f=!1,d=null,p=null;t&&(u=s&&c.route.id?s[c.route.id]:void 0,d=c.route.errorElement||Yg,o&&(l<0&&h===0?(o0("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,p=null):l===h&&(f=!0,p=c.route.hydrateFallbackElement||null)));let b=e.concat(r.slice(0,h+1)),m=()=>{let x;return u?x=d:f?x=p:c.route.Component?x=S.createElement(c.route.Component,null):c.route.element?x=c.route.element:x=a,S.createElement(Qg,{match:c,routeContext:{outlet:a,matches:b,isDataRoute:t!=null},children:x})};return t&&(c.route.ErrorBoundary||c.route.errorElement||h===0)?S.createElement(Xg,{location:t.location,revalidation:t.revalidation,component:d,error:u,children:m(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):m()},null)}function ra(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function e0(n){let e=S.useContext(Ei);return Ae(e,ra(n)),e}function t0(n){let e=S.useContext(Us);return Ae(e,ra(n)),e}function n0(n){let e=S.useContext(zt);return Ae(e,ra(n)),e}function sa(n){let e=n0(n),t=e.matches[e.matches.length-1];return Ae(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function i0(){return sa("useRouteId")}function r0(){var i;let n=S.useContext(ia),e=t0("useRouteError"),t=sa("useRouteError");return n!==void 0?n:(i=e.errors)==null?void 0:i[t]}function s0(){let{router:n}=e0("useNavigate"),e=sa("useNavigate"),t=S.useRef(!1);return Ku(()=>{t.current=!0}),S.useCallback(async(r,s={})=>{yn(t.current,Uu),t.current&&(typeof r=="number"?n.navigate(r):await n.navigate(r,{fromRouteId:e,...s}))},[n,e])}var hc={};function o0(n,e,t){hc[n]||(hc[n]=!0,yn(!1,t))}S.memo(l0);function l0({routes:n,future:e,state:t}){return Gu(n,void 0,t,e)}function a0(n){return Kg(n.context)}function An(n){Ae(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function c0({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:r,static:s=!1}){Ae(!Mr(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),l=S.useMemo(()=>({basename:o,navigator:r,static:s,future:{}}),[o,r,s]);typeof t=="string"&&(t=Mi(t));let{pathname:a="/",search:c="",hash:h="",state:u=null,key:f="default"}=t,d=S.useMemo(()=>{let p=fn(a,o);return p==null?null:{location:{pathname:p,search:c,hash:h,state:u,key:f},navigationType:i}},[o,a,c,h,u,f,i]);return yn(d!=null,`<Router basename="${o}"> is not able to match the URL "${a}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),d==null?null:S.createElement(Bt.Provider,{value:l},S.createElement(Ar.Provider,{children:e,value:d}))}function h0({children:n,location:e}){return Gg(Zo(n),e)}function Zo(n,e=[]){let t=[];return S.Children.forEach(n,(i,r)=>{if(!S.isValidElement(i))return;let s=[...e,r];if(i.type===S.Fragment){t.push.apply(t,Zo(i.props.children,s));return}Ae(i.type===An,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ae(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=Zo(i.props.children,s)),t.push(o)}),t}var ls="get",as="application/x-www-form-urlencoded";function Ks(n){return n!=null&&typeof n.tagName=="string"}function u0(n){return Ks(n)&&n.tagName.toLowerCase()==="button"}function f0(n){return Ks(n)&&n.tagName.toLowerCase()==="form"}function d0(n){return Ks(n)&&n.tagName.toLowerCase()==="input"}function p0(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function m0(n,e){return n.button===0&&(!e||e==="_self")&&!p0(n)}var Br=null;function g0(){if(Br===null)try{new FormData(document.createElement("form"),0),Br=!1}catch{Br=!0}return Br}var b0=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function yo(n){return n!=null&&!b0.has(n)?(yn(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${as}"`),null):n}function x0(n,e){let t,i,r,s,o;if(f0(n)){let l=n.getAttribute("action");i=l?fn(l,e):null,t=n.getAttribute("method")||ls,r=yo(n.getAttribute("enctype"))||as,s=new FormData(n)}else if(u0(n)||d0(n)&&(n.type==="submit"||n.type==="image")){let l=n.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let a=n.getAttribute("formaction")||l.getAttribute("action");if(i=a?fn(a,e):null,t=n.getAttribute("formmethod")||l.getAttribute("method")||ls,r=yo(n.getAttribute("formenctype"))||yo(l.getAttribute("enctype"))||as,s=new FormData(l,n),!g0()){let{name:c,type:h,value:u}=n;if(h==="image"){let f=c?`${c}.`:"";s.append(`${f}x`,"0"),s.append(`${f}y`,"0")}else c&&s.append(c,u)}}else{if(Ks(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=ls,i=null,r=as,o=n}return s&&r==="text/plain"&&(o=s,s=void 0),{action:i,method:t.toLowerCase(),encType:r,formData:s,body:o}}function oa(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function y0(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function v0(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function w0(n,e,t){let i=await Promise.all(n.map(async r=>{let s=e.routes[r.route.id];if(s){let o=await y0(s,t);return o.links?o.links():[]}return[]}));return A0(i.flat(1).filter(v0).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function uc(n,e,t,i,r,s){let o=(a,c)=>t[c]?a.route.id!==t[c].route.id:!0,l=(a,c)=>{var h;return t[c].pathname!==a.pathname||((h=t[c].route.path)==null?void 0:h.endsWith("*"))&&t[c].params["*"]!==a.params["*"]};return s==="assets"?e.filter((a,c)=>o(a,c)||l(a,c)):s==="data"?e.filter((a,c)=>{var u;let h=i.routes[a.route.id];if(!h||!h.hasLoader)return!1;if(o(a,c)||l(a,c))return!0;if(a.route.shouldRevalidate){let f=a.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((u=t[0])==null?void 0:u.params)||{},nextUrl:new URL(n,window.origin),nextParams:a.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function S0(n,e){return k0(n.map(t=>{let i=e.routes[t.route.id];if(!i)return[];let r=[i.module];return i.imports&&(r=r.concat(i.imports)),r}).flat(1))}function k0(n){return[...new Set(n)]}function C0(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function A0(n,e){let t=new Set;return new Set(e),n.reduce((i,r)=>{let s=JSON.stringify(C0(r));return t.has(s)||(t.add(s),i.push({key:s,link:r})),i},[])}function M0(n){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function E0(){let n=S.useContext(Ei);return oa(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function T0(){let n=S.useContext(Us);return oa(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var la=S.createContext(void 0);la.displayName="FrameworkContext";function Ju(){let n=S.useContext(la);return oa(n,"You must render this element inside a <HydratedRouter> element"),n}function D0(n,e){let t=S.useContext(la),[i,r]=S.useState(!1),[s,o]=S.useState(!1),{onFocus:l,onBlur:a,onMouseEnter:c,onMouseLeave:h,onTouchStart:u}=e,f=S.useRef(null);S.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let b=x=>{x.forEach(y=>{o(y.isIntersecting)})},m=new IntersectionObserver(b,{threshold:.5});return f.current&&m.observe(f.current),()=>{m.disconnect()}}},[n]),S.useEffect(()=>{if(i){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[i]);let d=()=>{r(!0)},p=()=>{r(!1),o(!1)};return t?n!=="intent"?[s,f,{}]:[s,f,{onFocus:Ii(l,d),onBlur:Ii(a,p),onMouseEnter:Ii(c,d),onMouseLeave:Ii(h,p),onTouchStart:Ii(u,d)}]:[!1,f,{}]}function Ii(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function R0({page:n,...e}){let{router:t}=E0(),i=S.useMemo(()=>Hu(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?S.createElement(O0,{page:n,matches:i,...e}):(console.warn(`Tried to prefetch ${n} but no routes matched.`),null)}function N0(n){let{manifest:e,routeModules:t}=Ju(),[i,r]=S.useState([]);return S.useEffect(()=>{let s=!1;return w0(n,e,t).then(o=>{s||r(o)}),()=>{s=!0}},[n,e,t]),i}function O0({page:n,matches:e,...t}){let i=Vn(),{manifest:r,routeModules:s}=Ju(),{loaderData:o,matches:l}=T0(),a=S.useMemo(()=>uc(n,e,l,r,i,"data"),[n,e,l,r,i]),c=S.useMemo(()=>uc(n,e,l,r,i,"assets"),[n,e,l,r,i]),h=S.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let d=new Set,p=!1;if(e.forEach(m=>{var y;let x=r.routes[m.route.id];!x||!x.hasLoader||(!a.some(C=>C.route.id===m.route.id)&&m.route.id in o&&((y=s[m.route.id])!=null&&y.shouldRevalidate)||x.hasClientLoader?p=!0:d.add(m.route.id))}),d.size===0)return[];let b=M0(n);return p&&d.size>0&&b.searchParams.set("_routes",e.filter(m=>d.has(m.route.id)).map(m=>m.route.id).join(",")),[b.pathname+b.search]},[o,i,r,a,e,n,s]),u=S.useMemo(()=>S0(c,r),[c,r]),f=N0(c);return S.createElement(S.Fragment,null,h.map(d=>S.createElement("link",{key:d,rel:"prefetch",as:"fetch",href:d,...t})),u.map(d=>S.createElement("link",{key:d,rel:"modulepreload",href:d,...t})),f.map(({key:d,link:p})=>S.createElement("link",{key:d,...p})))}function L0(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Yu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Yu&&(window.__reactRouterVersion="7.0.1")}catch{}function P0({basename:n,children:e,window:t}){let i=S.useRef();i.current==null&&(i.current=xg({window:t,v5Compat:!0}));let r=i.current,[s,o]=S.useState({action:r.action,location:r.location}),l=S.useCallback(a=>{S.startTransition(()=>o(a))},[o]);return S.useLayoutEffect(()=>r.listen(l),[r,l]),S.createElement(c0,{basename:n,children:e,location:s.location,navigationType:s.action,navigator:r})}var Xu=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pi=S.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:r,reloadDocument:s,replace:o,state:l,target:a,to:c,preventScrollReset:h,viewTransition:u,...f},d){let{basename:p}=S.useContext(Bt),b=typeof c=="string"&&Xu.test(c),m,x=!1;if(typeof c=="string"&&b&&(m=c,Yu))try{let R=new URL(window.location.href),W=c.startsWith("//")?new URL(R.protocol+c):new URL(c),H=fn(W.pathname,p);W.origin===R.origin&&H!=null?c=H+W.search+W.hash:x=!0}catch{yn(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=_g(c,{relative:r}),[C,M,w]=D0(i,f),A=z0(c,{replace:o,state:l,target:a,preventScrollReset:h,relative:r,viewTransition:u});function k(R){e&&e(R),R.defaultPrevented||A(R)}let L=S.createElement("a",{...f,...w,href:m||y,onClick:x||s?e:k,ref:L0(d,M),target:a,"data-discover":!b&&t==="render"?"true":void 0});return C&&!b?S.createElement(S.Fragment,null,L,S.createElement(R0,{page:y})):L});pi.displayName="Link";var Ie=S.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:r=!1,style:s,to:o,viewTransition:l,children:a,...c},h){let u=Er(o,{relative:c.relative}),f=Vn(),d=S.useContext(Us),{navigator:p,basename:b}=S.useContext(Bt),m=d!=null&&V0(u)&&l===!0,x=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,y=f.pathname,C=d&&d.navigation&&d.navigation.location?d.navigation.location.pathname:null;t||(y=y.toLowerCase(),C=C?C.toLowerCase():null,x=x.toLowerCase()),C&&b&&(C=fn(C,b)||C);const M=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let w=y===x||!r&&y.startsWith(x)&&y.charAt(M)==="/",A=C!=null&&(C===x||!r&&C.startsWith(x)&&C.charAt(x.length)==="/"),k={isActive:w,isPending:A,isTransitioning:m},L=w?e:void 0,R;typeof i=="function"?R=i(k):R=[i,w?"active":null,A?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let W=typeof s=="function"?s(k):s;return S.createElement(pi,{...c,"aria-current":L,className:R,ref:h,style:W,to:o,viewTransition:l},typeof a=="function"?a(k):a)});Ie.displayName="NavLink";var I0=S.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:r,state:s,method:o=ls,action:l,onSubmit:a,relative:c,preventScrollReset:h,viewTransition:u,...f},d)=>{let p=F0(),b=W0(l,{relative:c}),m=o.toLowerCase()==="get"?"get":"post",x=typeof l=="string"&&Xu.test(l),y=C=>{if(a&&a(C),C.defaultPrevented)return;C.preventDefault();let M=C.nativeEvent.submitter,w=(M==null?void 0:M.getAttribute("formmethod"))||o;p(M||C.currentTarget,{fetcherKey:e,method:w,navigate:t,replace:r,state:s,relative:c,preventScrollReset:h,viewTransition:u})};return S.createElement("form",{ref:d,method:m,action:b,onSubmit:i?a:y,...f,"data-discover":!x&&n==="render"?"true":void 0})});I0.displayName="Form";function B0(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Qu(n){let e=S.useContext(Ei);return Ae(e,B0(n)),e}function z0(n,{target:e,replace:t,state:i,preventScrollReset:r,relative:s,viewTransition:o}={}){let l=Ti(),a=Vn(),c=Er(n,{relative:s});return S.useCallback(h=>{if(m0(h,e)){h.preventDefault();let u=t!==void 0?t:rr(a)===rr(c);l(n,{replace:u,state:i,preventScrollReset:r,relative:s,viewTransition:o})}},[a,l,c,t,i,e,n,r,s,o])}var j0=0,H0=()=>`__${String(++j0)}__`;function F0(){let{router:n}=Qu("useSubmit"),{basename:e}=S.useContext(Bt),t=i0();return S.useCallback(async(i,r={})=>{let{action:s,method:o,encType:l,formData:a,body:c}=x0(i,e);if(r.navigate===!1){let h=r.fetcherKey||H0();await n.fetch(h,t,r.action||s,{preventScrollReset:r.preventScrollReset,formData:a,body:c,formMethod:r.method||o,formEncType:r.encType||l,flushSync:r.flushSync})}else await n.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:a,body:c,formMethod:r.method||o,formEncType:r.encType||l,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[n,e,t])}function W0(n,{relative:e}={}){let{basename:t}=S.useContext(Bt),i=S.useContext(zt);Ae(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),s={...Er(n||".",{relative:e})},o=Vn();if(n==null){s.search=o.search;let l=new URLSearchParams(s.search),a=l.getAll("index");if(a.some(h=>h==="")){l.delete("index"),a.filter(u=>u).forEach(u=>l.append("index",u));let h=l.toString();s.search=h?`?${h}`:""}}return(!n||n===".")&&r.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:qt([t,s.pathname])),rr(s)}function V0(n,e={}){let t=S.useContext(qu);Ae(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Qu("useViewTransitionState"),r=Er(n,{relative:e.relative});if(!t.isTransitioning)return!1;let s=fn(t.currentLocation.pathname,i)||t.currentLocation.pathname,o=fn(t.nextLocation.pathname,i)||t.nextLocation.pathname;return vs(r.pathname,o)!=null||vs(r.pathname,s)!=null}new TextEncoder;function Zu(n){var e,t,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(e=0;e<r;e++)n[e]&&(t=Zu(n[e]))&&(i&&(i+=" "),i+=t)}else for(t in n)n[t]&&(i&&(i+=" "),i+=t);return i}function ef(){for(var n,e,t=0,i="",r=arguments.length;t<r;t++)(n=arguments[t])&&(e=Zu(n))&&(i&&(i+=" "),i+=e);return i}const fc=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,dc=ef,$0=(n,e)=>t=>{var i;if((e==null?void 0:e.variants)==null)return dc(n,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:r,defaultVariants:s}=e,o=Object.keys(r).map(c=>{const h=t==null?void 0:t[c],u=s==null?void 0:s[c];if(h===null)return null;const f=fc(h)||fc(u);return r[c][f]}),l=t&&Object.entries(t).reduce((c,h)=>{let[u,f]=h;return f===void 0||(c[u]=f),c},{}),a=e==null||(i=e.compoundVariants)===null||i===void 0?void 0:i.reduce((c,h)=>{let{class:u,className:f,...d}=h;return Object.entries(d).every(p=>{let[b,m]=p;return Array.isArray(m)?m.includes({...s,...l}[b]):{...s,...l}[b]===m})?[...c,u,f]:c},[]);return dc(n,o,a,t==null?void 0:t.class,t==null?void 0:t.className)},aa="-",_0=n=>{const e=U0(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:i}=n;return{getClassGroupId:o=>{const l=o.split(aa);return l[0]===""&&l.length!==1&&l.shift(),tf(l,e)||q0(o)},getConflictingClassGroupIds:(o,l)=>{const a=t[o]||[];return l&&i[o]?[...a,...i[o]]:a}}},tf=(n,e)=>{var o;if(n.length===0)return e.classGroupId;const t=n[0],i=e.nextPart.get(t),r=i?tf(n.slice(1),i):void 0;if(r)return r;if(e.validators.length===0)return;const s=n.join(aa);return(o=e.validators.find(({validator:l})=>l(s)))==null?void 0:o.classGroupId},pc=/^\[(.+)\]$/,q0=n=>{if(pc.test(n)){const e=pc.exec(n)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},U0=n=>{const{theme:e,prefix:t}=n,i={nextPart:new Map,validators:[]};return G0(Object.entries(n.classGroups),t).forEach(([s,o])=>{el(o,i,s,e)}),i},el=(n,e,t,i)=>{n.forEach(r=>{if(typeof r=="string"){const s=r===""?e:mc(e,r);s.classGroupId=t;return}if(typeof r=="function"){if(K0(r)){el(r(i),e,t,i);return}e.validators.push({validator:r,classGroupId:t});return}Object.entries(r).forEach(([s,o])=>{el(o,mc(e,s),t,i)})})},mc=(n,e)=>{let t=n;return e.split(aa).forEach(i=>{t.nextPart.has(i)||t.nextPart.set(i,{nextPart:new Map,validators:[]}),t=t.nextPart.get(i)}),t},K0=n=>n.isThemeGetter,G0=(n,e)=>e?n.map(([t,i])=>{const r=i.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,l])=>[e+o,l])):s);return[t,r]}):n,J0=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,i=new Map;const r=(s,o)=>{t.set(s,o),e++,e>n&&(e=0,i=t,t=new Map)};return{get(s){let o=t.get(s);if(o!==void 0)return o;if((o=i.get(s))!==void 0)return r(s,o),o},set(s,o){t.has(s)?t.set(s,o):r(s,o)}}},nf="!",Y0=n=>{const{separator:e,experimentalParseClassName:t}=n,i=e.length===1,r=e[0],s=e.length,o=l=>{const a=[];let c=0,h=0,u;for(let m=0;m<l.length;m++){let x=l[m];if(c===0){if(x===r&&(i||l.slice(m,m+s)===e)){a.push(l.slice(h,m)),h=m+s;continue}if(x==="/"){u=m;continue}}x==="["?c++:x==="]"&&c--}const f=a.length===0?l:l.substring(h),d=f.startsWith(nf),p=d?f.substring(1):f,b=u&&u>h?u-h:void 0;return{modifiers:a,hasImportantModifier:d,baseClassName:p,maybePostfixModifierPosition:b}};return t?l=>t({className:l,parseClassName:o}):o},X0=n=>{if(n.length<=1)return n;const e=[];let t=[];return n.forEach(i=>{i[0]==="["?(e.push(...t.sort(),i),t=[]):t.push(i)}),e.push(...t.sort()),e},Q0=n=>({cache:J0(n.cacheSize),parseClassName:Y0(n),..._0(n)}),Z0=/\s+/,eb=(n,e)=>{const{parseClassName:t,getClassGroupId:i,getConflictingClassGroupIds:r}=e,s=[],o=n.trim().split(Z0);let l="";for(let a=o.length-1;a>=0;a-=1){const c=o[a],{modifiers:h,hasImportantModifier:u,baseClassName:f,maybePostfixModifierPosition:d}=t(c);let p=!!d,b=i(p?f.substring(0,d):f);if(!b){if(!p){l=c+(l.length>0?" "+l:l);continue}if(b=i(f),!b){l=c+(l.length>0?" "+l:l);continue}p=!1}const m=X0(h).join(":"),x=u?m+nf:m,y=x+b;if(s.includes(y))continue;s.push(y);const C=r(b,p);for(let M=0;M<C.length;++M){const w=C[M];s.push(x+w)}l=c+(l.length>0?" "+l:l)}return l};function tb(){let n=0,e,t,i="";for(;n<arguments.length;)(e=arguments[n++])&&(t=rf(e))&&(i&&(i+=" "),i+=t);return i}const rf=n=>{if(typeof n=="string")return n;let e,t="";for(let i=0;i<n.length;i++)n[i]&&(e=rf(n[i]))&&(t&&(t+=" "),t+=e);return t};function nb(n,...e){let t,i,r,s=o;function o(a){const c=e.reduce((h,u)=>u(h),n());return t=Q0(c),i=t.cache.get,r=t.cache.set,s=l,l(a)}function l(a){const c=i(a);if(c)return c;const h=eb(a,t);return r(a,h),h}return function(){return s(tb.apply(null,arguments))}}const xe=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},sf=/^\[(?:([a-z-]+):)?(.+)\]$/i,ib=/^\d+\/\d+$/,rb=new Set(["px","full","screen"]),sb=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ob=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,lb=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ab=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,cb=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Vt=n=>si(n)||rb.has(n)||ib.test(n),Xt=n=>Di(n,"length",bb),si=n=>!!n&&!Number.isNaN(Number(n)),vo=n=>Di(n,"number",si),Bi=n=>!!n&&Number.isInteger(Number(n)),hb=n=>n.endsWith("%")&&si(n.slice(0,-1)),ie=n=>sf.test(n),Qt=n=>sb.test(n),ub=new Set(["length","size","percentage"]),fb=n=>Di(n,ub,of),db=n=>Di(n,"position",of),pb=new Set(["image","url"]),mb=n=>Di(n,pb,yb),gb=n=>Di(n,"",xb),zi=()=>!0,Di=(n,e,t)=>{const i=sf.exec(n);return i?i[1]?typeof e=="string"?i[1]===e:e.has(i[1]):t(i[2]):!1},bb=n=>ob.test(n)&&!lb.test(n),of=()=>!1,xb=n=>ab.test(n),yb=n=>cb.test(n),vb=()=>{const n=xe("colors"),e=xe("spacing"),t=xe("blur"),i=xe("brightness"),r=xe("borderColor"),s=xe("borderRadius"),o=xe("borderSpacing"),l=xe("borderWidth"),a=xe("contrast"),c=xe("grayscale"),h=xe("hueRotate"),u=xe("invert"),f=xe("gap"),d=xe("gradientColorStops"),p=xe("gradientColorStopPositions"),b=xe("inset"),m=xe("margin"),x=xe("opacity"),y=xe("padding"),C=xe("saturate"),M=xe("scale"),w=xe("sepia"),A=xe("skew"),k=xe("space"),L=xe("translate"),R=()=>["auto","contain","none"],W=()=>["auto","hidden","clip","visible","scroll"],H=()=>["auto",ie,e],D=()=>[ie,e],X=()=>["",Vt,Xt],V=()=>["auto",si,ie],G=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Z=()=>["solid","dashed","dotted","double","none"],E=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],O=()=>["start","end","center","between","around","evenly","stretch"],j=()=>["","0",ie],Y=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ee=()=>[si,ie];return{cacheSize:500,separator:":",theme:{colors:[zi],spacing:[Vt,Xt],blur:["none","",Qt,ie],brightness:ee(),borderColor:[n],borderRadius:["none","","full",Qt,ie],borderSpacing:D(),borderWidth:X(),contrast:ee(),grayscale:j(),hueRotate:ee(),invert:j(),gap:D(),gradientColorStops:[n],gradientColorStopPositions:[hb,Xt],inset:H(),margin:H(),opacity:ee(),padding:D(),saturate:ee(),scale:ee(),sepia:j(),skew:ee(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",ie]}],container:["container"],columns:[{columns:[Qt]}],"break-after":[{"break-after":Y()}],"break-before":[{"break-before":Y()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...G(),ie]}],overflow:[{overflow:W()}],"overflow-x":[{"overflow-x":W()}],"overflow-y":[{"overflow-y":W()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Bi,ie]}],basis:[{basis:H()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ie]}],grow:[{grow:j()}],shrink:[{shrink:j()}],order:[{order:["first","last","none",Bi,ie]}],"grid-cols":[{"grid-cols":[zi]}],"col-start-end":[{col:["auto",{span:["full",Bi,ie]},ie]}],"col-start":[{"col-start":V()}],"col-end":[{"col-end":V()}],"grid-rows":[{"grid-rows":[zi]}],"row-start-end":[{row:["auto",{span:[Bi,ie]},ie]}],"row-start":[{"row-start":V()}],"row-end":[{"row-end":V()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ie]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ie]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...O()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...O(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...O(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ie,e]}],"min-w":[{"min-w":[ie,e,"min","max","fit"]}],"max-w":[{"max-w":[ie,e,"none","full","min","max","fit","prose",{screen:[Qt]},Qt]}],h:[{h:[ie,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ie,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ie,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ie,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Qt,Xt]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",vo]}],"font-family":[{font:[zi]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ie]}],"line-clamp":[{"line-clamp":["none",si,vo]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Vt,ie]}],"list-image":[{"list-image":["none",ie]}],"list-style-type":[{list:["none","disc","decimal",ie]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Vt,Xt]}],"underline-offset":[{"underline-offset":["auto",Vt,ie]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ie]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ie]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...G(),db]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",fb]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},mb]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[d]}],"gradient-via":[{via:[d]}],"gradient-to":[{to:[d]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...Z(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:Z()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...Z()]}],"outline-offset":[{"outline-offset":[Vt,ie]}],"outline-w":[{outline:[Vt,Xt]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:X()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Vt,Xt]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",Qt,gb]}],"shadow-color":[{shadow:[zi]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...E(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":E()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[i]}],contrast:[{contrast:[a]}],"drop-shadow":[{"drop-shadow":["","none",Qt,ie]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[u]}],saturate:[{saturate:[C]}],sepia:[{sepia:[w]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[a]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[C]}],"backdrop-sepia":[{"backdrop-sepia":[w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ie]}],duration:[{duration:ee()}],ease:[{ease:["linear","in","out","in-out",ie]}],delay:[{delay:ee()}],animate:[{animate:["none","spin","ping","pulse","bounce",ie]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[M]}],"scale-x":[{"scale-x":[M]}],"scale-y":[{"scale-y":[M]}],rotate:[{rotate:[Bi,ie]}],"translate-x":[{"translate-x":[L]}],"translate-y":[{"translate-y":[L]}],"skew-x":[{"skew-x":[A]}],"skew-y":[{"skew-y":[A]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ie]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ie]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ie]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[Vt,Xt,vo]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},wb=nb(vb);function xt(...n){return wb(ef(n))}const Sb=$0("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Te=S.forwardRef(({className:n,variant:e,size:t,asChild:i=!1,...r},s)=>{const o=i?Qm:"button";return g.jsx(o,{className:xt(Sb({variant:e,size:t,className:n})),ref:s,...r})});Te.displayName="Button";const Gs=S.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:xt("rounded-lg border bg-card text-card-foreground shadow-sm",n),...e}));Gs.displayName="Card";const ca=S.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:xt("flex flex-col space-y-1.5 p-6",n),...e}));ca.displayName="CardHeader";const ha=S.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:xt("text-2xl font-semibold leading-none tracking-tight",n),...e}));ha.displayName="CardTitle";const ua=S.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:xt("text-sm text-muted-foreground",n),...e}));ua.displayName="CardDescription";const Js=S.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:xt("p-6 pt-0",n),...e}));Js.displayName="CardContent";const kb=S.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:xt("flex items-center p-6 pt-0",n),...e}));kb.displayName="CardFooter";function lf(n){return n instanceof Map?n.clear=n.delete=n.set=function(){throw new Error("map is read-only")}:n instanceof Set&&(n.add=n.clear=n.delete=function(){throw new Error("set is read-only")}),Object.freeze(n),Object.getOwnPropertyNames(n).forEach(e=>{const t=n[e],i=typeof t;(i==="object"||i==="function")&&!Object.isFrozen(t)&&lf(t)}),n}class gc{constructor(e){e.data===void 0&&(e.data={}),this.data=e.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function af(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function sn(n,...e){const t=Object.create(null);for(const i in n)t[i]=n[i];return e.forEach(function(i){for(const r in i)t[r]=i[r]}),t}const Cb="</span>",bc=n=>!!n.scope,Ab=(n,{prefix:e})=>{if(n.startsWith("language:"))return n.replace("language:","language-");if(n.includes(".")){const t=n.split(".");return[`${e}${t.shift()}`,...t.map((i,r)=>`${i}${"_".repeat(r+1)}`)].join(" ")}return`${e}${n}`};class Mb{constructor(e,t){this.buffer="",this.classPrefix=t.classPrefix,e.walk(this)}addText(e){this.buffer+=af(e)}openNode(e){if(!bc(e))return;const t=Ab(e.scope,{prefix:this.classPrefix});this.span(t)}closeNode(e){bc(e)&&(this.buffer+=Cb)}value(){return this.buffer}span(e){this.buffer+=`<span class="${e}">`}}const xc=(n={})=>{const e={children:[]};return Object.assign(e,n),e};class fa{constructor(){this.rootNode=xc(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(e){this.top.children.push(e)}openNode(e){const t=xc({scope:e});this.add(t),this.stack.push(t)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(e){return this.constructor._walk(e,this.rootNode)}static _walk(e,t){return typeof t=="string"?e.addText(t):t.children&&(e.openNode(t),t.children.forEach(i=>this._walk(e,i)),e.closeNode(t)),e}static _collapse(e){typeof e!="string"&&e.children&&(e.children.every(t=>typeof t=="string")?e.children=[e.children.join("")]:e.children.forEach(t=>{fa._collapse(t)}))}}class Eb extends fa{constructor(e){super(),this.options=e}addText(e){e!==""&&this.add(e)}startScope(e){this.openNode(e)}endScope(){this.closeNode()}__addSublanguage(e,t){const i=e.root;t&&(i.scope=`language:${t}`),this.add(i)}toHTML(){return new Mb(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function sr(n){return n?typeof n=="string"?n:n.source:null}function cf(n){return $n("(?=",n,")")}function Tb(n){return $n("(?:",n,")*")}function Db(n){return $n("(?:",n,")?")}function $n(...n){return n.map(t=>sr(t)).join("")}function Rb(n){const e=n[n.length-1];return typeof e=="object"&&e.constructor===Object?(n.splice(n.length-1,1),e):{}}function da(...n){return"("+(Rb(n).capture?"":"?:")+n.map(i=>sr(i)).join("|")+")"}function hf(n){return new RegExp(n.toString()+"|").exec("").length-1}function Nb(n,e){const t=n&&n.exec(e);return t&&t.index===0}const Ob=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function pa(n,{joinWith:e}){let t=0;return n.map(i=>{t+=1;const r=t;let s=sr(i),o="";for(;s.length>0;){const l=Ob.exec(s);if(!l){o+=s;break}o+=s.substring(0,l.index),s=s.substring(l.index+l[0].length),l[0][0]==="\\"&&l[1]?o+="\\"+String(Number(l[1])+r):(o+=l[0],l[0]==="("&&t++)}return o}).map(i=>`(${i})`).join(e)}const Lb=/\b\B/,uf="[a-zA-Z]\\w*",ma="[a-zA-Z_]\\w*",ff="\\b\\d+(\\.\\d+)?",df="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",pf="\\b(0b[01]+)",Pb="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",Ib=(n={})=>{const e=/^#![ ]*\//;return n.binary&&(n.begin=$n(e,/.*\b/,n.binary,/\b.*/)),sn({scope:"meta",begin:e,end:/$/,relevance:0,"on:begin":(t,i)=>{t.index!==0&&i.ignoreMatch()}},n)},or={begin:"\\\\[\\s\\S]",relevance:0},Bb={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[or]},zb={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[or]},jb={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},Ys=function(n,e,t={}){const i=sn({scope:"comment",begin:n,end:e,contains:[]},t);i.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const r=da("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return i.contains.push({begin:$n(/[ ]+/,"(",r,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),i},Hb=Ys("//","$"),Fb=Ys("/\\*","\\*/"),Wb=Ys("#","$"),Vb={scope:"number",begin:ff,relevance:0},$b={scope:"number",begin:df,relevance:0},_b={scope:"number",begin:pf,relevance:0},qb={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[or,{begin:/\[/,end:/\]/,relevance:0,contains:[or]}]},Ub={scope:"title",begin:uf,relevance:0},Kb={scope:"title",begin:ma,relevance:0},Gb={begin:"\\.\\s*"+ma,relevance:0},Jb=function(n){return Object.assign(n,{"on:begin":(e,t)=>{t.data._beginMatch=e[1]},"on:end":(e,t)=>{t.data._beginMatch!==e[1]&&t.ignoreMatch()}})};var zr=Object.freeze({__proto__:null,APOS_STRING_MODE:Bb,BACKSLASH_ESCAPE:or,BINARY_NUMBER_MODE:_b,BINARY_NUMBER_RE:pf,COMMENT:Ys,C_BLOCK_COMMENT_MODE:Fb,C_LINE_COMMENT_MODE:Hb,C_NUMBER_MODE:$b,C_NUMBER_RE:df,END_SAME_AS_BEGIN:Jb,HASH_COMMENT_MODE:Wb,IDENT_RE:uf,MATCH_NOTHING_RE:Lb,METHOD_GUARD:Gb,NUMBER_MODE:Vb,NUMBER_RE:ff,PHRASAL_WORDS_MODE:jb,QUOTE_STRING_MODE:zb,REGEXP_MODE:qb,RE_STARTERS_RE:Pb,SHEBANG:Ib,TITLE_MODE:Ub,UNDERSCORE_IDENT_RE:ma,UNDERSCORE_TITLE_MODE:Kb});function Yb(n,e){n.input[n.index-1]==="."&&e.ignoreMatch()}function Xb(n,e){n.className!==void 0&&(n.scope=n.className,delete n.className)}function Qb(n,e){e&&n.beginKeywords&&(n.begin="\\b("+n.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",n.__beforeBegin=Yb,n.keywords=n.keywords||n.beginKeywords,delete n.beginKeywords,n.relevance===void 0&&(n.relevance=0))}function Zb(n,e){Array.isArray(n.illegal)&&(n.illegal=da(...n.illegal))}function ex(n,e){if(n.match){if(n.begin||n.end)throw new Error("begin & end are not supported with match");n.begin=n.match,delete n.match}}function tx(n,e){n.relevance===void 0&&(n.relevance=1)}const nx=(n,e)=>{if(!n.beforeMatch)return;if(n.starts)throw new Error("beforeMatch cannot be used with starts");const t=Object.assign({},n);Object.keys(n).forEach(i=>{delete n[i]}),n.keywords=t.keywords,n.begin=$n(t.beforeMatch,cf(t.begin)),n.starts={relevance:0,contains:[Object.assign(t,{endsParent:!0})]},n.relevance=0,delete t.beforeMatch},ix=["of","and","for","in","not","or","if","then","parent","list","value"],rx="keyword";function mf(n,e,t=rx){const i=Object.create(null);return typeof n=="string"?r(t,n.split(" ")):Array.isArray(n)?r(t,n):Object.keys(n).forEach(function(s){Object.assign(i,mf(n[s],e,s))}),i;function r(s,o){e&&(o=o.map(l=>l.toLowerCase())),o.forEach(function(l){const a=l.split("|");i[a[0]]=[s,sx(a[0],a[1])]})}}function sx(n,e){return e?Number(e):ox(n)?0:1}function ox(n){return ix.includes(n.toLowerCase())}const yc={},Nn=n=>{console.error(n)},vc=(n,...e)=>{console.log(`WARN: ${n}`,...e)},Un=(n,e)=>{yc[`${n}/${e}`]||(console.log(`Deprecated as of ${n}. ${e}`),yc[`${n}/${e}`]=!0)},ws=new Error;function gf(n,e,{key:t}){let i=0;const r=n[t],s={},o={};for(let l=1;l<=e.length;l++)o[l+i]=r[l],s[l+i]=!0,i+=hf(e[l-1]);n[t]=o,n[t]._emit=s,n[t]._multi=!0}function lx(n){if(Array.isArray(n.begin)){if(n.skip||n.excludeBegin||n.returnBegin)throw Nn("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),ws;if(typeof n.beginScope!="object"||n.beginScope===null)throw Nn("beginScope must be object"),ws;gf(n,n.begin,{key:"beginScope"}),n.begin=pa(n.begin,{joinWith:""})}}function ax(n){if(Array.isArray(n.end)){if(n.skip||n.excludeEnd||n.returnEnd)throw Nn("skip, excludeEnd, returnEnd not compatible with endScope: {}"),ws;if(typeof n.endScope!="object"||n.endScope===null)throw Nn("endScope must be object"),ws;gf(n,n.end,{key:"endScope"}),n.end=pa(n.end,{joinWith:""})}}function cx(n){n.scope&&typeof n.scope=="object"&&n.scope!==null&&(n.beginScope=n.scope,delete n.scope)}function hx(n){cx(n),typeof n.beginScope=="string"&&(n.beginScope={_wrap:n.beginScope}),typeof n.endScope=="string"&&(n.endScope={_wrap:n.endScope}),lx(n),ax(n)}function ux(n){function e(o,l){return new RegExp(sr(o),"m"+(n.case_insensitive?"i":"")+(n.unicodeRegex?"u":"")+(l?"g":""))}class t{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(l,a){a.position=this.position++,this.matchIndexes[this.matchAt]=a,this.regexes.push([a,l]),this.matchAt+=hf(l)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const l=this.regexes.map(a=>a[1]);this.matcherRe=e(pa(l,{joinWith:"|"}),!0),this.lastIndex=0}exec(l){this.matcherRe.lastIndex=this.lastIndex;const a=this.matcherRe.exec(l);if(!a)return null;const c=a.findIndex((u,f)=>f>0&&u!==void 0),h=this.matchIndexes[c];return a.splice(0,c),Object.assign(a,h)}}class i{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(l){if(this.multiRegexes[l])return this.multiRegexes[l];const a=new t;return this.rules.slice(l).forEach(([c,h])=>a.addRule(c,h)),a.compile(),this.multiRegexes[l]=a,a}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(l,a){this.rules.push([l,a]),a.type==="begin"&&this.count++}exec(l){const a=this.getMatcher(this.regexIndex);a.lastIndex=this.lastIndex;let c=a.exec(l);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const h=this.getMatcher(0);h.lastIndex=this.lastIndex+1,c=h.exec(l)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function r(o){const l=new i;return o.contains.forEach(a=>l.addRule(a.begin,{rule:a,type:"begin"})),o.terminatorEnd&&l.addRule(o.terminatorEnd,{type:"end"}),o.illegal&&l.addRule(o.illegal,{type:"illegal"}),l}function s(o,l){const a=o;if(o.isCompiled)return a;[Xb,ex,hx,nx].forEach(h=>h(o,l)),n.compilerExtensions.forEach(h=>h(o,l)),o.__beforeBegin=null,[Qb,Zb,tx].forEach(h=>h(o,l)),o.isCompiled=!0;let c=null;return typeof o.keywords=="object"&&o.keywords.$pattern&&(o.keywords=Object.assign({},o.keywords),c=o.keywords.$pattern,delete o.keywords.$pattern),c=c||/\w+/,o.keywords&&(o.keywords=mf(o.keywords,n.case_insensitive)),a.keywordPatternRe=e(c,!0),l&&(o.begin||(o.begin=/\B|\b/),a.beginRe=e(a.begin),!o.end&&!o.endsWithParent&&(o.end=/\B|\b/),o.end&&(a.endRe=e(a.end)),a.terminatorEnd=sr(a.end)||"",o.endsWithParent&&l.terminatorEnd&&(a.terminatorEnd+=(o.end?"|":"")+l.terminatorEnd)),o.illegal&&(a.illegalRe=e(o.illegal)),o.contains||(o.contains=[]),o.contains=[].concat(...o.contains.map(function(h){return fx(h==="self"?o:h)})),o.contains.forEach(function(h){s(h,a)}),o.starts&&s(o.starts,l),a.matcher=r(a),a}if(n.compilerExtensions||(n.compilerExtensions=[]),n.contains&&n.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return n.classNameAliases=sn(n.classNameAliases||{}),s(n)}function bf(n){return n?n.endsWithParent||bf(n.starts):!1}function fx(n){return n.variants&&!n.cachedVariants&&(n.cachedVariants=n.variants.map(function(e){return sn(n,{variants:null},e)})),n.cachedVariants?n.cachedVariants:bf(n)?sn(n,{starts:n.starts?sn(n.starts):null}):Object.isFrozen(n)?sn(n):n}var dx="11.10.0";class px extends Error{constructor(e,t){super(e),this.name="HTMLInjectionError",this.html=t}}const wo=af,wc=sn,Sc=Symbol("nomatch"),mx=7,xf=function(n){const e=Object.create(null),t=Object.create(null),i=[];let r=!0;const s="Could not find the language '{}', did you forget to load/include a language module?",o={disableAutodetect:!0,name:"Plain text",contains:[]};let l={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:Eb};function a(E){return l.noHighlightRe.test(E)}function c(E){let O=E.className+" ";O+=E.parentNode?E.parentNode.className:"";const j=l.languageDetectRe.exec(O);if(j){const Y=R(j[1]);return Y||(vc(s.replace("{}",j[1])),vc("Falling back to no-highlight mode for this block.",E)),Y?j[1]:"no-highlight"}return O.split(/\s+/).find(Y=>a(Y)||R(Y))}function h(E,O,j){let Y="",ee="";typeof O=="object"?(Y=E,j=O.ignoreIllegals,ee=O.language):(Un("10.7.0","highlight(lang, code, ...args) has been deprecated."),Un("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),ee=E,Y=O),j===void 0&&(j=!0);const ue={code:Y,language:ee};G("before:highlight",ue);const N=ue.result?ue.result:u(ue.language,ue.code,j);return N.code=ue.code,G("after:highlight",N),N}function u(E,O,j,Y){const ee=Object.create(null);function ue(I,_){return I.keywords[_]}function N(){if(!Q.keywords){ke.addText(de);return}let I=0;Q.keywordPatternRe.lastIndex=0;let _=Q.keywordPatternRe.exec(de),se="";for(;_;){se+=de.substring(I,_.index);const fe=Ge.case_insensitive?_[0].toLowerCase():_[0],_e=ue(Q,fe);if(_e){const[Wt,Gm]=_e;if(ke.addText(se),se="",ee[fe]=(ee[fe]||0)+1,ee[fe]<=mx&&(qn+=Gm),Wt.startsWith("_"))se+=_[0];else{const Jm=Ge.classNameAliases[Wt]||Wt;q(_[0],Jm)}}else se+=_[0];I=Q.keywordPatternRe.lastIndex,_=Q.keywordPatternRe.exec(de)}se+=de.substring(I),ke.addText(se)}function K(){if(de==="")return;let I=null;if(typeof Q.subLanguage=="string"){if(!e[Q.subLanguage]){ke.addText(de);return}I=u(Q.subLanguage,de,!0,Ir[Q.subLanguage]),Ir[Q.subLanguage]=I._top}else I=d(de,Q.subLanguage.length?Q.subLanguage:null);Q.relevance>0&&(qn+=I.relevance),ke.__addSublanguage(I._emitter,I.language)}function $(){Q.subLanguage!=null?K():N(),de=""}function q(I,_){I!==""&&(ke.startScope(_),ke.addText(I),ke.endScope())}function J(I,_){let se=1;const fe=_.length-1;for(;se<=fe;){if(!I._emit[se]){se++;continue}const _e=Ge.classNameAliases[I[se]]||I[se],Wt=_[se];_e?q(Wt,_e):(de=Wt,N(),de=""),se++}}function le(I,_){return I.scope&&typeof I.scope=="string"&&ke.openNode(Ge.classNameAliases[I.scope]||I.scope),I.beginScope&&(I.beginScope._wrap?(q(de,Ge.classNameAliases[I.beginScope._wrap]||I.beginScope._wrap),de=""):I.beginScope._multi&&(J(I.beginScope,_),de="")),Q=Object.create(I,{parent:{value:Q}}),Q}function ge(I,_,se){let fe=Nb(I.endRe,se);if(fe){if(I["on:end"]){const _e=new gc(I);I["on:end"](_,_e),_e.isMatchIgnored&&(fe=!1)}if(fe){for(;I.endsParent&&I.parent;)I=I.parent;return I}}if(I.endsWithParent)return ge(I.parent,_,se)}function Me(I){return Q.matcher.regexIndex===0?(de+=I[0],1):(bo=!0,0)}function ht(I){const _=I[0],se=I.rule,fe=new gc(se),_e=[se.__beforeBegin,se["on:begin"]];for(const Wt of _e)if(Wt&&(Wt(I,fe),fe.isMatchIgnored))return Me(_);return se.skip?de+=_:(se.excludeBegin&&(de+=_),$(),!se.returnBegin&&!se.excludeBegin&&(de=_)),le(se,I),se.returnBegin?0:_.length}function ut(I){const _=I[0],se=O.substring(I.index),fe=ge(Q,I,se);if(!fe)return Sc;const _e=Q;Q.endScope&&Q.endScope._wrap?($(),q(_,Q.endScope._wrap)):Q.endScope&&Q.endScope._multi?($(),J(Q.endScope,I)):_e.skip?de+=_:(_e.returnEnd||_e.excludeEnd||(de+=_),$(),_e.excludeEnd&&(de=_));do Q.scope&&ke.closeNode(),!Q.skip&&!Q.subLanguage&&(qn+=Q.relevance),Q=Q.parent;while(Q!==fe.parent);return fe.starts&&le(fe.starts,I),_e.returnEnd?0:_.length}function we(){const I=[];for(let _=Q;_!==Ge;_=_.parent)_.scope&&I.unshift(_.scope);I.forEach(_=>ke.openNode(_))}let $e={};function Yt(I,_){const se=_&&_[0];if(de+=I,se==null)return $(),0;if($e.type==="begin"&&_.type==="end"&&$e.index===_.index&&se===""){if(de+=O.slice(_.index,_.index+1),!r){const fe=new Error(`0 width match regex (${E})`);throw fe.languageName=E,fe.badRule=$e.rule,fe}return 1}if($e=_,_.type==="begin")return ht(_);if(_.type==="illegal"&&!j){const fe=new Error('Illegal lexeme "'+se+'" for mode "'+(Q.scope||"<unnamed>")+'"');throw fe.mode=Q,fe}else if(_.type==="end"){const fe=ut(_);if(fe!==Sc)return fe}if(_.type==="illegal"&&se==="")return 1;if(go>1e5&&go>_.index*3)throw new Error("potential infinite loop, way more iterations than matches");return de+=se,se.length}const Ge=R(E);if(!Ge)throw Nn(s.replace("{}",E)),new Error('Unknown language: "'+E+'"');const Pi=ux(Ge);let Le="",Q=Y||Pi;const Ir={},ke=new l.__emitter(l);we();let de="",qn=0,wn=0,go=0,bo=!1;try{if(Ge.__emitTokens)Ge.__emitTokens(O,ke);else{for(Q.matcher.considerAll();;){go++,bo?bo=!1:Q.matcher.considerAll(),Q.matcher.lastIndex=wn;const I=Q.matcher.exec(O);if(!I)break;const _=O.substring(wn,I.index),se=Yt(_,I);wn=I.index+se}Yt(O.substring(wn))}return ke.finalize(),Le=ke.toHTML(),{language:E,value:Le,relevance:qn,illegal:!1,_emitter:ke,_top:Q}}catch(I){if(I.message&&I.message.includes("Illegal"))return{language:E,value:wo(O),illegal:!0,relevance:0,_illegalBy:{message:I.message,index:wn,context:O.slice(wn-100,wn+100),mode:I.mode,resultSoFar:Le},_emitter:ke};if(r)return{language:E,value:wo(O),illegal:!1,relevance:0,errorRaised:I,_emitter:ke,_top:Q};throw I}}function f(E){const O={value:wo(E),illegal:!1,relevance:0,_top:o,_emitter:new l.__emitter(l)};return O._emitter.addText(E),O}function d(E,O){O=O||l.languages||Object.keys(e);const j=f(E),Y=O.filter(R).filter(H).map($=>u($,E,!1));Y.unshift(j);const ee=Y.sort(($,q)=>{if($.relevance!==q.relevance)return q.relevance-$.relevance;if($.language&&q.language){if(R($.language).supersetOf===q.language)return 1;if(R(q.language).supersetOf===$.language)return-1}return 0}),[ue,N]=ee,K=ue;return K.secondBest=N,K}function p(E,O,j){const Y=O&&t[O]||j;E.classList.add("hljs"),E.classList.add(`language-${Y}`)}function b(E){let O=null;const j=c(E);if(a(j))return;if(G("before:highlightElement",{el:E,language:j}),E.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",E);return}if(E.children.length>0&&(l.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(E)),l.throwUnescapedHTML))throw new px("One of your code blocks includes unescaped HTML.",E.innerHTML);O=E;const Y=O.textContent,ee=j?h(Y,{language:j,ignoreIllegals:!0}):d(Y);E.innerHTML=ee.value,E.dataset.highlighted="yes",p(E,j,ee.language),E.result={language:ee.language,re:ee.relevance,relevance:ee.relevance},ee.secondBest&&(E.secondBest={language:ee.secondBest.language,relevance:ee.secondBest.relevance}),G("after:highlightElement",{el:E,result:ee,text:Y})}function m(E){l=wc(l,E)}const x=()=>{M(),Un("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function y(){M(),Un("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let C=!1;function M(){if(document.readyState==="loading"){C=!0;return}document.querySelectorAll(l.cssSelector).forEach(b)}function w(){C&&M()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",w,!1);function A(E,O){let j=null;try{j=O(n)}catch(Y){if(Nn("Language definition for '{}' could not be registered.".replace("{}",E)),r)Nn(Y);else throw Y;j=o}j.name||(j.name=E),e[E]=j,j.rawDefinition=O.bind(null,n),j.aliases&&W(j.aliases,{languageName:E})}function k(E){delete e[E];for(const O of Object.keys(t))t[O]===E&&delete t[O]}function L(){return Object.keys(e)}function R(E){return E=(E||"").toLowerCase(),e[E]||e[t[E]]}function W(E,{languageName:O}){typeof E=="string"&&(E=[E]),E.forEach(j=>{t[j.toLowerCase()]=O})}function H(E){const O=R(E);return O&&!O.disableAutodetect}function D(E){E["before:highlightBlock"]&&!E["before:highlightElement"]&&(E["before:highlightElement"]=O=>{E["before:highlightBlock"](Object.assign({block:O.el},O))}),E["after:highlightBlock"]&&!E["after:highlightElement"]&&(E["after:highlightElement"]=O=>{E["after:highlightBlock"](Object.assign({block:O.el},O))})}function X(E){D(E),i.push(E)}function V(E){const O=i.indexOf(E);O!==-1&&i.splice(O,1)}function G(E,O){const j=E;i.forEach(function(Y){Y[j]&&Y[j](O)})}function Z(E){return Un("10.7.0","highlightBlock will be removed entirely in v12.0"),Un("10.7.0","Please use highlightElement now."),b(E)}Object.assign(n,{highlight:h,highlightAuto:d,highlightAll:M,highlightElement:b,highlightBlock:Z,configure:m,initHighlighting:x,initHighlightingOnLoad:y,registerLanguage:A,unregisterLanguage:k,listLanguages:L,getLanguage:R,registerAliases:W,autoDetection:H,inherit:wc,addPlugin:X,removePlugin:V}),n.debugMode=function(){r=!1},n.safeMode=function(){r=!0},n.versionString=dx,n.regex={concat:$n,lookahead:cf,either:da,optional:Db,anyNumberOfTimes:Tb};for(const E in zr)typeof zr[E]=="object"&&lf(zr[E]);return Object.assign(n,zr),n},mi=xf({});mi.newInstance=()=>xf({});var gx=mi;mi.HighlightJS=mi;mi.default=mi;const yf=Xm(gx);function bx(n){const e="[^\\(\\)\\[\\]\\{\\}\",'`;#|\\\\\\s]+",t="(-|\\+)?\\d+([./]\\d+)?",i=t+"[+\\-]"+t+"i",r={$pattern:e,built_in:"case-lambda call/cc class define-class exit-handler field import inherit init-field interface let*-values let-values let/ec mixin opt-lambda override protect provide public rename require require-for-syntax syntax syntax-case syntax-error unit/sig unless when with-syntax and begin call-with-current-continuation call-with-input-file call-with-output-file case cond define define-syntax delay do dynamic-wind else for-each if lambda let let* let-syntax letrec letrec-syntax map or syntax-rules ' * + , ,@ - ... / ; < <= = => > >= ` abs acos angle append apply asin assoc assq assv atan boolean? caar cadr call-with-input-file call-with-output-file call-with-values car cdddar cddddr cdr ceiling char->integer char-alphabetic? char-ci<=? char-ci<? char-ci=? char-ci>=? char-ci>? char-downcase char-lower-case? char-numeric? char-ready? char-upcase char-upper-case? char-whitespace? char<=? char<? char=? char>=? char>? char? close-input-port close-output-port complex? cons cos current-input-port current-output-port denominator display eof-object? eq? equal? eqv? eval even? exact->inexact exact? exp expt floor force gcd imag-part inexact->exact inexact? input-port? integer->char integer? interaction-environment lcm length list list->string list->vector list-ref list-tail list? load log magnitude make-polar make-rectangular make-string make-vector max member memq memv min modulo negative? newline not null-environment null? number->string number? numerator odd? open-input-file open-output-file output-port? pair? peek-char port? positive? procedure? quasiquote quote quotient rational? rationalize read read-char real-part real? remainder reverse round scheme-report-environment set! set-car! set-cdr! sin sqrt string string->list string->number string->symbol string-append string-ci<=? string-ci<? string-ci=? string-ci>=? string-ci>? string-copy string-fill! string-length string-ref string-set! string<=? string<? string=? string>=? string>? string? substring symbol->string symbol? tan transcript-off transcript-on truncate values vector vector->list vector-fill! vector-length vector-ref vector-set! with-input-from-file with-output-to-file write write-char zero?"},s={className:"literal",begin:"(#t|#f|#\\\\"+e+"|#\\\\.)"},o={className:"number",variants:[{begin:t,relevance:0},{begin:i,relevance:0},{begin:"#b[0-1]+(/[0-1]+)?"},{begin:"#o[0-7]+(/[0-7]+)?"},{begin:"#x[0-9a-f]+(/[0-9a-f]+)?"}]},l=n.QUOTE_STRING_MODE,a=[n.COMMENT(";","$",{relevance:0}),n.COMMENT("#\\|","\\|#")],c={begin:e,relevance:0},h={className:"symbol",begin:"'"+e},u={endsWithParent:!0,relevance:0},f={variants:[{begin:/'/},{begin:"`"}],contains:[{begin:"\\(",end:"\\)",contains:["self",s,l,o,c,h]}]},d={className:"name",relevance:0,begin:e,keywords:r},b={variants:[{begin:"\\(",end:"\\)"},{begin:"\\[",end:"\\]"}],contains:[{begin:/lambda/,endsWithParent:!0,returnBegin:!0,contains:[d,{endsParent:!0,variants:[{begin:/\(/,end:/\)/},{begin:/\[/,end:/\]/}],contains:[c]}]},d,u]};return u.contains=[s,o,l,c,h,f,b].concat(a),{name:"Scheme",aliases:["scm"],illegal:/\S/,contains:[n.SHEBANG(),o,l,h,f,b].concat(a)}}yf.registerLanguage("scheme",bx);const Dt=({text:n,type:e})=>{const t=S.useRef(null),i=S.useRef(!1),r=S.useCallback(()=>{if(t.current&&!i.current&&(e==="input"||e==="output"))try{yf.highlightElement(t.current),i.current=!0}catch(o){console.error("Highlighting failed:",o)}},[e]);if(S.useEffect(()=>(i.current=!1,r(),()=>{i.current=!1}),[n,r]),e==="system")return g.jsx("pre",{className:"text-teal-400 font-mono text-sm",children:n});const s=e==="output"?"text-green-400":"text-zinc-200";return g.jsx("pre",{ref:t,className:`hljs language-scheme font-mono text-sm whitespace-pre-wrap ${s}`,style:{background:"transparent"},children:n})};function xx({code:n,className:e=""}){return g.jsx("div",{className:`font-mono text-sm space-y-2 code-font ${e}`,children:n.map((t,i)=>g.jsxs("div",{className:"flex items-start gap-2",children:[t.type==="input"?g.jsx("span",{className:"text-cyan-400 shrink-0 select-none",children:"λ"}):g.jsx("span",{className:"ml-4"}),g.jsx("div",{className:"flex-1 group",children:g.jsx(Dt,{text:t.content,type:t.type})})]},i))})}function Xs(){return g.jsx("footer",{className:"py-6 bg-slate-900 text-white",children:g.jsx("div",{className:"container mx-auto px-4",children:g.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[g.jsxs("div",{className:"text-sm text-slate-300",children:["Dissertation by Jamie Wales © ",new Date().getFullYear()]}),g.jsx("div",{className:"flex items-center gap-6",children:g.jsx("a",{href:"https://github.com/jamie-wales/jaws",target:"_blank",rel:"noopener noreferrer",className:"text-slate-300 hover:text-white transition-colors",children:g.jsx(ea,{className:"h-5 w-5"})})})]})})})}function yx(){const n=Ti(),[e,t]=S.useState(!1),i=[{type:"input",content:`(define greet
  (lambda (name)
    (string-append
      "Hello, "
      name
      "!")))`},{type:"input",content:'(greet "friend")'},{type:"output",content:'"Hello, friend!"'}];return g.jsxs("div",{className:"min-h-screen bg-white flex flex-col",children:[g.jsx("nav",{className:"border-b bg-white sticky top-0 z-30",children:g.jsx("div",{className:"container mx-auto px-4 py-3",children:g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsxs(pi,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-slate-900",children:["JAWS",g.jsx(_t,{className:"text-cyan-600"})]}),g.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[g.jsx(Ie,{to:"/editor",className:({isActive:r})=>r?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Editor"}),g.jsx(Ie,{to:"/examples",className:({isActive:r})=>r?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Examples"}),g.jsx(Ie,{to:"/compiler-explorer",className:({isActive:r})=>r?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Compiler Explorer"}),g.jsx(Ie,{to:"/learn",className:"px-4 py-2 rounded-md font-medium bg-[#dd3f0c] text-white no-underline hover:no-underline hover:text-white hover:bg-[#dd3f0c]",children:"Learn Scheme"}),g.jsx(Te,{variant:"ghost",size:"icon",asChild:!0,children:g.jsx("a",{href:"https://github.com/jamie-wales/jaws",target:"_blank",rel:"noopener noreferrer",children:g.jsx(ea,{className:"h-5 w-5"})})})]}),g.jsx(Te,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>t(!0),children:g.jsx(Nu,{className:"h-5 w-5"})})]})})}),e&&g.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 md:hidden",children:g.jsxs("div",{className:"fixed inset-y-0 right-0 w-64 bg-white p-6 shadow-xl",children:[g.jsxs("div",{className:"flex justify-between items-center mb-8",children:[g.jsxs(pi,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-slate-900",onClick:()=>t(!1),children:["JAWS",g.jsx(_t,{className:"text-cyan-600"})]}),g.jsx(Te,{variant:"ghost",size:"icon",onClick:()=>t(!1),children:g.jsx(Ou,{className:"h-5 w-5"})})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsx(Ie,{to:"/editor",className:({isActive:r})=>r?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>t(!1),children:"Editor"}),g.jsx(Ie,{to:"/examples",className:({isActive:r})=>r?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>t(!1),children:"Examples"}),g.jsx(Ie,{to:"/compiler-explorer",className:({isActive:r})=>r?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>t(!1),children:"Compiler Explorer"}),g.jsx(Ie,{to:"/learn",className:"block px-4 py-2 rounded-md font-medium w-full text-center bg-[#dd3f0c] text-white no-underline hover:no-underline hover:text-white hover:bg-[#dd3f0c]",onClick:()=>t(!1),children:"Learn Scheme"})]})]})}),g.jsx("header",{className:"bg-gradient-to-r from-slate-900 via-blue-900 to-slate-900 text-white animate-gradientFlow",children:g.jsx("div",{className:"container mx-auto px-4 py-12 md:py-24",children:g.jsxs("div",{className:"grid md:grid-cols-2 gap-8 md:gap-12",children:[g.jsxs("div",{className:"space-y-6 animate-floatIn",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("h1",{className:"text-4xl md:text-6xl font-semibold leading-tight text-white",children:"JAWS"}),g.jsx(_t,{className:"h-8 w-8 md:h-12 md:w-12 text-[#dd3f0c]"})]}),g.jsx("p",{className:"text-lg md:text-xl font-medium tracking-wide text-cyan-400",children:"Jaws Awesomely Wrangles Scheme"})]}),g.jsx("p",{className:"text-lg md:text-xl text-slate-300",children:"Dive into Scheme programming with our modern, interactive development environment. Write, test, and learn with the power of JAWS."}),g.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-4 pt-4",children:[g.jsxs(Te,{size:"lg",className:"bg-[#dd3f0c] text-white hover:opacity-90 hover:-translate-y-1 transition-all duration-300 w-full sm:w-auto text-base",onClick:()=>n("/learn"),children:["Learn Scheme ",g.jsx(ys,{className:"ml-2 h-4 w-4"})]}),g.jsx(Te,{variant:"outline",size:"lg",className:"bg-transparent text-white hover:bg-slate-800/60 border-white hover:border-white w-full sm:w-auto text-base",onClick:()=>n("/examples"),children:"View Examples"})]})]}),g.jsx("div",{className:"bg-zinc-900 rounded-lg p-4 md:p-6 shadow-xl ring-1 ring-white/10 overflow-x-auto animate-fadeScale animation-delay-400",children:g.jsx(xx,{code:i})})]})})}),g.jsx("section",{className:"flex-1 py-12 md:py-20 bg-slate-50",children:g.jsxs("div",{className:"container mx-auto px-4",children:[g.jsx("h2",{className:"text-2xl md:text-3xl font-semibold text-slate-900 text-center mb-8 md:mb-12",children:"Deep dive into powerful features"}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8",children:[{Icon:Zm,title:"Interactive Editor",description:"Write and test code directly in your browser"},{Icon:Lu,title:"Live Compilation",description:"See how your code transforms at each stage"},{Icon:eg,title:"Rich Examples",description:"Learn from practical, runnable code examples"},{Icon:tg,title:"Community",description:"Share and learn with fellow developers"}].map((r,s)=>g.jsx(Gs,{className:"bg-white border-slate-200 hover:transform hover:-translate-y-1 transition-all duration-300 animate-fadeScale",style:{animationDelay:`${s*.1}s`},children:g.jsxs(Js,{className:"pt-6 text-center",children:[g.jsx(r.Icon,{className:"h-12 w-12 mb-4 mx-auto transition-transform duration-300 text-cyan-500"}),g.jsx("h3",{className:"text-lg md:text-xl font-semibold text-slate-900 mb-2",children:r.title}),g.jsx("p",{className:"text-base text-slate-600",children:r.description})]})},r.title))})]})}),g.jsx("section",{className:"py-12 border-t",children:g.jsx("div",{className:"container mx-auto px-4 text-center",children:g.jsxs("div",{className:"max-w-md mx-auto",children:[g.jsx("h2",{className:"text-2xl md:text-3xl font-semibold text-slate-900 mb-8",children:"Ready to dive in?"}),g.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[g.jsxs(Te,{size:"lg",className:"bg-[#dd3f0c] text-white hover:opacity-90 hover:-translate-y-1 transition-all duration-300 w-full sm:w-auto text-base",onClick:()=>n("/learn"),children:["Learn Scheme ",g.jsx(ys,{className:"ml-2 h-4 w-4"})]}),g.jsx(Te,{variant:"outline",size:"lg",className:"border-slate-800 text-slate-800 hover:bg-slate-100/60 hover:text-slate-900 w-full sm:w-auto text-base",onClick:()=>n("/examples"),children:"Browse Examples"})]})]})})}),g.jsx(Xs,{})]})}function vx(){const[n,e]=S.useState(!1);return g.jsxs("div",{className:"min-h-screen bg-background",children:[g.jsx("nav",{className:"border-b bg-white sticky top-0 z-30",children:g.jsx("div",{className:"container mx-auto px-4 py-3",children:g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsxs(pi,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-slate-900",children:["JAWS",g.jsx(_t,{className:"text-cyan-600"})]}),g.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[g.jsx(Ie,{to:"/editor",className:({isActive:t})=>t?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Editor"}),g.jsx(Ie,{to:"/examples",className:({isActive:t})=>t?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Examples"}),g.jsx(Ie,{to:"/compiler-explorer",className:({isActive:t})=>t?"px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",children:"Compiler Explorer"}),g.jsx(Ie,{to:"/learn",className:"px-4 py-2 rounded-md font-medium bg-[#dd3f0c] text-white no-underline hover:no-underline hover:text-white hover:bg-[#dd3f0c]",children:"Learn Scheme"}),g.jsx(Te,{variant:"ghost",size:"icon",asChild:!0,children:g.jsx("a",{href:"https://github.com/jamie-wales/jaws",target:"_blank",rel:"noopener noreferrer",children:g.jsx(ea,{className:"h-5 w-5"})})})]}),g.jsx(Te,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>e(!0),children:g.jsx(Nu,{className:"h-5 w-5"})})]})})}),n&&g.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 md:hidden",children:g.jsxs("div",{className:"fixed inset-y-0 right-0 w-64 bg-white p-6 shadow-xl",children:[g.jsxs("div",{className:"flex justify-between items-center mb-8",children:[g.jsxs(pi,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-slate-900",onClick:()=>e(!1),children:["JAWS",g.jsx(_t,{className:"text-cyan-600"})]}),g.jsx(Te,{variant:"ghost",size:"icon",onClick:()=>e(!1),children:g.jsx(Ou,{className:"h-5 w-5"})})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsx(Ie,{to:"/editor",className:({isActive:t})=>t?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>e(!1),children:"Editor"}),g.jsx(Ie,{to:"/examples",className:({isActive:t})=>t?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>e(!1),children:"Examples"}),g.jsx(Ie,{to:"/compiler-explorer",className:({isActive:t})=>t?"block px-4 py-2 rounded-md bg-blue-900 text-white no-underline hover:no-underline hover:text-white hover:bg-blue-900":"block px-4 py-2 rounded-md text-slate-600 hover:text-white hover:bg-slate-800",onClick:()=>e(!1),children:"Compiler Explorer"}),g.jsx(Ie,{to:"/learn",className:"block px-4 py-2 rounded-md font-medium w-full text-center bg-[#dd3f0c] text-white no-underline hover:no-underline hover:text-white hover:bg-[#dd3f0c]",onClick:()=>e(!1),children:"Learn Scheme"})]})]})}),g.jsx("main",{className:"h-[calc(100vh-57px)]",children:g.jsx(a0,{})})]})}function tl(){return tl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},tl.apply(null,arguments)}function wx(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.includes(i))continue;t[i]=n[i]}return t}class he{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){[e,t]=gi(this,e,t);let r=[];return this.decompose(0,e,r,2),i.length&&i.decompose(0,i.length,r,3),this.decompose(t,this.length,r,1),Rt.from(r,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=gi(this,e,t);let i=[];return this.decompose(e,t,i,0),Rt.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),r=new Zi(this),s=new Zi(e);for(let o=t,l=t;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(l+=r.value.length,r.done||l>=i)return!0}}iter(e=1){return new Zi(this,e)}iterRange(e,t=this.length){return new vf(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;i=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new wf(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?he.empty:e.length<=32?new Ee(e):Rt.from(Ee.split(e,[]))}}class Ee extends he{constructor(e,t=Sx(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,r){for(let s=0;;s++){let o=this.text[s],l=r+o.length;if((t?i:l)>=e)return new kx(r,l,i,o);r=l+1,i++}}decompose(e,t,i,r){let s=e<=0&&t>=this.length?this:new Ee(kc(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let o=i.pop(),l=cs(s.text,o.text.slice(),0,s.length);if(l.length<=32)i.push(new Ee(l,o.length+s.length));else{let a=l.length>>1;i.push(new Ee(l.slice(0,a)),new Ee(l.slice(a)))}}else i.push(s)}replace(e,t,i){if(!(i instanceof Ee))return super.replace(e,t,i);[e,t]=gi(this,e,t);let r=cs(this.text,cs(i.text,kc(this.text,0,e)),t),s=this.length+i.length-(t-e);return r.length<=32?new Ee(r,s):Rt.from(Ee.split(r,[]),s)}sliceString(e,t=this.length,i=`
`){[e,t]=gi(this,e,t);let r="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let l=this.text[o],a=s+l.length;s>e&&o&&(r+=i),e<a&&t>s&&(r+=l.slice(Math.max(0,e-s),t-s)),s=a+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],r=-1;for(let s of e)i.push(s),r+=s.length+1,i.length==32&&(t.push(new Ee(i,r)),i=[],r=-1);return r>-1&&t.push(new Ee(i,r)),t}}class Rt extends he{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,r){for(let s=0;;s++){let o=this.children[s],l=r+o.length,a=i+o.lines-1;if((t?a:l)>=e)return o.lineInner(e,t,i,r);r=l+1,i=a+1}}decompose(e,t,i,r){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let l=this.children[s],a=o+l.length;if(e<=a&&t>=o){let c=r&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!c?i.push(l):l.decompose(e-o,t-o,i,c)}o=a+1}}replace(e,t,i){if([e,t]=gi(this,e,t),i.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(e>=s&&t<=l){let a=o.replace(e-s,t-s,i),c=this.lines-o.lines+a.lines;if(a.lines<c>>4&&a.lines>c>>6){let h=this.children.slice();return h[r]=a,new Rt(h,this.length-(t-e)+i.length)}return super.replace(s,l,a)}s=l+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){[e,t]=gi(this,e,t);let r="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let l=this.children[s],a=o+l.length;o>e&&s&&(r+=i),e<a&&t>o&&(r+=l.sliceString(e-o,t-o,i)),o=a+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Rt))return 0;let i=0,[r,s,o,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,s+=t){if(r==o||s==l)return i;let a=this.children[r],c=e.children[s];if(a!=c)return i+a.scanIdentical(c,t);i+=a.length+1}}static from(e,t=e.reduce((i,r)=>i+r.length+1,-1)){let i=0;for(let d of e)i+=d.lines;if(i<32){let d=[];for(let p of e)p.flatten(d);return new Ee(d,t)}let r=Math.max(32,i>>5),s=r<<1,o=r>>1,l=[],a=0,c=-1,h=[];function u(d){let p;if(d.lines>s&&d instanceof Rt)for(let b of d.children)u(b);else d.lines>o&&(a>o||!a)?(f(),l.push(d)):d instanceof Ee&&a&&(p=h[h.length-1])instanceof Ee&&d.lines+p.lines<=32?(a+=d.lines,c+=d.length+1,h[h.length-1]=new Ee(p.text.concat(d.text),p.length+1+d.length)):(a+d.lines>r&&f(),a+=d.lines,c+=d.length+1,h.push(d))}function f(){a!=0&&(l.push(h.length==1?h[0]:Rt.from(h,c)),c=-1,a=h.length=0)}for(let d of e)u(d);return f(),l.length==1?l[0]:new Rt(l,t)}}he.empty=new Ee([""],0);function Sx(n){let e=-1;for(let t of n)e+=t.length+1;return e}function cs(n,e,t=0,i=1e9){for(let r=0,s=0,o=!0;s<n.length&&r<=i;s++){let l=n[s],a=r+l.length;a>=t&&(a>i&&(l=l.slice(0,i-r)),r<t&&(l=l.slice(t-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function kc(n,e,t){return cs(n,[""],e,t)}class Zi{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Ee?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,r=this.nodes[i],s=this.offsets[i],o=s>>1,l=r instanceof Ee?r.text.length:r.children.length;if(o==(t>0?l:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof Ee){let a=r.text[o+(t<0?-1:0)];if(this.offsets[i]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=r.children[o+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof Ee?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class vf{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new Zi(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=i?r:t<0?r.slice(r.length-i):r.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class wf{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:r}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(he.prototype[Symbol.iterator]=function(){return this.iter()},Zi.prototype[Symbol.iterator]=vf.prototype[Symbol.iterator]=wf.prototype[Symbol.iterator]=function(){return this});class kx{constructor(e,t,i,r){this.from=e,this.to=t,this.number=i,this.text=r}get length(){return this.to-this.from}}function gi(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}let oi="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<oi.length;n++)oi[n]+=oi[n-1];function Cx(n){for(let e=1;e<oi.length;e+=2)if(oi[e]>n)return oi[e-1]<=n;return!1}function Cc(n){return n>=127462&&n<=127487}const Ac=8205;function Fe(n,e,t=!0,i=!0){return(t?Sf:Ax)(n,e,i)}function Sf(n,e,t){if(e==n.length)return e;e&&kf(n.charCodeAt(e))&&Cf(n.charCodeAt(e-1))&&e--;let i=Be(n,e);for(e+=dt(i);e<n.length;){let r=Be(n,e);if(i==Ac||r==Ac||t&&Cx(r))e+=dt(r),i=r;else if(Cc(r)){let s=0,o=e-2;for(;o>=0&&Cc(Be(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function Ax(n,e,t){for(;e>0;){let i=Sf(n,e-2,t);if(i<e)return i;e--}return 0}function kf(n){return n>=56320&&n<57344}function Cf(n){return n>=55296&&n<56320}function Be(n,e){let t=n.charCodeAt(e);if(!Cf(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return kf(i)?(t-55296<<10)+(i-56320)+65536:t}function ga(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function dt(n){return n<65536?1:2}const nl=/\r\n?|\n/;var Je=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(Je||(Je={}));class Pt{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,r=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(i,r,s),r+=s):r+=o,i+=s}}iterChangedRanges(e,t=!1){il(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];r<0?e.push(i,r):e.push(r,i)}return new Pt(e)}composeDesc(e){return this.empty?e:e.empty?this:Af(this,e)}mapDesc(e,t=!1){return e.empty?this:rl(this,e,t)}mapPos(e,t=-1,i=Je.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],c=r+l;if(a<0){if(c>e)return s+(e-r);s+=l}else{if(i!=Je.Simple&&c>=e&&(i==Je.TrackDel&&r<e&&c>e||i==Je.TrackBefore&&r<e||i==Je.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!l)return e==r||t<0?s:s+a;s+=a}r=c}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,t=e){for(let i=0,r=0;i<this.sections.length&&r<=t;){let s=this.sections[i++],o=this.sections[i++],l=r+s;if(o>=0&&r<=t&&l>=e)return r<e&&l>t?"cover":!0;r=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+i+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Pt(e)}static create(e){return new Pt(e)}}class Ne extends Pt{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return il(this,(t,i,r,s,o)=>e=e.replace(r,r+(i-t),o),!1),e}mapDesc(e,t=!1){return rl(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let r=0,s=0;r<t.length;r+=2){let o=t[r],l=t[r+1];if(l>=0){t[r]=l,t[r+1]=o;let a=r>>1;for(;i.length<a;)i.push(he.empty);i.push(o?e.slice(s,s+o):he.empty)}s+=o}return new Ne(t,i)}compose(e){return this.empty?e:e.empty?this:Af(this,e,!0)}map(e,t=!1){return e.empty?this:rl(this,e,t,!0)}iterChanges(e,t=!1){il(this,e,t)}get desc(){return Pt.create(this.sections)}filter(e){let t=[],i=[],r=[],s=new lr(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&s.len==0;){if(s.done)break e;let h=Math.min(s.len,a-l);qe(r,h,-1);let u=s.ins==-1?-1:s.off==0?s.ins:0;qe(t,h,u),u>0&&on(i,t,s.text),s.forward(h),l+=h}let c=e[o++];for(;l<c;){if(s.done)break e;let h=Math.min(s.len,c-l);qe(t,h,-1),qe(r,h,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(h),l+=h}}return{changes:new Ne(t,i),filtered:Pt.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],r=this.sections[t+1];r<0?e.push(i):r==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let r=[],s=[],o=0,l=null;function a(h=!1){if(!h&&!r.length)return;o<t&&qe(r,t-o,-1);let u=new Ne(r,s);l=l?l.compose(u.map(l)):u,r=[],s=[],o=0}function c(h){if(Array.isArray(h))for(let u of h)c(u);else if(h instanceof Ne){if(h.length!=t)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${t})`);a(),l=l?l.compose(h.map(l)):h}else{let{from:u,to:f=u,insert:d}=h;if(u>f||u<0||f>t)throw new RangeError(`Invalid change range ${u} to ${f} (in doc of length ${t})`);let p=d?typeof d=="string"?he.of(d.split(i||nl)):d:he.empty,b=p.length;if(u==f&&b==0)return;u<o&&a(),u>o&&qe(r,u-o,-1),qe(r,f-u,b),on(s,r,p),o=f}}return c(e),a(!l),l}static empty(e){return new Ne(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;i.length<r;)i.push(he.empty);i[r]=he.of(s.slice(1)),t.push(s[0],i[r].length)}}}return new Ne(t,i)}static createSet(e,t){return new Ne(e,t)}}function qe(n,e,t,i=!1){if(e==0&&t<=0)return;let r=n.length-2;r>=0&&t<=0&&t==n[r+1]?n[r]+=e:e==0&&n[r]==0?n[r+1]+=t:i?(n[r]+=e,n[r+1]+=t):n.push(e,t)}function on(n,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<i;)n.push(he.empty);n.push(t)}}function il(n,e,t){let i=n.inserted;for(let r=0,s=0,o=0;o<n.sections.length;){let l=n.sections[o++],a=n.sections[o++];if(a<0)r+=l,s+=l;else{let c=r,h=s,u=he.empty;for(;c+=l,h+=a,a&&i&&(u=u.append(i[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)l=n.sections[o++],a=n.sections[o++];e(r,c,s,h,u),r=c,s=h}}}function rl(n,e,t,i=!1){let r=[],s=i?[]:null,o=new lr(n),l=new lr(e);for(let a=-1;;)if(o.ins==-1&&l.ins==-1){let c=Math.min(o.len,l.len);qe(r,c,-1),o.forward(c),l.forward(c)}else if(l.ins>=0&&(o.ins<0||a==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!t))){let c=l.len;for(qe(r,l.ins,-1);c;){let h=Math.min(o.len,c);o.ins>=0&&a<o.i&&o.len<=h&&(qe(r,0,o.ins),s&&on(s,r,o.text),a=o.i),o.forward(h),c-=h}l.next()}else if(o.ins>=0){let c=0,h=o.len;for(;h;)if(l.ins==-1){let u=Math.min(h,l.len);c+=u,h-=u,l.forward(u)}else if(l.ins==0&&l.len<h)h-=l.len,l.next();else break;qe(r,c,a<o.i?o.ins:0),s&&a<o.i&&on(s,r,o.text),a=o.i,o.forward(o.len-h)}else{if(o.done&&l.done)return s?Ne.createSet(r,s):Pt.create(r);throw new Error("Mismatched change set lengths")}}function Af(n,e,t=!1){let i=[],r=t?[]:null,s=new lr(n),o=new lr(e);for(let l=!1;;){if(s.done&&o.done)return r?Ne.createSet(i,r):Pt.create(i);if(s.ins==0)qe(i,s.len,0,l),s.next();else if(o.len==0&&!o.done)qe(i,0,o.ins,l),r&&on(r,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(s.len2,o.len),c=i.length;if(s.ins==-1){let h=o.ins==-1?-1:o.off?0:o.ins;qe(i,a,h,l),r&&h&&on(r,i,o.text)}else o.ins==-1?(qe(i,s.off?0:s.len,a,l),r&&on(r,i,s.textBit(a))):(qe(i,s.off?0:s.len,o.off?0:o.ins,l),r&&!o.off&&on(r,i,o.text));l=(s.ins>a||o.ins>=0&&o.len>a)&&(l||i.length>c),s.forward2(a),o.forward(a)}}}}class lr{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?he.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?he.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Tn{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let i,r;return this.empty?i=r=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),i==this.from&&r==this.to?this:new Tn(i,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return T.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return T.range(this.anchor,i)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return T.range(e.anchor,e.head)}static create(e,t,i){return new Tn(e,t,i)}}class T{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:T.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new T([this.main],0)}addRange(e,t=!0){return T.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,T.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new T(e.ranges.map(t=>Tn.fromJSON(t)),e.main)}static single(e,t=e){return new T([T.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=i:s.from<i)return T.normalized(e.slice(),t);i=s.to}return new T(e,t)}static cursor(e,t=0,i,r){return Tn.create(e,e,(t==0?0:t<0?8:16)|(i==null?7:Math.min(6,i))|(r??16777215)<<6)}static range(e,t,i,r){let s=(i??16777215)<<6|(r==null?7:Math.min(6,r));return t<e?Tn.create(t,e,48|s):Tn.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let i=e[t];e.sort((r,s)=>r.from-s.from),t=e.indexOf(i);for(let r=1;r<e.length;r++){let s=e[r],o=e[r-1];if(s.empty?s.from<=o.to:s.from<o.to){let l=o.from,a=Math.max(s.to,o.to);r<=t&&t--,e.splice(--r,2,s.anchor>s.head?T.range(a,l):T.range(l,a))}}return new T(e,t)}}function Mf(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let ba=0;class z{constructor(e,t,i,r,s){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=r,this.id=ba++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new z(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:xa),!!e.static,e.enables)}of(e){return new hs([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new hs(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new hs(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function xa(n,e){return n==e||n.length==e.length&&n.every((t,i)=>t===e[i])}class hs{constructor(e,t,i,r){this.dependencies=e,this.facet=t,this.type=i,this.value=r,this.id=ba++}dynamicSlot(e){var t;let i=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,a=!1,c=!1,h=[];for(let u of this.dependencies)u=="doc"?a=!0:u=="selection"?c=!0:((t=e[u.id])!==null&&t!==void 0?t:1)&1||h.push(e[u.id]);return{create(u){return u.values[o]=i(u),1},update(u,f){if(a&&f.docChanged||c&&(f.docChanged||f.selection)||sl(u,h)){let d=i(u);if(l?!Mc(d,u.values[o],r):!r(d,u.values[o]))return u.values[o]=d,1}return 0},reconfigure:(u,f)=>{let d,p=f.config.address[s];if(p!=null){let b=ks(f,p);if(this.dependencies.every(m=>m instanceof z?f.facet(m)===u.facet(m):m instanceof Ve?f.field(m,!1)==u.field(m,!1):!0)||(l?Mc(d=i(u),b,r):r(d=i(u),b)))return u.values[o]=b,0}else d=i(u);return u.values[o]=d,1}}}}function Mc(n,e,t){if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(!t(n[i],e[i]))return!1;return!0}function sl(n,e){let t=!1;for(let i of e)er(n,i)&1&&(t=!0);return t}function Mx(n,e,t){let i=t.map(a=>n[a.id]),r=t.map(a=>a.type),s=i.filter(a=>!(a&1)),o=n[e.id]>>1;function l(a){let c=[];for(let h=0;h<i.length;h++){let u=ks(a,i[h]);if(r[h]==2)for(let f of u)c.push(f);else c.push(u)}return e.combine(c)}return{create(a){for(let c of i)er(a,c);return a.values[o]=l(a),1},update(a,c){if(!sl(a,s))return 0;let h=l(a);return e.compare(h,a.values[o])?0:(a.values[o]=h,1)},reconfigure(a,c){let h=sl(a,i),u=c.config.facets[e.id],f=c.facet(e);if(u&&!h&&xa(t,u))return a.values[o]=f,0;let d=l(a);return e.compare(d,f)?(a.values[o]=f,0):(a.values[o]=d,1)}}}const Ec=z.define({static:!0});class Ve{constructor(e,t,i,r,s){this.id=e,this.createF=t,this.updateF=i,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let t=new Ve(ba++,e.create,e.update,e.compare||((i,r)=>i===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Ec).find(i=>i.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,r)=>{let s=i.values[t],o=this.updateF(s,r);return this.compareF(s,o)?0:(i.values[t]=o,1)},reconfigure:(i,r)=>r.config.address[this.id]!=null?(i.values[t]=r.field(this),0):(i.values[t]=this.create(i),1)}}init(e){return[this,Ec.of({field:this,create:e})]}get extension(){return this}}const Mn={lowest:4,low:3,default:2,high:1,highest:0};function ji(n){return e=>new Ef(e,n)}const _n={highest:ji(Mn.highest),high:ji(Mn.high),default:ji(Mn.default),low:ji(Mn.low),lowest:ji(Mn.lowest)};class Ef{constructor(e,t){this.inner=e,this.prec=t}}class Qs{of(e){return new ol(this,e)}reconfigure(e){return Qs.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class ol{constructor(e,t){this.compartment=e,this.inner=t}}class Ss{constructor(e,t,i,r,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let r=[],s=Object.create(null),o=new Map;for(let f of Ex(e,t,o))f instanceof Ve?r.push(f):(s[f.facet.id]||(s[f.facet.id]=[])).push(f);let l=Object.create(null),a=[],c=[];for(let f of r)l[f.id]=c.length<<1,c.push(d=>f.slot(d));let h=i==null?void 0:i.config.facets;for(let f in s){let d=s[f],p=d[0].facet,b=h&&h[f]||[];if(d.every(m=>m.type==0))if(l[p.id]=a.length<<1|1,xa(b,d))a.push(i.facet(p));else{let m=p.combine(d.map(x=>x.value));a.push(i&&p.compare(m,i.facet(p))?i.facet(p):m)}else{for(let m of d)m.type==0?(l[m.id]=a.length<<1|1,a.push(m.value)):(l[m.id]=c.length<<1,c.push(x=>m.dynamicSlot(x)));l[p.id]=c.length<<1,c.push(m=>Mx(m,p,d))}}let u=c.map(f=>f(l));return new Ss(e,o,u,l,a,s)}}function Ex(n,e,t){let i=[[],[],[],[],[]],r=new Map;function s(o,l){let a=r.get(o);if(a!=null){if(a<=l)return;let c=i[a].indexOf(o);c>-1&&i[a].splice(c,1),o instanceof ol&&t.delete(o.compartment)}if(r.set(o,l),Array.isArray(o))for(let c of o)s(c,l);else if(o instanceof ol){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;t.set(o.compartment,c),s(c,l)}else if(o instanceof Ef)s(o.inner,o.prec);else if(o instanceof Ve)i[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof hs)i[l].push(o),o.facet.extensions&&s(o.facet.extensions,Mn.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(c,l)}}return s(n,Mn.default),i.reduce((o,l)=>o.concat(l))}function er(n,e){if(e&1)return 2;let t=e>>1,i=n.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;n.status[t]=4;let r=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|r}function ks(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const Tf=z.define(),ll=z.define({combine:n=>n.some(e=>e),static:!0}),Df=z.define({combine:n=>n.length?n[0]:void 0,static:!0}),Rf=z.define(),Nf=z.define(),Of=z.define(),Lf=z.define({combine:n=>n.length?n[0]:!1});class jt{constructor(e,t){this.type=e,this.value=t}static define(){return new Tx}}class Tx{of(e){return new jt(this,e)}}class Dx{constructor(e){this.map=e}of(e){return new ne(this,e)}}class ne{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new ne(this.type,t)}is(e){return this.type==e}static define(e={}){return new Dx(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let r of e){let s=r.map(t);s&&i.push(s)}return i}}ne.reconfigure=ne.define();ne.appendConfig=ne.define();class Oe{constructor(e,t,i,r,s,o){this.startState=e,this.changes=t,this.selection=i,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&Mf(i,t.newLength),s.some(l=>l.type==Oe.time)||(this.annotations=s.concat(Oe.time.of(Date.now())))}static create(e,t,i,r,s,o){return new Oe(e,t,i,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Oe.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Oe.time=jt.define();Oe.userEvent=jt.define();Oe.addToHistory=jt.define();Oe.remote=jt.define();function Rx(n,e){let t=[];for(let i=0,r=0;;){let s,o;if(i<n.length&&(r==e.length||e[r]>=n[i]))s=n[i++],o=n[i++];else if(r<e.length)s=e[r++],o=e[r++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function Pf(n,e,t){var i;let r,s,o;return t?(r=e.changes,s=Ne.empty(e.changes.length),o=n.changes.compose(e.changes)):(r=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(i=n.selection)===null||i===void 0?void 0:i.map(r),effects:ne.mapEffects(n.effects,r).concat(ne.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function al(n,e,t){let i=e.selection,r=li(e.annotations);return e.userEvent&&(r=r.concat(Oe.userEvent.of(e.userEvent))),{changes:e.changes instanceof Ne?e.changes:Ne.of(e.changes||[],t,n.facet(Df)),selection:i&&(i instanceof T?i:T.single(i.anchor,i.head)),effects:li(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function If(n,e,t){let i=al(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;i=Pf(i,al(n,e[s],o?i.changes.newLength:n.doc.length),o)}let r=Oe.create(n,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return Ox(t?Nx(r):r)}function Nx(n){let e=n.startState,t=!0;for(let r of e.facet(Rf)){let s=r(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:Rx(t,s))}if(t!==!0){let r,s;if(t===!1)s=n.changes.invertedDesc,r=Ne.empty(e.doc.length);else{let o=n.changes.filter(t);r=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}n=Oe.create(e,r,n.selection&&n.selection.map(s),ne.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let i=e.facet(Nf);for(let r=i.length-1;r>=0;r--){let s=i[r](n);s instanceof Oe?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Oe?n=s[0]:n=If(e,li(s),!1)}return n}function Ox(n){let e=n.startState,t=e.facet(Of),i=n;for(let r=t.length-1;r>=0;r--){let s=t[r](n);s&&Object.keys(s).length&&(i=Pf(i,al(e,s,n.changes.newLength),!0))}return i==n?n:Oe.create(e,n.changes,n.selection,i.effects,i.annotations,i.scrollIntoView)}const Lx=[];function li(n){return n==null?Lx:Array.isArray(n)?n:[n]}var Se=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(Se||(Se={}));const Px=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let cl;try{cl=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Ix(n){if(cl)return cl.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||Px.test(t)))return!0}return!1}function Bx(n){return e=>{if(!/\S/.test(e))return Se.Space;if(Ix(e))return Se.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return Se.Word;return Se.Other}}class ae{constructor(e,t,i,r,s,o){this.config=e,this.doc=t,this.selection=i,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)er(this,l<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return er(this,i),ks(this,i)}update(...e){return If(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:r}=t;for(let l of e.effects)l.is(Qs.reconfigure)?(t&&(r=new Map,t.compartments.forEach((a,c)=>r.set(c,a)),t=null),r.set(l.value.compartment,l.value.extension)):l.is(ne.reconfigure)?(t=null,i=l.value):l.is(ne.appendConfig)&&(t=null,i=li(i).concat(l.value));let s;t?s=e.startState.values.slice():(t=Ss.resolve(i,r,this),s=new ae(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(a,c)=>c.reconfigure(a,this),null).values);let o=e.startState.facet(ll)?e.newSelection:e.newSelection.asSingle();new ae(t,e.newDoc,o,s,(l,a)=>a.update(l,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:T.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),r=this.changes(i.changes),s=[i.range],o=li(i.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),c=this.changes(a.changes),h=c.map(r);for(let f=0;f<l;f++)s[f]=s[f].map(h);let u=r.mapDesc(c,!0);s.push(a.range.map(u)),r=r.compose(h),o=ne.mapEffects(o,h).concat(ne.mapEffects(li(a.effects),u))}return{changes:r,selection:T.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Ne?e:Ne.of(e,this.doc.length,this.facet(ae.lineSeparator))}toText(e){return he.of(e.split(this.facet(ae.lineSeparator)||nl))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(er(this,t),ks(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let r=e[i];r instanceof Ve&&this.config.address[r.id]!=null&&(t[i]=r.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i){for(let s in i)if(Object.prototype.hasOwnProperty.call(e,s)){let o=i[s],l=e[s];r.push(o.init(a=>o.spec.fromJSON(l,a)))}}return ae.create({doc:e.doc,selection:T.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=Ss.resolve(e.extensions||[],new Map),i=e.doc instanceof he?e.doc:he.of((e.doc||"").split(t.staticFacet(ae.lineSeparator)||nl)),r=e.selection?e.selection instanceof T?e.selection:T.single(e.selection.anchor,e.selection.head):T.single(0);return Mf(r,i.length),t.staticFacet(ll)||(r=r.asSingle()),new ae(t,i,r,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(ae.tabSize)}get lineBreak(){return this.facet(ae.lineSeparator)||`
`}get readOnly(){return this.facet(Lf)}phrase(e,...t){for(let i of this.facet(ae.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,r)=>{if(r=="$")return"$";let s=+(r||1);return!s||s>t.length?i:t[s-1]})),e}languageDataAt(e,t,i=-1){let r=[];for(let s of this.facet(Tf))for(let o of s(this,t,i))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return Bx(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,l=e-i;for(;o>0;){let a=Fe(t,o,!1);if(s(t.slice(a,o))!=Se.Word)break;o=a}for(;l<r;){let a=Fe(t,l);if(s(t.slice(l,a))!=Se.Word)break;l=a}return o==l?null:T.range(o+i,l+i)}}ae.allowMultipleSelections=ll;ae.tabSize=z.define({combine:n=>n.length?n[0]:4});ae.lineSeparator=Df;ae.readOnly=Lf;ae.phrases=z.define({compare(n,e){let t=Object.keys(n),i=Object.keys(e);return t.length==i.length&&t.every(r=>n[r]==e[r])}});ae.languageData=Tf;ae.changeFilter=Rf;ae.transactionFilter=Nf;ae.transactionExtender=Of;Qs.reconfigure=ne.define();function Ht(n,e,t={}){let i={};for(let r of n)for(let s of Object.keys(r)){let o=r[s],l=i[s];if(l===void 0)i[s]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(t,s))i[s]=t[s](l,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)i[r]===void 0&&(i[r]=e[r]);return i}class In{eq(e){return this==e}range(e,t=e){return hl.create(e,t,this)}}In.prototype.startSide=In.prototype.endSide=0;In.prototype.point=!1;In.prototype.mapMode=Je.TrackDel;let hl=class Bf{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new Bf(e,t,i)}};function ul(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class ya{constructor(e,t,i,r){this.from=e,this.to=t,this.value=i,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,r=0){let s=i?this.to:this.from;for(let o=r,l=s.length;;){if(o==l)return o;let a=o+l>>1,c=s[a]-e||(i?this.value[a].endSide:this.value[a].startSide)-t;if(a==o)return c>=0?o:l;c>=0?l=a:o=a+1}}between(e,t,i,r){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let i=[],r=[],s=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let c=this.value[a],h=this.from[a]+e,u=this.to[a]+e,f,d;if(h==u){let p=t.mapPos(h,c.startSide,c.mapMode);if(p==null||(f=d=p,c.startSide!=c.endSide&&(d=t.mapPos(h,c.endSide),d<f)))continue}else if(f=t.mapPos(h,c.startSide),d=t.mapPos(u,c.endSide),f>d||f==d&&c.startSide>0&&c.endSide<=0)continue;(d-f||c.endSide-c.startSide)<0||(o<0&&(o=f),c.point&&(l=Math.max(l,d-f)),i.push(c),r.push(f-o),s.push(d-o))}return{mapped:i.length?new ya(r,s,i,l):null,pos:o}}}class ce{constructor(e,t,i,r){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=r}static create(e,t,i,r){return new ce(e,t,i,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(i&&(t=t.slice().sort(ul)),this.isEmpty)return t.length?ce.of(t):this;let l=new zf(this,null,-1).goto(0),a=0,c=[],h=new dn;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let u=t[a++];h.addInner(u.from,u.to,u.value)||c.push(u)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!o||r>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&h.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||r>l.to||s<l.from||o(l.from,l.to,l.value))&&(h.addInner(l.from,l.to,l.value)||c.push(hl.create(l.from,l.to,l.value))),l.next());return h.finishInner(this.nextLayer.isEmpty&&!c.length?ce.empty:this.nextLayer.update({add:c,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],r=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],c=e.touchesRange(l,l+a.length);if(c===!1)r=Math.max(r,a.maxPoint),t.push(a),i.push(e.mapPos(l));else if(c===!0){let{mapped:h,pos:u}=a.map(l,e);h&&(r=Math.max(r,h.maxPoint),t.push(h),i.push(u))}}let s=this.nextLayer.map(e);return t.length==0?s:new ce(i,t,s||ce.empty,r)}between(e,t,i){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return ar.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return ar.from(e).goto(t)}static compare(e,t,i,r,s=-1){let o=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=s),l=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=s),a=Tc(o,l,i),c=new Hi(o,a,s),h=new Hi(l,a,s);i.iterGaps((u,f,d)=>Dc(c,u,h,f,d,r)),i.empty&&i.length==0&&Dc(c,0,h,0,0,r)}static eq(e,t,i=0,r){r==null&&(r=999999999);let s=e.filter(h=>!h.isEmpty&&t.indexOf(h)<0),o=t.filter(h=>!h.isEmpty&&e.indexOf(h)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=Tc(s,o),a=new Hi(s,l,0).goto(i),c=new Hi(o,l,0).goto(i);for(;;){if(a.to!=c.to||!fl(a.active,c.active)||a.point&&(!c.point||!a.point.eq(c.point)))return!1;if(a.to>r)return!0;a.next(),c.next()}}static spans(e,t,i,r,s=-1){let o=new Hi(e,null,s).goto(t),l=t,a=o.openStart;for(;;){let c=Math.min(o.to,i);if(o.point){let h=o.activeForPoint(o.to),u=o.pointFrom<t?h.length+1:o.point.startSide<0?h.length:Math.min(h.length,a);r.point(l,c,o.point,h,u,o.pointRank),a=Math.min(o.openEnd(c),h.length)}else c>l&&(r.span(l,c,o.active,a),a=o.openEnd(c));if(o.to>i)return a+(o.point&&o.to>i?1:0);l=o.to,o.next()}}static of(e,t=!1){let i=new dn;for(let r of e instanceof hl?[e]:t?zx(e):e)i.add(r.from,r.to,r.value);return i.finish()}static join(e){if(!e.length)return ce.empty;let t=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let r=e[i];r!=ce.empty;r=r.nextLayer)t=new ce(r.chunkPos,r.chunk,t,Math.max(r.maxPoint,t.maxPoint));return t}}ce.empty=new ce([],[],null,-1);function zx(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let i=n[t];if(ul(e,i)>0)return n.slice().sort(ul);e=i}return n}ce.empty.nextLayer=ce.empty;class dn{finishChunk(e){this.chunks.push(new ya(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new dn)).add(e,t,i)}addInner(e,t,i){let r=e-this.lastTo||i.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(ce.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=ce.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Tc(n,e,t){let i=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=i.get(s.chunk[o]);l!=null&&(t?t.mapPos(l):l)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(l,l+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class zf{constructor(e,t,i,r=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class ar{constructor(e){this.heap=e}static from(e,t=null,i=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&r.push(new zf(o,t,i,s));return r.length==1?r[0]:new ar(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)So(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)So(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),So(this.heap,0)}}}function So(n,e){for(let t=n[e];;){let i=(e<<1)+1;if(i>=n.length)break;let r=n[i];if(i+1<n.length&&r.compare(n[i+1])>=0&&(r=n[i+1],i++),t.compare(r)<0)break;n[i]=t,n[e]=r,e=i}}class Hi{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=ar.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){jr(this.active,e),jr(this.activeTo,e),jr(this.activeRank,e),this.minActive=Rc(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:r,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||r-this.activeTo[t])>0;)t++;Hr(this.active,t,i),Hr(this.activeTo,t,r),Hr(this.activeRank,t,s),e&&Hr(e,t,this.cursor.from),this.minActive=Rc(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&jr(i,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let r=i.length-1;r>=0&&i[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function Dc(n,e,t,i,r,s){n.goto(e),t.goto(i);let o=i+r,l=i,a=i-e;for(;;){let c=n.to+a-t.to||n.endSide-t.endSide,h=c<0?n.to+a:t.to,u=Math.min(h,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&fl(n.activeForPoint(n.to),t.activeForPoint(t.to))||s.comparePoint(l,u,n.point,t.point):u>l&&!fl(n.active,t.active)&&s.compareRange(l,u,n.active,t.active),h>o)break;l=h,c<=0&&n.next(),c>=0&&t.next()}}function fl(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function jr(n,e){for(let t=e,i=n.length-1;t<i;t++)n[t]=n[t+1];n.pop()}function Hr(n,e,t){for(let i=n.length-1;i>=e;i--)n[i+1]=n[i];n[e]=t}function Rc(n,e){let t=-1,i=1e9;for(let r=0;r<e.length;r++)(e[r]-i||n[r].endSide-n[t].endSide)<0&&(t=r,i=e[r]);return t}function Ri(n,e,t=n.length){let i=0;for(let r=0;r<t;)n.charCodeAt(r)==9?(i+=e-i%e,r++):(i++,r=Fe(n,r));return i}function dl(n,e,t,i){for(let r=0,s=0;;){if(s>=e)return r;if(r==n.length)break;s+=n.charCodeAt(r)==9?t-s%t:1,r=Fe(n,r)}return i===!0?-1:n.length}const pl="ͼ",Nc=typeof Symbol>"u"?"__"+pl:Symbol.for(pl),ml=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Oc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class pn{constructor(e,t){this.rules=[];let{finish:i}=t||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,l,a,c){let h=[],u=/^@(\w+)\b/.exec(o[0]),f=u&&u[1]=="keyframes";if(u&&l==null)return a.push(o[0]+";");for(let d in l){let p=l[d];if(/&/.test(d))s(d.split(/,\s*/).map(b=>o.map(m=>b.replace(/&/,m))).reduce((b,m)=>b.concat(m)),p,a);else if(p&&typeof p=="object"){if(!u)throw new RangeError("The value of a property ("+d+") should be a primitive value.");s(r(d),p,h,f)}else p!=null&&h.push(d.replace(/_.*/,"").replace(/[A-Z]/g,b=>"-"+b.toLowerCase())+": "+p+";")}(h.length||f)&&a.push((i&&!u&&!c?o.map(i):o).join(", ")+" {"+h.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Oc[Nc]||1;return Oc[Nc]=e+1,pl+e.toString(36)}static mount(e,t,i){let r=e[ml],s=i&&i.nonce;r?s&&r.setNonce(s):r=new jx(e,s),r.mount(Array.isArray(t)?t:[t],e)}}let Lc=new Map;class jx{constructor(e,t){let i=e.ownerDocument||e,r=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let s=Lc.get(i);if(s)return e[ml]=s;this.sheet=new r.CSSStyleSheet,Lc.set(i,this)}else this.styleTag=i.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[ml]=this}mount(e,t){let i=this.sheet,r=0,s=0;for(let o=0;o<e.length;o++){let l=e[o],a=this.modules.indexOf(l);if(a<s&&a>-1&&(this.modules.splice(a,1),s--,a=-1),a==-1){if(this.modules.splice(s++,0,l),i)for(let c=0;c<l.rules.length;c++)i.insertRule(l.rules[c],r++)}else{for(;s<a;)r+=this.modules[s++].rules.length;r+=l.rules.length,s++}}if(i)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let a=0;a<this.modules.length;a++)o+=this.modules[a].getRules()+`
`;this.styleTag.textContent=o;let l=t.head||t;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var mn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},cr={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Hx=typeof navigator<"u"&&/Mac/.test(navigator.platform),Fx=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ze=0;ze<10;ze++)mn[48+ze]=mn[96+ze]=String(ze);for(var ze=1;ze<=24;ze++)mn[ze+111]="F"+ze;for(var ze=65;ze<=90;ze++)mn[ze]=String.fromCharCode(ze+32),cr[ze]=String.fromCharCode(ze);for(var ko in mn)cr.hasOwnProperty(ko)||(cr[ko]=mn[ko]);function Wx(n){var e=Hx&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Fx&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?cr:mn)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function hr(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function gl(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function us(n,e){if(!e.anchorNode)return!1;try{return gl(n,e.anchorNode)}catch{return!1}}function bi(n){return n.nodeType==3?zn(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function tr(n,e,t,i){return t?Pc(n,e,t,i,-1)||Pc(n,e,t,i,1):!1}function Bn(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function Cs(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function Pc(n,e,t,i,r){for(;;){if(n==t&&e==i)return!0;if(e==(r<0?0:It(n))){if(n.nodeName=="DIV")return!1;let s=n.parentNode;if(!s||s.nodeType!=1)return!1;e=Bn(n)+(r<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(r<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=r<0?It(n):0}else return!1}}function It(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Tr(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function Vx(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function jf(n,e){let t=e.width/n.offsetWidth,i=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-n.offsetHeight)<1)&&(i=1),{scaleX:t,scaleY:i}}function $x(n,e,t,i,r,s,o,l){let a=n.ownerDocument,c=a.defaultView||window;for(let h=n,u=!1;h&&!u;)if(h.nodeType==1){let f,d=h==a.body,p=1,b=1;if(d)f=Vx(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(u=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let y=h.getBoundingClientRect();({scaleX:p,scaleY:b}=jf(h,y)),f={left:y.left,right:y.left+h.clientWidth*p,top:y.top,bottom:y.top+h.clientHeight*b}}let m=0,x=0;if(r=="nearest")e.top<f.top?(x=-(f.top-e.top+o),t>0&&e.bottom>f.bottom+x&&(x=e.bottom-f.bottom+x+o)):e.bottom>f.bottom&&(x=e.bottom-f.bottom+o,t<0&&e.top-x<f.top&&(x=-(f.top+x-e.top+o)));else{let y=e.bottom-e.top,C=f.bottom-f.top;x=(r=="center"&&y<=C?e.top+y/2-C/2:r=="start"||r=="center"&&t<0?e.top-o:e.bottom-C+o)-f.top}if(i=="nearest"?e.left<f.left?(m=-(f.left-e.left+s),t>0&&e.right>f.right+m&&(m=e.right-f.right+m+s)):e.right>f.right&&(m=e.right-f.right+s,t<0&&e.left<f.left+m&&(m=-(f.left+m-e.left+s))):m=(i=="center"?e.left+(e.right-e.left)/2-(f.right-f.left)/2:i=="start"==l?e.left-s:e.right-(f.right-f.left)+s)-f.left,m||x)if(d)c.scrollBy(m,x);else{let y=0,C=0;if(x){let M=h.scrollTop;h.scrollTop+=x/b,C=(h.scrollTop-M)*b}if(m){let M=h.scrollLeft;h.scrollLeft+=m/p,y=(h.scrollLeft-M)*p}e={left:e.left-y,top:e.top-C,right:e.right-y,bottom:e.bottom-C},y&&Math.abs(y-m)<1&&(i="nearest"),C&&Math.abs(C-x)<1&&(r="nearest")}if(d)break;h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function _x(n){let e=n.ownerDocument,t,i;for(let r=n.parentNode;r&&!(r==e.body||t&&i);)if(r.nodeType==1)!i&&r.scrollHeight>r.clientHeight&&(i=r),!t&&r.scrollWidth>r.clientWidth&&(t=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:t,y:i}}class qx{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:i}=e;this.set(t,Math.min(e.anchorOffset,t?It(t):0),i,Math.min(e.focusOffset,i?It(i):0))}set(e,t,i,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=r}}let Kn=null;function Hf(n){if(n.setActive)return n.setActive();if(Kn)return n.focus(Kn);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(Kn==null?{get preventScroll(){return Kn={preventScroll:!0},!0}}:void 0),!Kn){Kn=!1;for(let t=0;t<e.length;){let i=e[t++],r=e[t++],s=e[t++];i.scrollTop!=r&&(i.scrollTop=r),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let Ic;function zn(n,e,t=e){let i=Ic||(Ic=document.createRange());return i.setEnd(n,t),i.setStart(n,e),i}function ai(n,e,t,i){let r={key:e,code:e,keyCode:t,which:t,cancelable:!0};i&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=i);let s=new KeyboardEvent("keydown",r);s.synthetic=!0,n.dispatchEvent(s);let o=new KeyboardEvent("keyup",r);return o.synthetic=!0,n.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function Ux(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function Ff(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function Kx(n,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(i=Math.min(i,It(t));;)if(i){if(t.nodeType!=1)return!1;let r=t.childNodes[i-1];r.contentEditable=="false"?i--:(t=r,i=It(t))}else{if(t==n)return!0;i=Bn(t),t=t.parentNode}}function Wf(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function Vf(n,e){for(let t=n,i=e;;){if(t.nodeType==3&&i>0)return{node:t,offset:i};if(t.nodeType==1&&i>0){if(t.contentEditable=="false")return null;t=t.childNodes[i-1],i=It(t)}else if(t.parentNode&&!Cs(t))i=Bn(t),t=t.parentNode;else return null}}function $f(n,e){for(let t=n,i=e;;){if(t.nodeType==3&&i<t.nodeValue.length)return{node:t,offset:i};if(t.nodeType==1&&i<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[i],i=0}else if(t.parentNode&&!Cs(t))i=Bn(t)+1,t=t.parentNode;else return null}}class Ue{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new Ue(e.parentNode,Bn(e),t)}static after(e,t){return new Ue(e.parentNode,Bn(e)+1,t)}}const va=[];class me{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let i=this.dom,r=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=r?r.nextSibling:i.firstChild)){let l=me.get(s);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,t),o.flags&=-8}if(s=r?r.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&s!=o.dom&&(t.written=!0),o.dom.parentNode==i)for(;s&&s!=o.dom;)s=Bc(s);else i.insertBefore(o.dom,s);r=o.dom}for(s=r?r.nextSibling:i.firstChild,s&&t&&t.node==i&&(t.written=!0);s;)s=Bc(s)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,t),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let r=It(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!me.get(i);)i=i.nextSibling;if(!i)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==i)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,i=0){let r=-1,s=-1,o=-1,l=-1;for(let a=0,c=i,h=i;a<this.children.length;a++){let u=this.children[a],f=c+u.length;if(c<e&&f>t)return u.domBoundsAround(e,t,c);if(f>=e&&r==-1&&(r=a,s=c),c>t&&u.dom.parentNode==this.dom){o=a,l=h;break}h=f,c=f+u.breakAfter}return{from:s,to:l<0?i+this.length:l,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=va){this.markDirty();for(let r=e;r<t;r++){let s=this.children[r];s.parent==this&&i.indexOf(s)<0&&s.destroy()}i.length<250?this.children.splice(e,t-e,...i):this.children=[].concat(this.children.slice(0,e),i,this.children.slice(t));for(let r=0;r<i.length;r++)i[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new _f(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,i,r,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}me.prototype.breakAfter=0;function Bc(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class _f{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function qf(n,e,t,i,r,s,o,l,a){let{children:c}=n,h=c.length?c[e]:null,u=s.length?s[s.length-1]:null,f=u?u.breakAfter:o;if(!(e==i&&h&&!o&&!f&&s.length<2&&h.merge(t,r,s.length?u:null,t==0,l,a))){if(i<c.length){let d=c[i];d&&(r<d.length||d.breakAfter&&(u!=null&&u.breakAfter))?(e==i&&(d=d.split(r),r=0),!f&&u&&d.merge(0,r,u,!0,0,a)?s[s.length-1]=d:((r||d.children.length&&!d.children[0].length)&&d.merge(0,r,null,!1,0,a),s.push(d))):d!=null&&d.breakAfter&&(u?u.breakAfter=1:o=1),i++}for(h&&(h.breakAfter=o,t>0&&(!o&&s.length&&h.merge(t,h.length,s[0],!1,l,0)?h.breakAfter=s.shift().breakAfter:(t<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(t,h.length,null,!1,l,0),e++));e<i&&s.length;)if(c[i-1].become(s[s.length-1]))i--,s.pop(),a=s.length?0:l;else if(c[e].become(s[0]))e++,s.shift(),l=s.length?0:a;else break;!s.length&&e&&i<c.length&&!c[e-1].breakAfter&&c[i].merge(0,0,c[e-1],!1,l,a)&&e--,(e<i||s.length)&&n.replaceChildren(e,i,s)}}function Uf(n,e,t,i,r,s){let o=n.childCursor(),{i:l,off:a}=o.findPos(t,1),{i:c,off:h}=o.findPos(e,-1),u=e-t;for(let f of i)u+=f.length;n.length+=u,qf(n,c,h,l,a,i,0,r,s)}let et=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},bl=typeof document<"u"?document:{documentElement:{style:{}}};const xl=/Edge\/(\d+)/.exec(et.userAgent),Kf=/MSIE \d/.test(et.userAgent),yl=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(et.userAgent),Zs=!!(Kf||yl||xl),zc=!Zs&&/gecko\/(\d+)/i.test(et.userAgent),Co=!Zs&&/Chrome\/(\d+)/.exec(et.userAgent),jc="webkitFontSmoothing"in bl.documentElement.style,Gf=!Zs&&/Apple Computer/.test(et.vendor),Hc=Gf&&(/Mobile\/\w+/.test(et.userAgent)||et.maxTouchPoints>2);var F={mac:Hc||/Mac/.test(et.platform),windows:/Win/.test(et.platform),linux:/Linux|X11/.test(et.platform),ie:Zs,ie_version:Kf?bl.documentMode||6:yl?+yl[1]:xl?+xl[1]:0,gecko:zc,gecko_version:zc?+(/Firefox\/(\d+)/.exec(et.userAgent)||[0,0])[1]:0,chrome:!!Co,chrome_version:Co?+Co[1]:0,ios:Hc,android:/Android\b/.test(et.userAgent),webkit:jc,safari:Gf,webkit_version:jc?+(/\bAppleWebKit\/(\d+)/.exec(et.userAgent)||[0,0])[1]:0,tabSize:bl.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Gx=256;class St extends me{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return this.flags&8||i&&(!(i instanceof St)||this.length-(t-e)+i.length>Gx||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new St(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Ue(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Jx(this.dom,e,t)}}class Kt extends me{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let r of t)r.setParent(this)}setAttrs(e){if(Ff(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,i,r,s,o){return i&&(!(i instanceof Kt&&i.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(Uf(this,e,t,i?i.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],i=0,r=-1,s=0;for(let l of this.children){let a=i+l.length;a>e&&t.push(i<e?l.split(e-i):l),r<0&&i>=e&&(r=s),i=a,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new Kt(this.mark,t,o)}domAtPos(e){return Jf(this,e)}coordsAt(e,t){return Xf(this,e,t)}}function Jx(n,e,t){let i=n.nodeValue.length;e>i&&(e=i);let r=e,s=e,o=0;e==0&&t<0||e==i&&t>=0?F.chrome||F.gecko||(e?(r--,o=1):s<i&&(s++,o=-1)):t<0?r--:s<i&&s++;let l=zn(n,r,s).getClientRects();if(!l.length)return null;let a=l[(o?o<0:t>=0)?0:l.length-1];return F.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,c=>c.width)||a),o?Tr(a,o<0):a||null}class ln extends me{static create(e,t,i){return new ln(e,t,i)}constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}split(e){let t=ln.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,i,r,s,o){return i&&(!(i instanceof ln)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e instanceof ln&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return he.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,i=t&&t.state.doc,r=this.posAtStart;return i?i.slice(r,r+this.length):he.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Ue.before(this.dom):Ue.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);if(i)return i;let r=this.dom.getClientRects(),s=null;if(!r.length)return null;let o=this.side?this.side<0:e>0;for(let l=o?r.length-1:0;s=r[l],!(e>0?l==0:l==r.length-1||s.top<s.bottom);l+=o?-1:1);return Tr(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class xi extends me{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof xi&&e.side==this.side}split(){return new xi(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Ue.before(this.dom):Ue.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return he.empty}get isHidden(){return!0}}St.prototype.children=ln.prototype.children=xi.prototype.children=va;function Jf(n,e){let t=n.dom,{children:i}=n,r=0;for(let s=0;r<i.length;r++){let o=i[r],l=s+o.length;if(!(l==s&&o.getSide()<=0)){if(e>s&&e<l&&o.dom.parentNode==t)return o.domAtPos(e-s);if(e<=s)break;s=l}}for(let s=r;s>0;s--){let o=i[s-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let s=r;s<i.length;s++){let o=i[s];if(o.dom.parentNode==t)return o.domAtPos(0)}return new Ue(t,0)}function Yf(n,e,t){let i,{children:r}=n;t>0&&e instanceof Kt&&r.length&&(i=r[r.length-1])instanceof Kt&&i.mark.eq(e.mark)?Yf(i,e.children[0],t-1):(r.push(e),e.setParent(n)),n.length+=e.length}function Xf(n,e,t){let i=null,r=-1,s=null,o=-1;function l(c,h){for(let u=0,f=0;u<c.children.length&&f<=h;u++){let d=c.children[u],p=f+d.length;p>=h&&(d.children.length?l(d,h-f):(!s||s.isHidden&&t>0)&&(p>h||f==p&&d.getSide()>0)?(s=d,o=h-f):(f<h||f==p&&d.getSide()<0&&!d.isHidden)&&(i=d,r=h-f)),f=p}}l(n,e);let a=(t<0?i:s)||i||s;return a?a.coordsAt(Math.max(0,a==i?r:o),t):Yx(n)}function Yx(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=bi(e);return t[t.length-1]||null}function vl(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const Fc=Object.create(null);function As(n,e,t){if(n==e)return!0;n||(n=Fc),e||(e=Fc);let i=Object.keys(n),r=Object.keys(e);if(i.length-(t&&i.indexOf(t)>-1?1:0)!=r.length-(t&&r.indexOf(t)>-1?1:0))return!1;for(let s of i)if(s!=t&&(r.indexOf(s)==-1||n[s]!==e[s]))return!1;return!0}function wl(n,e,t){let i=!1;if(e)for(let r in e)t&&r in t||(i=!0,r=="style"?n.style.cssText="":n.removeAttribute(r));if(t)for(let r in t)e&&e[r]==t[r]||(i=!0,r=="style"?n.style.cssText=t[r]:n.setAttribute(r,t[r]));return i}function Xx(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let i=n.attributes[t];e[i.name]=i.value}return e}class Jt{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Ye=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(Ye||(Ye={}));class U extends In{constructor(e,t,i,r){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Dr(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return t+=i&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new gn(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,r;if(e.isBlockGap)i=-5e8,r=4e8;else{let{start:s,end:o}=Qf(e,t);i=(s?t?-3e8:-1:5e8)-1,r=(o?t?2e8:1:-6e8)+1}return new gn(e,i,r,t,e.widget||null,!0)}static line(e){return new Rr(e)}static set(e,t=!1){return ce.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}U.none=ce.empty;class Dr extends U{constructor(e){let{start:t,end:i}=Qf(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,i;return this==e||e instanceof Dr&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&As(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Dr.prototype.point=!1;class Rr extends U{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Rr&&this.spec.class==e.spec.class&&As(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Rr.prototype.mapMode=Je.TrackBefore;Rr.prototype.point=!0;class gn extends U{constructor(e,t,i,r,s,o){super(t,i,s,e),this.block=r,this.isReplace=o,this.mapMode=r?t<=0?Je.TrackBefore:Je.TrackAfter:Je.TrackDel}get type(){return this.startSide!=this.endSide?Ye.WidgetRange:this.startSide<=0?Ye.WidgetBefore:Ye.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof gn&&Qx(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}gn.prototype.point=!0;function Qf(n,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=n;return t==null&&(t=n.inclusive),i==null&&(i=n.inclusive),{start:t??e,end:i??e}}function Qx(n,e){return n==e||!!(n&&e&&n.compare(e))}function Sl(n,e,t,i=0){let r=t.length-1;r>=0&&t[r]+i>=n?t[r]=Math.max(t[r],e):t.push(n,e)}class Re extends me{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,r,s,o){if(i){if(!(i instanceof Re))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),Uf(this,e,t,i?i.children.slice():[],s,o),!0}split(e){let t=new Re;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:r}=this.childPos(e);r&&(t.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)t.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){As(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Yf(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=vl(t,this.attrs||{})),i&&(this.attrs=vl({class:i},this.attrs||{}))}domAtPos(e){return Jf(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var i;this.dom?this.flags&4&&(Ff(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(wl(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&me.get(r)instanceof Kt;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((i=me.get(r))===null||i===void 0?void 0:i.isEditable)==!1&&(!F.ios||!this.children.some(s=>s instanceof St))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let i of this.children){if(!(i instanceof St)||/[^ -~]/.test(i.text))return null;let r=bi(i.dom);if(r.length!=1)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let i=Xf(this,e,t);if(!this.children.length&&i&&this.parent){let{heightOracle:r}=this.parent.view.viewState,s=i.bottom-i.top;if(Math.abs(s-r.lineHeight)<2&&r.textHeight<s){let o=(s-r.textHeight)/2;return{top:i.top+o,bottom:i.bottom-o,left:i.left,right:i.left}}}return i}become(e){return e instanceof Re&&this.children.length==0&&e.children.length==0&&As(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let i=0,r=0;i<e.children.length;i++){let s=e.children[i],o=r+s.length;if(o>=t){if(s instanceof Re)return s;if(o>t)break}r=o+s.breakAfter}return null}}class Ut extends me{constructor(e,t,i){super(),this.widget=e,this.length=t,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,r,s,o){return i&&(!(i instanceof Ut)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?Ue.before(this.dom):Ue.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new Ut(this.widget,t,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return va}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):he.empty}domBoundsAround(){return null}become(e){return e instanceof Ut&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);return i||(this.widget instanceof kl?null:Tr(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:i}=this.deco;return t==i?!1:e<0?t<0:i>0}}class kl extends Jt{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class nr{constructor(e,t,i,r){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Ut&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Re),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Fr(new xi(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Ut)&&this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-i)),this.getLine().append(Fr(new St(this.text.slice(this.textOff,this.textOff+r)),t),i),this.atCursorPos=!0,this.textOff+=r,e-=r,i=0}}span(e,t,i,r){this.buildText(t-e,i,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,i,r,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof gn){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=t-e;if(i instanceof gn)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Ut(i.widget||yi.block,l,i));else{let a=ln.create(i.widget||yi.inline,l,l?0:i.startSide),c=this.atCursorPos&&!a.isEditable&&s<=r.length&&(e<t||i.startSide>0),h=!a.isEditable&&(e<t||s>r.length||i.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!c&&!a.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),c&&(u.append(Fr(new xi(1),r),s),s=r.length+Math.max(0,s-r.length)),u.append(Fr(a,r),s),this.atCursorPos=h,this.pendingBuffer=h?e<t||s>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,i,r,s){let o=new nr(e,t,i,s);return o.openEnd=ce.spans(r,t,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Fr(n,e){for(let t of e)n=new Kt(t,[n],n.length);return n}class yi extends Jt{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}yi.inline=new yi("span");yi.block=new yi("div");var ve=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(ve||(ve={}));const jn=ve.LTR,wa=ve.RTL;function Zf(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const Zx=Zf("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ey=Zf("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Cl=Object.create(null),At=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);Cl[e]=t,Cl[t]=-e}function ed(n){return n<=247?Zx[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?ey[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const ty=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class an{get dir(){return this.level%2?wa:jn}constructor(e,t,i){this.from=e,this.to=t,this.level=i}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,i,r){let s=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=t&&l.to>=t){if(l.level==i)return o;(s<0||(r!=0?r<0?l.from<t:l.to>t:e[s].level>l.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function td(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let i=n[t],r=e[t];if(i.from!=r.from||i.to!=r.to||i.direction!=r.direction||!td(i.inner,r.inner))return!1}return!0}const pe=[];function ny(n,e,t,i,r){for(let s=0;s<=i.length;s++){let o=s?i[s-1].to:e,l=s<i.length?i[s].from:t,a=s?256:r;for(let c=o,h=a,u=a;c<l;c++){let f=ed(n.charCodeAt(c));f==512?f=h:f==8&&u==4&&(f=16),pe[c]=f==4?2:f,f&7&&(u=f),h=f}for(let c=o,h=a,u=a;c<l;c++){let f=pe[c];if(f==128)c<l-1&&h==pe[c+1]&&h&24?f=pe[c]=h:pe[c]=256;else if(f==64){let d=c+1;for(;d<l&&pe[d]==64;)d++;let p=c&&h==8||d<t&&pe[d]==8?u==1?1:8:256;for(let b=c;b<d;b++)pe[b]=p;c=d-1}else f==8&&u==1&&(pe[c]=1);h=f,f&7&&(u=f)}}}function iy(n,e,t,i,r){let s=r==1?2:1;for(let o=0,l=0,a=0;o<=i.length;o++){let c=o?i[o-1].to:e,h=o<i.length?i[o].from:t;for(let u=c,f,d,p;u<h;u++)if(d=Cl[f=n.charCodeAt(u)])if(d<0){for(let b=l-3;b>=0;b-=3)if(At[b+1]==-d){let m=At[b+2],x=m&2?r:m&4?m&1?s:r:0;x&&(pe[u]=pe[At[b]]=x),l=b;break}}else{if(At.length==189)break;At[l++]=u,At[l++]=f,At[l++]=a}else if((p=pe[u])==2||p==1){let b=p==r;a=b?0:1;for(let m=l-3;m>=0;m-=3){let x=At[m+2];if(x&2)break;if(b)At[m+2]|=2;else{if(x&4)break;At[m+2]|=4}}}}}function ry(n,e,t,i){for(let r=0,s=i;r<=t.length;r++){let o=r?t[r-1].to:n,l=r<t.length?t[r].from:e;for(let a=o;a<l;){let c=pe[a];if(c==256){let h=a+1;for(;;)if(h==l){if(r==t.length)break;h=t[r++].to,l=r<t.length?t[r].from:e}else if(pe[h]==256)h++;else break;let u=s==1,f=(h<e?pe[h]:i)==1,d=u==f?u?1:2:i;for(let p=h,b=r,m=b?t[b-1].to:n;p>a;)p==m&&(p=t[--b].from,m=b?t[b-1].to:n),pe[--p]=d;a=h}else s=c,a++}}}function Al(n,e,t,i,r,s,o){let l=i%2?2:1;if(i%2==r%2)for(let a=e,c=0;a<t;){let h=!0,u=!1;if(c==s.length||a<s[c].from){let b=pe[a];b!=l&&(h=!1,u=b==16)}let f=!h&&l==1?[]:null,d=h?i:i+1,p=a;e:for(;;)if(c<s.length&&p==s[c].from){if(u)break e;let b=s[c];if(!h)for(let m=b.to,x=c+1;;){if(m==t)break e;if(x<s.length&&s[x].from==m)m=s[x++].to;else{if(pe[m]==l)break e;break}}if(c++,f)f.push(b);else{b.from>a&&o.push(new an(a,b.from,d));let m=b.direction==jn!=!(d%2);Ml(n,m?i+1:i,r,b.inner,b.from,b.to,o),a=b.to}p=b.to}else{if(p==t||(h?pe[p]!=l:pe[p]==l))break;p++}f?Al(n,a,p,i+1,r,f,o):a<p&&o.push(new an(a,p,d)),a=p}else for(let a=t,c=s.length;a>e;){let h=!0,u=!1;if(!c||a>s[c-1].to){let b=pe[a-1];b!=l&&(h=!1,u=b==16)}let f=!h&&l==1?[]:null,d=h?i:i+1,p=a;e:for(;;)if(c&&p==s[c-1].to){if(u)break e;let b=s[--c];if(!h)for(let m=b.from,x=c;;){if(m==e)break e;if(x&&s[x-1].to==m)m=s[--x].from;else{if(pe[m-1]==l)break e;break}}if(f)f.push(b);else{b.to<a&&o.push(new an(b.to,a,d));let m=b.direction==jn!=!(d%2);Ml(n,m?i+1:i,r,b.inner,b.from,b.to,o),a=b.from}p=b.from}else{if(p==e||(h?pe[p-1]!=l:pe[p-1]==l))break;p--}f?Al(n,p,a,i+1,r,f,o):p<a&&o.push(new an(p,a,d)),a=p}}function Ml(n,e,t,i,r,s,o){let l=e%2?2:1;ny(n,r,s,i,l),iy(n,r,s,i,l),ry(r,s,i,l),Al(n,r,s,e,t,i,o)}function sy(n,e,t){if(!n)return[new an(0,0,e==wa?1:0)];if(e==jn&&!t.length&&!ty.test(n))return nd(n.length);if(t.length)for(;n.length>pe.length;)pe[pe.length]=256;let i=[],r=e==jn?0:1;return Ml(n,r,r,t,0,n.length,i),i}function nd(n){return[new an(0,n,0)]}let id="";function oy(n,e,t,i,r){var s;let o=i.head-n.from,l=an.find(e,o,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc),a=e[l],c=a.side(r,t);if(o==c){let f=l+=r?1:-1;if(f<0||f>=e.length)return null;a=e[l=f],o=a.side(!r,t),c=a.side(r,t)}let h=Fe(n.text,o,a.forward(r,t));(h<a.from||h>a.to)&&(h=c),id=n.text.slice(Math.min(o,h),Math.max(o,h));let u=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return u&&h==c&&u.level+(r?0:1)<a.level?T.cursor(u.side(!r,t)+n.from,u.forward(r,t)?1:-1,u.level):T.cursor(h+n.from,a.forward(r,t)?-1:1,a.level)}function ly(n,e,t){for(let i=e;i<t;i++){let r=ed(n.charCodeAt(i));if(r==1)return jn;if(r==2||r==4)return wa}return jn}const rd=z.define(),sd=z.define(),od=z.define(),ld=z.define(),El=z.define(),ad=z.define(),cd=z.define(),Sa=z.define(),ka=z.define(),hd=z.define({combine:n=>n.some(e=>e)}),ud=z.define({combine:n=>n.some(e=>e)}),fd=z.define();class ci{constructor(e,t="nearest",i="nearest",r=5,s=5,o=!1){this.range=e,this.y=t,this.x=i,this.yMargin=r,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new ci(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new ci(T.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Wr=ne.define({map:(n,e)=>n.map(e)}),dd=ne.define();function nt(n,e,t){let i=n.facet(ld);i.length?i[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const tn=z.define({combine:n=>n.length?n[0]:!0});let ay=0;const Ui=z.define();class De{constructor(e,t,i,r,s){this.id=e,this.create=t,this.domEventHandlers=i,this.domEventObservers=r,this.extension=s(this)}static define(e,t){const{eventHandlers:i,eventObservers:r,provide:s,decorations:o}=t||{};return new De(ay++,e,i,r,l=>{let a=[Ui.of(l)];return o&&a.push(ur.of(c=>{let h=c.plugin(l);return h?o(h):U.none})),s&&a.push(s(l)),a})}static fromClass(e,t){return De.define(i=>new e(i),t)}}class Ao{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(nt(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){nt(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){nt(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const pd=z.define(),Ca=z.define(),ur=z.define(),md=z.define(),Aa=z.define(),gd=z.define();function Wc(n,e){let t=n.state.facet(gd);if(!t.length)return t;let i=t.map(s=>s instanceof Function?s(n):s),r=[];return ce.spans(i,e.from,e.to,{point(){},span(s,o,l,a){let c=s-e.from,h=o-e.from,u=r;for(let f=l.length-1;f>=0;f--,a--){let d=l[f].spec.bidiIsolate,p;if(d==null&&(d=ly(e.text,c,h)),a>0&&u.length&&(p=u[u.length-1]).to==c&&p.direction==d)p.to=h,u=p.inner;else{let b={from:c,to:h,direction:d,inner:[]};u.push(b),u=b.inner}}}}),r}const bd=z.define();function xd(n){let e=0,t=0,i=0,r=0;for(let s of n.state.facet(bd)){let o=s(n);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(r=Math.max(r,o.bottom)))}return{left:e,right:t,top:i,bottom:r}}const Ki=z.define();class mt{constructor(e,t,i,r){this.fromA=e,this.toA=t,this.fromB=i,this.toB=r}join(e){return new mt(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>i.toA)){if(r.toA<i.fromA)break;i=i.join(r),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let r=0,s=0,o=0,l=0;;r++){let a=r==e.length?null:e[r],c=o-l,h=a?a.fromB:1e9;for(;s<t.length&&t[s]<h;){let u=t[s],f=t[s+1],d=Math.max(l,u),p=Math.min(h,f);if(d<=p&&new mt(d+c,p+c,d,p).addToSet(i),f>h)break;s+=2}if(!a)return i;new mt(a.fromA,a.toA,a.fromB,a.toB).addToSet(i),o=a.toA,l=a.toB}}}class Ms{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=Ne.empty(this.startState.doc.length);for(let s of i)this.changes=this.changes.compose(s.changes);let r=[];this.changes.iterChangedRanges((s,o,l,a)=>r.push(new mt(s,o,l,a))),this.changedRanges=r}static create(e,t,i){return new Ms(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Vc extends me{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=U.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Re],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new mt(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:c,toA:h})=>h<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?r=this.domChanged.newSel.head:!my(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let s=r>-1?hy(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:h}=this.hasComposition;i=new mt(c,h,e.changes.mapPos(c,-1),e.changes.mapPos(h,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(F.ie||F.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,l=this.updateDeco(),a=dy(o,l,e.changes);return i=mt.extendWithRanges(i,a),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,i);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=F.chrome||F.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||r.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Ut&&o.widget instanceof kl&&s.push(o.dom);r.updateGaps(s)}updateChildren(e,t,i){let r=i?i.range.addToSet(e.slice()):e,s=this.childCursor(t);for(let o=r.length-1;;o--){let l=o>=0?r[o]:null;if(!l)break;let{fromA:a,toA:c,fromB:h,toB:u}=l,f,d,p,b;if(i&&i.range.fromB<u&&i.range.toB>h){let M=nr.build(this.view.state.doc,h,i.range.fromB,this.decorations,this.dynamicDecorationMap),w=nr.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);d=M.breakAtStart,p=M.openStart,b=w.openEnd;let A=this.compositionView(i);w.breakAtStart?A.breakAfter=1:w.content.length&&A.merge(A.length,A.length,w.content[0],!1,w.openStart,0)&&(A.breakAfter=w.content[0].breakAfter,w.content.shift()),M.content.length&&A.merge(0,0,M.content[M.content.length-1],!0,0,M.openEnd)&&M.content.pop(),f=M.content.concat(A).concat(w.content)}else({content:f,breakAtStart:d,openStart:p,openEnd:b}=nr.build(this.view.state.doc,h,u,this.decorations,this.dynamicDecorationMap));let{i:m,off:x}=s.findPos(c,1),{i:y,off:C}=s.findPos(a,-1);qf(this,y,C,m,x,f,d,p,b)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let i of t.effects)i.is(dd)&&(this.editContextFormatting=i.value)}compositionView(e){let t=new St(e.text.nodeValue);t.flags|=8;for(let{deco:r}of e.marks)t=new Kt(r,[t],t.length);let i=new Re;return i.append(t,0),i}fixCompositionDOM(e){let t=(s,o)=>{o.flags|=8|(o.children.some(a=>a.flags&7)?1:0),this.markedForComposition.add(o);let l=me.get(s);l&&l!=o&&(l.dom=null),o.setDOM(s)},i=this.childPos(e.range.fromB,1),r=this.children[i.i];t(e.line,r);for(let s=e.marks.length-1;s>=-1;s--)i=r.childPos(i.off,1),r=r.children[i.i],t(s>=0?e.marks[s].node:e.text,r)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,r=i==this.dom,s=!r&&us(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(r||t||s))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(l.anchor)),c=l.empty?a:this.moveToLine(this.domAtPos(l.head));if(F.gecko&&l.empty&&!this.hasComposition&&cy(a)){let u=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(u,a.node.childNodes[a.offset]||null)),a=c=new Ue(u,0),o=!0}let h=this.view.observer.selectionRange;(o||!h.focusNode||(!tr(a.node,a.offset,h.anchorNode,h.anchorOffset)||!tr(c.node,c.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,l))&&(this.view.observer.ignore(()=>{F.android&&F.chrome&&this.dom.contains(h.focusNode)&&py(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let u=hr(this.view.root);if(u)if(l.empty){if(F.gecko){let f=uy(a.node,a.offset);if(f&&f!=3){let d=(f==1?Vf:$f)(a.node,a.offset);d&&(a=new Ue(d.node,d.offset))}}u.collapse(a.node,a.offset),l.bidiLevel!=null&&u.caretBidiLevel!==void 0&&(u.caretBidiLevel=l.bidiLevel)}else if(u.extend){u.collapse(a.node,a.offset);try{u.extend(c.node,c.offset)}catch{}}else{let f=document.createRange();l.anchor>l.head&&([a,c]=[c,a]),f.setEnd(c.node,c.offset),f.setStart(a.node,a.offset),u.removeAllRanges(),u.addRange(f)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(a,c)),this.impreciseAnchor=a.precise?null:new Ue(h.anchorNode,h.anchorOffset),this.impreciseHead=c.precise?null:new Ue(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&tr(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,i=hr(e.root),{anchorNode:r,anchorOffset:s}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let o=Re.find(this,t.head);if(!o)return;let l=o.posAtStart;if(t.head==l||t.head==l+o.length)return;let a=this.coordsAt(t.head,-1),c=this.coordsAt(t.head,1);if(!a||!c||a.bottom>c.top)return;let h=this.domAtPos(t.head+t.assoc);i.collapse(h.node,h.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let u=e.observer.selectionRange;e.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=t.from&&i.collapse(r,s)}moveToLine(e){let t=this.dom,i;if(e.node!=t)return e;for(let r=e.offset;!i&&r<t.childNodes.length;r++){let s=me.get(t.childNodes[r]);s instanceof Re&&(i=s.domAtPos(0))}for(let r=e.offset-1;!i&&r>=0;r--){let s=me.get(t.childNodes[r]);s instanceof Re&&(i=s.domAtPos(s.length))}return i?new Ue(i.node,i.offset,!0):e}nearest(e){for(let t=e;t;){let i=me.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(i<r.length||r instanceof Re)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){let i=null,r=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let l=this.children[o],a=s-l.breakAfter,c=a-l.length;if(a<e)break;if(c<=e&&(c<e||l.covers(-1))&&(a>e||l.covers(1))&&(!i||l instanceof Re&&!(i instanceof Re&&t>=0)))i=l,r=c;else if(i&&c==e&&a==e&&l instanceof Ut&&Math.abs(t)<2){if(l.deco.startSide<0)break;o&&(i=null)}s=c}return i?i.coordsAt(e-r,t):null}coordsForChar(e){let{i:t,off:i}=this.childPos(e,1),r=this.children[t];if(!(r instanceof Re))return null;for(;r.children.length;){let{i:l,off:a}=r.childPos(i,1);for(;;l++){if(l==r.children.length)return null;if((r=r.children[l]).length)break}i=a}if(!(r instanceof St))return null;let s=Fe(r.text,i);if(s==i)return null;let o=zn(r.dom,i,s).getClientRects();for(let l=0;l<o.length;l++){let a=o[l];if(l==o.length-1||a.top<a.bottom&&a.left<a.right)return a}return null}measureVisibleLineHeights(e){let t=[],{from:i,to:r}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==ve.LTR;for(let c=0,h=0;h<this.children.length;h++){let u=this.children[h],f=c+u.length;if(f>r)break;if(c>=i){let d=u.dom.getBoundingClientRect();if(t.push(d.height),o){let p=u.dom.lastChild,b=p?bi(p):[];if(b.length){let m=b[b.length-1],x=a?m.right-d.left:d.right-m.left;x>l&&(l=x,this.minWidth=s,this.minWidthFrom=c,this.minWidthTo=f)}}}c=f+u.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?ve.RTL:ve.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Re){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),t,i,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=bi(e.firstChild)[0];t=e.getBoundingClientRect().height,i=s?s.width/27:7,r=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:i,textHeight:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new _f(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,r=0;;r++){let s=r==t.viewports.length?null:t.viewports[r],o=s?s.from-1:this.length;if(o>i){let l=(t.lineBlockAt(o).bottom-t.lineBlockAt(i).top)/this.view.scaleY;e.push(U.replace({widget:new kl(l),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return U.set(e)}updateDeco(){let e=1,t=this.view.state.facet(ur).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),i=!1,r=this.view.state.facet(md).map((s,o)=>{let l=typeof s=="function";return l&&(i=!0),l?s(this.view):s});for(r.length&&(this.dynamicDecorationMap[e++]=i,t.push(ce.join(r))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(fd))try{if(c(this.view,e.range,e))return!0}catch(h){nt(this.view.state,h,"scroll handler")}let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!i)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,r.left),top:Math.min(i.top,r.top),right:Math.max(i.right,r.right),bottom:Math.max(i.bottom,r.bottom)});let s=xd(this.view),o={left:i.left-s.left,top:i.top-s.top,right:i.right+s.right,bottom:i.bottom+s.bottom},{offsetWidth:l,offsetHeight:a}=this.view.scrollDOM;$x(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,l),-l),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==ve.LTR)}}function cy(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function yd(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let i=Vf(t.focusNode,t.focusOffset),r=$f(t.focusNode,t.focusOffset),s=i||r;if(r&&i&&r.node!=i.node){let l=me.get(r.node);if(!l||l instanceof St&&l.text!=r.node.nodeValue)s=r;else if(n.docView.lastCompositionAfterCursor){let a=me.get(i.node);!a||a instanceof St&&a.text!=i.node.nodeValue||(s=r)}}if(n.docView.lastCompositionAfterCursor=s!=i,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function hy(n,e,t){let i=yd(n,t);if(!i)return null;let{node:r,from:s,to:o}=i,l=r.nodeValue;if(/[\n\r]/.test(l)||n.state.doc.sliceString(i.from,i.to)!=l)return null;let a=e.invertedDesc,c=new mt(a.mapPos(s),a.mapPos(o),s,o),h=[];for(let u=r.parentNode;;u=u.parentNode){let f=me.get(u);if(f instanceof Kt)h.push({node:u,deco:f.mark});else{if(f instanceof Re||u.nodeName=="DIV"&&u.parentNode==n.contentDOM)return{range:c,text:r,marks:h,line:u};if(u!=n.contentDOM)h.push({node:u,deco:new Dr({inclusive:!0,attributes:Xx(u),tagName:u.tagName.toLowerCase()})});else return null}}}function uy(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let fy=class{constructor(){this.changes=[]}compareRange(e,t){Sl(e,t,this.changes)}comparePoint(e,t){Sl(e,t,this.changes)}};function dy(n,e,t){let i=new fy;return ce.compare(n,e,t,i),i.changes}function py(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function my(n,e){let t=!1;return e&&n.iterChangedRanges((i,r)=>{i<e.to&&r>e.from&&(t=!0)}),t}function gy(n,e,t=1){let i=n.charCategorizer(e),r=n.doc.lineAt(e),s=e-r.from;if(r.length==0)return T.cursor(e);s==0?t=1:s==r.length&&(t=-1);let o=s,l=s;t<0?o=Fe(r.text,s,!1):l=Fe(r.text,s);let a=i(r.text.slice(o,l));for(;o>0;){let c=Fe(r.text,o,!1);if(i(r.text.slice(c,o))!=a)break;o=c}for(;l<r.length;){let c=Fe(r.text,l);if(i(r.text.slice(l,c))!=a)break;l=c}return T.range(o+r.from,l+r.from)}function by(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function xy(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function Mo(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function $c(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function _c(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function Tl(n,e,t){let i,r,s,o,l=!1,a,c,h,u;for(let p=n.firstChild;p;p=p.nextSibling){let b=bi(p);for(let m=0;m<b.length;m++){let x=b[m];r&&Mo(r,x)&&(x=$c(_c(x,r.bottom),r.top));let y=by(e,x),C=xy(t,x);if(y==0&&C==0)return p.nodeType==3?qc(p,e,t):Tl(p,e,t);if(!i||o>C||o==C&&s>y){i=p,r=x,s=y,o=C;let M=C?t<x.top?-1:1:y?e<x.left?-1:1:0;l=!M||(M>0?m<b.length-1:m>0)}y==0?t>x.bottom&&(!h||h.bottom<x.bottom)?(a=p,h=x):t<x.top&&(!u||u.top>x.top)&&(c=p,u=x):h&&Mo(h,x)?h=_c(h,x.bottom):u&&Mo(u,x)&&(u=$c(u,x.top))}}if(h&&h.bottom>=t?(i=a,r=h):u&&u.top<=t&&(i=c,r=u),!i)return{node:n,offset:0};let f=Math.max(r.left,Math.min(r.right,e));if(i.nodeType==3)return qc(i,f,t);if(l&&i.contentEditable!="false")return Tl(i,f,t);let d=Array.prototype.indexOf.call(n.childNodes,i)+(e>=(r.left+r.right)/2?1:0);return{node:n,offset:d}}function qc(n,e,t){let i=n.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<i;l++){let a=zn(n,l,l+1).getClientRects();for(let c=0;c<a.length;c++){let h=a[c];if(h.top==h.bottom)continue;o||(o=e-h.left);let u=(h.top>t?h.top-t:t-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&u<s){let f=e>=(h.left+h.right)/2,d=f;if((F.chrome||F.gecko)&&zn(n,l).getBoundingClientRect().left==h.right&&(d=!f),u<=0)return{node:n,offset:l+(d?1:0)};r=l+(d?1:0),s=u}}}return{node:n,offset:r>-1?r:o>0?n.nodeValue.length:0}}function vd(n,e,t,i=-1){var r,s;let o=n.contentDOM.getBoundingClientRect(),l=o.top+n.viewState.paddingTop,a,{docHeight:c}=n.viewState,{x:h,y:u}=e,f=u-l;if(f<0)return 0;if(f>c)return n.state.doc.length;for(let M=n.viewState.heightOracle.textHeight/2,w=!1;a=n.elementAtHeight(f),a.type!=Ye.Text;)for(;f=i>0?a.bottom+M:a.top-M,!(f>=0&&f<=c);){if(w)return t?null:0;w=!0,i=-i}u=l+f;let d=a.from;if(d<n.viewport.from)return n.viewport.from==0?0:t?null:Uc(n,o,a,h,u);if(d>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:t?null:Uc(n,o,a,h,u);let p=n.dom.ownerDocument,b=n.root.elementFromPoint?n.root:p,m=b.elementFromPoint(h,u);m&&!n.contentDOM.contains(m)&&(m=null),m||(h=Math.max(o.left+1,Math.min(o.right-1,h)),m=b.elementFromPoint(h,u),m&&!n.contentDOM.contains(m)&&(m=null));let x,y=-1;if(m&&((r=n.docView.nearest(m))===null||r===void 0?void 0:r.isEditable)!=!1){if(p.caretPositionFromPoint){let M=p.caretPositionFromPoint(h,u);M&&({offsetNode:x,offset:y}=M)}else if(p.caretRangeFromPoint){let M=p.caretRangeFromPoint(h,u);M&&({startContainer:x,startOffset:y}=M,(!n.contentDOM.contains(x)||F.safari&&yy(x,y,h)||F.chrome&&vy(x,y,h))&&(x=void 0))}x&&(y=Math.min(It(x),y))}if(!x||!n.docView.dom.contains(x)){let M=Re.find(n.docView,d);if(!M)return f>a.top+a.height/2?a.to:a.from;({node:x,offset:y}=Tl(M.dom,h,u))}let C=n.docView.nearest(x);if(!C)return null;if(C.isWidget&&((s=C.dom)===null||s===void 0?void 0:s.nodeType)==1){let M=C.dom.getBoundingClientRect();return e.y<M.top||e.y<=M.bottom&&e.x<=(M.left+M.right)/2?C.posAtStart:C.posAtEnd}else return C.localPosFromDOM(x,y)+C.posAtStart}function Uc(n,e,t,i,r){let s=Math.round((i-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let l=n.viewState.heightOracle.textHeight,a=Math.floor((r-t.top-(n.defaultLineHeight-l)*.5)/l);s+=a*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+dl(o,s,n.state.tabSize)}function yy(n,e,t){let i;if(n.nodeType!=3||e!=(i=n.nodeValue.length))return!1;for(let r=n.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return zn(n,i-1,i).getBoundingClientRect().left>t}function vy(n,e,t){if(e!=0)return!1;for(let r=n;;){let s=r.parentNode;if(!s||s.nodeType!=1||s.firstChild!=r)return!1;if(s.classList.contains("cm-line"))break;r=s}let i=n.nodeType==1?n.getBoundingClientRect():zn(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return t-i.left>5}function Dl(n,e){let t=n.lineBlockAt(e);if(Array.isArray(t.type)){for(let i of t.type)if(i.to>e||i.to==e&&(i.to==t.to||i.type==Ye.Text))return i}return t}function wy(n,e,t,i){let r=Dl(n,e.head),s=!i||r.type!=Ye.Text||!(n.lineWrapping||r.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let o=n.dom.getBoundingClientRect(),l=n.textDirectionAt(r.from),a=n.posAtCoords({x:t==(l==ve.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(a!=null)return T.cursor(a,t?-1:1)}return T.cursor(t?r.to:r.from,t?-1:1)}function Kc(n,e,t,i){let r=n.state.doc.lineAt(e.head),s=n.bidiSpans(r),o=n.textDirectionAt(r.from);for(let l=e,a=null;;){let c=oy(r,s,o,l,t),h=id;if(!c){if(r.number==(t?n.state.doc.lines:1))return l;h=`
`,r=n.state.doc.line(r.number+(t?1:-1)),s=n.bidiSpans(r),c=n.visualLineSide(r,!t)}if(a){if(!a(h))return l}else{if(!i)return c;a=i(h)}l=c}}function Sy(n,e,t){let i=n.state.charCategorizer(e),r=i(t);return s=>{let o=i(s);return r==Se.Space&&(r=o),r==o}}function ky(n,e,t,i){let r=e.head,s=t?1:-1;if(r==(t?n.state.doc.length:0))return T.cursor(r,e.assoc);let o=e.goalColumn,l,a=n.contentDOM.getBoundingClientRect(),c=n.coordsAtPos(r,e.assoc||-1),h=n.documentTop;if(c)o==null&&(o=c.left-a.left),l=s<0?c.top:c.bottom;else{let d=n.viewState.lineBlockAt(r);o==null&&(o=Math.min(a.right-a.left,n.defaultCharacterWidth*(r-d.from))),l=(s<0?d.top:d.bottom)+h}let u=a.left+o,f=i??n.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=l+(f+d)*s,b=vd(n,{x:u,y:p},!1,s);if(p<a.top||p>a.bottom||(s<0?b<r:b>r)){let m=n.docView.coordsForChar(b),x=!m||p<m.top?-1:1;return T.cursor(b,x,void 0,o)}}}function fs(n,e,t){for(;;){let i=0;for(let r of n)r.between(e-1,e+1,(s,o,l)=>{if(e>s&&e<o){let a=i||t||(e-s<o-e?-1:1);e=a<0?s:o,i=a}});if(!i)return e}}function Eo(n,e,t){let i=fs(n.state.facet(Aa).map(r=>r(n)),t.from,e.head>t.from?-1:1);return i==t.from?t:T.cursor(i,i<t.from?1:-1)}const Gi="￿";class Cy{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(ae.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Gi}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let r=e;;){this.findPointBefore(i,r);let s=this.text.length;this.readNode(r);let o=r.nextSibling;if(o==t)break;let l=me.get(r),a=me.get(o);(l&&a?l.breakAfter:(l?l.breakAfter:Cs(r))||Cs(o)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>s)&&this.lineBreak(),r=o}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,l;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(l=r.exec(t))&&(s=l.index,o=l[0].length),this.append(t.slice(i,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=o-1);i=s+o}}readNode(e){if(e.cmIgnore)return;let t=me.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let r=i.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(Ay(e,i.node,i.offset)?t:0))}}function Ay(n,e,t){for(;;){if(!e||t<It(e))return!1;if(e==n)return!0;t=Bn(e)+1,e=e.parentNode}}class Gc{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class My{constructor(e,t,i,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,i,0))){let l=s||o?[]:Dy(e),a=new Cy(l,e.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=Ry(l,this.bounds.from)}else{let l=e.observer.selectionRange,a=s&&s.node==l.focusNode&&s.offset==l.focusOffset||!gl(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),c=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!gl(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset),h=e.viewport;if((F.ios||F.chrome)&&e.state.selection.main.empty&&a!=c&&(h.from>0||h.to<e.state.doc.length)){let u=Math.min(a,c),f=Math.max(a,c),d=h.from-u,p=h.to-f;(d==0||d==1||u==0)&&(p==0||p==-1||f==e.state.doc.length)&&(a=0,c=e.state.doc.length)}this.newSel=T.single(c,a)}}}function wd(n,e){let t,{newSel:i}=e,r=n.state.selection.main,s=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:l}=e.bounds,a=r.from,c=null;(s===8||F.android&&e.text.length<l-o)&&(a=r.to,c="end");let h=Ty(n.state.doc.sliceString(o,l,Gi),e.text,a-o,c);h&&(F.chrome&&s==13&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==Gi+Gi&&h.toB--,t={from:o+h.from,to:o+h.toA,insert:he.of(e.text.slice(h.from,h.toB).split(Gi))})}else i&&(!n.hasFocus&&n.state.facet(tn)||i.main.eq(r))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!r.empty&&i&&i.main.empty?t={from:r.from,to:r.to,insert:n.state.doc.slice(r.from,r.to)}:t&&t.from>=r.from&&t.to<=r.to&&(t.from!=r.from||t.to!=r.to)&&r.to-r.from-(t.to-t.from)<=4?t={from:r.from,to:r.to,insert:n.state.doc.slice(r.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,r.to))}:(F.mac||F.android)&&t&&t.from==t.to&&t.from==r.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=T.single(i.main.anchor-1,i.main.head-1)),t={from:r.from,to:r.to,insert:he.of([" "])}):F.chrome&&t&&t.from==t.to&&t.from==r.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(i&&(i=T.single(i.main.anchor-1,i.main.head-1)),t={from:r.from,to:r.to,insert:he.of([" "])}),t)return Ma(n,t,i,s);if(i&&!i.main.eq(r)){let o=!1,l="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),l=n.inputState.lastSelectionOrigin),n.dispatch({selection:i,scrollIntoView:o,userEvent:l}),!0}else return!1}function Ma(n,e,t,i=-1){if(F.ios&&n.inputState.flushIOSKey(e))return!0;let r=n.state.selection.main;if(F.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&n.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&ai(n.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&ai(n.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&ai(n.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,l=()=>o||(o=Ey(n,e,t));return n.state.facet(ad).some(a=>a(n,e.from,e.to,s,l))||n.dispatch(l()),!0}function Ey(n,e,t){let i,r=n.state,s=r.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let l=s.from<e.from?r.sliceDoc(s.from,e.from):"",a=s.to>e.to?r.sliceDoc(e.to,s.to):"";i=r.replaceSelection(n.state.toText(l+e.insert.sliceString(0,void 0,n.state.lineBreak)+a))}else{let l=r.changes(e),a=t&&t.main.to<=l.newLength?t.main:void 0;if(r.selection.ranges.length>1&&n.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let c=n.state.sliceDoc(e.from,e.to),h,u=t&&yd(n,t.main.head);if(u){let p=e.insert.length-(e.to-e.from);h={from:u.from,to:u.to-p}}else h=n.state.doc.lineAt(s.head);let f=s.to-e.to,d=s.to-s.from;i=r.changeByRange(p=>{if(p.from==s.from&&p.to==s.to)return{changes:l,range:a||p.map(l)};let b=p.to-f,m=b-c.length;if(p.to-p.from!=d||n.state.sliceDoc(m,b)!=c||p.to>=h.from&&p.from<=h.to)return{range:p};let x=r.changes({from:m,to:b,insert:e.insert}),y=p.to-s.to;return{changes:x,range:a?T.range(Math.max(0,a.anchor+y),Math.max(0,a.head+y)):p.map(x)}})}else i={changes:l,selection:a&&r.selection.replaceRange(a)}}let o="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,o+=".compose",n.inputState.compositionFirstChange&&(o+=".start",n.inputState.compositionFirstChange=!1)),r.update(i,{userEvent:o,scrollIntoView:!0})}function Ty(n,e,t,i){let r=Math.min(n.length,e.length),s=0;for(;s<r&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&n.length==e.length)return null;let o=n.length,l=e.length;for(;o>0&&l>0&&n.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(i=="end"){let a=Math.max(0,s-Math.min(o,l));t-=o+a-s}if(o<s&&n.length<e.length){let a=t<=s&&t>=o?s-t:0;s-=a,l=s+(l-o),o=s}else if(l<s){let a=t<=s&&t>=l?s-t:0;s-=a,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}function Dy(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:r,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new Gc(t,i)),(r!=t||s!=i)&&e.push(new Gc(r,s))),e}function Ry(n,e){if(n.length==0)return null;let t=n[0].pos,i=n.length==2?n[1].pos:t;return t>-1&&i>-1?T.single(t+e,i+e):null}class Ny{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,F.safari&&e.contentDOM.addEventListener("input",()=>null),F.gecko&&Ky(e.contentDOM.ownerDocument)}handleEvent(e){!Hy(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let i=this.handlers[e];if(i){for(let r of i.observers)r(this.view,t);for(let r of i.handlers){if(t.defaultPrevented)break;if(r(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=Oy(e),i=this.handlers,r=this.view.contentDOM;for(let s in t)if(s!="scroll"){let o=!t[s].handlers.length,l=i[s];l&&o!=!l.handlers.length&&(r.removeEventListener(s,this.handleEvent),l=null),l||r.addEventListener(s,this.handleEvent,{passive:o})}for(let s in i)s!="scroll"&&!t[s]&&r.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&kd.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),F.android&&F.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return F.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=Sd.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||Ly.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,ai(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:F.safari&&!F.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Jc(n,e){return(t,i)=>{try{return e.call(n,i,t)}catch(r){nt(t.state,r)}}}function Oy(n){let e=Object.create(null);function t(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of n){let r=i.spec;if(r&&r.domEventHandlers)for(let s in r.domEventHandlers){let o=r.domEventHandlers[s];o&&t(s).handlers.push(Jc(i.value,o))}if(r&&r.domEventObservers)for(let s in r.domEventObservers){let o=r.domEventObservers[s];o&&t(s).observers.push(Jc(i.value,o))}}for(let i in kt)t(i).handlers.push(kt[i]);for(let i in bt)t(i).observers.push(bt[i]);return e}const Sd=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ly="dthko",kd=[16,17,18,20,91,92,224,225],Vr=6;function $r(n){return Math.max(0,n)*.7+8}function Py(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class Iy{constructor(e,t,i,r){this.view=e,this.startEvent=t,this.style=i,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=_x(e.contentDOM),this.atoms=e.state.facet(Aa).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(ae.allowMultipleSelections)&&By(e,t),this.dragging=jy(e,t)&&Md(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Py(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,i=0,r=0,s=0,o=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:l}=this.scrollParents.y.getBoundingClientRect());let a=xd(this.view);e.clientX-a.left<=r+Vr?t=-$r(r-e.clientX):e.clientX+a.right>=o-Vr&&(t=$r(e.clientX-o)),e.clientY-a.top<=s+Vr?i=-$r(s-e.clientY):e.clientY+a.bottom>=l-Vr&&(i=$r(e.clientY-l)),this.setScrollSpeed(t,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let i=0;i<e.ranges.length;i++){let r=e.ranges[i],s=null;if(r.empty){let o=fs(this.atoms,r.from,0);o!=r.from&&(s=T.cursor(o,-1))}else{let o=fs(this.atoms,r.from,-1),l=fs(this.atoms,r.to,1);(o!=r.from||l!=r.to)&&(s=T.range(r.from==r.anchor?o:l,r.from==r.head?o:l))}s&&(t||(t=e.ranges.slice()),t[i]=s)}return t?T.create(t,e.mainIndex):e}select(e){let{view:t}=this,i=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function By(n,e){let t=n.state.facet(rd);return t.length?t[0](e):F.mac?e.metaKey:e.ctrlKey}function zy(n,e){let t=n.state.facet(sd);return t.length?t[0](e):F.mac?!e.altKey:!e.ctrlKey}function jy(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let i=hr(n.root);if(!i||i.rangeCount==0)return!0;let r=i.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function Hy(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=me.get(t))&&i.ignoreEvent(e))return!1;return!0}const kt=Object.create(null),bt=Object.create(null),Cd=F.ie&&F.ie_version<15||F.ios&&F.webkit_version<604;function Fy(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),Ad(n,t.value)},50)}function eo(n,e,t){for(let i of n.facet(e))t=i(t,n);return t}function Ad(n,e){e=eo(n.state,Sa,e);let{state:t}=n,i,r=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(Rl!=null&&t.selection.ranges.every(a=>a.empty)&&Rl==s.toString()){let a=-1;i=t.changeByRange(c=>{let h=t.doc.lineAt(c.from);if(h.from==a)return{range:c};a=h.from;let u=t.toText((o?s.line(r++).text:e)+t.lineBreak);return{changes:{from:h.from,insert:u},range:T.cursor(c.from+u.length)}})}else o?i=t.changeByRange(a=>{let c=s.line(r++);return{changes:{from:a.from,to:a.to,insert:c.text},range:T.cursor(a.from+c.length)}}):i=t.replaceSelection(s);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}bt.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};kt.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);bt.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};bt.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};kt.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let i of n.state.facet(od))if(t=i(n,e),t)break;if(!t&&e.button==0&&(t=$y(n,e)),t){let i=!n.hasFocus;n.inputState.startMouseSelection(new Iy(n,e,t,i)),i&&n.observer.ignore(()=>{Hf(n.contentDOM);let s=n.root.activeElement;s&&!s.contains(n.contentDOM)&&s.blur()});let r=n.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function Yc(n,e,t,i){if(i==1)return T.cursor(e,t);if(i==2)return gy(n.state,e,t);{let r=Re.find(n.docView,e),s=n.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,l=r?r.posAtEnd:s.to;return l<n.state.doc.length&&l==s.to&&l++,T.range(o,l)}}let Xc=(n,e,t)=>e>=t.top&&e<=t.bottom&&n>=t.left&&n<=t.right;function Wy(n,e,t,i){let r=Re.find(n.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&Xc(t,i,o))return-1;let l=r.coordsAt(s,1);return l&&Xc(t,i,l)?1:o&&o.bottom>=i?-1:1}function Qc(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Wy(n,t,e.clientX,e.clientY)}}const Vy=F.ie&&F.ie_version<=11;let Zc=null,eh=0,th=0;function Md(n){if(!Vy)return n.detail;let e=Zc,t=th;return Zc=n,th=Date.now(),eh=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(eh+1)%3:1}function $y(n,e){let t=Qc(n,e),i=Md(e),r=n.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),r=r.map(s.changes))},get(s,o,l){let a=Qc(n,s),c,h=Yc(n,a.pos,a.bias,i);if(t.pos!=a.pos&&!o){let u=Yc(n,t.pos,t.bias,i),f=Math.min(u.from,h.from),d=Math.max(u.to,h.to);h=f<h.from?T.range(f,d):T.range(d,f)}return o?r.replaceRange(r.main.extend(h.from,h.to)):l&&i==1&&r.ranges.length>1&&(c=_y(r,a.pos))?c:l?r.addRange(h):T.create([h])}}}function _y(n,e){for(let t=0;t<n.ranges.length;t++){let{from:i,to:r}=n.ranges[t];if(i<=e&&r>=e)return T.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}kt.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let r=n.docView.nearest(e.target);if(r&&r.isWidget){let s=r.posAtStart,o=s+r.length;(s>=t.to||o<=t.from)&&(t=T.range(s,o))}}let{inputState:i}=n;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",eo(n.state,ka,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};kt.dragend=n=>(n.inputState.draggedContent=null,!1);function nh(n,e,t,i){if(t=eo(n.state,Sa,t),!t)return;let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=n.inputState,o=i&&s&&zy(n,e)?{from:s.from,to:s.to}:null,l={from:r,insert:t},a=n.state.changes(o?[o,l]:l);n.focus(),n.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}kt.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let i=Array(t.length),r=0,s=()=>{++r==t.length&&nh(n,e,i.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(i[o]=l.result),s()},l.readAsText(t[o])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return nh(n,e,i,!0),!0}return!1};kt.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=Cd?null:e.clipboardData;return t?(Ad(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(Fy(n),!1)};function qy(n,e){let t=n.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function Uy(n){let e=[],t=[],i=!1;for(let r of n.selection.ranges)r.empty||(e.push(n.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>r&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),r=o.number}i=!0}return{text:eo(n,ka,e.join(n.lineBreak)),ranges:t,linewise:i}}let Rl=null;kt.copy=kt.cut=(n,e)=>{let{text:t,ranges:i,linewise:r}=Uy(n.state);if(!t&&!r)return!1;Rl=r?t:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=Cd?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(qy(n,t),!1)};const Ed=jt.define();function Td(n,e){let t=[];for(let i of n.facet(cd)){let r=i(n,e);r&&t.push(r)}return t?n.update({effects:t,annotations:Ed.of(!0)}):null}function Dd(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=Td(n.state,e);t?n.dispatch(t):n.update([])}},10)}bt.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),Dd(n)};bt.blur=n=>{n.observer.clearSelectionRange(),Dd(n)};bt.compositionstart=bt.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};bt.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,F.chrome&&F.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};bt.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};kt.beforeinput=(n,e)=>{var t,i;if(e.inputType=="insertReplacementText"&&n.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let l=o[0],a=n.posAtDOM(l.startContainer,l.startOffset),c=n.posAtDOM(l.endContainer,l.endOffset);return Ma(n,{from:a,to:c,insert:n.state.toText(s)},null),!0}}let r;if(F.chrome&&F.android&&(r=Sd.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let s=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return F.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),F.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>bt.compositionend(n,e),20),!1};const ih=new Set;function Ky(n){ih.has(n)||(ih.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const rh=["pre-wrap","normal","pre-line","break-spaces"];let vi=!1;function sh(){vi=!1}class Gy{constructor(e){this.lineWrapping=e,this.doc=he.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return rh.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let r=e[i];r<0?i++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,i,r,s,o){let l=rh.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=t,this.charWidth=i,this.textHeight=r,this.lineLength=s,a){this.heightSamples={};for(let c=0;c<o.length;c++){let h=o[c];h<0?c++:this.heightSamples[Math.floor(h*10)]=!0}}return a}}class Jy{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Nt{constructor(e,t,i,r,s){this.from=e,this.length=t,this.top=i,this.height=r,this._content=s}get type(){return typeof this._content=="number"?Ye.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof gn?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Nt(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var ye=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(ye||(ye={}));const ds=.001;class Xe{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>ds&&(vi=!0),this.height=e)}replace(e,t,i){return Xe.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,r){let s=this,o=i.doc;for(let l=r.length-1;l>=0;l--){let{fromA:a,toA:c,fromB:h,toB:u}=r[l],f=s.lineAt(a,ye.ByPosNoHeight,i.setDoc(t),0,0),d=f.to>=c?f:s.lineAt(c,ye.ByPosNoHeight,i,0,0);for(u+=d.to-c,c=d.to;l>0&&f.from<=r[l-1].toA;)a=r[l-1].fromA,h=r[l-1].fromB,l--,a<f.from&&(f=s.lineAt(a,ye.ByPosNoHeight,i,0,0));h+=f.from-a,a=f.from;let p=Ea.build(i.setDoc(o),e,h,u);s=Es(s,s.replace(a,c,p))}return s.updateHeight(i,0)}static empty(){return new ot(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,r=0,s=0;for(;;)if(t==i)if(r>s*2){let l=e[t-1];l.break?e.splice(--t,1,l.left,null,l.right):e.splice(--t,1,l.left,l.right),i+=1+l.break,r-=l.size}else if(s>r*2){let l=e[i];l.break?e.splice(i,1,l.left,null,l.right):e.splice(i,1,l.left,l.right),i+=2+l.break,s-=l.size}else break;else if(r<s){let l=e[t++];l&&(r+=l.size)}else{let l=e[--i];l&&(s+=l.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,i++),new Yy(Xe.of(e.slice(0,t)),o,Xe.of(e.slice(i)))}}function Es(n,e){return n==e?n:(n.constructor!=e.constructor&&(vi=!0),e)}Xe.prototype.size=1;class Rd extends Xe{constructor(e,t,i){super(e,t),this.deco=i}blockAt(e,t,i,r){return new Nt(r,this.length,i,this.height,this.deco||0)}lineAt(e,t,i,r,s){return this.blockAt(0,i,r,s)}forEachLine(e,t,i,r,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,i,r,s))}updateHeight(e,t=0,i=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class ot extends Rd{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,i,r){return new Nt(r,this.length,i,this.height,this.breaks)}replace(e,t,i){let r=i[0];return i.length==1&&(r instanceof ot||r instanceof Pe&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof Pe?r=new ot(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):Xe.of(i)}updateHeight(e,t=0,i=!1,r){return r&&r.from<=t&&r.more?this.setHeight(r.heights[r.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Pe extends Xe{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,s=r-i+1,o,l=0;if(e.lineWrapping){let a=Math.min(this.height,e.lineHeight*s);o=a/s,this.length>s+1&&(l=(this.height-a)/(this.length-s-1))}else o=this.height/s;return{firstLine:i,lastLine:r,perLine:o,perChar:l}}blockAt(e,t,i,r){let{firstLine:s,lastLine:o,perLine:l,perChar:a}=this.heightMetrics(t,r);if(t.lineWrapping){let c=r+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),h=t.doc.lineAt(c),u=l+h.length*a,f=Math.max(i,e-u/2);return new Nt(h.from,h.length,f,u,0)}else{let c=Math.max(0,Math.min(o-s,Math.floor((e-i)/l))),{from:h,length:u}=t.doc.line(s+c);return new Nt(h,u,i+l*c,l,0)}}lineAt(e,t,i,r,s){if(t==ye.ByHeight)return this.blockAt(e,i,r,s);if(t==ye.ByPosNoHeight){let{from:d,to:p}=i.doc.lineAt(e);return new Nt(d,p-d,0,0,0)}let{firstLine:o,perLine:l,perChar:a}=this.heightMetrics(i,s),c=i.doc.lineAt(e),h=l+c.length*a,u=c.number-o,f=r+l*u+a*(c.from-s-u);return new Nt(c.from,c.length,Math.max(r,Math.min(f,r+this.height-h)),h,0)}forEachLine(e,t,i,r,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:l,perLine:a,perChar:c}=this.heightMetrics(i,s);for(let h=e,u=r;h<=t;){let f=i.doc.lineAt(h);if(h==e){let p=f.number-l;u+=a*p+c*(e-s-p)}let d=a+c*f.length;o(new Nt(f.from,f.length,u,d,0)),u+=d,h=f.to+1}}replace(e,t,i){let r=this.length-t;if(r>0){let s=i[i.length-1];s instanceof Pe?i[i.length-1]=new Pe(s.length+r):i.push(null,new Pe(r-1))}if(e>0){let s=i[0];s instanceof Pe?i[0]=new Pe(e+s.length):i.unshift(new Pe(e-1),null)}return Xe.of(i)}decomposeLeft(e,t){t.push(new Pe(e-1),null)}decomposeRight(e,t){t.push(null,new Pe(this.length-e-1))}updateHeight(e,t=0,i=!1,r){let s=t+this.length;if(r&&r.from<=t+this.length&&r.more){let o=[],l=Math.max(t,r.from),a=-1;for(r.from>t&&o.push(new Pe(r.from-t-1).updateHeight(e,t));l<=s&&r.more;){let h=e.doc.lineAt(l).length;o.length&&o.push(null);let u=r.heights[r.index++];a==-1?a=u:Math.abs(u-a)>=ds&&(a=-2);let f=new ot(h,u);f.outdated=!1,o.push(f),l+=h+1}l<=s&&o.push(null,new Pe(s-l).updateHeight(e,l));let c=Xe.of(o);return(a<0||Math.abs(c.height-this.height)>=ds||Math.abs(a-this.heightMetrics(e,t).perLine)>=ds)&&(vi=!0),Es(this,c)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Yy extends Xe{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,r){let s=i+this.left.height;return e<s?this.left.blockAt(e,t,i,r):this.right.blockAt(e,t,s,r+this.left.length+this.break)}lineAt(e,t,i,r,s){let o=r+this.left.height,l=s+this.left.length+this.break,a=t==ye.ByHeight?e<o:e<l,c=a?this.left.lineAt(e,t,i,r,s):this.right.lineAt(e,t,i,o,l);if(this.break||(a?c.to<l:c.from>l))return c;let h=t==ye.ByPosNoHeight?ye.ByPosNoHeight:ye.ByPos;return a?c.join(this.right.lineAt(l,h,i,o,l)):this.left.lineAt(l,h,i,r,s).join(c)}forEachLine(e,t,i,r,s,o){let l=r+this.left.height,a=s+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,i,r,s,o),t>=a&&this.right.forEachLine(e,t,i,l,a,o);else{let c=this.lineAt(a,ye.ByPos,i,r,s);e<c.from&&this.left.forEachLine(e,c.from-1,i,r,s,o),c.to>=e&&c.from<=t&&o(c),t>c.to&&this.right.forEachLine(c.to+1,t,i,l,a,o)}}replace(e,t,i){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,i));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let l of i)s.push(l);if(e>0&&oh(s,o-1),t<this.length){let l=s.length;this.decomposeRight(t,s),oh(s,l)}return Xe.of(s)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,r=i+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Xe.of(this.break?[e,null,t]:[e,t]):(this.left=Es(this.left,e),this.right=Es(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,r){let{left:s,right:o}=this,l=t+s.length+this.break,a=null;return r&&r.from<=t+s.length&&r.more?a=s=s.updateHeight(e,t,i,r):s.updateHeight(e,t,i),r&&r.from<=l+o.length&&r.more?a=o=o.updateHeight(e,l,i,r):o.updateHeight(e,l,i),a?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function oh(n,e){let t,i;n[e]==null&&(t=n[e-1])instanceof Pe&&(i=n[e+1])instanceof Pe&&n.splice(e-1,3,new Pe(t.length+1+i.length))}const Xy=5;class Ea{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof ot?r.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new ot(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let r=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let o=t-e;i.block?this.addBlock(new Rd(o,r,i)):(o||s||r>=Xy)&&this.addLineDeco(r,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new ot(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new Pe(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof ot)return e;let t=new ot(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,i){let r=this.ensureLine();r.length+=i,r.collapsed+=i,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=t,this.writtenTo=this.pos=this.pos+i}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof ot)&&!this.isCovered?this.nodes.push(new ot(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let r of this.nodes)r instanceof ot&&r.updateHeight(this.oracle,i),i+=r?r.length:1;return this.nodes}static build(e,t,i,r){let s=new Ea(i,e);return ce.spans(t,i,r,s,0),s.finish(i)}}function Qy(n,e,t){let i=new Zy;return ce.compare(n,e,t,i,0),i.changes}class Zy{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,r){(e<t||i&&i.heightRelevant||r&&r.heightRelevant)&&Sl(e,t,this.changes,5)}}function ev(n,e){let t=n.getBoundingClientRect(),i=n.ownerDocument,r=i.defaultView||window,s=Math.max(0,t.left),o=Math.min(r.innerWidth,t.right),l=Math.max(0,t.top),a=Math.min(r.innerHeight,t.bottom);for(let c=n.parentNode;c&&c!=i.body;)if(c.nodeType==1){let h=c,u=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&u.overflow!="visible"){let f=h.getBoundingClientRect();s=Math.max(s,f.left),o=Math.min(o,f.right),l=Math.max(l,f.top),a=Math.min(c==n.parentNode?r.innerHeight:a,f.bottom)}c=u.position=="absolute"||u.position=="fixed"?h.offsetParent:h.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:l-(t.top+e),bottom:Math.max(l,a)-(t.top+e)}}function tv(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class To{constructor(e,t,i,r){this.from=e,this.to=t,this.size=i,this.displaySize=r}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=t[i];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e,t){return U.replace({widget:new nv(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class nv extends Jt{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class lh{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=ah,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ve.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(Ca).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new Gy(t),this.stateDeco=e.facet(ur).filter(i=>typeof i!="function"),this.heightMap=Xe.empty().applyChanges(this.stateDeco,he.empty,this.heightOracle.setDoc(e.doc),[new mt(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=U.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let r=i?t.head:t.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new _r(s,o))}}return this.viewports=e.sort((i,r)=>i.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?ah:new Ta(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Ji(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(ur).filter(h=>typeof h!="function");let r=e.changedRanges,s=mt.extendWithRanges(r,Qy(i,this.stateDeco,e?e.changes:Ne.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);sh(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||vi)&&(e.flags|=2),l?(this.scrollAnchorPos=e.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let a=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let c=a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(ud)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),r=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?ve.RTL:ve.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),l=t.getBoundingClientRect(),a=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let c=0,h=0;if(l.width&&l.height){let{scaleX:M,scaleY:w}=jf(t,l);(M>.005&&Math.abs(this.scaleX-M)>.005||w>.005&&Math.abs(this.scaleY-w)>.005)&&(this.scaleX=M,this.scaleY=w,c|=8,o=a=!0)}let u=(parseInt(i.paddingTop)||0)*this.scaleY,f=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=u||this.paddingBottom!=f)&&(this.paddingTop=u,this.paddingBottom=f,c|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=8);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=Wf(e.scrollDOM);let p=(this.printing?tv:ev)(t,this.paddingTop),b=p.top-this.pixelViewport.top,m=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let x=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(x!=this.inView&&(this.inView=x,x&&(a=!0)),!this.inView&&!this.scrollTarget)return 0;let y=l.width;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,c|=8),a){let M=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(M)&&(o=!0),o||r.lineWrapping&&Math.abs(y-this.contentDOMWidth)>r.charWidth){let{lineHeight:w,charWidth:A,textHeight:k}=e.docView.measureTextSize();o=w>0&&r.refresh(s,w,A,k,y/A,M),o&&(e.docView.minWidth=0,c|=8)}b>0&&m>0?h=Math.max(b,m):b<0&&m<0&&(h=Math.min(b,m)),sh();for(let w of this.viewports){let A=w.from==this.viewport.from?M:e.docView.measureVisibleLineHeights(w);this.heightMap=(o?Xe.empty().applyChanges(this.stateDeco,he.empty,this.heightOracle,[new mt(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,o,new Jy(w.from,A))}vi&&(c|=2)}let C=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return C&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),c|=this.updateForViewport()),(c&2||C)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,a=new _r(r.lineAt(o-i*1e3,ye.ByHeight,s,0,0).from,r.lineAt(l+(1-i)*1e3,ye.ByHeight,s,0,0).to);if(t){let{head:c}=t.range;if(c<a.from||c>a.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=r.lineAt(c,ye.ByPos,s,0,0),f;t.y=="center"?f=(u.top+u.bottom)/2-h/2:t.y=="start"||t.y=="nearest"&&c<a.from?f=u.top:f=u.bottom-h,a=new _r(r.lineAt(f-1e3/2,ye.ByHeight,s,0,0).from,r.lineAt(f+h+1e3/2,ye.ByHeight,s,0,0).to)}}return a}mapViewport(e,t){let i=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new _r(this.heightMap.lineAt(i,ye.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,ye.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,ye.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,ye.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||r<=o-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||s>=l+Math.max(10,Math.min(i,250)))&&r>o-2*1e3&&s<l+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let r of e)t.touchesRange(r.from,r.to)||i.push(new To(t.mapPos(r.from),t.mapPos(r.to),r.size,r.displaySize));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,r=i?1e4:2e3,s=r>>1,o=r<<1;if(this.defaultTextDirection!=ve.LTR&&!i)return[];let l=[],a=(h,u,f,d)=>{if(u-h<s)return;let p=this.state.selection.main,b=[p.from];p.empty||b.push(p.to);for(let x of b)if(x>h&&x<u){a(h,x-10,f,d),a(x+10,u,f,d);return}let m=rv(e,x=>x.from>=f.from&&x.to<=f.to&&Math.abs(x.from-h)<s&&Math.abs(x.to-u)<s&&!b.some(y=>x.from<y&&x.to>y));if(!m){if(u<f.to&&t&&i&&t.visibleRanges.some(C=>C.from<=u&&C.to>=u)){let C=t.moveToLineBoundary(T.cursor(u),!1,!0).head;C>h&&(u=C)}let x=this.gapSize(f,h,u,d),y=i||x<2e6?x:2e6;m=new To(h,u,x,y)}l.push(m)},c=h=>{if(h.length<o||h.type!=Ye.Text)return;let u=iv(h.from,h.to,this.stateDeco);if(u.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(i){let b=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,m,x;if(f!=null){let y=Ur(u,f),C=((this.visibleBottom-this.visibleTop)/2+b)/h.height;m=y-C,x=y+C}else m=(this.visibleTop-h.top-b)/h.height,x=(this.visibleBottom-h.top+b)/h.height;d=qr(u,m),p=qr(u,x)}else{let b=u.total*this.heightOracle.charWidth,m=r*this.heightOracle.charWidth,x=0;if(b>2e6)for(let A of e)A.from>=h.from&&A.from<h.to&&A.size!=A.displaySize&&A.from*this.heightOracle.charWidth+x<this.pixelViewport.left&&(x=A.size-A.displaySize);let y=this.pixelViewport.left+x,C=this.pixelViewport.right+x,M,w;if(f!=null){let A=Ur(u,f),k=((C-y)/2+m)/b;M=A-k,w=A+k}else M=(y-m)/b,w=(C+m)/b;d=qr(u,M),p=qr(u,w)}d>h.from&&a(h.from,d,h,u),p<h.to&&a(p,h.to,h,u)};for(let h of this.viewportLines)Array.isArray(h.type)?h.type.forEach(c):c(h);return l}gapSize(e,t,i,r){let s=Ur(r,i)-Ur(r,t);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){To.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=U.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];ce.spans(e,this.viewport.from,this.viewport.to,{span(r,s){t.push({from:r,to:s})},point(){}},20);let i=t.length!=this.visibleRanges.length||this.visibleRanges.some((r,s)=>r.from!=t[s].from||r.to!=t[s].to);return this.visibleRanges=t,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Ji(this.heightMap.lineAt(e,ye.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Ji(this.heightMap.lineAt(this.scaler.fromDOM(e),ye.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Ji(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class _r{constructor(e,t){this.from=e,this.to=t}}function iv(n,e,t){let i=[],r=n,s=0;return ce.spans(t,n,e,{span(){},point(o,l){o>r&&(i.push({from:r,to:o}),s+=o-r),r=l}},20),r<e&&(i.push({from:r,to:e}),s+=e-r),{total:s,ranges:i}}function qr({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(n*t);for(let r=0;;r++){let{from:s,to:o}=e[r],l=o-s;if(i<=l)return s+i;i-=l}}function Ur(n,e){let t=0;for(let{from:i,to:r}of n.ranges){if(e<=r){t+=e-i;break}t+=r-i}return t/n.total}function rv(n,e){for(let t of n)if(e(t))return t}const ah={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};class Ta{constructor(e,t,i){let r=0,s=0,o=0;this.viewports=i.map(({from:l,to:a})=>{let c=t.lineAt(l,ye.ByPos,e,0,0).top,h=t.lineAt(a,ye.ByPos,e,0,0).bottom;return r+=h-c,{from:l,to:a,top:c,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let l of this.viewports)l.domTop=o+(l.top-s)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),s=l.bottom}toDOM(e){for(let t=0,i=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return r+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,r=s.domBottom}}fromDOM(e){for(let t=0,i=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return i+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,r=s.domBottom}}eq(e){return e instanceof Ta?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,i)=>t.from==e.viewports[i].from&&t.to==e.viewports[i].to):!1}}function Ji(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),i=e.toDOM(n.bottom);return new Nt(n.from,n.length,t,i-t,Array.isArray(n._content)?n._content.map(r=>Ji(r,e)):n._content)}const Kr=z.define({combine:n=>n.join(" ")}),Nl=z.define({combine:n=>n.indexOf(!0)>-1}),Ol=pn.newName(),Nd=pn.newName(),Od=pn.newName(),Ld={"&light":"."+Nd,"&dark":"."+Od};function Ll(n,e,t){return new pn(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,r=>{if(r=="&")return n;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):n+" "+i}})}const sv=Ll("."+Ol,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Ld),ov={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Do=F.ie&&F.ie_version<=11;class lv{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new qx,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(F.ie&&F.ie_version<=11||F.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(F.chrome&&F.chrome_version<126)&&(this.editContext=new cv(e),e.state.facet(tn)&&(e.contentDOM.editContext=this.editContext.editContext)),Do&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,r=this.selectionRange;if(i.state.facet(tn)?i.root.activeElement!=this.dom:!us(this.dom,r))return;let s=r.anchorNode&&i.docView.nearest(r.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(F.ie&&F.ie_version<=11||F.android&&F.chrome)&&!i.state.selection.main.empty&&r.focusNode&&tr(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=hr(e.root);if(!t)return!1;let i=F.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&av(this.view,t)||t;if(!i||this.selectionRange.eq(i))return!1;let r=us(this.dom,i);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Kx(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,ov),Do&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Do&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let r=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&ai(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,i=-1,r=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(r=!0),t==-1?{from:t,to:i}=o:(t=Math.min(o.from,t),i=Math.max(o.to,i)))}return{from:t,to:i,typeOver:r}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),r=this.selectionChanged&&us(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new My(this.view,e,t,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let i=this.view.state,r=wd(this.view,t);return this.view.state==i&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let i=ch(t,e.previousSibling||e.target.previousSibling,-1),r=ch(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(tn)!=e.state.facet(tn)&&(e.view.contentDOM.editContext=e.state.facet(tn)?this.editContext.editContext:null))}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function ch(n,e,t){for(;e;){let i=me.get(e);if(i&&i.parent==n)return i;let r=e.parentNode;e=r!=n.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function hh(n,e){let t=e.startContainer,i=e.startOffset,r=e.endContainer,s=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor);return tr(o.node,o.offset,r,s)&&([t,i,r,s]=[r,s,t,i]),{anchorNode:t,anchorOffset:i,focusNode:r,focusOffset:s}}function av(n,e){if(e.getComposedRanges){let r=e.getComposedRanges(n.root)[0];if(r)return hh(n,r)}let t=null;function i(r){r.preventDefault(),r.stopImmediatePropagation(),t=r.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",i,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",i,!0),t?hh(n,t):null}class cv{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let{anchor:r}=e.state.selection.main,s={from:this.toEditorPos(i.updateRangeStart),to:this.toEditorPos(i.updateRangeEnd),insert:he.of(i.text.split(`
`))};s.from==this.from&&r<this.from?s.from=r:s.to==this.to&&r>this.to&&(s.to=r),!(s.from==s.to&&!s.insert.length)&&(this.pendingContextChange=s,e.state.readOnly||Ma(e,s,T.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd))),this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)))},this.handlers.characterboundsupdate=i=>{let r=[],s=null;for(let o=this.toEditorPos(i.rangeStart),l=this.toEditorPos(i.rangeEnd);o<l;o++){let a=e.coordsForChar(o);s=a&&new DOMRect(a.left,a.top,a.right-a.left,a.bottom-a.top)||s||new DOMRect,r.push(s)}t.updateCharacterBounds(i.rangeStart,r)},this.handlers.textformatupdate=i=>{let r=[];for(let s of i.getTextFormats()){let o=s.underlineStyle,l=s.underlineThickness;if(o!="None"&&l!="None"){let a=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${l=="Thin"?1:2}px`;r.push(U.mark({attributes:{style:a}}).range(this.toEditorPos(s.rangeStart),this.toEditorPos(s.rangeEnd)))}}e.dispatch({effects:dd.of(U.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{e.inputState.composing=-1,e.inputState.compositionFirstChange=null};for(let i in this.handlers)t.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let r=hr(i.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,i=!1,r=this.pendingContextChange;return e.changes.iterChanges((s,o,l,a,c)=>{if(i)return;let h=c.length-(o-s);if(r&&o>=r.to)if(r.from==s&&r.to==o&&r.insert.eq(c)){r=this.pendingContextChange=null,t+=h,this.to+=h;return}else r=null,this.revertPending(e.state);if(s+=t,o+=t,o<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+c.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),c.toString()),this.to+=h}t+=h}),r&&!i&&this.revertPending(e.state),!i}update(e){let t=this.pendingContextChange;!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.resetRange(e.state),this.editContext.updateText(0,this.editContext.text.length,e.state.doc.sliceString(this.from,this.to)),this.setSelection(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),r=this.toContextPos(t.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(i,r)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e){return e+this.from}toContextPos(e){return e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}let B=class Pl{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(r=>r.forEach(s=>i(s,this)))||(r=>this.update(r)),this.dispatch=this.dispatch.bind(this),this._root=e.root||Ux(e.parent)||document,this.viewState=new lh(e.state||ae.create(e)),e.scrollTo&&e.scrollTo.is(Wr)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Ui).map(r=>new Ao(r));for(let r of this.plugins)r.update(this);this.observer=new lv(this),this.inputState=new Ny(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Vc(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof Oe?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,r,s=this.state;for(let f of e){if(f.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=f.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,l=0,a=null;e.some(f=>f.annotation(Ed))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,a=Td(s,o),a||(l=1));let c=this.observer.delayedAndroidKey,h=null;if(c?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(ae.phrases)!=this.state.facet(ae.phrases))return this.setState(s);r=Ms.create(this,s,e),r.flags|=l;let u=this.viewState.scrollTarget;try{this.updateState=2;for(let f of e){if(u&&(u=u.map(f.changes)),f.scrollIntoView){let{main:d}=f.state.selection;u=new ci(d.empty?d:T.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of f.effects)d.is(Wr)&&(u=d.value.clip(this.state))}this.viewState.update(r,u),this.bidiCache=Ts.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(Ki)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(Kr)!=r.state.facet(Kr)&&(this.viewState.mustMeasureContent=!0),(t||i||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!r.empty)for(let f of this.state.facet(El))try{f(r)}catch(d){nt(this.state,d,"update listener")}(a||h)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),h&&!wd(this,h)&&c.force&&ai(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new lh(e),this.plugins=e.facet(Ui).map(i=>new Ao(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new Vc(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Ui),i=e.state.facet(Ui);if(t!=i){let r=[];for(let s of i){let o=t.indexOf(s);if(o<0)r.push(new Ao(s));else{let l=this.plugins[o];l.mustUpdate=e,r.push(l)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);t!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(i){nt(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,i=this.scrollDOM,r=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if(Wf(i))s=-1,o=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(r);s=d.from,o=d.top}this.updateState=1;let a=this.viewState.measure(this);if(!a&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];a&4||([this.measureRequests,c]=[c,this.measureRequests]);let h=c.map(d=>{try{return d.read(this)}catch(p){return nt(this.state,p),uh}}),u=Ms.create(this,this.state,[]),f=!1;u.flags|=a,t?t.flags|=a:t=u,this.updateState=2,u.empty||(this.updatePlugins(u),this.inputState.update(u),this.updateAttrs(),f=this.docView.update(u),f&&this.docViewUpdate());for(let d=0;d<c.length;d++)if(h[d]!=uh)try{let p=c[d];p.write&&p.write(h[d],this)}catch(p){nt(this.state,p)}if(f&&this.docView.updateSelection(!0),!u.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(p>1||p<-1){r=r+p,i.scrollTop=r/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let l of this.state.facet(El))l(t)}get themeClasses(){return Ol+" "+(this.state.facet(Nl)?Od:Nd)+" "+this.state.facet(Kr)}updateAttrs(){let e=fh(this,pd,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(tn)?"true":"false",class:"cm-content",style:`${F.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),fh(this,Ca,t);let i=this.observer.ignore(()=>{let r=wl(this.contentDOM,this.contentAttrs,t),s=wl(this.dom,this.editorAttrs,e);return r||s});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let r of i.effects)if(r.is(Pl.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(Ki);let e=this.state.facet(Pl.cspNonce);pn.mount(this.root,this.styleModules.concat(sv).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return Eo(this,e,Kc(this,e,t,i))}moveByGroup(e,t){return Eo(this,e,Kc(this,e,t,i=>Sy(this,e.head,i)))}visualLineSide(e,t){let i=this.bidiSpans(e),r=this.textDirectionAt(e.from),s=i[t?i.length-1:0];return T.cursor(s.side(t,r)+e.from,s.forward(!t,r)?1:-1)}moveToLineBoundary(e,t,i=!0){return wy(this,e,t,i)}moveVertically(e,t,i){return Eo(this,e,ky(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),vd(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[an.find(s,e-r.from,-1,t)];return Tr(i,o.dir==ve.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(hd)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>hv)return nd(e.length);let t=this.textDirectionAt(e.from),i;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||td(s.isolates,i=Wc(this,e))))return s.order;i||(i=Wc(this,e));let r=sy(e.text,t,i);return this.bidiCache.push(new Ts(e.from,e.to,t,i,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||F.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Hf(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Wr.of(new ci(typeof e=="number"?T.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return Wr.of(new ci(T.cursor(i.from),"start","start",i.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return De.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return De.define(()=>({}),{eventObservers:e})}static theme(e,t){let i=pn.newName(),r=[Kr.of(i),Ki.of(Ll(`.${i}`,e))];return t&&t.dark&&r.push(Nl.of(!0)),r}static baseTheme(e){return _n.lowest(Ki.of(Ll("."+Ol,e,Ld)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),r=i&&me.get(i)||me.get(e);return((t=r==null?void 0:r.rootView)===null||t===void 0?void 0:t.view)||null}};B.styleModule=Ki;B.inputHandler=ad;B.clipboardInputFilter=Sa;B.clipboardOutputFilter=ka;B.scrollHandler=fd;B.focusChangeEffect=cd;B.perLineTextDirection=hd;B.exceptionSink=ld;B.updateListener=El;B.editable=tn;B.mouseSelectionStyle=od;B.dragMovesSelection=sd;B.clickAddsSelectionRange=rd;B.decorations=ur;B.outerDecorations=md;B.atomicRanges=Aa;B.bidiIsolatedRanges=gd;B.scrollMargins=bd;B.darkTheme=Nl;B.cspNonce=z.define({combine:n=>n.length?n[0]:""});B.contentAttributes=Ca;B.editorAttributes=pd;B.lineWrapping=B.contentAttributes.of({class:"cm-lineWrapping"});B.announce=ne.define();const hv=4096,uh={};class Ts{constructor(e,t,i,r,s,o){this.from=e,this.to=t,this.dir=i,this.isolates=r,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let i=[],r=e.length?e[e.length-1].dir:ve.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!t.touchesRange(o.from,o.to)&&i.push(new Ts(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function fh(n,e,t){for(let i=n.state.facet(e),r=i.length-1;r>=0;r--){let s=i[r],o=typeof s=="function"?s(n):s;o&&vl(o,t)}return t}const uv=F.mac?"mac":F.windows?"win":F.linux?"linux":"key";function fv(n,e){const t=n.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let r,s,o,l;for(let a=0;a<t.length-1;++a){const c=t[a];if(/^(cmd|meta|m)$/i.test(c))l=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(i="Alt-"+i),s&&(i="Ctrl-"+i),l&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function Gr(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const dv=_n.default(B.domEventHandlers({keydown(n,e){return Id(Pd(e.state),n,e,"editor")}})),to=z.define({enables:dv}),dh=new WeakMap;function Pd(n){let e=n.facet(to),t=dh.get(e);return t||dh.set(e,t=gv(e.reduce((i,r)=>i.concat(r),[]))),t}function pv(n,e,t){return Id(Pd(n.state),e,n,t)}let nn=null;const mv=4e3;function gv(n,e=uv){let t=Object.create(null),i=Object.create(null),r=(o,l)=>{let a=i[o];if(a==null)i[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,l,a,c,h)=>{var u,f;let d=t[o]||(t[o]=Object.create(null)),p=l.split(/ (?!$)/).map(x=>fv(x,e));for(let x=1;x<p.length;x++){let y=p.slice(0,x).join(" ");r(y,!0),d[y]||(d[y]={preventDefault:!0,stopPropagation:!1,run:[C=>{let M=nn={view:C,prefix:y,scope:o};return setTimeout(()=>{nn==M&&(nn=null)},mv),!0}]})}let b=p.join(" ");r(b,!1);let m=d[b]||(d[b]={preventDefault:!1,stopPropagation:!1,run:((f=(u=d._any)===null||u===void 0?void 0:u.run)===null||f===void 0?void 0:f.slice())||[]});a&&m.run.push(a),c&&(m.preventDefault=!0),h&&(m.stopPropagation=!0)};for(let o of n){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of l){let h=t[c]||(t[c]=Object.create(null));h._any||(h._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:u}=o;for(let f in h)h[f].run.push(d=>u(d,Il))}let a=o[e]||o.key;if(a)for(let c of l)s(c,a,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(c,"Shift-"+a,o.shift,o.preventDefault,o.stopPropagation)}return t}let Il=null;function Id(n,e,t,i){Il=e;let r=Wx(e),s=Be(r,0),o=dt(s)==r.length&&r!=" ",l="",a=!1,c=!1,h=!1;nn&&nn.view==t&&nn.scope==i&&(l=nn.prefix+" ",kd.indexOf(e.keyCode)<0&&(c=!0,nn=null));let u=new Set,f=m=>{if(m){for(let x of m.run)if(!u.has(x)&&(u.add(x),x(t)))return m.stopPropagation&&(h=!0),!0;m.preventDefault&&(m.stopPropagation&&(h=!0),c=!0)}return!1},d=n[i],p,b;return d&&(f(d[l+Gr(r,e,!o)])?a=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(F.windows&&e.ctrlKey&&e.altKey)&&(p=mn[e.keyCode])&&p!=r?(f(d[l+Gr(p,e,!0)])||e.shiftKey&&(b=cr[e.keyCode])!=r&&b!=p&&f(d[l+Gr(b,e,!1)]))&&(a=!0):o&&e.shiftKey&&f(d[l+Gr(r,e,!0)])&&(a=!0),!a&&f(d._any)&&(a=!0)),c&&(a=!0),a&&h&&e.stopPropagation(),Il=null,a}class Nr{constructor(e,t,i,r,s){this.className=e,this.left=t,this.top=i,this.width=r,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,i){if(i.empty){let r=e.coordsAtPos(i.head,i.assoc||1);if(!r)return[];let s=Bd(e);return[new Nr(t,r.left-s.left,r.top-s.top,null,r.bottom-r.top)]}else return bv(e,t,i)}}function Bd(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==ve.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function ph(n,e,t,i){let r=n.coordsAtPos(e,t*2);if(!r)return i;let s=n.dom.getBoundingClientRect(),o=(r.top+r.bottom)/2,l=n.posAtCoords({x:s.left+1,y:o}),a=n.posAtCoords({x:s.right-1,y:o});return l==null||a==null?i:{from:Math.max(i.from,Math.min(l,a)),to:Math.min(i.to,Math.max(l,a))}}function bv(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let i=Math.max(t.from,n.viewport.from),r=Math.min(t.to,n.viewport.to),s=n.textDirection==ve.LTR,o=n.contentDOM,l=o.getBoundingClientRect(),a=Bd(n),c=o.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),u=l.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),f=l.right-(h?parseInt(h.paddingRight):0),d=Dl(n,i),p=Dl(n,r),b=d.type==Ye.Text?d:null,m=p.type==Ye.Text?p:null;if(b&&(n.lineWrapping||d.widgetLineBreaks)&&(b=ph(n,i,1,b)),m&&(n.lineWrapping||p.widgetLineBreaks)&&(m=ph(n,r,-1,m)),b&&m&&b.from==m.from&&b.to==m.to)return y(C(t.from,t.to,b));{let w=b?C(t.from,null,b):M(d,!1),A=m?C(null,t.to,m):M(p,!0),k=[];return(b||d).to<(m||p).from-(b&&m?1:0)||d.widgetLineBreaks>1&&w.bottom+n.defaultLineHeight/2<A.top?k.push(x(u,w.bottom,f,A.top)):w.bottom<A.top&&n.elementAtHeight((w.bottom+A.top)/2).type==Ye.Text&&(w.bottom=A.top=(w.bottom+A.top)/2),y(w).concat(k).concat(y(A))}function x(w,A,k,L){return new Nr(e,w-a.left,A-a.top-.01,k-w,L-A+.01)}function y({top:w,bottom:A,horizontal:k}){let L=[];for(let R=0;R<k.length;R+=2)L.push(x(k[R],w,k[R+1],A));return L}function C(w,A,k){let L=1e9,R=-1e9,W=[];function H(V,G,Z,E,O){let j=n.coordsAtPos(V,V==k.to?-2:2),Y=n.coordsAtPos(Z,Z==k.from?2:-2);!j||!Y||(L=Math.min(j.top,Y.top,L),R=Math.max(j.bottom,Y.bottom,R),O==ve.LTR?W.push(s&&G?u:j.left,s&&E?f:Y.right):W.push(!s&&E?u:Y.left,!s&&G?f:j.right))}let D=w??k.from,X=A??k.to;for(let V of n.visibleRanges)if(V.to>D&&V.from<X)for(let G=Math.max(V.from,D),Z=Math.min(V.to,X);;){let E=n.state.doc.lineAt(G);for(let O of n.bidiSpans(E)){let j=O.from+E.from,Y=O.to+E.from;if(j>=Z)break;Y>G&&H(Math.max(j,G),w==null&&j<=D,Math.min(Y,Z),A==null&&Y>=X,O.dir)}if(G=E.to+1,G>=Z)break}return W.length==0&&H(D,w==null,X,A==null,n.textDirection),{top:L,bottom:R,horizontal:W}}function M(w,A){let k=l.top+(A?w.top:w.bottom);return{top:k,bottom:k,horizontal:[]}}}function xv(n,e){return n.constructor==e.constructor&&n.eq(e)}class yv{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(ps)!=e.state.facet(ps)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,i=e.facet(ps);for(;t<i.length&&i[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,i)=>!xv(t,this.drawn[i]))){let t=this.dom.firstChild,i=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[i].constructor&&r.update(t,this.drawn[i])?(t=t.nextSibling,i++):this.dom.insertBefore(r.draw(),t);for(;t;){let r=t.nextSibling;t.remove(),t=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const ps=z.define();function zd(n){return[De.define(e=>new yv(e,n)),ps.of(n)]}const jd=!F.ios,fr=z.define({combine(n){return Ht(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function vv(n={}){return[fr.of(n),wv,Sv,kv,ud.of(!0)]}function Hd(n){return n.startState.facet(fr)!=n.state.facet(fr)}const wv=zd({above:!0,markers(n){let{state:e}=n,t=e.facet(fr),i=[];for(let r of e.selection.ranges){let s=r==e.selection.main;if(r.empty?!s||jd:t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=r.empty?r:T.cursor(r.head,r.head>r.anchor?-1:1);for(let a of Nr.forRange(n,o,l))i.push(a)}}return i},update(n,e){n.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=Hd(n);return t&&mh(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){mh(e.state,n)},class:"cm-cursorLayer"});function mh(n,e){e.style.animationDuration=n.facet(fr).cursorBlinkRate+"ms"}const Sv=zd({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:Nr.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||Hd(n)},class:"cm-selectionLayer"}),Bl={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};jd&&(Bl[".cm-line"].caretColor=Bl[".cm-content"].caretColor="transparent !important");const kv=_n.highest(B.theme(Bl)),Fd=ne.define({map(n,e){return n==null?null:e.mapPos(n)}}),Yi=Ve.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,i)=>i.is(Fd)?i.value:t,n)}}),Cv=De.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(Yi);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(Yi)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(Yi),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let i=n.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-i.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(Yi)!=n&&this.view.dispatch({effects:Fd.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Av(){return[Yi,Cv]}function gh(n,e,t,i,r){e.lastIndex=0;for(let s=n.iterRange(t,i),o=t,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=e.exec(s.value);)r(o+l.index,l)}function Mv(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let i=[];for(let{from:r,to:s}of t)r=Math.max(n.state.doc.lineAt(r).from,r-e),s=Math.min(n.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}class Ev{constructor(e){const{regexp:t,decoration:i,decorate:r,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,r)this.addMatch=(l,a,c,h)=>r(h,c,c+l[0].length,l,a);else if(typeof i=="function")this.addMatch=(l,a,c,h)=>{let u=i(l,a,c);u&&h(c,c+l[0].length,u)};else if(i)this.addMatch=(l,a,c,h)=>h(c,c+l[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let t=new dn,i=t.add.bind(t);for(let{from:r,to:s}of Mv(e,this.maxLength))gh(e.state.doc,this.regexp,r,s,(o,l)=>this.addMatch(l,e,o,i));return t.finish()}updateDeco(e,t){let i=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((s,o,l,a)=>{a>e.view.viewport.from&&l<e.view.viewport.to&&(i=Math.min(l,i),r=Math.max(a,r))}),e.viewportChanged||r-i>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),i,r):t}updateRange(e,t,i,r){for(let s of e.visibleRanges){let o=Math.max(s.from,i),l=Math.min(s.to,r);if(l>o){let a=e.state.doc.lineAt(o),c=a.to<l?e.state.doc.lineAt(l):a,h=Math.max(s.from,a.from),u=Math.min(s.to,c.to);if(this.boundary){for(;o>a.from;o--)if(this.boundary.test(a.text[o-1-a.from])){h=o;break}for(;l<c.to;l++)if(this.boundary.test(c.text[l-c.from])){u=l;break}}let f=[],d,p=(b,m,x)=>f.push(x.range(b,m));if(a==c)for(this.regexp.lastIndex=h-a.from;(d=this.regexp.exec(a.text))&&d.index<u-a.from;)this.addMatch(d,e,d.index+a.from,p);else gh(e.state.doc,this.regexp,h,u,(b,m)=>this.addMatch(m,e,b,p));t=t.update({filterFrom:h,filterTo:u,filter:(b,m)=>b<h||m>u,add:f})}}return t}}const zl=/x/.unicode!=null?"gu":"g",Tv=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,zl),Dv={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Ro=null;function Rv(){var n;if(Ro==null&&typeof document<"u"&&document.body){let e=document.body.style;Ro=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return Ro||!1}const ms=z.define({combine(n){let e=Ht(n,{render:null,specialChars:Tv,addSpecialChars:null});return(e.replaceTabs=!Rv())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,zl)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,zl)),e}});function Nv(n={}){return[ms.of(n),Ov()]}let bh=null;function Ov(){return bh||(bh=De.fromClass(class{constructor(n){this.view=n,this.decorations=U.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(ms)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new Ev({regexp:n.specialChars,decoration:(e,t,i)=>{let{doc:r}=t.state,s=Be(e[0],0);if(s==9){let o=r.lineAt(i),l=t.state.tabSize,a=Ri(o.text,l,i-o.from);return U.replace({widget:new Bv((l-a%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=U.replace({widget:new Iv(n,s)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(ms);n.startState.facet(ms)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const Lv="•";function Pv(n){return n>=32?Lv:n==10?"␤":String.fromCharCode(9216+n)}class Iv extends Jt{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=Pv(this.code),i=e.state.phrase("Control character")+" "+(Dv[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,i,t);if(r)return r;let s=document.createElement("span");return s.textContent=t,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class Bv extends Jt{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function zv(){return Hv}const jv=U.line({class:"cm-activeLine"}),Hv=De.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let i of n.state.selection.ranges){let r=n.lineBlockAt(i.head);r.from>e&&(t.push(jv.range(r.from)),e=r.from)}return U.set(t)}},{decorations:n=>n.decorations});class Fv extends Jt{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),typeof this.content=="string"?t.setAttribute("aria-label","placeholder "+this.content):t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?bi(e.firstChild):[];if(!t.length)return null;let i=window.getComputedStyle(e.parentNode),r=Tr(t[0],i.direction!="rtl"),s=parseInt(i.lineHeight);return r.bottom-r.top>s*1.5?{left:r.left,right:r.right,top:r.top,bottom:r.top+s}:r}ignoreEvent(){return!1}}function Wv(n){return De.fromClass(class{constructor(e){this.view=e,this.placeholder=n?U.set([U.widget({widget:new Fv(n),side:1}).range(0)]):U.none}get decorations(){return this.view.state.doc.length?U.none:this.placeholder}},{decorations:e=>e.decorations})}const jl=2e3;function Vv(n,e,t){let i=Math.min(e.line,t.line),r=Math.max(e.line,t.line),s=[];if(e.off>jl||t.off>jl||e.col<0||t.col<0){let o=Math.min(e.off,t.off),l=Math.max(e.off,t.off);for(let a=i;a<=r;a++){let c=n.doc.line(a);c.length<=l&&s.push(T.range(c.from+o,c.to+l))}}else{let o=Math.min(e.col,t.col),l=Math.max(e.col,t.col);for(let a=i;a<=r;a++){let c=n.doc.line(a),h=dl(c.text,o,n.tabSize,!0);if(h<0)s.push(T.cursor(c.to));else{let u=dl(c.text,l,n.tabSize);s.push(T.range(c.from+h,c.from+u))}}}return s}function $v(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function xh(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),i=n.state.doc.lineAt(t),r=t-i.from,s=r>jl?-1:r==i.length?$v(n,e.clientX):Ri(i.text,n.state.tabSize,t-i.from);return{line:i.number,col:s,off:r}}function _v(n,e){let t=xh(n,e),i=n.state.selection;return t?{update(r){if(r.docChanged){let s=r.changes.mapPos(r.startState.doc.line(t.line).from),o=r.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},i=i.map(r.changes)}},get(r,s,o){let l=xh(n,r);if(!l)return i;let a=Vv(n.state,t,l);return a.length?o?T.create(a.concat(i.ranges)):T.create(a):i}}:null}function qv(n){let e=t=>t.altKey&&t.button==0;return B.mouseSelectionStyle.of((t,i)=>e(i)?_v(t,i):null)}const Uv={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},Kv={style:"cursor: crosshair"};function Gv(n={}){let[e,t]=Uv[n.key||"Alt"],i=De.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventObservers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)},mousemove(r){this.set(t(r))}}});return[i,B.contentAttributes.of(r=>{var s;return!((s=r.plugin(i))===null||s===void 0)&&s.isDown?Kv:null})]}const Fi="-10000px";class Wd{constructor(e,t,i,r){this.facet=t,this.createTooltipView=i,this.removeTooltipView=r,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=i(o,s))}update(e,t){var i;let r=e.state.facet(this.facet),s=r.filter(a=>a);if(r===this.input){for(let a of this.tooltipViews)a.update&&a.update(e);return!1}let o=[],l=t?[]:null;for(let a=0;a<s.length;a++){let c=s[a],h=-1;if(c){for(let u=0;u<this.tooltips.length;u++){let f=this.tooltips[u];f&&f.create==c.create&&(h=u)}if(h<0)o[a]=this.createTooltipView(c,a?o[a-1]:null),l&&(l[a]=!!c.above);else{let u=o[a]=this.tooltipViews[h];l&&(l[a]=t[h]),u.update&&u.update(e)}}}for(let a of this.tooltipViews)o.indexOf(a)<0&&(this.removeTooltipView(a),(i=a.destroy)===null||i===void 0||i.call(a));return t&&(l.forEach((a,c)=>t[c]=a),t.length=l.length),this.input=r,this.tooltips=s,this.tooltipViews=o,!0}}function Jv(n){let{win:e}=n;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const No=z.define({combine:n=>{var e,t,i;return{position:F.ios?"absolute":((e=n.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=n.find(r=>r.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||Jv}}}),yh=new WeakMap,Da=De.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(No);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Wd(n,Ra,(t,i)=>this.createTooltip(t,i),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,i=n.state.facet(No);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),i=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",t.dom.appendChild(r)}return t.dom.style.position=this.position,t.dom.style.top=Fi,t.dom.style.left="0px",this.container.insertBefore(t.dom,i),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(n=i.destroy)===null||n===void 0||n.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=this.view.dom.getBoundingClientRect(),e=1,t=1,i=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(F.gecko)i=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==Fi&&r.style.left=="0px"){let s=r.getBoundingClientRect();i=Math.abs(s.top+1e4)>1||Math.abs(s.left)>1}}if(i||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(e=r.width/this.parent.offsetWidth,t=r.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:t}=this.view.viewState);return{editor:n,parent:this.parent?this.container.getBoundingClientRect():n,pos:this.manager.tooltips.map((r,s)=>{let o=this.manager.tooltipViews[s];return o.getCoords?o.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(No).tooltipSpace(this.view),scaleX:e,scaleY:t,makeAbsolute:i}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{editor:t,space:i,scaleX:r,scaleY:s}=n,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],c=this.manager.tooltipViews[l],{dom:h}=c,u=n.pos[l],f=n.size[l];if(!u||u.bottom<=Math.max(t.top,i.top)||u.top>=Math.min(t.bottom,i.bottom)||u.right<Math.max(t.left,i.left)-.1||u.left>Math.min(t.right,i.right)+.1){h.style.top=Fi;continue}let d=a.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,b=f.right-f.left,m=(e=yh.get(c))!==null&&e!==void 0?e:f.bottom-f.top,x=c.offset||Xv,y=this.view.textDirection==ve.LTR,C=f.width>i.right-i.left?y?i.left:i.right-f.width:y?Math.max(i.left,Math.min(u.left-(d?14:0)+x.x,i.right-b)):Math.min(Math.max(i.left,u.left-b+(d?14:0)-x.x),i.right-b),M=this.above[l];!a.strictSide&&(M?u.top-(f.bottom-f.top)-x.y<i.top:u.bottom+(f.bottom-f.top)+x.y>i.bottom)&&M==i.bottom-u.bottom>u.top-i.top&&(M=this.above[l]=!M);let w=(M?u.top-i.top:i.bottom-u.bottom)-p;if(w<m&&c.resize!==!1){if(w<this.view.defaultLineHeight){h.style.top=Fi;continue}yh.set(c,m),h.style.height=(m=w)/s+"px"}else h.style.height&&(h.style.height="");let A=M?u.top-m-p-x.y:u.bottom+p+x.y,k=C+b;if(c.overlap!==!0)for(let L of o)L.left<k&&L.right>C&&L.top<A+m&&L.bottom>A&&(A=M?L.top-m-2-p:L.bottom+p+2);if(this.position=="absolute"?(h.style.top=(A-n.parent.top)/s+"px",h.style.left=(C-n.parent.left)/r+"px"):(h.style.top=A/s+"px",h.style.left=C/r+"px"),d){let L=u.left+(y?x.x:-x.x)-(C+14-7);d.style.left=L/r+"px"}c.overlap!==!0&&o.push({left:C,top:A,right:k,bottom:A+m}),h.classList.toggle("cm-tooltip-above",M),h.classList.toggle("cm-tooltip-below",!M),c.positioned&&c.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Fi}},{eventObservers:{scroll(){this.maybeMeasure()}}}),Yv=B.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Xv={x:0,y:0},Ra=z.define({enables:[Da,Yv]}),Ds=z.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class no{static create(e){return new no(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Wd(e,Ds,(t,i)=>this.createHostedView(t,i),t=>t.dom.remove())}createHostedView(e,t){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let i of this.manager.tooltipViews){let r=i[e];if(r!==void 0){if(t===void 0)t=r;else if(t!==r)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const Qv=Ra.compute([Ds],n=>{let e=n.facet(Ds);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var i;return(i=t.end)!==null&&i!==void 0?i:t.pos})),create:no.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class Zv{constructor(e,t,i,r,s){this.view=e,this.source=t,this.field=i,this.setHover=r,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,i=e.docView.nearest(t.target);if(!i)return;let r,s=1;if(i instanceof ln)r=i.posAtStart;else{if(r=e.posAtCoords(t),r==null)return;let l=e.coordsAtPos(r);if(!l||t.y<l.top||t.y>l.bottom||t.x<l.left-e.defaultCharacterWidth||t.x>l.right+e.defaultCharacterWidth)return;let a=e.bidiSpans(e.state.doc.lineAt(r)).find(h=>h.from<=r&&h.to>=r),c=a&&a.dir==ve.RTL?-1:1;s=t.x<l.left?-c:c}let o=this.source(e,r,s);if(o!=null&&o.then){let l=this.pending={pos:r};o.then(a=>{this.pending==l&&(this.pending=null,a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])}))},a=>nt(e.state,a,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(Da),t=e?e.manager.tooltips.findIndex(i=>i.create==no.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:s}=this;if(r.length&&s&&!ew(s.dom,e)||this.pending){let{pos:o}=r[0]||this.pending,l=(i=(t=r[0])===null||t===void 0?void 0:t.end)!==null&&i!==void 0?i:o;(o==l?this.view.posAtCoords(this.lastMove)!=o:!tw(this.view,o,l,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=i=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Jr=4;function ew(n,e){let{left:t,right:i,top:r,bottom:s}=n.getBoundingClientRect(),o;if(o=n.querySelector(".cm-tooltip-arrow")){let l=o.getBoundingClientRect();r=Math.min(l.top,r),s=Math.max(l.bottom,s)}return e.clientX>=t-Jr&&e.clientX<=i+Jr&&e.clientY>=r-Jr&&e.clientY<=s+Jr}function tw(n,e,t,i,r,s){let o=n.scrollDOM.getBoundingClientRect(),l=n.documentTop+n.documentPadding.top+n.contentHeight;if(o.left>i||o.right<i||o.top>r||Math.min(o.bottom,l)<r)return!1;let a=n.posAtCoords({x:i,y:r},!1);return a>=e&&a<=t}function nw(n,e={}){let t=ne.define(),i=Ve.define({create(){return[]},update(r,s){if(r.length&&(e.hideOnChange&&(s.docChanged||s.selection)?r=[]:e.hideOn&&(r=r.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let l of r){let a=s.changes.mapPos(l.pos,-1,Je.TrackDel);if(a!=null){let c=Object.assign(Object.create(null),l);c.pos=a,c.end!=null&&(c.end=s.changes.mapPos(c.end)),o.push(c)}}r=o}for(let o of s.effects)o.is(t)&&(r=o.value),o.is(iw)&&(r=[]);return r},provide:r=>Ds.from(r)});return{active:i,extension:[i,De.define(r=>new Zv(r,n,i,t,e.hoverTime||300)),Qv]}}function Vd(n,e){let t=n.plugin(Da);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}const iw=ne.define(),vh=z.define({combine(n){let e,t;for(let i of n)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function dr(n,e){let t=n.plugin($d),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const $d=De.fromClass(class{constructor(n){this.input=n.state.facet(pr),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(vh);this.top=new Yr(n,!0,e.topContainer),this.bottom=new Yr(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(vh);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Yr(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Yr(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(pr);if(t!=this.input){let i=t.filter(a=>a),r=[],s=[],o=[],l=[];for(let a of i){let c=this.specs.indexOf(a),h;c<0?(h=a(n.view),l.push(h)):(h=this.panels[c],h.update&&h.update(n)),r.push(h),(h.top?s:o).push(h)}this.specs=i,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let i of this.panels)i.update&&i.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>B.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});let Yr=class{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=wh(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=wh(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}};function wh(n){let e=n.nextSibling;return n.remove(),e}const pr=z.define({enables:$d});class Gt extends In{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Gt.prototype.elementClass="";Gt.prototype.toDOM=void 0;Gt.prototype.mapMode=Je.TrackBefore;Gt.prototype.startSide=Gt.prototype.endSide=-1;Gt.prototype.point=!0;const gs=z.define(),rw=z.define(),sw={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>ce.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},ir=z.define();function ow(n){return[_d(),ir.of(Object.assign(Object.assign({},sw),n))]}const Sh=z.define({combine:n=>n.some(e=>e)});function _d(n){return[lw]}const lw=De.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(ir).map(e=>new Ch(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(Sh),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(Sh)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let t=ce.iter(this.view.state.facet(gs),this.view.viewport.from),i=[],r=this.gutters.map(s=>new aw(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(s.type)){let o=!0;for(let l of s.type)if(l.type==Ye.Text&&o){Hl(t,i,l.from);for(let a of r)a.line(this.view,l,i);o=!1}else if(l.widget)for(let a of r)a.widget(this.view,l)}else if(s.type==Ye.Text){Hl(t,i,s.from);for(let o of r)o.line(this.view,s,i)}else if(s.widget)for(let o of r)o.widget(this.view,s);for(let s of r)s.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(ir),t=n.state.facet(ir),i=n.docChanged||n.heightChanged||n.viewportChanged||!ce.eq(n.startState.facet(gs),n.state.facet(gs),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(n)&&(i=!0);else{i=!0;let r=[];for(let s of t){let o=e.indexOf(s);o<0?r.push(new Ch(this.view,s)):(this.gutters[o].update(n),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)this.dom.appendChild(s.dom);this.gutters=r}return i}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>B.scrollMargins.of(e=>{let t=e.plugin(n);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==ve.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function kh(n){return Array.isArray(n)?n:[n]}function Hl(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class aw{constructor(e,t,i){this.gutter=e,this.height=i,this.i=0,this.cursor=ce.iter(e.markers,t.from)}addElement(e,t,i){let{gutter:r}=this,s=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==r.elements.length){let l=new qd(e,o,s,i);r.elements.push(l),r.dom.appendChild(l.dom)}else r.elements[this.i].update(e,o,s,i);this.height=t.bottom,this.i++}line(e,t,i){let r=[];Hl(this.cursor,r,t.from),i.length&&(r=r.concat(i));let s=this.gutter.config.lineMarker(e,t,r);s&&r.unshift(s);let o=this.gutter;r.length==0&&!o.config.renderEmptyElements||this.addElement(e,t,r)}widget(e,t){let i=this.gutter.config.widgetMarker(e,t.widget,t),r=i?[i]:null;for(let s of e.state.facet(rw)){let o=s(e,t.widget,t);o&&(r||(r=[])).push(o)}r&&this.addElement(e,t,r)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Ch{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,r=>{let s=r.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let a=s.getBoundingClientRect();o=(a.top+a.bottom)/2}else o=r.clientY;let l=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[i](e,l,r)&&r.preventDefault()});this.markers=kh(t.markers(e)),t.initialSpacer&&(this.spacer=new qd(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=kh(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let i=e.view.viewport;return!ce.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class qd{constructor(e,t,i,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,r)}update(e,t,i,r){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),cw(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let i="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let l=o,a=s<t.length?t[s++]:null,c=!1;if(a){let h=a.elementClass;h&&(i+=" "+h);for(let u=o;u<this.markers.length;u++)if(this.markers[u].compare(a)){l=u,c=!0;break}}else l=this.markers.length;for(;o<l;){let h=this.markers[o++];if(h.toDOM){h.destroy(r);let u=r.nextSibling;r.remove(),r=u}}if(!a)break;a.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(a.toDOM(e),r)),c&&o++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function cw(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const hw=z.define(),uw=z.define(),ti=z.define({combine(n){return Ht(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let r in t){let s=i[r],o=t[r];i[r]=s?(l,a,c)=>s(l,a,c)||o(l,a,c):o}return i}})}});class Oo extends Gt{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Lo(n,e){return n.state.facet(ti).formatNumber(e,n.state)}const fw=ir.compute([ti],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(hw)},lineMarker(e,t,i){return i.some(r=>r.toDOM)?null:new Oo(Lo(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,i)=>{for(let r of e.state.facet(uw)){let s=r(e,t,i);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(ti)!=e.state.facet(ti),initialSpacer(e){return new Oo(Lo(e,Ah(e.state.doc.lines)))},updateSpacer(e,t){let i=Lo(t.view,Ah(t.view.state.doc.lines));return i==e.number?e:new Oo(i)},domEventHandlers:n.facet(ti).domEventHandlers}));function dw(n={}){return[ti.of(n),_d(),fw]}function Ah(n){let e=9;for(;e<n;)e=e*10+9;return e}const pw=new class extends Gt{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},mw=gs.compute(["selection"],n=>{let e=[],t=-1;for(let i of n.selection.ranges){let r=n.doc.lineAt(i.head).from;r>t&&(t=r,e.push(pw.range(r)))}return ce.of(e)});function gw(){return mw}const bw=1024;let xw=0;class Po{constructor(e,t){this.from=e,this.to=t}}class oe{constructor(e={}){this.id=xw++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=rt.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}oe.closedBy=new oe({deserialize:n=>n.split(" ")});oe.openedBy=new oe({deserialize:n=>n.split(" ")});oe.group=new oe({deserialize:n=>n.split(" ")});oe.isolate=new oe({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});oe.contextHash=new oe({perNode:!0});oe.lookAhead=new oe({perNode:!0});oe.mounted=new oe({perNode:!0});class Rs{constructor(e,t,i){this.tree=e,this.overlay=t,this.parser=i}static get(e){return e&&e.props&&e.props[oe.mounted.id]}}const yw=Object.create(null);class rt{constructor(e,t,i,r=0){this.name=e,this.props=t,this.id=i,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):yw,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new rt(e.name||"",t,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(oe.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let r of i.split(" "))t[r]=e[i];return i=>{for(let r=i.prop(oe.group),s=-1;s<(r?r.length:0);s++){let o=t[s<0?i.name:r[s]];if(o)return o}}}}rt.none=new rt("",Object.create(null),0,8);class Na{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let r=null;for(let s of e){let o=s(i);o&&(r||(r=Object.assign({},i.props)),r[o[0].id]=o[1])}t.push(r?new rt(i.name,r,i.id,i.flags):i)}return new Na(t)}}const Xr=new WeakMap,Mh=new WeakMap;var je;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(je||(je={}));class Ce{constructor(e,t,i,r,s){if(this.type=e,this.children=t,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=Rs.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let r=i.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Wl(this.topNode,e)}cursorAt(e,t=0,i=0){let r=Xr.get(this)||this.topNode,s=new Wl(r);return s.moveTo(e,t),Xr.set(this,s._tree),s}get topNode(){return new gt(this,0,0,null)}resolve(e,t=0){let i=mr(Xr.get(this)||this.topNode,e,t,!1);return Xr.set(this,i),i}resolveInner(e,t=0){let i=mr(Mh.get(this)||this.topNode,e,t,!0);return Mh.set(this,i),i}resolveStack(e,t=0){return Sw(this,e,t)}iterate(e){let{enter:t,leave:i,from:r=0,to:s=this.length}=e,o=e.mode||0,l=(o&je.IncludeAnonymous)>0;for(let a=this.cursor(o|je.IncludeAnonymous);;){let c=!1;if(a.from<=s&&a.to>=r&&(!l&&a.type.isAnonymous||t(a)!==!1)){if(a.firstChild())continue;c=!0}for(;c&&i&&(l||!a.type.isAnonymous)&&i(a),!a.nextSibling();){if(!a.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Pa(rt.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,r)=>new Ce(this.type,t,i,r,this.propValues),e.makeTree||((t,i,r)=>new Ce(rt.none,t,i,r)))}static build(e){return kw(e)}}Ce.empty=new Ce(rt.none,[],[],0);class Oa{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Oa(this.buffer,this.index)}}class bn{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return rt.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],r=this.set.types[t],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,i,r,s){let{buffer:o}=this,l=-1;for(let a=e;a!=t&&!(Ud(s,r,o[a+1],o[a+2])&&(l=a,i>0));a=o[a+3]);return l}slice(e,t,i){let r=this.buffer,s=new Uint16Array(t-e),o=0;for(let l=e,a=0;l<t;){s[a++]=r[l++],s[a++]=r[l++]-i;let c=s[a++]=r[l++]-i;s[a++]=r[l++]-e,o=Math.max(o,c)}return new bn(s,o,this.set)}}function Ud(n,e,t,i){switch(n){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function mr(n,e,t,i){for(var r;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!i&&n instanceof gt&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=i?0:je.IgnoreOverlays;if(i)for(let o=n,l=o.parent;l;o=l,l=o.parent)o instanceof gt&&o.index<0&&((r=l.enter(e,t,s))===null||r===void 0?void 0:r.from)!=o.from&&(n=l);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class Kd{cursor(e=0){return new Wl(this,e)}getChild(e,t=null,i=null){let r=Eh(this,e,t,i);return r.length?r[0]:null}getChildren(e,t=null,i=null){return Eh(this,e,t,i)}resolve(e,t=0){return mr(this,e,t,!1)}resolveInner(e,t=0){return mr(this,e,t,!0)}matchContext(e){return Fl(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),i=this;for(;t;){let r=t.lastChild;if(!r||r.to!=t.to)break;r.type.isError&&r.from==r.to?(i=t,t=r.prevSibling):t=r}return i}get node(){return this}get next(){return this.parent}}class gt extends Kd{constructor(e,t,i,r){super(),this._tree=e,this.from=t,this.index=i,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,r,s=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,c=t>0?l.length:-1;e!=c;e+=t){let h=l[e],u=a[e]+o.from;if(Ud(r,i,u,u+h.length)){if(h instanceof bn){if(s&je.ExcludeBuffers)continue;let f=h.findChild(0,h.buffer.length,t,i-u,r);if(f>-1)return new cn(new vw(o,h,e,u),null,f)}else if(s&je.IncludeAnonymous||!h.type.isAnonymous||La(h)){let f;if(!(s&je.IgnoreMounts)&&(f=Rs.get(h))&&!f.overlay)return new gt(f.tree,u,e,o);let d=new gt(h,u,e,o);return s&je.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?h.children.length-1:0,t,i,r)}}}if(s&je.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let r;if(!(i&je.IgnoreOverlays)&&(r=Rs.get(this._tree))&&r.overlay){let s=e-this.from;for(let{from:o,to:l}of r.overlay)if((t>0?o<=s:o<s)&&(t<0?l>=s:l>s))return new gt(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Eh(n,e,t,i){let r=n.cursor(),s=[];if(!r.firstChild())return s;if(t!=null){for(let o=!1;!o;)if(o=r.type.is(t),!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}function Fl(n,e,t=e.length-1){for(let i=n;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class vw{constructor(e,t,i,r){this.parent=e,this.buffer=t,this.index=i,this.start=r}}class cn extends Kd{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,i){super(),this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,t,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,i);return s<0?null:new cn(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&je.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new cn(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new cn(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new cn(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1];e.push(i.slice(r,s,o)),t.push(0)}return new Ce(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Gd(n){if(!n.length)return null;let e=0,t=n[0];for(let s=1;s<n.length;s++){let o=n[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let i=t instanceof gt&&t.index<0?null:t.parent,r=n.slice();return i?r[e]=i:r.splice(e,1),new ww(r,t)}class ww{constructor(e,t){this.heads=e,this.node=t}get next(){return Gd(this.heads)}}function Sw(n,e,t){let i=n.resolveInner(e,t),r=null;for(let s=i instanceof gt?i:i.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(r||(r=[i])).push(o.resolve(e,t)),s=o}else{let o=Rs.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let l=new gt(o.tree,o.overlay[0].from+s.from,-1,s);(r||(r=[i])).push(mr(l,e,t,!1))}}return r?Gd(r):i}class Wl{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof gt)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=i+r.buffer[e+1],this.to=i+r.buffer[e+2],!0}yield(e){return e?e instanceof gt?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&je.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&je.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&je.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:i}=r)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let s=t+e,o=e<0?-1:i._tree.children.length;s!=o;s+=e){let l=i._tree.children[s];if(this.mode&je.IncludeAnonymous||l instanceof bn||!l.type.isAnonymous||La(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;t=o,i=s+1;break e}r=this.stack[--s]}for(let r=i;r<this.stack.length;r++)t=new cn(this.buffer,t,this.stack[r]);return this.bufferNode=new cn(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&t&&t(this),r=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,r=!0}}}matchContext(e){if(!this.buffer)return Fl(this.node.parent,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return Fl(this._tree,e,r);let o=i[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function La(n){return n.children.some(e=>e instanceof bn||!e.type.isAnonymous||La(e))}function kw(n){var e;let{buffer:t,nodeSet:i,maxBufferLength:r=bw,reused:s=[],minRepeatType:o=i.types.length}=n,l=Array.isArray(t)?new Oa(t,t.length):t,a=i.types,c=0,h=0;function u(w,A,k,L,R,W){let{id:H,start:D,end:X,size:V}=l,G=h,Z=c;for(;V<0;)if(l.next(),V==-1){let ee=s[H];k.push(ee),L.push(D-w);return}else if(V==-3){c=H;return}else if(V==-4){h=H;return}else throw new RangeError(`Unrecognized record size: ${V}`);let E=a[H],O,j,Y=D-w;if(X-D<=r&&(j=m(l.pos-A,R))){let ee=new Uint16Array(j.size-j.skip),ue=l.pos-j.size,N=ee.length;for(;l.pos>ue;)N=x(j.start,ee,N);O=new bn(ee,X-j.start,i),Y=j.start-w}else{let ee=l.pos-V;l.next();let ue=[],N=[],K=H>=o?H:-1,$=0,q=X;for(;l.pos>ee;)K>=0&&l.id==K&&l.size>=0?(l.end<=q-r&&(p(ue,N,D,$,l.end,q,K,G,Z),$=ue.length,q=l.end),l.next()):W>2500?f(D,ee,ue,N):u(D,ee,ue,N,K,W+1);if(K>=0&&$>0&&$<ue.length&&p(ue,N,D,$,D,q,K,G,Z),ue.reverse(),N.reverse(),K>-1&&$>0){let J=d(E,Z);O=Pa(E,ue,N,0,ue.length,0,X-D,J,J)}else O=b(E,ue,N,X-D,G-X,Z)}k.push(O),L.push(Y)}function f(w,A,k,L){let R=[],W=0,H=-1;for(;l.pos>A;){let{id:D,start:X,end:V,size:G}=l;if(G>4)l.next();else{if(H>-1&&X<H)break;H<0&&(H=V-r),R.push(D,X,V),W++,l.next()}}if(W){let D=new Uint16Array(W*4),X=R[R.length-2];for(let V=R.length-3,G=0;V>=0;V-=3)D[G++]=R[V],D[G++]=R[V+1]-X,D[G++]=R[V+2]-X,D[G++]=G;k.push(new bn(D,R[2]-X,i)),L.push(X-w)}}function d(w,A){return(k,L,R)=>{let W=0,H=k.length-1,D,X;if(H>=0&&(D=k[H])instanceof Ce){if(!H&&D.type==w&&D.length==R)return D;(X=D.prop(oe.lookAhead))&&(W=L[H]+D.length+X)}return b(w,k,L,R,W,A)}}function p(w,A,k,L,R,W,H,D,X){let V=[],G=[];for(;w.length>L;)V.push(w.pop()),G.push(A.pop()+k-R);w.push(b(i.types[H],V,G,W-R,D-W,X)),A.push(R-k)}function b(w,A,k,L,R,W,H){if(W){let D=[oe.contextHash,W];H=H?[D].concat(H):[D]}if(R>25){let D=[oe.lookAhead,R];H=H?[D].concat(H):[D]}return new Ce(w,A,k,L,H)}function m(w,A){let k=l.fork(),L=0,R=0,W=0,H=k.end-r,D={size:0,start:0,skip:0};e:for(let X=k.pos-w;k.pos>X;){let V=k.size;if(k.id==A&&V>=0){D.size=L,D.start=R,D.skip=W,W+=4,L+=4,k.next();continue}let G=k.pos-V;if(V<0||G<X||k.start<H)break;let Z=k.id>=o?4:0,E=k.start;for(k.next();k.pos>G;){if(k.size<0)if(k.size==-3)Z+=4;else break e;else k.id>=o&&(Z+=4);k.next()}R=E,L+=V,W+=Z}return(A<0||L==w)&&(D.size=L,D.start=R,D.skip=W),D.size>4?D:void 0}function x(w,A,k){let{id:L,start:R,end:W,size:H}=l;if(l.next(),H>=0&&L<o){let D=k;if(H>4){let X=l.pos-(H-4);for(;l.pos>X;)k=x(w,A,k)}A[--k]=D,A[--k]=W-w,A[--k]=R-w,A[--k]=L}else H==-3?c=L:H==-4&&(h=L);return k}let y=[],C=[];for(;l.pos>0;)u(n.start||0,n.bufferStart||0,y,C,-1,0);let M=(e=n.length)!==null&&e!==void 0?e:y.length?C[0]+y[0].length:0;return new Ce(a[n.topID],y.reverse(),C.reverse(),M)}const Th=new WeakMap;function bs(n,e){if(!n.isAnonymous||e instanceof bn||e.type!=n)return 1;let t=Th.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=n||!(i instanceof Ce)){t=1;break}t+=bs(n,i)}Th.set(e,t)}return t}function Pa(n,e,t,i,r,s,o,l,a){let c=0;for(let p=i;p<r;p++)c+=bs(n,e[p]);let h=Math.ceil(c*1.5/8),u=[],f=[];function d(p,b,m,x,y){for(let C=m;C<x;){let M=C,w=b[C],A=bs(n,p[C]);for(C++;C<x;C++){let k=bs(n,p[C]);if(A+k>=h)break;A+=k}if(C==M+1){if(A>h){let k=p[M];d(k.children,k.positions,0,k.children.length,b[M]+y);continue}u.push(p[M])}else{let k=b[C-1]+p[C-1].length-w;u.push(Pa(n,p,b,M,C,w,k,null,a))}f.push(w+y-s)}}return d(e,t,i,r,0),(l||a)(u,f,o)}class On{constructor(e,t,i,r,s=!1,o=!1){this.from=e,this.to=t,this.tree=i,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let r=[new On(0,e.length,e,0,!1,i)];for(let s of t)s.to>e.length&&r.push(s);return r}static applyChanges(e,t,i=128){if(!t.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let l=0,a=0,c=0;;l++){let h=l<t.length?t[l]:null,u=h?h.fromA:1e9;if(u-a>=i)for(;o&&o.from<u;){let f=o;if(a>=f.from||u<=f.to||c){let d=Math.max(f.from,a)-c,p=Math.min(f.to,u)-c;f=d>=p?null:new On(d,p,f.tree,f.offset+c,l>0,!!h)}if(f&&r.push(f),o.to>u)break;o=s<e.length?e[s++]:null}if(!h)break;a=h.toA,c=h.toA-h.toB}return r}}class Jd{startParse(e,t,i){return typeof e=="string"&&(e=new Cw(e)),i=i?i.length?i.map(r=>new Po(r.from,r.to)):[new Po(0,0)]:[new Po(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let r=this.startParse(e,t,i);for(;;){let s=r.advance();if(s)return s}}}class Cw{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new oe({perNode:!0});let Aw=0;class ft{constructor(e,t,i,r){this.name=e,this.set=t,this.base=i,this.modified=r,this.id=Aw++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let i=typeof e=="string"?e:"?";if(e instanceof ft&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let r=new ft(i,[],null,[]);if(r.set.push(r),t)for(let s of t.set)r.set.push(s);return r}static defineModifier(e){let t=new Ns(e);return i=>i.modified.indexOf(t)>-1?i:Ns.get(i.base||i,i.modified.concat(t).sort((r,s)=>r.id-s.id))}}let Mw=0;class Ns{constructor(e){this.name=e,this.instances=[],this.id=Mw++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(l=>l.base==e&&Ew(t,l.modified));if(i)return i;let r=[],s=new ft(e.name,r,e,t);for(let l of t)l.instances.push(s);let o=Tw(t);for(let l of e.set)if(!l.modified.length)for(let a of o)r.push(Ns.get(l,a));return s}}function Ew(n,e){return n.length==e.length&&n.every((t,i)=>t==e[i])}function Tw(n){let e=[[]];for(let t=0;t<n.length;t++)for(let i=0,r=e.length;i<r;i++)e.push(e[i].concat(n[t]));return e.sort((t,i)=>i.length-t.length)}function Dw(n){let e=Object.create(null);for(let t in n){let i=n[t];Array.isArray(i)||(i=[i]);for(let r of t.split(" "))if(r){let s=[],o=2,l=r;for(let u=0;;){if(l=="..."&&u>0&&u+3==r.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!f)throw new RangeError("Invalid path: "+r);if(s.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),u+=f[0].length,u==r.length)break;let d=r[u++];if(u==r.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+r);l=r.slice(u)}let a=s.length-1,c=s[a];if(!c)throw new RangeError("Invalid path: "+r);let h=new Os(i,o,a>0?s.slice(0,a):null);e[c]=h.sort(e[c])}}return Yd.add(e)}const Yd=new oe;class Os{constructor(e,t,i,r){this.tags=e,this.mode=t,this.context=i,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Os.empty=new Os([],2,null);function Xd(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:i,all:r=null}=e||{};return{style:s=>{let o=r;for(let l of s)for(let a of l.set){let c=t[a.id];if(c){o=o?o+" "+c:c;break}}return o},scope:i}}function Rw(n,e){let t=null;for(let i of n){let r=i.style(e);r&&(t=t?t+" "+r:r)}return t}function Nw(n,e,t,i=0,r=n.length){let s=new Ow(i,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),i,r,"",s.highlighters),s.flush(r)}class Ow{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,r,s){let{type:o,from:l,to:a}=e;if(l>=i||a<=t)return;o.isTop&&(s=this.highlighters.filter(d=>!d.scope||d.scope(o)));let c=r,h=Lw(e)||Os.empty,u=Rw(s,h.tags);if(u&&(c&&(c+=" "),c+=u,h.mode==1&&(r+=(r?" ":"")+u)),this.startSpan(Math.max(t,l),c),h.opaque)return;let f=e.tree&&e.tree.prop(oe.mounted);if(f&&f.overlay){let d=e.node.enter(f.overlay[0].from+l,1),p=this.highlighters.filter(m=>!m.scope||m.scope(f.tree.type)),b=e.firstChild();for(let m=0,x=l;;m++){let y=m<f.overlay.length?f.overlay[m]:null,C=y?y.from+l:a,M=Math.max(t,x),w=Math.min(i,C);if(M<w&&b)for(;e.from<w&&(this.highlightRange(e,M,w,r,s),this.startSpan(Math.min(w,e.to),c),!(e.to>=C||!e.nextSibling())););if(!y||C>i)break;x=y.to+l,x>t&&(this.highlightRange(d.cursor(),Math.max(t,y.from+l),Math.min(i,x),"",p),this.startSpan(Math.min(i,x),c))}b&&e.parent()}else if(e.firstChild()){f&&(r="");do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,r,s),this.startSpan(Math.min(i,e.to),c)}while(e.nextSibling());e.parent()}}}function Lw(n){let e=n.type.prop(Yd);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const P=ft.define,Qr=P(),Zt=P(),Dh=P(Zt),Rh=P(Zt),en=P(),Zr=P(en),Io=P(en),Tt=P(),Sn=P(Tt),Mt=P(),Et=P(),Vl=P(),Wi=P(Vl),es=P(),v={comment:Qr,lineComment:P(Qr),blockComment:P(Qr),docComment:P(Qr),name:Zt,variableName:P(Zt),typeName:Dh,tagName:P(Dh),propertyName:Rh,attributeName:P(Rh),className:P(Zt),labelName:P(Zt),namespace:P(Zt),macroName:P(Zt),literal:en,string:Zr,docString:P(Zr),character:P(Zr),attributeValue:P(Zr),number:Io,integer:P(Io),float:P(Io),bool:P(en),regexp:P(en),escape:P(en),color:P(en),url:P(en),keyword:Mt,self:P(Mt),null:P(Mt),atom:P(Mt),unit:P(Mt),modifier:P(Mt),operatorKeyword:P(Mt),controlKeyword:P(Mt),definitionKeyword:P(Mt),moduleKeyword:P(Mt),operator:Et,derefOperator:P(Et),arithmeticOperator:P(Et),logicOperator:P(Et),bitwiseOperator:P(Et),compareOperator:P(Et),updateOperator:P(Et),definitionOperator:P(Et),typeOperator:P(Et),controlOperator:P(Et),punctuation:Vl,separator:P(Vl),bracket:Wi,angleBracket:P(Wi),squareBracket:P(Wi),paren:P(Wi),brace:P(Wi),content:Tt,heading:Sn,heading1:P(Sn),heading2:P(Sn),heading3:P(Sn),heading4:P(Sn),heading5:P(Sn),heading6:P(Sn),contentSeparator:P(Tt),list:P(Tt),quote:P(Tt),emphasis:P(Tt),strong:P(Tt),link:P(Tt),monospace:P(Tt),strikethrough:P(Tt),inserted:P(),deleted:P(),changed:P(),invalid:P(),meta:es,documentMeta:P(es),annotation:P(es),processingInstruction:P(es),definition:ft.defineModifier("definition"),constant:ft.defineModifier("constant"),function:ft.defineModifier("function"),standard:ft.defineModifier("standard"),local:ft.defineModifier("local"),special:ft.defineModifier("special")};for(let n in v){let e=v[n];e instanceof ft&&(e.name=n)}Xd([{tag:v.link,class:"tok-link"},{tag:v.heading,class:"tok-heading"},{tag:v.emphasis,class:"tok-emphasis"},{tag:v.strong,class:"tok-strong"},{tag:v.keyword,class:"tok-keyword"},{tag:v.atom,class:"tok-atom"},{tag:v.bool,class:"tok-bool"},{tag:v.url,class:"tok-url"},{tag:v.labelName,class:"tok-labelName"},{tag:v.inserted,class:"tok-inserted"},{tag:v.deleted,class:"tok-deleted"},{tag:v.literal,class:"tok-literal"},{tag:v.string,class:"tok-string"},{tag:v.number,class:"tok-number"},{tag:[v.regexp,v.escape,v.special(v.string)],class:"tok-string2"},{tag:v.variableName,class:"tok-variableName"},{tag:v.local(v.variableName),class:"tok-variableName tok-local"},{tag:v.definition(v.variableName),class:"tok-variableName tok-definition"},{tag:v.special(v.variableName),class:"tok-variableName2"},{tag:v.definition(v.propertyName),class:"tok-propertyName tok-definition"},{tag:v.typeName,class:"tok-typeName"},{tag:v.namespace,class:"tok-namespace"},{tag:v.className,class:"tok-className"},{tag:v.macroName,class:"tok-macroName"},{tag:v.propertyName,class:"tok-propertyName"},{tag:v.operator,class:"tok-operator"},{tag:v.comment,class:"tok-comment"},{tag:v.meta,class:"tok-meta"},{tag:v.invalid,class:"tok-invalid"},{tag:v.punctuation,class:"tok-punctuation"}]);var Bo;const ni=new oe;function Pw(n){return z.define({combine:n?e=>e.concat(n):void 0})}const Iw=new oe;class vt{constructor(e,t,i=[],r=""){this.data=e,this.name=r,ae.prototype.hasOwnProperty("tree")||Object.defineProperty(ae.prototype,"tree",{get(){return We(this)}}),this.parser=t,this.extension=[xn.of(this),ae.languageData.of((s,o,l)=>{let a=Nh(s,o,l),c=a.type.prop(ni);if(!c)return[];let h=s.facet(c),u=a.type.prop(Iw);if(u){let f=a.resolve(o-a.from,l);for(let d of u)if(d.test(f,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(h)}}return h})].concat(i)}isActiveAt(e,t,i=-1){return Nh(e,t,i).type.prop(ni)==this.data}findRegions(e){let t=e.facet(xn);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],r=(s,o)=>{if(s.prop(ni)==this.data){i.push({from:o,to:o+s.length});return}let l=s.prop(oe.mounted);if(l){if(l.tree.prop(ni)==this.data){if(l.overlay)for(let a of l.overlay)i.push({from:a.from+o,to:a.to+o});else i.push({from:o,to:o+s.length});return}else if(l.overlay){let a=i.length;if(r(l.tree,l.overlay[0].from+o),i.length>a)return}}for(let a=0;a<s.children.length;a++){let c=s.children[a];c instanceof Ce&&r(c,s.positions[a]+o)}};return r(We(e),0),i}get allowsNesting(){return!0}}vt.setState=ne.define();function Nh(n,e,t){let i=n.facet(xn),r=We(n).topNode;if(!i||i.allowsNesting)for(let s=r;s;s=s.enter(e,t,je.ExcludeBuffers))s.type.isTop&&(r=s);return r}function We(n){let e=n.field(vt.state,!1);return e?e.tree:Ce.empty}class Bw{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let Vi=null;class wi{constructor(e,t,i=[],r,s,o,l,a){this.parser=e,this.state=t,this.fragments=i,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new wi(e,t,[],Ce.empty,0,i,[],null)}startParse(){return this.parser.startParse(new Bw(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Ce.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(On.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(On.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Vi;Vi=this;try{return e()}finally{Vi=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Oh(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:r,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((c,h,u,f)=>a.push({fromA:c,toA:h,fromB:u,toB:f})),i=On.applyChanges(i,a),r=Ce.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let c of this.skipped){let h=e.mapPos(c.from,1),u=e.mapPos(c.to,-1);h<u&&l.push({from:h,to:u})}}}return new wi(this.parser,t,i,r,s,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:r,to:s}=this.skipped[i];r<e.to&&s>e.from&&(this.fragments=Oh(this.fragments,r,s),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Jd{createParse(t,i,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let a=Vi;if(a){for(let c of r)a.tempSkipped.push(c);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=o,new Ce(rt.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Vi}}function Oh(n,e,t){return On.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Si{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new Si(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=wi.create(e.facet(xn).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new Si(i)}}vt.state=Ve.define({create:Si.init,update(n,e){for(let t of e.effects)if(t.is(vt.setState))return t.value;return e.startState.facet(xn)!=e.state.facet(xn)?Si.init(e.state):n.apply(e)}});let Qd=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(Qd=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const zo=typeof navigator<"u"&&(!((Bo=navigator.scheduling)===null||Bo===void 0)&&Bo.isInputPending)?()=>navigator.scheduling.isInputPending():null,zw=De.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(vt.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(vt.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=Qd(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:r}}=this.view,s=i.field(vt.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!zo?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<r&&i.doc.length>r+1e3,a=s.context.work(()=>zo&&zo()||Date.now()>o,r+(l?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:vt.setState.of(new Si(s.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>nt(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),xn=z.define({combine(n){return n.length?n[0]:null},enables:n=>[vt.state,zw,B.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]}),Zd=z.define(),io=z.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function Hn(n){let e=n.facet(io);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function gr(n,e){let t="",i=n.tabSize,r=n.facet(io)[0];if(r=="	"){for(;e>=i;)t+="	",e-=i;r=" "}for(let s=0;s<e;s++)t+=r;return t}function Ia(n,e){n instanceof ae&&(n=new ro(n));for(let i of n.state.facet(Zd)){let r=i(n,e);if(r!==void 0)return r}let t=We(n.state);return t.length>=e?Hw(n,t,e):null}class ro{constructor(e,t={}){this.state=e,this.options=t,this.unit=Hn(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=i.from&&r<=i.to?s&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:i.text.slice(r-i.from),from:r}:{text:i.text.slice(0,r-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:r}=this.lineAt(e,t);return i.slice(e-r,Math.min(i.length,e+100-r))}column(e,t=1){let{text:i,from:r}=this.lineAt(e,t),s=this.countColumn(i,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,t=e.length){return Ri(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:r}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const jw=new oe;function Hw(n,e,t){let i=e.resolveStack(t),r=i.node.enterUnfinishedNodesBefore(t);if(r!=i.node){let s=[];for(let o=r;o!=i.node;o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)i={node:s[o],next:i}}return ep(i,n,t)}function ep(n,e,t){for(let i=n;i;i=i.next){let r=Ww(i.node);if(r)return r(Ba.create(e,t,i))}return 0}function Fw(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function Ww(n){let e=n.type.prop(jw);if(e)return e;let t=n.firstChild,i;if(t&&(i=t.type.prop(oe.closedBy))){let r=n.lastChild,s=r&&i.indexOf(r.name)>-1;return o=>qw(o,!0,1,void 0,s&&!Fw(o)?r.from:void 0)}return n.parent==null?Vw:null}function Vw(){return 0}class Ba extends ro{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.context=i}get node(){return this.context.node}static create(e,t,i){return new Ba(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(t.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if($w(i,e))break;t=this.state.doc.lineAt(i.from)}return this.lineIndent(t.from)}continue(){return ep(this.context.next,this.base,this.pos)}}function $w(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function _w(n){let e=n.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let r=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==i)return null;if(!a.type.isSkipped){if(a.from>=o)return null;let c=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+c}}l=a.to}}function qw(n,e,t,i,r){let s=n.textAfter,o=s.match(/^\s*/)[0].length,l=r==n.pos+o,a=_w(n);return a?l?n.column(a.from):n.column(a.to):n.baseIndent+(l?0:n.unit*t)}const Uw=200;function Kw(){return ae.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:i}=n.newSelection.main,r=t.lineAt(i);if(i>r.from+Uw)return n;let s=t.sliceString(r.from,i);if(!e.some(c=>c.test(s)))return n;let{state:o}=n,l=-1,a=[];for(let{head:c}of o.selection.ranges){let h=o.doc.lineAt(c);if(h.from==l)continue;l=h.from;let u=Ia(o,h.from);if(u==null)continue;let f=/^\s*/.exec(h.text)[0],d=gr(o,u);f!=d&&a.push({from:h.from,to:h.from+f.length,insert:d})}return a.length?[n,{changes:a,sequential:!0}]:n})}const Gw=z.define(),Jw=new oe;function Yw(n,e,t){let i=We(n);if(i.length<t)return null;let r=i.resolveStack(t,1),s=null;for(let o=r;o;o=o.next){let l=o.node;if(l.to<=t||l.from>t)continue;if(s&&l.from<e)break;let a=l.type.prop(Jw);if(a&&(l.to<i.length-50||i.length==n.doc.length||!Xw(l))){let c=a(l,n);c&&c.from<=t&&c.from>=e&&c.to>t&&(s=c)}}return s}function Xw(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function Ls(n,e,t){for(let i of n.facet(Gw)){let r=i(n,e,t);if(r)return r}return Yw(n,e,t)}function tp(n,e){let t=e.mapPos(n.from,1),i=e.mapPos(n.to,-1);return t>=i?void 0:{from:t,to:i}}const so=ne.define({map:tp}),Or=ne.define({map:tp});function np(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(i=>i.from<=t&&i.to>=t)||e.push(n.lineBlockAt(t));return e}const Fn=Ve.define({create(){return U.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is(so)&&!Qw(n,t.value.from,t.value.to)){let{preparePlaceholder:i}=e.state.facet(sp),r=i?U.replace({widget:new s1(i(e.state,t.value))}):Lh;n=n.update({add:[r.range(t.value.from,t.value.to)]})}else t.is(Or)&&(n=n.update({filter:(i,r)=>t.value.from!=i||t.value.to!=r,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:i}=e.selection.main;n.between(i,i,(r,s)=>{r<i&&s>i&&(t=!0)}),t&&(n=n.update({filterFrom:i,filterTo:i,filter:(r,s)=>s<=i||r>=i}))}return n},provide:n=>B.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(i,r)=>{t.push(i,r)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let i=n[t++],r=n[t++];if(typeof i!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(Lh.range(i,r))}return U.set(e,!0)}});function Ps(n,e,t){var i;let r=null;return(i=n.field(Fn,!1))===null||i===void 0||i.between(e,t,(s,o)=>{(!r||r.from>s)&&(r={from:s,to:o})}),r}function Qw(n,e,t){let i=!1;return n.between(e,e,(r,s)=>{r==e&&s==t&&(i=!0)}),i}function ip(n,e){return n.field(Fn,!1)?e:e.concat(ne.appendConfig.of(op()))}const Zw=n=>{for(let e of np(n)){let t=Ls(n.state,e.from,e.to);if(t)return n.dispatch({effects:ip(n.state,[so.of(t),rp(n,t)])}),!0}return!1},e1=n=>{if(!n.state.field(Fn,!1))return!1;let e=[];for(let t of np(n)){let i=Ps(n.state,t.from,t.to);i&&e.push(Or.of(i),rp(n,i,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function rp(n,e,t=!0){let i=n.state.doc.lineAt(e.from).number,r=n.state.doc.lineAt(e.to).number;return B.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${i} ${n.state.phrase("to")} ${r}.`)}const t1=n=>{let{state:e}=n,t=[];for(let i=0;i<e.doc.length;){let r=n.lineBlockAt(i),s=Ls(e,r.from,r.to);s&&t.push(so.of(s)),i=(s?n.lineBlockAt(s.to):r).to+1}return t.length&&n.dispatch({effects:ip(n.state,t)}),!!t.length},n1=n=>{let e=n.state.field(Fn,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(i,r)=>{t.push(Or.of({from:i,to:r}))}),n.dispatch({effects:t}),!0},i1=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Zw},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:e1},{key:"Ctrl-Alt-[",run:t1},{key:"Ctrl-Alt-]",run:n1}],r1={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},sp=z.define({combine(n){return Ht(n,r1)}});function op(n){return[Fn,a1]}function lp(n,e){let{state:t}=n,i=t.facet(sp),r=o=>{let l=n.lineBlockAt(n.posAtDOM(o.target)),a=Ps(n.state,l.from,l.to);a&&n.dispatch({effects:Or.of(a)}),o.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(n,r,e);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}const Lh=U.replace({widget:new class extends Jt{toDOM(n){return lp(n,null)}}});class s1 extends Jt{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return lp(e,this.value)}}const o1={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class jo extends Gt{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function l1(n={}){let e=Object.assign(Object.assign({},o1),n),t=new jo(e,!0),i=new jo(e,!1),r=De.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(xn)!=o.state.facet(xn)||o.startState.field(Fn,!1)!=o.state.field(Fn,!1)||We(o.startState)!=We(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new dn;for(let a of o.viewportLineBlocks){let c=Ps(o.state,a.from,a.to)?i:Ls(o.state,a.from,a.to)?t:null;c&&l.add(a.from,a.from,c)}return l.finish()}}),{domEventHandlers:s}=e;return[r,ow({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(r))===null||l===void 0?void 0:l.markers)||ce.empty},initialSpacer(){return new jo(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(o,l,a)=>{if(s.click&&s.click(o,l,a))return!0;let c=Ps(o.state,l.from,l.to);if(c)return o.dispatch({effects:Or.of(c)}),!0;let h=Ls(o.state,l.from,l.to);return h?(o.dispatch({effects:so.of(h)}),!0):!1}})}),op()]}const a1=B.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Ni{constructor(e,t){this.specs=e;let i;function r(l){let a=pn.newName();return(i||(i=Object.create(null)))["."+a]=l,a}const s=typeof t.all=="string"?t.all:t.all?r(t.all):void 0,o=t.scope;this.scope=o instanceof vt?l=>l.prop(ni)==o.data:o?l=>l==o:void 0,this.style=Xd(e.map(l=>({tag:l.tag,class:l.class||r(Object.assign({},l,{tag:null}))})),{all:s}).style,this.module=i?new pn(i):null,this.themeType=t.themeType}static define(e,t){return new Ni(e,t||{})}}const $l=z.define(),ap=z.define({combine(n){return n.length?[n[0]]:null}});function Ho(n){let e=n.facet($l);return e.length?e:n.facet(ap)}function za(n,e){let t=[h1],i;return n instanceof Ni&&(n.module&&t.push(B.styleModule.of(n.module)),i=n.themeType),e!=null&&e.fallback?t.push(ap.of(n)):i?t.push($l.computeN([B.darkTheme],r=>r.facet(B.darkTheme)==(i=="dark")?[n]:[])):t.push($l.of(n)),t}class c1{constructor(e){this.markCache=Object.create(null),this.tree=We(e.state),this.decorations=this.buildDeco(e,Ho(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=We(e.state),i=Ho(e.state),r=i!=Ho(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!r&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return U.none;let i=new dn;for(let{from:r,to:s}of e.visibleRanges)Nw(this.tree,t,(o,l,a)=>{i.add(o,l,this.markCache[a]||(this.markCache[a]=U.mark({class:a})))},r,s);return i.finish()}}const h1=_n.high(De.fromClass(c1,{decorations:n=>n.decorations})),u1=Ni.define([{tag:v.meta,color:"#404740"},{tag:v.link,textDecoration:"underline"},{tag:v.heading,textDecoration:"underline",fontWeight:"bold"},{tag:v.emphasis,fontStyle:"italic"},{tag:v.strong,fontWeight:"bold"},{tag:v.strikethrough,textDecoration:"line-through"},{tag:v.keyword,color:"#708"},{tag:[v.atom,v.bool,v.url,v.contentSeparator,v.labelName],color:"#219"},{tag:[v.literal,v.inserted],color:"#164"},{tag:[v.string,v.deleted],color:"#a11"},{tag:[v.regexp,v.escape,v.special(v.string)],color:"#e40"},{tag:v.definition(v.variableName),color:"#00f"},{tag:v.local(v.variableName),color:"#30a"},{tag:[v.typeName,v.namespace],color:"#085"},{tag:v.className,color:"#167"},{tag:[v.special(v.variableName),v.macroName],color:"#256"},{tag:v.definition(v.propertyName),color:"#00c"},{tag:v.comment,color:"#940"},{tag:v.invalid,color:"#f00"}]),f1=B.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),cp=1e4,hp="()[]{}",up=z.define({combine(n){return Ht(n,{afterCursor:!0,brackets:hp,maxScanDistance:cp,renderMatch:m1})}}),d1=U.mark({class:"cm-matchingBracket"}),p1=U.mark({class:"cm-nonmatchingBracket"});function m1(n){let e=[],t=n.matched?d1:p1;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const g1=Ve.define({create(){return U.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],i=e.state.facet(up);for(let r of e.state.selection.ranges){if(!r.empty)continue;let s=Ot(e.state,r.head,-1,i)||r.head>0&&Ot(e.state,r.head-1,1,i)||i.afterCursor&&(Ot(e.state,r.head,1,i)||r.head<e.state.doc.length&&Ot(e.state,r.head+1,-1,i));s&&(t=t.concat(i.renderMatch(s,e.state)))}return U.set(t,!0)},provide:n=>B.decorations.from(n)}),b1=[g1,f1];function x1(n={}){return[up.of(n),b1]}const y1=new oe;function _l(n,e,t){let i=n.prop(e<0?oe.openedBy:oe.closedBy);if(i)return i;if(n.name.length==1){let r=t.indexOf(n.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function ql(n){let e=n.type.prop(y1);return e?e(n.node):n}function Ot(n,e,t,i={}){let r=i.maxScanDistance||cp,s=i.brackets||hp,o=We(n),l=o.resolveInner(e,t);for(let a=l;a;a=a.parent){let c=_l(a.type,t,s);if(c&&a.from<a.to){let h=ql(a);if(h&&(t>0?e>=h.from&&e<h.to:e>h.from&&e<=h.to))return v1(n,e,t,a,h,c,s)}}return w1(n,e,t,o,l.type,r,s)}function v1(n,e,t,i,r,s,o){let l=i.parent,a={from:r.from,to:r.to},c=0,h=l==null?void 0:l.cursor();if(h&&(t<0?h.childBefore(i.from):h.childAfter(i.to)))do if(t<0?h.to<=i.from:h.from>=i.to){if(c==0&&s.indexOf(h.type.name)>-1&&h.from<h.to){let u=ql(h);return{start:a,end:u?{from:u.from,to:u.to}:void 0,matched:!0}}else if(_l(h.type,t,o))c++;else if(_l(h.type,-t,o)){if(c==0){let u=ql(h);return{start:a,end:u&&u.from<u.to?{from:u.from,to:u.to}:void 0,matched:!1}}c--}}while(t<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function w1(n,e,t,i,r,s,o){let l=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},h=n.doc.iterRange(e,t>0?n.doc.length:0),u=0;for(let f=0;!h.next().done&&f<=s;){let d=h.value;t<0&&(f+=d.length);let p=e+f*t;for(let b=t>0?0:d.length-1,m=t>0?d.length:-1;b!=m;b+=t){let x=o.indexOf(d[b]);if(!(x<0||i.resolveInner(p+b,1).type!=r))if(x%2==0==t>0)u++;else{if(u==1)return{start:c,end:{from:p+b,to:p+b+1},matched:x>>1==a>>1};u--}}t>0&&(f+=d.length)}return h.done?{start:c,matched:!1}:null}function Ph(n,e,t,i=0,r=0){e==null&&(e=n.search(/[^\s\u00a0]/),e==-1&&(e=n.length));let s=r;for(let o=i;o<e;o++)n.charCodeAt(o)==9?s+=t-s%t:s++;return s}class fp{constructor(e,t,i,r){this.string=e,this.tabSize=t,this.indentUnit=i,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),i;if(typeof e=="string"?i=t==e:i=t&&(e instanceof RegExp?e.test(t):e(t)),i)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ph(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:Ph(this.string,null,this.tabSize)}match(e,t,i){if(typeof e=="string"){let r=o=>i?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function S1(n){return{name:n.name||"",token:n.token,blankLine:n.blankLine||(()=>{}),startState:n.startState||(()=>!0),copyState:n.copyState||k1,indent:n.indent||(()=>null),languageData:n.languageData||{},tokenTable:n.tokenTable||Fa}}function k1(n){if(typeof n!="object")return n;let e={};for(let t in n){let i=n[t];e[t]=i instanceof Array?i.slice():i}return e}const Ih=new WeakMap;class ja extends vt{constructor(e){let t=Pw(e.languageData),i=S1(e),r,s=new class extends Jd{createParse(o,l,a){return new A1(r,o,l,a)}};super(t,s,[Zd.of((o,l)=>this.getIndent(o,l))],e.name),this.topNode=T1(t),r=this,this.streamParser=i,this.stateAfter=new oe({perNode:!0}),this.tokenTable=e.tokenTable?new gp(i.tokenTable):E1}static define(e){return new ja(e)}getIndent(e,t){let i=We(e.state),r=i.resolve(t);for(;r&&r.type!=this.topNode;)r=r.parent;if(!r)return null;let s,{overrideIndentation:o}=e.options;o&&(s=Ih.get(e.state),s!=null&&s<t-1e4&&(s=void 0));let l=Ha(this,i,0,r.from,s??t),a,c;if(l?(c=l.state,a=l.pos+1):(c=this.streamParser.startState(e.unit),a=0),t-a>1e4)return null;for(;a<t;){let u=e.state.doc.lineAt(a),f=Math.min(t,u.to);if(u.length){let d=o?o(u.from):-1,p=new fp(u.text,e.state.tabSize,e.unit,d<0?void 0:d);for(;p.pos<f-u.from;)pp(this.streamParser.token,p,c)}else this.streamParser.blankLine(c,e.unit);if(f==t)break;a=u.to+1}let h=e.lineAt(t);return o&&s==null&&Ih.set(e.state,h.from),this.streamParser.indent(c,/^\s*(.*)/.exec(h.text)[1],e)}get allowsNesting(){return!1}}function Ha(n,e,t,i,r){let s=t>=i&&t+e.length<=r&&e.prop(n.stateAfter);if(s)return{state:n.streamParser.copyState(s),pos:t+e.length};for(let o=e.children.length-1;o>=0;o--){let l=e.children[o],a=t+e.positions[o],c=l instanceof Ce&&a<r&&Ha(n,l,a,i,r);if(c)return c}return null}function dp(n,e,t,i,r){if(r&&t<=0&&i>=e.length)return e;!r&&e.type==n.topNode&&(r=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],l=e.children[s],a;if(o<i&&l instanceof Ce){if(!(a=dp(n,l,t-o,i-o,r)))break;return r?new Ce(e.type,e.children.slice(0,s).concat(a),e.positions.slice(0,s+1),o+a.length):a}}return null}function C1(n,e,t,i){for(let r of e){let s=r.from+(r.openStart?25:0),o=r.to-(r.openEnd?25:0),l=s<=t&&o>t&&Ha(n,r.tree,0-r.offset,t,o),a;if(l&&(a=dp(n,r.tree,t+r.offset,l.pos+r.offset,!1)))return{state:l.state,tree:a}}return{state:n.streamParser.startState(i?Hn(i):4),tree:Ce.empty}}class A1{constructor(e,t,i,r){this.lang=e,this.input=t,this.fragments=i,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=wi.get(),o=r[0].from,{state:l,tree:a}=C1(e,i,o,s==null?void 0:s.state);this.state=l,this.parsedPos=this.chunkStart=o+a.length;for(let c=0;c<a.children.length;c++)this.chunks.push(a.children[c]),this.chunkPos.push(a.positions[c]);s&&this.parsedPos<s.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(Hn(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=wi.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),i=Math.min(t,this.chunkStart+2048);for(e&&(i=Math.min(i,e.viewport.to));this.parsedPos<i;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let i=t.indexOf(`
`);i>-1&&(t=t.slice(0,i))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),i=e+t.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=i||(t=t.slice(0,s-(i-t.length)),r++,r==this.ranges.length))break;let o=this.ranges[r].from,l=this.lineAfter(o);t+=l,i=o+l.length}return{line:t,end:i}}skipGapsTo(e,t,i){for(;;){let r=this.ranges[this.rangeIndex].to,s=e+t;if(i>0?r>s:r>=s)break;let o=this.ranges[++this.rangeIndex].from;t+=o-r}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,i,r,s){if(this.ranges.length>1){s=this.skipGapsTo(t,s,1),t+=s;let o=this.chunk.length;s=this.skipGapsTo(i,s,-1),i+=s,r+=this.chunk.length-o}return this.chunk.push(e,t,i,r),s}parseLine(e){let{line:t,end:i}=this.nextLine(),r=0,{streamParser:s}=this.lang,o=new fp(t,e?e.state.tabSize:4,e?Hn(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let l=pp(s.token,o,this.state);if(l&&(r=this.emitToken(this.lang.tokenTable.resolve(l),this.parsedPos+o.start,this.parsedPos+o.pos,4,r)),o.start>1e4)break}this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Ce.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:M1,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Ce(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Ce(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function pp(n,e,t){e.start=e.pos;for(let i=0;i<10;i++){let r=n(e,t);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}const Fa=Object.create(null),br=[rt.none],M1=new Na(br),Bh=[],zh=Object.create(null),mp=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])mp[n]=bp(Fa,e);class gp{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),mp)}resolve(e){return e?this.table[e]||(this.table[e]=bp(this.extra,e)):0}}const E1=new gp(Fa);function Fo(n,e){Bh.indexOf(n)>-1||(Bh.push(n),console.warn(e))}function bp(n,e){let t=[];for(let l of e.split(" ")){let a=[];for(let c of l.split(".")){let h=n[c]||v[c];h?typeof h=="function"?a.length?a=a.map(h):Fo(c,`Modifier ${c} used at start of tag`):a.length?Fo(c,`Tag ${c} used as modifier`):a=Array.isArray(h)?h:[h]:Fo(c,`Unknown highlighting tag ${c}`)}for(let c of a)t.push(c)}if(!t.length)return 0;let i=e.replace(/ /g,"_"),r=i+" "+t.map(l=>l.id),s=zh[r];if(s)return s.id;let o=zh[r]=rt.define({id:br.length,name:i,props:[Dw({[i]:t})]});return br.push(o),o.id}function T1(n){let e=rt.define({id:br.length,name:"Document",props:[ni.add(()=>n)],top:!0});return br.push(e),e}ve.RTL,ve.LTR;const D1=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),i=Va(n.state,t.from);return i.line?R1(n):i.block?O1(n):!1};function Wa(n,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let r=n(e,t);return r?(i(t.update(r)),!0):!1}}const R1=Wa(I1,0),N1=Wa(xp,0),O1=Wa((n,e)=>xp(n,e,P1(e)),0);function Va(n,e){let t=n.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const $i=50;function L1(n,{open:e,close:t},i,r){let s=n.sliceDoc(i-$i,i),o=n.sliceDoc(r,r+$i),l=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(o)[0].length,c=s.length-l;if(s.slice(c-e.length,c)==e&&o.slice(a,a+t.length)==t)return{open:{pos:i-l,margin:l&&1},close:{pos:r+a,margin:a&&1}};let h,u;r-i<=2*$i?h=u=n.sliceDoc(i,r):(h=n.sliceDoc(i,i+$i),u=n.sliceDoc(r-$i,r));let f=/^\s*/.exec(h)[0].length,d=/\s*$/.exec(u)[0].length,p=u.length-d-t.length;return h.slice(f,f+e.length)==e&&u.slice(p,p+t.length)==t?{open:{pos:i+f+e.length,margin:/\s/.test(h.charAt(f+e.length))?1:0},close:{pos:r-d-t.length,margin:/\s/.test(u.charAt(p-1))?1:0}}:null}function P1(n){let e=[];for(let t of n.selection.ranges){let i=n.doc.lineAt(t.from),r=t.to<=i.to?i:n.doc.lineAt(t.to);r.from>i.from&&r.from==t.to&&(r=t.to==i.to+1?i:n.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=r.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:r.to})}return e}function xp(n,e,t=e.selection.ranges){let i=t.map(s=>Va(e,s.from).block);if(!i.every(s=>s))return null;let r=t.map((s,o)=>L1(e,i[o],s.from,s.to));if(n!=2&&!r.every(s=>s))return{changes:e.changes(t.map((s,o)=>r[o]?[]:[{from:s.from,insert:i[o].open+" "},{from:s.to,insert:" "+i[o].close}]))};if(n!=1&&r.some(s=>s)){let s=[];for(let o=0,l;o<r.length;o++)if(l=r[o]){let a=i[o],{open:c,close:h}=l;s.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:h.pos-h.margin,to:h.pos+a.close.length})}return{changes:s}}return null}function I1(n,e,t=e.selection.ranges){let i=[],r=-1;for(let{from:s,to:o}of t){let l=i.length,a=1e9,c=Va(e,s).line;if(c){for(let h=s;h<=o;){let u=e.doc.lineAt(h);if(u.from>r&&(s==o||o>u.from)){r=u.from;let f=/^\s*/.exec(u.text)[0].length,d=f==u.length,p=u.text.slice(f,f+c.length)==c?f:-1;f<u.text.length&&f<a&&(a=f),i.push({line:u,comment:p,token:c,indent:f,empty:d,single:!1})}h=u.to+1}if(a<1e9)for(let h=l;h<i.length;h++)i[h].indent<i[h].line.text.length&&(i[h].indent=a);i.length==l+1&&(i[l].single=!0)}}if(n!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:a,indent:c,empty:h,single:u}of i)(u||!h)&&s.push({from:l.from+c,insert:a+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:l,token:a}of i)if(l>=0){let c=o.from+l,h=c+a.length;o.text[h-o.from]==" "&&h++,s.push({from:c,to:h})}return{changes:s}}return null}const Ul=jt.define(),B1=jt.define(),z1=z.define(),yp=z.define({combine(n){return Ht(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(i,r)=>e(i,r)||t(i,r)})}}),vp=Ve.define({create(){return Lt.empty},update(n,e){let t=e.state.facet(yp),i=e.annotation(Ul);if(i){let a=it.fromTransaction(e,i.selection),c=i.side,h=c==0?n.undone:n.done;return a?h=Is(h,h.length,t.minDepth,a):h=kp(h,e.startState.selection),new Lt(c==0?i.rest:h,c==0?h:i.rest)}let r=e.annotation(B1);if((r=="full"||r=="before")&&(n=n.isolate()),e.annotation(Oe.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let s=it.fromTransaction(e),o=e.annotation(Oe.time),l=e.annotation(Oe.userEvent);return s?n=n.addChanges(s,o,l,t,e):e.selection&&(n=n.addSelection(e.startState.selection,o,l,t.newGroupDelay)),(r=="full"||r=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Lt(n.done.map(it.fromJSON),n.undone.map(it.fromJSON))}});function j1(n={}){return[vp,yp.of(n),B.domEventHandlers({beforeinput(e,t){let i=e.inputType=="historyUndo"?wp:e.inputType=="historyRedo"?Kl:null;return i?(e.preventDefault(),i(t)):!1}})]}function oo(n,e){return function({state:t,dispatch:i}){if(!e&&t.readOnly)return!1;let r=t.field(vp,!1);if(!r)return!1;let s=r.pop(n,t,e);return s?(i(s),!0):!1}}const wp=oo(0,!1),Kl=oo(1,!1),H1=oo(0,!0),F1=oo(1,!0);class it{constructor(e,t,i,r,s){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new it(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new it(e.changes&&Ne.fromJSON(e.changes),[],e.mapped&&Pt.fromJSON(e.mapped),e.startSelection&&T.fromJSON(e.startSelection),e.selectionsAfter.map(T.fromJSON))}static fromTransaction(e,t){let i=pt;for(let r of e.startState.facet(z1)){let s=r(e);s.length&&(i=i.concat(s))}return!i.length&&e.changes.empty?null:new it(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,pt)}static selection(e){return new it(void 0,pt,void 0,void 0,e)}}function Is(n,e,t,i){let r=e+1>t+20?e-t-1:0,s=n.slice(r,e);return s.push(i),s}function W1(n,e){let t=[],i=!1;return n.iterChangedRanges((r,s)=>t.push(r,s)),e.iterChangedRanges((r,s,o,l)=>{for(let a=0;a<t.length;){let c=t[a++],h=t[a++];l>=c&&o<=h&&(i=!0)}}),i}function V1(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,i)=>t.empty!=e.ranges[i].empty).length===0}function Sp(n,e){return n.length?e.length?n.concat(e):n:e}const pt=[],$1=200;function kp(n,e){if(n.length){let t=n[n.length-1],i=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-$1));return i.length&&i[i.length-1].eq(e)?n:(i.push(e),Is(n,n.length-1,1e9,t.setSelAfter(i)))}else return[it.selection([e])]}function _1(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Wo(n,e){if(!n.length)return n;let t=n.length,i=pt;for(;t;){let r=q1(n[t-1],e,i);if(r.changes&&!r.changes.empty||r.effects.length){let s=n.slice(0,t);return s[t-1]=r,s}else e=r.mapped,t--,i=r.selectionsAfter}return i.length?[it.selection(i)]:pt}function q1(n,e,t){let i=Sp(n.selectionsAfter.length?n.selectionsAfter.map(l=>l.map(e)):pt,t);if(!n.changes)return it.selection(i);let r=n.changes.map(e),s=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(s):s;return new it(r,ne.mapEffects(n.effects,e),o,n.startSelection.map(s),i)}const U1=/^(input\.type|delete)($|\.)/;class Lt{constructor(e,t,i=0,r=void 0){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=r}isolate(){return this.prevTime?new Lt(this.done,this.undone):this}addChanges(e,t,i,r,s){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!i||U1.test(i))&&(!l.selectionsAfter.length&&t-this.prevTime<r.newGroupDelay&&r.joinToEvent(s,W1(l.changes,e.changes))||i=="input.type.compose")?o=Is(o,o.length-1,r.minDepth,new it(e.changes.compose(l.changes),Sp(ne.mapEffects(e.effects,l.changes),l.effects),l.mapped,l.startSelection,pt)):o=Is(o,o.length,r.minDepth,e),new Lt(o,pt,t,i)}addSelection(e,t,i,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:pt;return s.length>0&&t-this.prevTime<r&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&V1(s[s.length-1],e)?this:new Lt(kp(this.done,e),this.undone,t,i)}addMapping(e){return new Lt(Wo(this.done,e),Wo(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1],o=s.selectionsAfter[0]||t.selection;if(i&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Ul.of({side:e,rest:_1(r),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let l=r.length==1?pt:r.slice(0,r.length-1);return s.mapped&&(l=Wo(l,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Ul.of({side:e,rest:l,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Lt.empty=new Lt(pt,pt);const K1=[{key:"Mod-z",run:wp,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Kl,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Kl,preventDefault:!0},{key:"Mod-u",run:H1,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:F1,preventDefault:!0}];function Oi(n,e){return T.create(n.ranges.map(e),n.mainIndex)}function Ft(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Ct({state:n,dispatch:e},t){let i=Oi(n.selection,t);return i.eq(n.selection,!0)?!1:(e(Ft(n,i)),!0)}function lo(n,e){return T.cursor(e?n.to:n.from)}function Cp(n,e){return Ct(n,t=>t.empty?n.moveByChar(t,e):lo(t,e))}function Ke(n){return n.textDirectionAt(n.state.selection.main.head)==ve.LTR}const Ap=n=>Cp(n,!Ke(n)),Mp=n=>Cp(n,Ke(n));function Ep(n,e){return Ct(n,t=>t.empty?n.moveByGroup(t,e):lo(t,e))}const G1=n=>Ep(n,!Ke(n)),J1=n=>Ep(n,Ke(n));function Y1(n,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function ao(n,e,t){let i=We(n).resolveInner(e.head),r=t?oe.closedBy:oe.openedBy;for(let a=e.head;;){let c=t?i.childAfter(a):i.childBefore(a);if(!c)break;Y1(n,c,r)?i=c:a=t?c.to:c.from}let s=i.type.prop(r),o,l;return s&&(o=t?Ot(n,i.from,1):Ot(n,i.to,-1))&&o.matched?l=t?o.end.to:o.end.from:l=t?i.to:i.from,T.cursor(l,t?-1:1)}const X1=n=>Ct(n,e=>ao(n.state,e,!Ke(n))),Q1=n=>Ct(n,e=>ao(n.state,e,Ke(n)));function Tp(n,e){return Ct(n,t=>{if(!t.empty)return lo(t,e);let i=n.moveVertically(t,e);return i.head!=t.head?i:n.moveToLineBoundary(t,e)})}const Dp=n=>Tp(n,!1),Rp=n=>Tp(n,!0);function Np(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,i=0,r;if(e){for(let s of n.state.facet(B.scrollMargins)){let o=s(n);o!=null&&o.top&&(t=Math.max(o==null?void 0:o.top,t)),o!=null&&o.bottom&&(i=Math.max(o==null?void 0:o.bottom,i))}r=n.scrollDOM.clientHeight-t-i}else r=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:i,selfScroll:e,height:Math.max(n.defaultLineHeight,r-5)}}function Op(n,e){let t=Np(n),{state:i}=n,r=Oi(i.selection,o=>o.empty?n.moveVertically(o,e,t.height):lo(o,e));if(r.eq(i.selection))return!1;let s;if(t.selfScroll){let o=n.coordsAtPos(i.selection.main.head),l=n.scrollDOM.getBoundingClientRect(),a=l.top+t.marginTop,c=l.bottom-t.marginBottom;o&&o.top>a&&o.bottom<c&&(s=B.scrollIntoView(r.main.head,{y:"start",yMargin:o.top-a}))}return n.dispatch(Ft(i,r),{effects:s}),!0}const jh=n=>Op(n,!1),Gl=n=>Op(n,!0);function vn(n,e,t){let i=n.lineBlockAt(e.head),r=n.moveToLineBoundary(e,t);if(r.head==e.head&&r.head!=(t?i.to:i.from)&&(r=n.moveToLineBoundary(e,t,!1)),!t&&r.head==i.from&&i.length){let s=/^\s*/.exec(n.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(r=T.cursor(i.from+s))}return r}const Z1=n=>Ct(n,e=>vn(n,e,!0)),eS=n=>Ct(n,e=>vn(n,e,!1)),tS=n=>Ct(n,e=>vn(n,e,!Ke(n))),nS=n=>Ct(n,e=>vn(n,e,Ke(n))),iS=n=>Ct(n,e=>T.cursor(n.lineBlockAt(e.head).from,1)),rS=n=>Ct(n,e=>T.cursor(n.lineBlockAt(e.head).to,-1));function sS(n,e,t){let i=!1,r=Oi(n.selection,s=>{let o=Ot(n,s.head,-1)||Ot(n,s.head,1)||s.head>0&&Ot(n,s.head-1,1)||s.head<n.doc.length&&Ot(n,s.head+1,-1);if(!o||!o.end)return s;i=!0;let l=o.start.from==s.head?o.end.to:o.end.from;return T.cursor(l)});return i?(e(Ft(n,r)),!0):!1}const oS=({state:n,dispatch:e})=>sS(n,e);function yt(n,e){let t=Oi(n.state.selection,i=>{let r=e(i);return T.range(i.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(Ft(n.state,t)),!0)}function Lp(n,e){return yt(n,t=>n.moveByChar(t,e))}const Pp=n=>Lp(n,!Ke(n)),Ip=n=>Lp(n,Ke(n));function Bp(n,e){return yt(n,t=>n.moveByGroup(t,e))}const lS=n=>Bp(n,!Ke(n)),aS=n=>Bp(n,Ke(n)),cS=n=>yt(n,e=>ao(n.state,e,!Ke(n))),hS=n=>yt(n,e=>ao(n.state,e,Ke(n)));function zp(n,e){return yt(n,t=>n.moveVertically(t,e))}const jp=n=>zp(n,!1),Hp=n=>zp(n,!0);function Fp(n,e){return yt(n,t=>n.moveVertically(t,e,Np(n).height))}const Hh=n=>Fp(n,!1),Fh=n=>Fp(n,!0),uS=n=>yt(n,e=>vn(n,e,!0)),fS=n=>yt(n,e=>vn(n,e,!1)),dS=n=>yt(n,e=>vn(n,e,!Ke(n))),pS=n=>yt(n,e=>vn(n,e,Ke(n))),mS=n=>yt(n,e=>T.cursor(n.lineBlockAt(e.head).from)),gS=n=>yt(n,e=>T.cursor(n.lineBlockAt(e.head).to)),Wh=({state:n,dispatch:e})=>(e(Ft(n,{anchor:0})),!0),Vh=({state:n,dispatch:e})=>(e(Ft(n,{anchor:n.doc.length})),!0),$h=({state:n,dispatch:e})=>(e(Ft(n,{anchor:n.selection.main.anchor,head:0})),!0),_h=({state:n,dispatch:e})=>(e(Ft(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),bS=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),xS=({state:n,dispatch:e})=>{let t=co(n).map(({from:i,to:r})=>T.range(i,Math.min(r+1,n.doc.length)));return e(n.update({selection:T.create(t),userEvent:"select"})),!0},yS=({state:n,dispatch:e})=>{let t=Oi(n.selection,i=>{let r=We(n),s=r.resolveStack(i.from,1);if(i.empty){let o=r.resolveStack(i.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:l}=o;if((l.from<i.from&&l.to>=i.to||l.to>i.to&&l.from<=i.from)&&o.next)return T.range(l.to,l.from)}return i});return t.eq(n.selection)?!1:(e(Ft(n,t)),!0)},vS=({state:n,dispatch:e})=>{let t=n.selection,i=null;return t.ranges.length>1?i=T.create([t.main]):t.main.empty||(i=T.create([T.cursor(t.main.head)])),i?(e(Ft(n,i)),!0):!1};function Lr(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:i}=n,r=i.changeByRange(s=>{let{from:o,to:l}=s;if(o==l){let a=e(s);a<o?(t="delete.backward",a=ts(n,a,!1)):a>o&&(t="delete.forward",a=ts(n,a,!0)),o=Math.min(o,a),l=Math.max(l,a)}else o=ts(n,o,!1),l=ts(n,l,!0);return o==l?{range:s}:{changes:{from:o,to:l},range:T.cursor(o,o<s.head?-1:1)}});return r.changes.empty?!1:(n.dispatch(i.update(r,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?B.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function ts(n,e,t){if(n instanceof B)for(let i of n.state.facet(B.atomicRanges).map(r=>r(n)))i.between(e,e,(r,s)=>{r<e&&s>e&&(e=t?s:r)});return e}const Wp=(n,e,t)=>Lr(n,i=>{let r=i.from,{state:s}=n,o=s.doc.lineAt(r),l,a;if(t&&!e&&r>o.from&&r<o.from+200&&!/[^ \t]/.test(l=o.text.slice(0,r-o.from))){if(l[l.length-1]=="	")return r-1;let c=Ri(l,s.tabSize),h=c%Hn(s)||Hn(s);for(let u=0;u<h&&l[l.length-1-u]==" ";u++)r--;a=r}else a=Fe(o.text,r-o.from,e,e)+o.from,a==r&&o.number!=(e?s.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(a-o.from,r-o.from))&&(a=Fe(o.text,a-o.from,!1,!1)+o.from);return a}),Jl=n=>Wp(n,!1,!0),Vp=n=>Wp(n,!0,!1),$p=(n,e)=>Lr(n,t=>{let i=t.head,{state:r}=n,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let l=null;;){if(i==(e?s.to:s.from)){i==t.head&&s.number!=(e?r.doc.lines:1)&&(i+=e?1:-1);break}let a=Fe(s.text,i-s.from,e)+s.from,c=s.text.slice(Math.min(i,a)-s.from,Math.max(i,a)-s.from),h=o(c);if(l!=null&&h!=l)break;(c!=" "||i!=t.head)&&(l=h),i=a}return i}),_p=n=>$p(n,!1),wS=n=>$p(n,!0),SS=n=>Lr(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),kS=n=>Lr(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),CS=n=>Lr(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),AS=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:he.of(["",""])},range:T.cursor(i.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},MS=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>{if(!i.empty||i.from==0||i.from==n.doc.length)return{range:i};let r=i.from,s=n.doc.lineAt(r),o=r==s.from?r-1:Fe(s.text,r-s.from,!1)+s.from,l=r==s.to?r+1:Fe(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:n.doc.slice(r,l).append(n.doc.slice(o,r))},range:T.cursor(l)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function co(n){let e=[],t=-1;for(let i of n.selection.ranges){let r=n.doc.lineAt(i.from),s=n.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=n.doc.lineAt(i.to-1)),t>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(i)}else e.push({from:r.from,to:s.to,ranges:[i]});t=s.number+1}return e}function qp(n,e,t){if(n.readOnly)return!1;let i=[],r=[];for(let s of co(n)){if(t?s.to==n.doc.length:s.from==0)continue;let o=n.doc.lineAt(t?s.to+1:s.from-1),l=o.length+1;if(t){i.push({from:s.to,to:o.to},{from:s.from,insert:o.text+n.lineBreak});for(let a of s.ranges)r.push(T.range(Math.min(n.doc.length,a.anchor+l),Math.min(n.doc.length,a.head+l)))}else{i.push({from:o.from,to:s.from},{from:s.to,insert:n.lineBreak+o.text});for(let a of s.ranges)r.push(T.range(a.anchor-l,a.head-l))}}return i.length?(e(n.update({changes:i,scrollIntoView:!0,selection:T.create(r,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const ES=({state:n,dispatch:e})=>qp(n,e,!1),TS=({state:n,dispatch:e})=>qp(n,e,!0);function Up(n,e,t){if(n.readOnly)return!1;let i=[];for(let r of co(n))t?i.push({from:r.from,insert:n.doc.slice(r.from,r.to)+n.lineBreak}):i.push({from:r.to,insert:n.lineBreak+n.doc.slice(r.from,r.to)});return e(n.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const DS=({state:n,dispatch:e})=>Up(n,e,!1),RS=({state:n,dispatch:e})=>Up(n,e,!0),NS=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(co(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),i=Oi(e.selection,r=>{let s;if(n.lineWrapping){let o=n.lineBlockAt(r.head),l=n.coordsAtPos(r.head,r.assoc||1);l&&(s=o.bottom+n.documentTop-l.bottom+n.defaultLineHeight/2)}return n.moveVertically(r,!0,s)}).map(t);return n.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function OS(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=We(n).resolveInner(e),i=t.childBefore(e),r=t.childAfter(e),s;return i&&r&&i.to<=e&&r.from>=e&&(s=i.type.prop(oe.closedBy))&&s.indexOf(r.name)>-1&&n.doc.lineAt(i.to).from==n.doc.lineAt(r.from).from&&!/\S/.test(n.sliceDoc(i.to,r.from))?{from:i.to,to:r.from}:null}const qh=Kp(!1),LS=Kp(!0);function Kp(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(r=>{let{from:s,to:o}=r,l=e.doc.lineAt(s),a=!n&&s==o&&OS(e,s);n&&(s=o=(o<=l.to?l:e.doc.lineAt(o)).to);let c=new ro(e,{simulateBreak:s,simulateDoubleBreak:!!a}),h=Ia(c,s);for(h==null&&(h=Ri(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:s,to:o}=a:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let u=["",gr(e,h)];return a&&u.push(gr(e,c.lineIndent(l.from,-1))),{changes:{from:s,to:o,insert:he.of(u)},range:T.cursor(s+1+u[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function $a(n,e){let t=-1;return n.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let l=n.doc.lineAt(o);l.number>t&&(i.empty||i.to>l.from)&&(e(l,r,i),t=l.number),o=l.to+1}let s=n.changes(r);return{changes:r,range:T.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const PS=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),i=new ro(n,{overrideIndentation:s=>{let o=t[s];return o??-1}}),r=$a(n,(s,o,l)=>{let a=Ia(i,s.from);if(a==null)return;/\S/.test(s.text)||(a=0);let c=/^\s*/.exec(s.text)[0],h=gr(n,a);(c!=h||l.from<s.from+c.length)&&(t[s.from]=a,o.push({from:s.from,to:s.from+c.length,insert:h}))});return r.changes.empty||e(n.update(r,{userEvent:"indent"})),!0},Gp=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update($a(n,(t,i)=>{i.push({from:t.from,insert:n.facet(io)})}),{userEvent:"input.indent"})),!0),Jp=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update($a(n,(t,i)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let s=Ri(r,n.tabSize),o=0,l=gr(n,Math.max(0,s-Hn(n)));for(;o<r.length&&o<l.length&&r.charCodeAt(o)==l.charCodeAt(o);)o++;i.push({from:t.from+o,to:t.from+r.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),IS=n=>(n.setTabFocusMode(),!0),BS=[{key:"Ctrl-b",run:Ap,shift:Pp,preventDefault:!0},{key:"Ctrl-f",run:Mp,shift:Ip},{key:"Ctrl-p",run:Dp,shift:jp},{key:"Ctrl-n",run:Rp,shift:Hp},{key:"Ctrl-a",run:iS,shift:mS},{key:"Ctrl-e",run:rS,shift:gS},{key:"Ctrl-d",run:Vp},{key:"Ctrl-h",run:Jl},{key:"Ctrl-k",run:SS},{key:"Ctrl-Alt-h",run:_p},{key:"Ctrl-o",run:AS},{key:"Ctrl-t",run:MS},{key:"Ctrl-v",run:Gl}],zS=[{key:"ArrowLeft",run:Ap,shift:Pp,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:G1,shift:lS,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:tS,shift:dS,preventDefault:!0},{key:"ArrowRight",run:Mp,shift:Ip,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:J1,shift:aS,preventDefault:!0},{mac:"Cmd-ArrowRight",run:nS,shift:pS,preventDefault:!0},{key:"ArrowUp",run:Dp,shift:jp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Wh,shift:$h},{mac:"Ctrl-ArrowUp",run:jh,shift:Hh},{key:"ArrowDown",run:Rp,shift:Hp,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Vh,shift:_h},{mac:"Ctrl-ArrowDown",run:Gl,shift:Fh},{key:"PageUp",run:jh,shift:Hh},{key:"PageDown",run:Gl,shift:Fh},{key:"Home",run:eS,shift:fS,preventDefault:!0},{key:"Mod-Home",run:Wh,shift:$h},{key:"End",run:Z1,shift:uS,preventDefault:!0},{key:"Mod-End",run:Vh,shift:_h},{key:"Enter",run:qh,shift:qh},{key:"Mod-a",run:bS},{key:"Backspace",run:Jl,shift:Jl},{key:"Delete",run:Vp},{key:"Mod-Backspace",mac:"Alt-Backspace",run:_p},{key:"Mod-Delete",mac:"Alt-Delete",run:wS},{mac:"Mod-Backspace",run:kS},{mac:"Mod-Delete",run:CS}].concat(BS.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),jS=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:X1,shift:cS},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Q1,shift:hS},{key:"Alt-ArrowUp",run:ES},{key:"Shift-Alt-ArrowUp",run:DS},{key:"Alt-ArrowDown",run:TS},{key:"Shift-Alt-ArrowDown",run:RS},{key:"Escape",run:vS},{key:"Mod-Enter",run:LS},{key:"Alt-l",mac:"Ctrl-l",run:xS},{key:"Mod-i",run:yS,preventDefault:!0},{key:"Mod-[",run:Jp},{key:"Mod-]",run:Gp},{key:"Mod-Alt-\\",run:PS},{key:"Shift-Mod-k",run:NS},{key:"Shift-Mod-\\",run:oS},{key:"Mod-/",run:D1},{key:"Alt-A",run:N1},{key:"Ctrl-m",mac:"Shift-Alt-m",run:IS}].concat(zS),HS={key:"Tab",run:Gp,shift:Jp};function be(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=t[i];typeof r=="string"?n.setAttribute(i,r):r!=null&&(n[i]=r)}e++}for(;e<arguments.length;e++)Yp(n,arguments[e]);return n}function Yp(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)Yp(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}const Uh=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class ki{constructor(e,t,i=0,r=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,r),this.bufferStart=i,this.normalize=s?l=>s(Uh(l)):Uh,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Be(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=ga(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=dt(e);let r=this.normalize(t);for(let s=0,o=i;;s++){let l=r.charCodeAt(s),a=this.match(l,o,this.bufferPos+this.bufferStart);if(s==r.length-1){if(a)return this.value=a,this;break}o==i&&s<t.length&&t.charCodeAt(s)==l&&o++}}}match(e,t,i){let r=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],l=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?r={from:this.matches[s+1],to:i}:(this.matches[s]++,l=!0)),l||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:t,to:i}:this.matches.push(1,t)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(ki.prototype[Symbol.iterator]=function(){return this});const Xp={from:-1,to:-1,match:/.*/.exec("")},_a="gm"+(/x/.unicode==null?"":"u");class Qp{constructor(e,t,i,r=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=Xp,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new Zp(e,t,i,r,s);this.re=new RegExp(t,_a+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=Bs(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,r=i+t[0].length;if(this.matchPos=Bs(this.text,r+(i==r?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<r||i>this.value.to)&&(!this.test||this.test(i,r,t)))return this.value={from:i,to:r,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Vo=new WeakMap;class hi{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let r=Vo.get(e);if(!r||r.from>=i||r.to<=t){let l=new hi(t,e.sliceString(t,i));return Vo.set(e,l),l}if(r.from==t&&r.to==i)return r;let{text:s,from:o}=r;return o>t&&(s=e.sliceString(t,o)+s,o=t),r.to<i&&(s+=e.sliceString(r.to,i)),Vo.set(e,new hi(o,s)),new hi(t,s.slice(t-o,i-o))}}class Zp{constructor(e,t,i,r,s){this.text=e,this.to=s,this.done=!1,this.value=Xp,this.matchPos=Bs(e,r),this.re=new RegExp(t,_a+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=hi.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let i=this.flat.from+t.index,r=i+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,r,t)))return this.value={from:i,to:r,match:t},this.matchPos=Bs(this.text,r+(i==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=hi.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(Qp.prototype[Symbol.iterator]=Zp.prototype[Symbol.iterator]=function(){return this});function FS(n){try{return new RegExp(n,_a),!0}catch{return!1}}function Bs(n,e){if(e>=n.length)return e;let t=n.lineAt(e),i;for(;e<t.to&&(i=t.text.charCodeAt(e-t.from))>=56320&&i<57344;)e++;return e}function Yl(n){let e=String(n.state.doc.lineAt(n.state.selection.main.head).number),t=be("input",{class:"cm-textfield",name:"line",value:e}),i=be("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),n.dispatch({effects:zs.of(!1)}),n.focus()):s.keyCode==13&&(s.preventDefault(),r())},onsubmit:s=>{s.preventDefault(),r()}},be("label",n.state.phrase("Go to line"),": ",t)," ",be("button",{class:"cm-button",type:"submit"},n.state.phrase("go")));function r(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!s)return;let{state:o}=n,l=o.doc.lineAt(o.selection.main.head),[,a,c,h,u]=s,f=h?+h.slice(1):0,d=c?+c:l.number;if(c&&u){let m=d/100;a&&(m=m*(a=="-"?-1:1)+l.number/o.doc.lines),d=Math.round(o.doc.lines*m)}else c&&a&&(d=d*(a=="-"?-1:1)+l.number);let p=o.doc.line(Math.max(1,Math.min(o.doc.lines,d))),b=T.cursor(p.from+Math.max(0,Math.min(f,p.length)));n.dispatch({effects:[zs.of(!1),B.scrollIntoView(b.from,{y:"center"})],selection:b}),n.focus()}return{dom:i}}const zs=ne.define(),Kh=Ve.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(zs)&&(n=t.value);return n},provide:n=>pr.from(n,e=>e?Yl:null)}),WS=n=>{let e=dr(n,Yl);if(!e){let t=[zs.of(!0)];n.state.field(Kh,!1)==null&&t.push(ne.appendConfig.of([Kh,VS])),n.dispatch({effects:t}),e=dr(n,Yl)}return e&&e.dom.querySelector("input").select(),!0},VS=B.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),$S={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},_S=z.define({combine(n){return Ht(n,$S,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function qS(n){return[YS,JS]}const US=U.mark({class:"cm-selectionMatch"}),KS=U.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function Gh(n,e,t,i){return(t==0||n(e.sliceDoc(t-1,t))!=Se.Word)&&(i==e.doc.length||n(e.sliceDoc(i,i+1))!=Se.Word)}function GS(n,e,t,i){return n(e.sliceDoc(t,t+1))==Se.Word&&n(e.sliceDoc(i-1,i))==Se.Word}const JS=De.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(_S),{state:t}=n,i=t.selection;if(i.ranges.length>1)return U.none;let r=i.main,s,o=null;if(r.empty){if(!e.highlightWordAroundCursor)return U.none;let a=t.wordAt(r.head);if(!a)return U.none;o=t.charCategorizer(r.head),s=t.sliceDoc(a.from,a.to)}else{let a=r.to-r.from;if(a<e.minSelectionLength||a>200)return U.none;if(e.wholeWords){if(s=t.sliceDoc(r.from,r.to),o=t.charCategorizer(r.head),!(Gh(o,t,r.from,r.to)&&GS(o,t,r.from,r.to)))return U.none}else if(s=t.sliceDoc(r.from,r.to),!s)return U.none}let l=[];for(let a of n.visibleRanges){let c=new ki(t.doc,s,a.from,a.to);for(;!c.next().done;){let{from:h,to:u}=c.value;if((!o||Gh(o,t,h,u))&&(r.empty&&h<=r.from&&u>=r.to?l.push(KS.range(h,u)):(h>=r.to||u<=r.from)&&l.push(US.range(h,u)),l.length>e.maxMatches))return U.none}}return U.set(l)}},{decorations:n=>n.decorations}),YS=B.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),XS=({state:n,dispatch:e})=>{let{selection:t}=n,i=T.create(t.ranges.map(r=>n.wordAt(r.head)||T.cursor(r.head)),t.mainIndex);return i.eq(t)?!1:(e(n.update({selection:i})),!0)};function QS(n,e){let{main:t,ranges:i}=n.selection,r=n.wordAt(t.head),s=r&&r.from==t.from&&r.to==t.to;for(let o=!1,l=new ki(n.doc,e,i[i.length-1].to);;)if(l.next(),l.done){if(o)return null;l=new ki(n.doc,e,0,Math.max(0,i[i.length-1].from-1)),o=!0}else{if(o&&i.some(a=>a.from==l.value.from))continue;if(s){let a=n.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const ZS=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(s=>s.from===s.to))return XS({state:n,dispatch:e});let i=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(s=>n.sliceDoc(s.from,s.to)!=i))return!1;let r=QS(n,i);return r?(e(n.update({selection:n.selection.addRange(T.range(r.from,r.to),!1),effects:B.scrollIntoView(r.to)})),!0):!1},Li=z.define({combine(n){return Ht(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new uk(e),scrollToMatch:e=>B.scrollIntoView(e)})}});class em{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||FS(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new ik(this):new tk(this)}getCursor(e,t=0,i){let r=e.doc?e:ae.create({doc:e});return i==null&&(i=r.doc.length),this.regexp?Xn(this,r,t,i):Yn(this,r,t,i)}}class tm{constructor(e){this.spec=e}}function Yn(n,e,t,i){return new ki(e.doc,n.unquoted,t,i,n.caseSensitive?void 0:r=>r.toLowerCase(),n.wholeWord?ek(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function ek(n,e){return(t,i,r,s)=>((s>t||s+r.length<i)&&(s=Math.max(0,t-2),r=n.sliceString(s,Math.min(n.length,i+2))),(e(js(r,t-s))!=Se.Word||e(Hs(r,t-s))!=Se.Word)&&(e(Hs(r,i-s))!=Se.Word||e(js(r,i-s))!=Se.Word))}class tk extends tm{constructor(e){super(e)}nextMatch(e,t,i){let r=Yn(this.spec,e,i,e.doc.length).nextOverlapping();return r.done&&(r=Yn(this.spec,e,0,t).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,t,i){for(let r=i;;){let s=Math.max(t,r-1e4-this.spec.unquoted.length),o=Yn(this.spec,e,s,r),l=null;for(;!o.nextOverlapping().done;)l=o.value;if(l)return l;if(s==t)return null;r-=1e4}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let i=Yn(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=t)return null;r.push(i.value)}return r}highlight(e,t,i,r){let s=Yn(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}function Xn(n,e,t,i){return new Qp(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?nk(e.charCategorizer(e.selection.main.head)):void 0},t,i)}function js(n,e){return n.slice(Fe(n,e,!1),e)}function Hs(n,e){return n.slice(e,Fe(n,e))}function nk(n){return(e,t,i)=>!i[0].length||(n(js(i.input,i.index))!=Se.Word||n(Hs(i.input,i.index))!=Se.Word)&&(n(Hs(i.input,i.index+i[0].length))!=Se.Word||n(js(i.input,i.index+i[0].length))!=Se.Word)}class ik extends tm{nextMatch(e,t,i){let r=Xn(this.spec,e,i,e.doc.length).next();return r.done&&(r=Xn(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,i){for(let r=1;;r++){let s=Math.max(t,i-r*1e4),o=Xn(this.spec,e,s,i),l=null;for(;!o.next().done;)l=o.value;if(l&&(s==t||l.from>s+10))return l;if(s==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(t,i)=>i=="$"?"$":i=="&"?e.match[0]:i!="0"&&+i<e.match.length?e.match[i]:t)}matchAll(e,t){let i=Xn(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=t)return null;r.push(i.value)}return r}highlight(e,t,i,r){let s=Xn(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}const xr=ne.define(),qa=ne.define(),hn=Ve.define({create(n){return new $o(Xl(n).create(),null)},update(n,e){for(let t of e.effects)t.is(xr)?n=new $o(t.value.create(),n.panel):t.is(qa)&&(n=new $o(n.query,t.value?Ua:null));return n},provide:n=>pr.from(n,e=>e.panel)});class $o{constructor(e,t){this.query=e,this.panel=t}}const rk=U.mark({class:"cm-searchMatch"}),sk=U.mark({class:"cm-searchMatch cm-searchMatch-selected"}),ok=De.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(hn))}update(n){let e=n.state.field(hn);(e!=n.startState.field(hn)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return U.none;let{view:t}=this,i=new dn;for(let r=0,s=t.visibleRanges,o=s.length;r<o;r++){let{from:l,to:a}=s[r];for(;r<o-1&&a>s[r+1].from-2*250;)a=s[++r].to;n.highlight(t.state,l,a,(c,h)=>{let u=t.state.selection.ranges.some(f=>f.from==c&&f.to==h);i.add(c,h,u?sk:rk)})}return i.finish()}},{decorations:n=>n.decorations});function Pr(n){return e=>{let t=e.state.field(hn,!1);return t&&t.query.spec.valid?n(e,t):rm(e)}}const Fs=Pr((n,{query:e})=>{let{to:t}=n.state.selection.main,i=e.nextMatch(n.state,t,t);if(!i)return!1;let r=T.single(i.from,i.to),s=n.state.facet(Li);return n.dispatch({selection:r,effects:[Ka(n,i),s.scrollToMatch(r.main,n)],userEvent:"select.search"}),im(n),!0}),Ws=Pr((n,{query:e})=>{let{state:t}=n,{from:i}=t.selection.main,r=e.prevMatch(t,i,i);if(!r)return!1;let s=T.single(r.from,r.to),o=n.state.facet(Li);return n.dispatch({selection:s,effects:[Ka(n,r),o.scrollToMatch(s.main,n)],userEvent:"select.search"}),im(n),!0}),lk=Pr((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:T.create(t.map(i=>T.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),ak=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:r}=t.main,s=[],o=0;for(let l=new ki(n.doc,n.sliceDoc(i,r));!l.next().done;){if(s.length>1e3)return!1;l.value.from==i&&(o=s.length),s.push(T.range(l.value.from,l.value.to))}return e(n.update({selection:T.create(s,o),userEvent:"select.search.matches"})),!0},Jh=Pr((n,{query:e})=>{let{state:t}=n,{from:i,to:r}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,i,i);if(!s)return!1;let o=[],l,a,c=[];if(s.from==i&&s.to==r&&(a=t.toText(e.getReplacement(s)),o.push({from:s.from,to:s.to,insert:a}),s=e.nextMatch(t,s.from,s.to),c.push(B.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(i).number)+"."))),s){let h=o.length==0||o[0].from>=s.to?0:s.to-s.from-a.length;l=T.single(s.from-h,s.to-h),c.push(Ka(n,s)),c.push(t.facet(Li).scrollToMatch(l.main,n))}return n.dispatch({changes:o,selection:l,effects:c,userEvent:"input.replace"}),!0}),ck=Pr((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(r=>{let{from:s,to:o}=r;return{from:s,to:o,insert:e.getReplacement(r)}});if(!t.length)return!1;let i=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:B.announce.of(i),userEvent:"input.replace.all"}),!0});function Ua(n){return n.state.facet(Li).createPanel(n)}function Xl(n,e){var t,i,r,s,o;let l=n.selection.main,a=l.empty||l.to>l.from+100?"":n.sliceDoc(l.from,l.to);if(e&&!a)return e;let c=n.facet(Li);return new em({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:c.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:c.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:c.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:c.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function nm(n){let e=dr(n,Ua);return e&&e.dom.querySelector("[main-field]")}function im(n){let e=nm(n);e&&e==n.root.activeElement&&e.select()}const rm=n=>{let e=n.state.field(hn,!1);if(e&&e.panel){let t=nm(n);if(t&&t!=n.root.activeElement){let i=Xl(n.state,e.query.spec);i.valid&&n.dispatch({effects:xr.of(i)}),t.focus(),t.select()}}else n.dispatch({effects:[qa.of(!0),e?xr.of(Xl(n.state,e.query.spec)):ne.appendConfig.of(dk)]});return!0},sm=n=>{let e=n.state.field(hn,!1);if(!e||!e.panel)return!1;let t=dr(n,Ua);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:qa.of(!1)}),!0},hk=[{key:"Mod-f",run:rm,scope:"editor search-panel"},{key:"F3",run:Fs,shift:Ws,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Fs,shift:Ws,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:sm,scope:"editor search-panel"},{key:"Mod-Shift-l",run:ak},{key:"Mod-Alt-g",run:WS},{key:"Mod-d",run:ZS,preventDefault:!0}];class uk{constructor(e){this.view=e;let t=this.query=e.state.field(hn).query.spec;this.commit=this.commit.bind(this),this.searchField=be("input",{value:t.search,placeholder:st(e,"Find"),"aria-label":st(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=be("input",{value:t.replace,placeholder:st(e,"Replace"),"aria-label":st(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=be("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=be("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=be("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function i(r,s,o){return be("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=be("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,i("next",()=>Fs(e),[st(e,"next")]),i("prev",()=>Ws(e),[st(e,"previous")]),i("select",()=>lk(e),[st(e,"all")]),be("label",null,[this.caseField,st(e,"match case")]),be("label",null,[this.reField,st(e,"regexp")]),be("label",null,[this.wordField,st(e,"by word")]),...e.state.readOnly?[]:[be("br"),this.replaceField,i("replace",()=>Jh(e),[st(e,"replace")]),i("replaceAll",()=>ck(e),[st(e,"replace all")])],be("button",{name:"close",onclick:()=>sm(e),"aria-label":st(e,"close"),type:"button"},["×"])])}commit(){let e=new em({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:xr.of(e)}))}keydown(e){pv(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Ws:Fs)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),Jh(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(xr)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Li).top}}function st(n,e){return n.state.phrase(e)}const ns=30,is=/[\s\.,:;?!]/;function Ka(n,{from:e,to:t}){let i=n.state.doc.lineAt(e),r=n.state.doc.lineAt(t).to,s=Math.max(i.from,e-ns),o=Math.min(r,t+ns),l=n.state.sliceDoc(s,o);if(s!=i.from){for(let a=0;a<ns;a++)if(!is.test(l[a+1])&&is.test(l[a])){l=l.slice(a);break}}if(o!=r){for(let a=l.length-1;a>l.length-ns;a--)if(!is.test(l[a-1])&&is.test(l[a])){l=l.slice(0,a);break}}return B.announce.of(`${n.state.phrase("current match")}. ${l} ${n.state.phrase("on line")} ${i.number}.`)}const fk=B.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),dk=[hn,_n.low(ok),fk];class om{constructor(e,t,i,r){this.state=e,this.pos=t,this.explicit=i,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=We(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),r=t.text.slice(i-t.from,this.pos-t.from),s=r.search(lm(e,!1));return s<0?null:{from:i+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function Yh(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function pk(n){let e=Object.create(null),t=Object.create(null);for(let{label:r}of n){e[r[0]]=!0;for(let s=1;s<r.length;s++)t[r[s]]=!0}let i=Yh(e)+Yh(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function mk(n){let e=n.map(r=>typeof r=="string"?{label:r}:r),[t,i]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:pk(e);return r=>{let s=r.matchBefore(i);return s||r.explicit?{from:s?s.from:r.pos,options:e,validFor:t}:null}}class Xh{constructor(e,t,i,r){this.completion=e,this.source=t,this.match=i,this.score=r}}function un(n){return n.selection.main.from}function lm(n,e){var t;let{source:i}=n,r=e&&i[0]!="^",s=i[i.length-1]!="$";return!r&&!s?n:new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const am=jt.define();function gk(n,e,t,i){let{main:r}=n.selection,s=t-r.from,o=i-r.from;return Object.assign(Object.assign({},n.changeByRange(l=>{if(l!=r&&t!=i&&n.sliceDoc(l.from+s,l.from+o)!=n.sliceDoc(t,i))return{range:l};let a=n.toText(e);return{changes:{from:l.from+s,to:i==r.from?l.to:l.from+o,insert:a},range:T.cursor(l.from+s+a.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const Qh=new WeakMap;function bk(n){if(!Array.isArray(n))return n;let e=Qh.get(n);return e||Qh.set(n,e=mk(n)),e}const Vs=ne.define(),yr=ne.define();class xk{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let i=Be(e,t),r=dt(i);this.chars.push(i);let s=e.slice(t,t+r),o=s.toUpperCase();this.folded.push(Be(o==s?s.toLowerCase():o,0)),t+=r}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:r,precise:s,byWord:o}=this;if(t.length==1){let y=Be(e,0),C=dt(y),M=C==e.length?0:-100;if(y!=t[0])if(y==i[0])M+=-200;else return null;return this.ret(M,[0,C])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,c=0;if(l<0){for(let y=0,C=Math.min(e.length,200);y<C&&c<a;){let M=Be(e,y);(M==t[c]||M==i[c])&&(r[c++]=y),y+=dt(M)}if(c<a)return null}let h=0,u=0,f=!1,d=0,p=-1,b=-1,m=/[a-z]/.test(e),x=!0;for(let y=0,C=Math.min(e.length,200),M=0;y<C&&u<a;){let w=Be(e,y);l<0&&(h<a&&w==t[h]&&(s[h++]=y),d<a&&(w==t[d]||w==i[d]?(d==0&&(p=y),b=y+1,d++):d=0));let A,k=w<255?w>=48&&w<=57||w>=97&&w<=122?2:w>=65&&w<=90?1:0:(A=ga(w))!=A.toLowerCase()?1:A!=A.toUpperCase()?2:0;(!y||k==1&&m||M==0&&k!=0)&&(t[u]==w||i[u]==w&&(f=!0)?o[u++]=y:o.length&&(x=!1)),M=k,y+=dt(w)}return u==a&&o[0]==0&&x?this.result(-100+(f?-200:0),o,e):d==a&&p==0?this.ret(-200-e.length+(b==e.length?0:-100),[0,b]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):d==a?this.ret(-900-e.length,[p,b]):u==a?this.result(-100+(f?-200:0)+-700+(x?0:-1100),o,e):t.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,i){let r=[],s=0;for(let o of t){let l=o+(this.astral?dt(Be(i,o)):1);s&&r[s-1]==o?r[s-1]=l:(r[s++]=o,r[s++]=l)}return this.ret(e-i.length,r)}}class yk{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),i=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,t.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const He=z.define({combine(n){return Ht(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:vk,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>i=>Zh(e(i),t(i)),optionClass:(e,t)=>i=>Zh(e(i),t(i)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function Zh(n,e){return n?e?n+" "+e:n:e}function vk(n,e,t,i,r,s){let o=n.textDirection==ve.RTL,l=o,a=!1,c="top",h,u,f=e.left-r.left,d=r.right-e.right,p=i.right-i.left,b=i.bottom-i.top;if(l&&f<Math.min(p,d)?l=!1:!l&&d<Math.min(p,f)&&(l=!0),p<=(l?f:d))h=Math.max(r.top,Math.min(t.top,r.bottom-b))-e.top,u=Math.min(400,l?f:d);else{a=!0,u=Math.min(400,(o?e.right:r.right-e.left)-30);let y=r.bottom-e.bottom;y>=b||y>e.top?h=t.bottom-e.top:(c="bottom",h=e.bottom-t.top)}let m=(e.bottom-e.top)/s.offsetHeight,x=(e.right-e.left)/s.offsetWidth;return{style:`${c}: ${h/m}px; max-width: ${u/x}px`,class:"cm-completionInfo-"+(a?o?"left-narrow":"right-narrow":l?"left":"right")}}function wk(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,r,s){let o=document.createElement("span");o.className="cm-completionLabel";let l=t.displayLabel||t.label,a=0;for(let c=0;c<s.length;){let h=s[c++],u=s[c++];h>a&&o.appendChild(document.createTextNode(l.slice(a,h)));let f=o.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(l.slice(h,u))),f.className="cm-completionMatchedText",a=u}return a<l.length&&o.appendChild(document.createTextNode(l.slice(a))),o},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function _o(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let r=Math.floor(e/t);return{from:r*t,to:(r+1)*t}}let i=Math.floor((n-e)/t);return{from:n-(i+1)*t,to:n-i*t}}class Sk{constructor(e,t,i){this.view=e,this.stateField=t,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let r=e.state.field(t),{options:s,selected:o}=r.open,l=e.state.facet(He);this.optionContent=wk(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=_o(s.length,o,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=e.state.field(t).open;for(let h=a.target,u;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(u=/-(\d+)$/.exec(h.id))&&+u[1]<c.length){this.applyCompletion(e,c[+u[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(He).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:yr.of(null)})}),this.showOptions(s,r.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let i=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=r){let{options:s,selected:o,disabled:l}=i.open;(!r.open||r.open.options!=s)&&(this.range=_o(s.length,o,e.state.facet(He).maxRenderedOptions),this.showOptions(s,i.id)),this.updateSel(),l!=((t=r.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of t.split(" "))i&&this.dom.classList.add(i);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=_o(t.options.length,t.selected,this.view.state.facet(He).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:i}=t.options[t.selected],{info:r}=i;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(i);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,i)}).catch(o=>nt(this.view.state,o,"completion info")):this.addInfoPane(s,i)}}addInfoPane(e,t){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:s}=e;i.appendChild(r),this.infoDestroy=s||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,r=this.range.from;i;i=i.nextSibling,r++)i.nodeName!="LI"||!i.id?r--:r==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return t&&Ck(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.defaultView||window;s={left:0,top:0,right:o.innerWidth,bottom:o.innerHeight}}return r.top>Math.min(s.bottom,t.bottom)-10||r.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(He).positionInfo(this.view,t,r,i,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,i){const r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));let s=null;for(let o=i.from;o<i.to;o++){let{completion:l,match:a}=e[o],{section:c}=l;if(c){let f=typeof c=="string"?c:c.name;if(f!=s&&(o>i.from||i.from==0))if(s=f,typeof c!="string"&&c.header)r.appendChild(c.header(c));else{let d=r.appendChild(document.createElement("completion-section"));d.textContent=f}}const h=r.appendChild(document.createElement("li"));h.id=t+"-"+o,h.setAttribute("role","option");let u=this.optionClass(l);u&&(h.className=u);for(let f of this.optionContent){let d=f(l,this.view.state,this.view,a);d&&h.appendChild(d)}}return i.from&&r.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function kk(n,e){return t=>new Sk(t,n,e)}function Ck(n,e){let t=n.getBoundingClientRect(),i=e.getBoundingClientRect(),r=t.height/n.offsetHeight;i.top<t.top?n.scrollTop-=(t.top-i.top)/r:i.bottom>t.bottom&&(n.scrollTop+=(i.bottom-t.bottom)/r)}function eu(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function Ak(n,e){let t=[],i=null,r=c=>{t.push(c);let{section:h}=c.completion;if(h){i||(i=[]);let u=typeof h=="string"?h:h.name;i.some(f=>f.name==u)||i.push(typeof h=="string"?{name:u}:h)}},s=e.facet(He);for(let c of n)if(c.hasResult()){let h=c.result.getMatch;if(c.result.filter===!1)for(let u of c.result.options)r(new Xh(u,c.source,h?h(u):[],1e9-t.length));else{let u=e.sliceDoc(c.from,c.to),f,d=s.filterStrict?new yk(u):new xk(u);for(let p of c.result.options)if(f=d.match(p.label)){let b=p.displayLabel?h?h(p,f.matched):[]:f.matched;r(new Xh(p,c.source,b,f.score+(p.boost||0)))}}}if(i){let c=Object.create(null),h=0,u=(f,d)=>{var p,b;return((p=f.rank)!==null&&p!==void 0?p:1e9)-((b=d.rank)!==null&&b!==void 0?b:1e9)||(f.name<d.name?-1:1)};for(let f of i.sort(u))h-=1e5,c[f.name]=h;for(let f of t){let{section:d}=f.completion;d&&(f.score+=c[typeof d=="string"?d:d.name])}}let o=[],l=null,a=s.compareCompletions;for(let c of t.sort((h,u)=>u.score-h.score||a(h.completion,u.completion))){let h=c.completion;!l||l.label!=h.label||l.detail!=h.detail||l.type!=null&&h.type!=null&&l.type!=h.type||l.apply!=h.apply||l.boost!=h.boost?o.push(c):eu(c.completion)>eu(l)&&(o[o.length-1]=c),l=c.completion}return o}class ii{constructor(e,t,i,r,s,o){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=r,this.selected=s,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new ii(this.options,tu(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,i,r,s){let o=Ak(e,t);if(!o.length)return r&&e.some(a=>a.state==1)?new ii(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let l=t.facet(He).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let a=r.options[r.selected].completion;for(let c=0;c<o.length;c++)if(o[c].completion==a){l=c;break}}return new ii(o,tu(i,l),{pos:e.reduce((a,c)=>c.hasResult()?Math.min(a,c.from):a,1e8),create:Nk,above:s.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new ii(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class $s{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new $s(Dk,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(He),s=(i.override||t.languageDataAt("autocomplete",un(t)).map(bk)).map(l=>(this.active.find(c=>c.source==l)||new at(l,this.active.some(c=>c.state!=0)?1:0)).update(e,i));s.length==this.active.length&&s.every((l,a)=>l==this.active[a])&&(s=this.active);let o=this.open;o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!Mk(s,this.active)?o=ii.build(s,t,this.id,o,i):o&&o.disabled&&!s.some(l=>l.state==1)&&(o=null),!o&&s.every(l=>l.state!=1)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new at(l.source,0):l));for(let l of e.effects)l.is(um)&&(o=o&&o.setSelected(l.value,this.id));return s==this.active&&o==this.open?this:new $s(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?Ek:Tk}}function Mk(n,e){if(n==e)return!0;for(let t=0,i=0;;){for(;t<n.length&&!n[t].hasResult;)t++;for(;i<e.length&&!e[i].hasResult;)i++;let r=t==n.length,s=i==e.length;if(r||s)return r==s;if(n[t++].result!=e[i++].result)return!1}}const Ek={"aria-autocomplete":"list"},Tk={};function tu(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const Dk=[];function cm(n,e){if(n.isUserEvent("input.complete")){let i=n.annotation(am);if(i&&e.activateOnCompletion(i))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class at{constructor(e,t,i=-1){this.source=e,this.state=t,this.explicitPos=i}hasResult(){return!1}update(e,t){let i=cm(e,t),r=this;(i&8||i&16&&this.touches(e))&&(r=new at(r.source,0)),i&4&&r.state==0&&(r=new at(this.source,1)),r=r.updateFor(e,i);for(let s of e.effects)if(s.is(Vs))r=new at(r.source,1,s.value?un(e.state):-1);else if(s.is(yr))r=new at(r.source,0);else if(s.is(hm))for(let o of s.value)o.source==r.source&&(r=o);return r}updateFor(e,t){return this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new at(this.source,this.state,e.mapPos(this.explicitPos))}touches(e){return e.changes.touchesRange(un(e.state))}}class ui extends at{constructor(e,t,i,r,s){super(e,2,t),this.result=i,this.from=r,this.to=s}hasResult(){return!0}updateFor(e,t){var i;if(!(t&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),l=un(e.state);if((this.explicitPos<0?l<=s:l<this.from)||l>o||!r||t&2&&un(e.startState)==this.from)return new at(this.source,t&4?1:0);let a=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return Rk(r.validFor,e.state,s,o)?new ui(this.source,a,r,s,o):r.update&&(r=r.update(r,s,o,new om(e.state,l,a>=0)))?new ui(this.source,a,r,r.from,(i=r.to)!==null&&i!==void 0?i:un(e.state)):new at(this.source,1,a)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new ui(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new at(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function Rk(n,e,t,i){if(!n)return!1;let r=e.sliceDoc(t,i);return typeof n=="function"?n(r,t,i,e):lm(n,!0).test(r)}const hm=ne.define({map(n,e){return n.map(t=>t.map(e))}}),um=ne.define(),tt=Ve.define({create(){return $s.start()},update(n,e){return n.update(e)},provide:n=>[Ra.from(n,e=>e.tooltip),B.contentAttributes.from(n,e=>e.attrs)]});function Ga(n,e){const t=e.completion.apply||e.completion.label;let i=n.state.field(tt).active.find(r=>r.source==e.source);return i instanceof ui?(typeof t=="string"?n.dispatch(Object.assign(Object.assign({},gk(n.state,t,i.from,i.to)),{annotations:am.of(e.completion)})):t(n,e.completion,i.from,i.to),!0):!1}const Nk=kk(tt,Ga);function rs(n,e="option"){return t=>{let i=t.state.field(tt,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<t.state.facet(He).interactionDelay)return!1;let r=1,s;e=="page"&&(s=Vd(t,i.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,l=i.open.selected>-1?i.open.selected+r*(n?1:-1):n?0:o-1;return l<0?l=e=="page"?0:o-1:l>=o&&(l=e=="page"?o-1:0),t.dispatch({effects:um.of(l)}),!0}}const Ok=n=>{let e=n.state.field(tt,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(He).interactionDelay?!1:Ga(n,e.open.options[e.open.selected])},nu=n=>n.state.field(tt,!1)?(n.dispatch({effects:Vs.of(!0)}),!0):!1,Lk=n=>{let e=n.state.field(tt,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:yr.of(null)}),!0)};class Pk{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const Ik=50,Bk=1e3,zk=De.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(tt).active)e.state==1&&this.startQuery(e)}update(n){let e=n.state.field(tt),t=n.state.facet(He);if(!n.selectionSet&&!n.docChanged&&n.startState.field(tt)==e)return;let i=n.transactions.some(s=>{let o=cm(s,t);return o&8||(s.selection||s.docChanged)&&!(o&3)});for(let s=0;s<this.running.length;s++){let o=this.running[s];if(i||o.context.abortOnDocChange&&n.docChanged||o.updates.length+n.transactions.length>Ik&&Date.now()-o.time>Bk){for(let l of o.context.abortListeners)try{l()}catch(a){nt(this.view.state,a)}o.context.abortListeners=null,this.running.splice(s--,1)}else o.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(s=>s.effects.some(o=>o.is(Vs)))&&(this.pendingStart=!0);let r=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.state==1&&!this.running.some(o=>o.active.source==s.source))?setTimeout(()=>this.startUpdate(),r):-1,this.composing!=0)for(let s of n.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(tt);for(let t of e.active)t.state==1&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t)}startQuery(n){let{state:e}=this.view,t=un(e),i=new om(e,t,n.explicitPos==t,this.view),r=new Pk(n,i);this.running.push(r),Promise.resolve(n.source(i)).then(s=>{r.context.aborted||(r.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:yr.of(null)}),nt(this.view.state,s)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(He).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(He);for(let i=0;i<this.running.length;i++){let r=this.running[i];if(r.done===void 0)continue;if(this.running.splice(i--,1),r.done){let o=new ui(r.active.source,r.active.explicitPos,r.done,r.done.from,(n=r.done.to)!==null&&n!==void 0?n:un(r.updates.length?r.updates[0].startState:this.view.state));for(let l of r.updates)o=o.update(l,t);if(o.hasResult()){e.push(o);continue}}let s=this.view.state.field(tt).active.find(o=>o.source==r.active.source);if(s&&s.state==1)if(r.done==null){let o=new at(r.active.source,0);for(let l of r.updates)o=o.update(l,t);o.state!=1&&e.push(o)}else this.startQuery(s)}e.length&&this.view.dispatch({effects:hm.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(tt,!1);if(e&&e.tooltip&&this.view.state.facet(He).closeOnBlur){let t=e.open&&Vd(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:yr.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Vs.of(!1)}),20),this.composing=0}}}),jk=typeof navigator=="object"&&/Win/.test(navigator.platform),Hk=_n.highest(B.domEventHandlers({keydown(n,e){let t=e.state.field(tt,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!(jk&&n.altKey)||n.metaKey)return!1;let i=t.open.options[t.open.selected],r=t.active.find(o=>o.source==i.source),s=i.completion.commitCharacters||r.result.commitCharacters;return s&&s.indexOf(n.key)>-1&&Ga(e,i),!1}})),Fk=B.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),vr={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Dn=ne.define({map(n,e){let t=e.mapPos(n,-1,Je.TrackAfter);return t??void 0}}),Ja=new class extends In{};Ja.startSide=1;Ja.endSide=-1;const fm=Ve.define({create(){return ce.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:i=>i>=t.from&&i<=t.to})}for(let t of e.effects)t.is(Dn)&&(n=n.update({add:[Ja.range(t.value,t.value+1)]}));return n}});function Wk(){return[$k,fm]}const qo="()[]{}<>";function dm(n){for(let e=0;e<qo.length;e+=2)if(qo.charCodeAt(e)==n)return qo.charAt(e+1);return ga(n<128?n:n+1)}function pm(n,e){return n.languageDataAt("closeBrackets",e)[0]||vr}const Vk=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),$k=B.inputHandler.of((n,e,t,i)=>{if((Vk?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let r=n.state.selection.main;if(i.length>2||i.length==2&&dt(Be(i,0))==1||e!=r.from||t!=r.to)return!1;let s=Uk(n.state,i);return s?(n.dispatch(s),!0):!1}),_k=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let i=pm(n,n.selection.main.head).brackets||vr.brackets,r=null,s=n.changeByRange(o=>{if(o.empty){let l=Kk(n.doc,o.head);for(let a of i)if(a==l&&ho(n.doc,o.head)==dm(Be(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:T.cursor(o.head-a.length)}}return{range:r=o}});return r||e(n.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!r},qk=[{key:"Backspace",run:_k}];function Uk(n,e){let t=pm(n,n.selection.main.head),i=t.brackets||vr.brackets;for(let r of i){let s=dm(Be(r,0));if(e==r)return s==r?Yk(n,r,i.indexOf(r+r+r)>-1,t):Gk(n,r,s,t.before||vr.before);if(e==s&&mm(n,n.selection.main.from))return Jk(n,r,s)}return null}function mm(n,e){let t=!1;return n.field(fm).between(0,n.doc.length,i=>{i==e&&(t=!0)}),t}function ho(n,e){let t=n.sliceString(e,e+2);return t.slice(0,dt(Be(t,0)))}function Kk(n,e){let t=n.sliceString(e-2,e);return dt(Be(t,0))==t.length?t:t.slice(1)}function Gk(n,e,t,i){let r=null,s=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:Dn.of(o.to+e.length),range:T.range(o.anchor+e.length,o.head+e.length)};let l=ho(n.doc,o.head);return!l||/\s/.test(l)||i.indexOf(l)>-1?{changes:{insert:e+t,from:o.head},effects:Dn.of(o.head+e.length),range:T.cursor(o.head+e.length)}:{range:r=o}});return r?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function Jk(n,e,t){let i=null,r=n.changeByRange(s=>s.empty&&ho(n.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:T.cursor(s.head+t.length)}:i={range:s});return i?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Yk(n,e,t,i){let r=i.stringPrefixes||vr.stringPrefixes,s=null,o=n.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:Dn.of(l.to+e.length),range:T.range(l.anchor+e.length,l.head+e.length)};let a=l.head,c=ho(n.doc,a),h;if(c==e){if(iu(n,a))return{changes:{insert:e+e,from:a},effects:Dn.of(a+e.length),range:T.cursor(a+e.length)};if(mm(n,a)){let f=t&&n.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+f.length,insert:f},range:T.cursor(a+f.length)}}}else{if(t&&n.sliceDoc(a-2*e.length,a)==e+e&&(h=ru(n,a-2*e.length,r))>-1&&iu(n,h))return{changes:{insert:e+e+e+e,from:a},effects:Dn.of(a+e.length),range:T.cursor(a+e.length)};if(n.charCategorizer(a)(c)!=Se.Word&&ru(n,a,r)>-1&&!Xk(n,a,e,r))return{changes:{insert:e+e,from:a},effects:Dn.of(a+e.length),range:T.cursor(a+e.length)}}return{range:s=l}});return s?null:n.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function iu(n,e){let t=We(n).resolveInner(e+1);return t.parent&&t.from==e}function Xk(n,e,t,i){let r=We(n).resolveInner(e,-1),s=i.reduce((o,l)=>Math.max(o,l.length),0);for(let o=0;o<5;o++){let l=n.sliceDoc(r.from,Math.min(r.to,r.from+t.length+s)),a=l.indexOf(t);if(!a||a>-1&&i.indexOf(l.slice(0,a))>-1){let h=r.firstChild;for(;h&&h.from==r.from&&h.to-h.from>t.length+a;){if(n.sliceDoc(h.to-t.length,h.to)==t)return!1;h=h.firstChild}return!0}let c=r.to==e&&r.parent;if(!c)break;r=c}return!1}function ru(n,e,t){let i=n.charCategorizer(e);if(i(n.sliceDoc(e-1,e))!=Se.Word)return e;for(let r of t){let s=e-r.length;if(n.sliceDoc(s,e)==r&&i(n.sliceDoc(s-1,s))!=Se.Word)return s}return-1}function Qk(n={}){return[Hk,tt,He.of(n),zk,Zk,Fk]}const gm=[{key:"Ctrl-Space",run:nu},{mac:"Alt-`",run:nu},{key:"Escape",run:Lk},{key:"ArrowDown",run:rs(!0)},{key:"ArrowUp",run:rs(!1)},{key:"PageDown",run:rs(!0,"page")},{key:"PageUp",run:rs(!1,"page")},{key:"Enter",run:Ok}],Zk=_n.highest(to.computeN([He],n=>n.facet(He).defaultKeymap?[gm]:[]));class eC{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class En{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let r=e,s=i.facet(wr).markerFilter;s&&(r=s(r,i));let o=U.set(r.map(l=>l.from==l.to||l.from==l.to-1&&i.doc.lineAt(l.from).to==l.from?U.widget({widget:new cC(l),diagnostic:l}).range(l.from):U.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity+(l.markClass?" "+l.markClass:"")},diagnostic:l}).range(l.from,l.to)),!0);return new En(o,t,Ci(o))}}function Ci(n,e=null,t=0){let i=null;return n.between(t,1e9,(r,s,{spec:o})=>{if(!(e&&o.diagnostic!=e))return i=new eC(r,s,o.diagnostic),!1}),i}function tC(n,e){let t=e.pos,i=e.end||t,r=n.state.facet(wr).hideOn(n,t,i);if(r!=null)return r;let s=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(o=>o.is(bm))||n.changes.touchesRange(s.from,Math.max(s.to,i)))}function nC(n,e){return n.field(ct,!1)?e:e.concat(ne.appendConfig.of(fC))}const bm=ne.define(),Ya=ne.define(),xm=ne.define(),ct=Ve.define({create(){return new En(U.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),i=null,r=n.panel;if(n.selected){let s=e.changes.mapPos(n.selected.from,1);i=Ci(t,n.selected.diagnostic,s)||Ci(t,null,s)}!t.size&&r&&e.state.facet(wr).autoPanel&&(r=null),n=new En(t,r,i)}for(let t of e.effects)if(t.is(bm)){let i=e.state.facet(wr).autoPanel?t.value.length?Sr.open:null:n.panel;n=En.init(t.value,i,e.state)}else t.is(Ya)?n=new En(n.diagnostics,t.value?Sr.open:null,n.selected):t.is(xm)&&(n=new En(n.diagnostics,n.panel,t.value));return n},provide:n=>[pr.from(n,e=>e.panel),B.decorations.from(n,e=>e.diagnostics)]}),iC=U.mark({class:"cm-lintRange cm-lintRange-active"});function rC(n,e,t){let{diagnostics:i}=n.state.field(ct),r=[],s=2e8,o=0;i.between(e-(t<0?1:0),e+(t>0?1:0),(a,c,{spec:h})=>{e>=a&&e<=c&&(a==c||(e>a||t>0)&&(e<c||t<0))&&(r.push(h.diagnostic),s=Math.min(a,s),o=Math.max(c,o))});let l=n.state.facet(wr).tooltipFilter;return l&&(r=l(r,n.state)),r.length?{pos:s,end:o,above:n.state.doc.lineAt(s).to<o,create(){return{dom:sC(n,r)}}}:null}function sC(n,e){return be("ul",{class:"cm-tooltip-lint"},e.map(t=>vm(n,t,!1)))}const oC=n=>{let e=n.state.field(ct,!1);(!e||!e.panel)&&n.dispatch({effects:nC(n.state,[Ya.of(!0)])});let t=dr(n,Sr.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},su=n=>{let e=n.state.field(ct,!1);return!e||!e.panel?!1:(n.dispatch({effects:Ya.of(!1)}),!0)},lC=n=>{let e=n.state.field(ct,!1);if(!e)return!1;let t=n.state.selection.main,i=e.diagnostics.iter(t.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==t.from&&i.to==t.to)?!1:(n.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},aC=[{key:"Mod-Shift-m",run:oC,preventDefault:!0},{key:"F8",run:lC}],wr=z.define({combine(n){return Object.assign({sources:n.map(e=>e.source).filter(e=>e!=null)},Ht(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?i=>e(i)||t(i):e:t}))}});function ym(n){let e=[];if(n)e:for(let{name:t}of n){for(let i=0;i<t.length;i++){let r=t[i];if(/[a-zA-Z]/.test(r)&&!e.some(s=>s.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function vm(n,e,t){var i;let r=t?ym(e.actions):[];return be("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},be("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,o)=>{let l=!1,a=f=>{if(f.preventDefault(),l)return;l=!0;let d=Ci(n.state.field(ct).diagnostics,e);d&&s.apply(n,d.from,d.to)},{name:c}=s,h=r[o]?c.indexOf(r[o]):-1,u=h<0?c:[c.slice(0,h),be("u",c.slice(h,h+1)),c.slice(h+1)];return be("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${c}${h<0?"":` (access key "${r[o]})"`}.`},u)}),e.source&&be("div",{class:"cm-diagnosticSource"},e.source))}class cC extends Jt{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return be("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class ou{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=vm(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Sr{constructor(e){this.view=e,this.items=[];let t=r=>{if(r.keyCode==27)su(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=ym(s.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==r.keyCode){let a=Ci(this.view.state.field(ct).diagnostics,s);a&&s.actions[l].apply(e,a.from,a.to)}}else return;r.preventDefault()},i=r=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(r.target)&&this.moveSelection(s)};this.list=be("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i}),this.dom=be("div",{class:"cm-panel-lint"},this.list,be("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>su(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(ct).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(ct),i=0,r=!1,s=null;for(e.between(0,this.view.state.doc.length,(o,l,{spec:a})=>{let c=-1,h;for(let u=i;u<this.items.length;u++)if(this.items[u].diagnostic==a.diagnostic){c=u;break}c<0?(h=new ou(this.view,a.diagnostic),this.items.splice(i,0,h),r=!0):(h=this.items[c],c>i&&(this.items.splice(i,c-i),r=!0)),t&&h.diagnostic==t.diagnostic?h.dom.hasAttribute("aria-selected")||(h.dom.setAttribute("aria-selected","true"),s=h):h.dom.hasAttribute("aria-selected")&&h.dom.removeAttribute("aria-selected"),i++});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new ou(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{let a=l.height/this.list.offsetHeight;o.top<l.top?this.list.scrollTop-=(l.top-o.top)/a:o.bottom>l.bottom&&(this.list.scrollTop+=(o.bottom-l.bottom)/a)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(ct),i=Ci(t.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:xm.of(i)})}static open(e){return new Sr(e)}}function hC(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function ss(n){return hC(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const uC=B.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:ss("#d11")},".cm-lintRange-warning":{backgroundImage:ss("orange")},".cm-lintRange-info":{backgroundImage:ss("#999")},".cm-lintRange-hint":{backgroundImage:ss("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),fC=[ct,B.decorations.compute([ct],n=>{let{selected:e,panel:t}=n.field(ct);return!e||!t||e.from==e.to?U.none:U.set([iC.range(e.from,e.to)])}),nw(rC,{hideOn:tC}),uC];var lu=function(e){e===void 0&&(e={});var{crosshairCursor:t=!1}=e,i=[];e.closeBracketsKeymap!==!1&&(i=i.concat(qk)),e.defaultKeymap!==!1&&(i=i.concat(jS)),e.searchKeymap!==!1&&(i=i.concat(hk)),e.historyKeymap!==!1&&(i=i.concat(K1)),e.foldKeymap!==!1&&(i=i.concat(i1)),e.completionKeymap!==!1&&(i=i.concat(gm)),e.lintKeymap!==!1&&(i=i.concat(aC));var r=[];return e.lineNumbers!==!1&&r.push(dw()),e.highlightActiveLineGutter!==!1&&r.push(gw()),e.highlightSpecialChars!==!1&&r.push(Nv()),e.history!==!1&&r.push(j1()),e.foldGutter!==!1&&r.push(l1()),e.drawSelection!==!1&&r.push(vv()),e.dropCursor!==!1&&r.push(Av()),e.allowMultipleSelections!==!1&&r.push(ae.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&r.push(Kw()),e.syntaxHighlighting!==!1&&r.push(za(u1,{fallback:!0})),e.bracketMatching!==!1&&r.push(x1()),e.closeBrackets!==!1&&r.push(Wk()),e.autocompletion!==!1&&r.push(Qk()),e.rectangularSelection!==!1&&r.push(qv()),t!==!1&&r.push(Gv()),e.highlightActiveLine!==!1&&r.push(zv()),e.highlightSelectionMatches!==!1&&r.push(qS()),e.tabSize&&typeof e.tabSize=="number"&&r.push(io.of(" ".repeat(e.tabSize))),r.concat([to.of(i.flat())]).filter(Boolean)};const dC="#e5c07b",au="#e06c75",pC="#56b6c2",mC="#ffffff",xs="#abb2bf",Ql="#7d8799",gC="#61afef",bC="#98c379",cu="#d19a66",xC="#c678dd",yC="#21252b",hu="#2c313a",uu="#282c34",Uo="#353a42",vC="#3E4451",fu="#528bff",wC=B.theme({"&":{color:xs,backgroundColor:uu},".cm-content":{caretColor:fu},".cm-cursor, .cm-dropCursor":{borderLeftColor:fu},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:vC},".cm-panels":{backgroundColor:yC,color:xs},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:uu,color:Ql,border:"none"},".cm-activeLineGutter":{backgroundColor:hu},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Uo},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Uo,borderBottomColor:Uo},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:hu,color:xs}}},{dark:!0}),SC=Ni.define([{tag:v.keyword,color:xC},{tag:[v.name,v.deleted,v.character,v.propertyName,v.macroName],color:au},{tag:[v.function(v.variableName),v.labelName],color:gC},{tag:[v.color,v.constant(v.name),v.standard(v.name)],color:cu},{tag:[v.definition(v.name),v.separator],color:xs},{tag:[v.typeName,v.className,v.number,v.changed,v.annotation,v.modifier,v.self,v.namespace],color:dC},{tag:[v.operator,v.operatorKeyword,v.url,v.escape,v.regexp,v.link,v.special(v.string)],color:pC},{tag:[v.meta,v.comment],color:Ql},{tag:v.strong,fontWeight:"bold"},{tag:v.emphasis,fontStyle:"italic"},{tag:v.strikethrough,textDecoration:"line-through"},{tag:v.link,color:Ql,textDecoration:"underline"},{tag:v.heading,fontWeight:"bold",color:au},{tag:[v.atom,v.bool,v.special(v.variableName)],color:cu},{tag:[v.processingInstruction,v.string,v.inserted],color:bC},{tag:v.invalid,color:mC}]),kC=[wC,za(SC)];var CC=B.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),AC=function(e){e===void 0&&(e={});var{indentWithTab:t=!0,editable:i=!0,readOnly:r=!1,theme:s="light",placeholder:o="",basicSetup:l=!0}=e,a=[];switch(t&&a.unshift(to.of([HS])),l&&(typeof l=="boolean"?a.unshift(lu()):a.unshift(lu(l))),o&&a.unshift(Wv(o)),s){case"light":a.push(CC);break;case"dark":a.push(kC);break;case"none":break;default:a.push(s);break}return i===!1&&a.push(B.editable.of(!1)),r&&a.push(ae.readOnly.of(!0)),[...a]},MC=n=>({line:n.state.doc.lineAt(n.state.selection.main.from),lineCount:n.state.doc.lines,lineBreak:n.state.lineBreak,length:n.state.doc.length,readOnly:n.state.readOnly,tabSize:n.state.tabSize,selection:n.state.selection,selectionAsSingle:n.state.selection.asSingle().main,ranges:n.state.selection.ranges,selectionCode:n.state.sliceDoc(n.state.selection.main.from,n.state.selection.main.to),selections:n.state.selection.ranges.map(e=>n.state.sliceDoc(e.from,e.to)),selectedText:n.state.selection.ranges.some(e=>!e.empty)}),du=jt.define(),EC=[];function TC(n){var{value:e,selection:t,onChange:i,onStatistics:r,onCreateEditor:s,onUpdate:o,extensions:l=EC,autoFocus:a,theme:c="light",height:h=null,minHeight:u=null,maxHeight:f=null,width:d=null,minWidth:p=null,maxWidth:b=null,placeholder:m="",editable:x=!0,readOnly:y=!1,indentWithTab:C=!0,basicSetup:M=!0,root:w,initialState:A}=n,[k,L]=S.useState(),[R,W]=S.useState(),[H,D]=S.useState(),X=B.theme({"&":{height:h,minHeight:u,maxHeight:f,width:d,minWidth:p,maxWidth:b},"& .cm-scroller":{height:"100% !important"}}),V=B.updateListener.of(E=>{if(E.docChanged&&typeof i=="function"&&!E.transactions.some(Y=>Y.annotation(du))){var O=E.state.doc,j=O.toString();i(j,E)}r&&r(MC(E))}),G=AC({theme:c,editable:x,readOnly:y,placeholder:m,indentWithTab:C,basicSetup:M}),Z=[V,X,...G];return o&&typeof o=="function"&&Z.push(B.updateListener.of(o)),Z=Z.concat(l),S.useEffect(()=>{if(k&&!H){var E={doc:e,selection:t,extensions:Z},O=A?ae.fromJSON(A.json,E,A.fields):ae.create(E);if(D(O),!R){var j=new B({state:O,parent:k,root:w});W(j),s&&s(j,O)}}return()=>{R&&(D(void 0),W(void 0))}},[k,H]),S.useEffect(()=>L(n.container),[n.container]),S.useEffect(()=>()=>{R&&(R.destroy(),W(void 0))},[R]),S.useEffect(()=>{a&&R&&R.focus()},[a,R]),S.useEffect(()=>{R&&R.dispatch({effects:ne.reconfigure.of(Z)})},[c,l,h,u,f,d,p,b,m,x,y,C,M,i,o]),S.useEffect(()=>{if(e!==void 0){var E=R?R.state.doc.toString():"";R&&e!==E&&R.dispatch({changes:{from:0,to:E.length,insert:e||""},annotations:[du.of(!0)]})}},[e,R]),{state:H,setState:D,view:R,setView:W,container:k,setContainer:L}}var DC=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],wm=S.forwardRef((n,e)=>{var{className:t,value:i="",selection:r,extensions:s=[],onChange:o,onStatistics:l,onCreateEditor:a,onUpdate:c,autoFocus:h,theme:u="light",height:f,minHeight:d,maxHeight:p,width:b,minWidth:m,maxWidth:x,basicSetup:y,placeholder:C,indentWithTab:M,editable:w,readOnly:A,root:k,initialState:L}=n,R=wx(n,DC),W=S.useRef(null),{state:H,view:D,container:X}=TC({container:W.current,root:k,value:i,autoFocus:h,theme:u,height:f,minHeight:d,maxHeight:p,width:b,minWidth:m,maxWidth:x,basicSetup:y,placeholder:C,indentWithTab:M,editable:w,readOnly:A,selection:r,onChange:o,onStatistics:l,onCreateEditor:a,onUpdate:c,extensions:s,initialState:L});if(S.useImperativeHandle(e,()=>({editor:W.current,state:H,view:D}),[W,X,H,D]),typeof i!="string")throw new Error("value must be typeof string but got "+typeof i);var V=typeof u=="string"?"cm-theme-"+u:"cm-theme";return g.jsx("div",tl({ref:W,className:""+V+(t?" "+t:"")},R))});wm.displayName="CodeMirror";var RC="builtin",kn="comment",pu="string",mu="symbol",_i="atom",gu="number",bu="bracket",NC=2;function Sm(n){for(var e={},t=n.split(" "),i=0;i<t.length;++i)e[t[i]]=!0;return e}var xu=Sm("λ case-lambda call/cc class cond-expand define-class define-values exit-handler field import inherit init-field interface let*-values let-values let/ec mixin opt-lambda override protect provide public rename require require-for-syntax syntax syntax-case syntax-error unit/sig unless when with-syntax and begin call-with-current-continuation call-with-input-file call-with-output-file case cond define define-syntax define-macro defmacro delay do dynamic-wind else for-each if lambda let let* let-syntax letrec letrec-syntax map or syntax-rules abs acos angle append apply asin assoc assq assv atan boolean? caar cadr call-with-input-file call-with-output-file call-with-values car cdddar cddddr cdr ceiling char->integer char-alphabetic? char-ci<=? char-ci<? char-ci=? char-ci>=? char-ci>? char-downcase char-lower-case? char-numeric? char-ready? char-upcase char-upper-case? char-whitespace? char<=? char<? char=? char>=? char>? char? close-input-port close-output-port complex? cons cos current-input-port current-output-port denominator display eof-object? eq? equal? eqv? eval even? exact->inexact exact? exp expt #f floor force gcd imag-part inexact->exact inexact? input-port? integer->char integer? interaction-environment lcm length list list->string list->vector list-ref list-tail list? load log magnitude make-polar make-rectangular make-string make-vector max member memq memv min modulo negative? newline not null-environment null? number->string number? numerator odd? open-input-file open-output-file output-port? pair? peek-char port? positive? procedure? quasiquote quote quotient rational? rationalize read read-char real-part real? remainder reverse round scheme-report-environment set! set-car! set-cdr! sin sqrt string string->list string->number string->symbol string-append string-ci<=? string-ci<? string-ci=? string-ci>=? string-ci>? string-copy string-fill! string-length string-ref string-set! string<=? string<? string=? string>=? string>? string? substring symbol->string symbol? #t tan transcript-off transcript-on truncate values vector vector->list vector-fill! vector-length vector-ref vector-set! with-input-from-file with-output-to-file write write-char zero?"),OC=Sm("define let letrec let* lambda define-macro defmacro let-syntax letrec-syntax let-values let*-values define-syntax syntax-rules define-values when unless");function LC(n,e,t){this.indent=n,this.type=e,this.prev=t}function Ko(n,e,t){n.indentStack=new LC(e,t,n.indentStack)}function PC(n){n.indentStack=n.indentStack.prev}var IC=new RegExp(/^(?:[-+]i|[-+][01]+#*(?:\/[01]+#*)?i|[-+]?[01]+#*(?:\/[01]+#*)?@[-+]?[01]+#*(?:\/[01]+#*)?|[-+]?[01]+#*(?:\/[01]+#*)?[-+](?:[01]+#*(?:\/[01]+#*)?)?i|[-+]?[01]+#*(?:\/[01]+#*)?)(?=[()\s;"]|$)/i),BC=new RegExp(/^(?:[-+]i|[-+][0-7]+#*(?:\/[0-7]+#*)?i|[-+]?[0-7]+#*(?:\/[0-7]+#*)?@[-+]?[0-7]+#*(?:\/[0-7]+#*)?|[-+]?[0-7]+#*(?:\/[0-7]+#*)?[-+](?:[0-7]+#*(?:\/[0-7]+#*)?)?i|[-+]?[0-7]+#*(?:\/[0-7]+#*)?)(?=[()\s;"]|$)/i),zC=new RegExp(/^(?:[-+]i|[-+][\da-f]+#*(?:\/[\da-f]+#*)?i|[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?@[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?|[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?[-+](?:[\da-f]+#*(?:\/[\da-f]+#*)?)?i|[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?)(?=[()\s;"]|$)/i),jC=new RegExp(/^(?:[-+]i|[-+](?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)i|[-+]?(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)@[-+]?(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)|[-+]?(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)[-+](?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)?i|(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*))(?=[()\s;"]|$)/i);function HC(n){return n.match(IC)}function FC(n){return n.match(BC)}function Go(n,e){return e===!0&&n.backUp(1),n.match(jC)}function WC(n){return n.match(zC)}function yu(n,e){for(var t,i=!1;(t=n.next())!=null;){if(t==e.token&&!i){e.state.mode=!1;break}i=!i&&t=="\\"}}const VC={name:"scheme",startState:function(){return{indentStack:null,indentation:0,mode:!1,sExprComment:!1,sExprQuote:!1}},token:function(n,e){if(e.indentStack==null&&n.sol()&&(e.indentation=n.indentation()),n.eatSpace())return null;var t=null;switch(e.mode){case"string":yu(n,{token:'"',state:e}),t=pu;break;case"symbol":yu(n,{token:"|",state:e}),t=mu;break;case"comment":for(var i,r=!1;(i=n.next())!=null;){if(i=="#"&&r){e.mode=!1;break}r=i=="|"}t=kn;break;case"s-expr-comment":if(e.mode=!1,n.peek()=="("||n.peek()=="[")e.sExprComment=0;else{n.eatWhile(/[^\s\(\)\[\]]/),t=kn;break}default:var s=n.next();if(s=='"')e.mode="string",t=pu;else if(s=="'")n.peek()=="("||n.peek()=="["?(typeof e.sExprQuote!="number"&&(e.sExprQuote=0),t=_i):(n.eatWhile(/[\w_\-!$%&*+\.\/:<=>?@\^~]/),t=_i);else if(s=="|")e.mode="symbol",t=mu;else if(s=="#")if(n.eat("|"))e.mode="comment",t=kn;else if(n.eat(/[tf]/i))t=_i;else if(n.eat(";"))e.mode="s-expr-comment",t=kn;else{var o=null,l=!1,a=!0;n.eat(/[ei]/i)?l=!0:n.backUp(1),n.match(/^#b/i)?o=HC:n.match(/^#o/i)?o=FC:n.match(/^#x/i)?o=WC:n.match(/^#d/i)?o=Go:n.match(/^[-+0-9.]/,!1)?(a=!1,o=Go):l||n.eat("#"),o!=null&&(a&&!l&&n.match(/^#[ei]/i),o(n)&&(t=gu))}else if(/^[-+0-9.]/.test(s)&&Go(n,!0))t=gu;else if(s==";")n.skipToEnd(),t=kn;else if(s=="("||s=="["){for(var c="",h=n.column(),u;(u=n.eat(/[^\s\(\[\;\)\]]/))!=null;)c+=u;c.length>0&&OC.propertyIsEnumerable(c)?Ko(e,h+NC,s):(n.eatSpace(),n.eol()||n.peek()==";"?Ko(e,h+1,s):Ko(e,h+n.current().length,s)),n.backUp(n.current().length-1),typeof e.sExprComment=="number"&&e.sExprComment++,typeof e.sExprQuote=="number"&&e.sExprQuote++,t=bu}else s==")"||s=="]"?(t=bu,e.indentStack!=null&&e.indentStack.type==(s==")"?"(":"[")&&(PC(e),typeof e.sExprComment=="number"&&--e.sExprComment==0&&(t=kn,e.sExprComment=!1),typeof e.sExprQuote=="number"&&--e.sExprQuote==0&&(t=_i,e.sExprQuote=!1))):(n.eatWhile(/[\w_\-!$%&*+\.\/:<=>?@\^~]/),xu&&xu.propertyIsEnumerable(n.current())?t=RC:t="variable")}return typeof e.sExprComment=="number"?kn:typeof e.sExprQuote=="number"?_i:t},indent:function(n){return n.indentStack==null?n.indentation:n.indentStack.indent},languageData:{closeBrackets:{brackets:["(","[","{",'"']},commentTokens:{line:";;"}}},te={name:"githubDark",dark:!0,background:"#24292e",foreground:"#d1d5da",selection:"#3392FF44",cursor:"#c8e1ff",dropdownBackground:"#24292e",dropdownBorder:"#1b1f23",activeLine:"#4d566022",matchingBracket:"#17E5E650",keyword:"#f97583",storage:"#f97583",variable:"#ffab70",parameter:"#e1e4e8",function:"#79b8ff",string:"#9ecbff",constant:"#79b8ff",type:"#79b8ff",class:"#b392f0",number:"#79b8ff",comment:"#6a737d",heading:"#79b8ff",invalid:"#f97583",regexp:"#9ecbff"},$C=B.theme({"&":{color:te.foreground,backgroundColor:te.background},".cm-content":{caretColor:te.cursor},".cm-cursor, .cm-dropCursor":{borderLeftColor:te.cursor},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:te.selection},".cm-panels":{backgroundColor:te.dropdownBackground,color:te.foreground},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:te.dropdownBackground,outline:`1px solid ${te.dropdownBorder}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:te.selection},".cm-activeLine":{backgroundColor:te.activeLine},".cm-selectionMatch":{backgroundColor:te.selection},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:te.matchingBracket,outline:"none"},".cm-gutters":{backgroundColor:te.background,color:te.foreground,border:"none"},".cm-activeLineGutter":{backgroundColor:te.background},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:te.foreground},".cm-tooltip":{border:`1px solid ${te.dropdownBorder}`,backgroundColor:te.dropdownBackground,color:te.foreground},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:te.foreground,borderBottomColor:te.foreground},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{background:te.selection,color:te.foreground}}},{dark:te.dark}),_C=Ni.define([{tag:v.keyword,color:te.keyword},{tag:[v.name,v.deleted,v.character,v.macroName],color:te.variable},{tag:[v.propertyName],color:te.function},{tag:[v.processingInstruction,v.string,v.inserted,v.special(v.string)],color:te.string},{tag:[v.function(v.variableName),v.labelName],color:te.function},{tag:[v.color,v.constant(v.name),v.standard(v.name)],color:te.constant},{tag:[v.definition(v.name),v.separator],color:te.variable},{tag:[v.className],color:te.class},{tag:[v.number,v.changed,v.annotation,v.modifier,v.self,v.namespace],color:te.number},{tag:[v.typeName],color:te.type,fontStyle:te.type},{tag:[v.operator,v.operatorKeyword],color:te.keyword},{tag:[v.url,v.escape,v.regexp,v.link],color:te.regexp},{tag:[v.meta,v.comment],color:te.comment},{tag:v.strong,fontWeight:"bold"},{tag:v.emphasis,fontStyle:"italic"},{tag:v.link,textDecoration:"underline"},{tag:v.heading,fontWeight:"bold",color:te.heading},{tag:[v.atom,v.bool,v.special(v.variableName)],color:te.variable},{tag:v.invalid,color:te.invalid},{tag:v.strikethrough,textDecoration:"line-through"}]),qC=[$C,za(_C)],Xa=({value:n,onChange:e,height:t="200px",fullEditor:i=!1,minHeight:r="24px",maxHeight:s="150px"})=>g.jsx(wm,{value:n,height:t,minHeight:i?void 0:r,maxHeight:i?void 0:s,theme:qC,extensions:[ja.define(VC)],onChange:e,className:`border-none w-full 
                [&_.cm-editor]:bg-transparent 
                [&_.cm-focused]:outline-none 
                [&_.cm-gutters]:bg-transparent 
                [&_.cm-gutters]:border-none 
                [&_.cm-line]:bg-transparent 
                [&_.cm-activeLine]:bg-transparent 
                [&_.cm-activeLineGutter]:bg-transparent 
                [&_.cm-scroller]:bg-transparent
                [&_.cm-editor]:bg-zinc-900
                [&_.cm-content]:bg-zinc-900
                ${i?"":"[&_.cm-editor]:min-h-[24px]"}
            `,basicSetup:{lineNumbers:i,highlightActiveLineGutter:i,highlightSpecialChars:!0,history:!0,foldGutter:i,drawSelection:!0,dropCursor:!0,allowMultipleSelections:i,indentOnInput:!0,bracketMatching:!0,closeBrackets:!0,autocompletion:!0,rectangularSelection:i,crosshairCursor:i,highlightActiveLine:i,highlightSelectionMatches:i,closeBracketsKeymap:!0,defaultKeymap:!0,searchKeymap:i,historyKeymap:!0,foldKeymap:i,completionKeymap:!0,lintKeymap:i}}),UC=({value:n,onChange:e,onKeyDown:t})=>g.jsxs("div",{className:"flex items-start gap-2 text-sm w-full",onKeyDown:t,children:[g.jsx("span",{className:"text-blue-400 shrink-0 mt-[3px]",children:"λ"}),g.jsx("div",{className:"flex-1 min-w-0",children:g.jsx(Xa,{value:n,onChange:e,height:"auto",fullEditor:!1,minHeight:"24px",maxHeight:"150px"})})]}),Qa=S.forwardRef(({onCommand:n,onInputChange:e,className:t},i)=>{const[r,s]=S.useState([]),[o,l]=S.useState(""),[a,c]=S.useState(!1),h=S.useRef(null),u=S.useRef(""),f=`     ██╗ █████╗ ██╗    ██╗███████╗
     ██║██╔══██╗██║    ██║██╔════╝
     ██║███████║██║ █╗ ██║███████╗
██   ██║██╔══██║██║███╗██║╚════██║
╚█████╔╝██║  ██║╚███╔███╔╝███████║
 ╚════╝ ╚═╝  ╚═╝ ╚══╝╚══╝ ╚══════╝`;S.useEffect(()=>{s([{type:"system",content:f,timestamp:new Date().toLocaleTimeString(),id:d()},{type:"system",content:"Welcome to the Jaws REPL!",timestamp:new Date().toLocaleTimeString(),id:d()},{type:"system",content:`Type 'exit' to quit, '(help)' for commands.
`,timestamp:new Date().toLocaleTimeString(),id:d()}])},[]),S.useEffect(()=>{h.current&&(h.current.scrollTop=h.current.scrollHeight)},[r]);const d=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,p=async w=>{if(!w.trim()||a)return;c(!0);const A=d();u.current=A;try{const k=w.trim(),L=await n(k);u.current===A&&(s(R=>[...R,{type:"input",content:k,timestamp:new Date().toLocaleTimeString(),id:d()}]),L&&L!=="undefined"&&s(R=>[...R,{type:"output",content:L,timestamp:new Date().toLocaleTimeString(),id:d()}]))}catch(k){const L=k;u.current===A&&s(R=>[...R,{type:"input",content:w.trim(),timestamp:new Date().toLocaleTimeString(),id:d()},{type:"output",content:`Error: ${L.message}`,timestamp:new Date().toLocaleTimeString(),id:d()}])}finally{u.current===A&&(c(!1),m())}},b=()=>o,m=()=>{l(""),e==null||e("")},x=w=>{l(w),e==null||e(w)},y=()=>{u.current=d(),s([{type:"system",content:f,timestamp:new Date().toLocaleTimeString(),id:d()},{type:"system",content:"Welcome to the Jaws REPL!",timestamp:new Date().toLocaleTimeString(),id:d()},{type:"system",content:`Type 'exit' to quit, '(help)' for commands.
`,timestamp:new Date().toLocaleTimeString(),id:d()}])};S.useImperativeHandle(i,()=>({writeOutput:w=>{const A=d();u.current=A,w&&w!=="undefined"&&s(k=>[...k,{type:"output",content:w.trim(),timestamp:new Date().toLocaleTimeString(),id:d()}])},writeSystem:w=>{const A=d();u.current=A,s(k=>[...k,{type:"system",content:w,timestamp:new Date().toLocaleTimeString(),id:d()}])},writeInput:w=>{const A=d();u.current=A,s(k=>[...k,{type:"input",content:w,timestamp:new Date().toLocaleTimeString(),id:d()}])},getCurrentInput:b,clearInput:m,setInput:x,clear:y}));const C=w=>{l(w),e==null||e(w)},M=async w=>{if(w.key==="Enter"&&!w.shiftKey){w.preventDefault(),w.stopPropagation();const A=(o.match(/\(/g)||[]).length,k=(o.match(/\)/g)||[]).length;if(A!==k)return;const L=o.trim();if(!L)return;await p(L)}};return g.jsxs("div",{className:`min-h-[500px] flex flex-col bg-zinc-900 transition-all duration-300 ${t}`,children:[g.jsx("div",{ref:h,className:"flex-1 min-h-[400px] p-4 overflow-y-auto code-font scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-transparent",children:r.map(w=>g.jsx("div",{style:{opacity:0,animation:"fadeSlideIn 0.3s ease-out forwards",animationDelay:"0.2s"},className:`terminal-line ${w.type!=="system"?"mb-2":"mb-0"} group`,children:g.jsxs("div",{className:`flex items-start gap-2 rounded-lg ${w.type!=="system"?"p-2":"p-0"} transition-all duration-300 ${w.type!=="system"?"hover:bg-zinc-800/30":""}`,children:[w.type==="input"&&g.jsxs("span",{className:"text-blue-400 shrink-0 code-font",style:{opacity:0,animation:"slideFromLeft 0.3s ease-out forwards",animationDelay:"0.2s"},children:["jaws: ","|>"]}),g.jsx("div",{className:"flex-1 terminal-content code-font",children:g.jsx(Dt,{text:w.content,type:w.type})}),w.type!=="system"&&g.jsx("span",{className:"text-zinc-500 shrink-0 ml-2 opacity-40 code-font",children:w.timestamp})]})},w.id))}),g.jsx("div",{className:"border-t border-zinc-700/50",children:g.jsxs("div",{className:"px-4 py-3 w-full",children:[g.jsx(UC,{onChange:C,value:o,onKeyDown:M}),g.jsx("div",{className:"mt-2 flex justify-end",children:g.jsxs(Te,{variant:"default",size:"sm",onClick:()=>p(o),className:`flex items-center gap-2 transition-all duration-200 
                                 hover:scale-105 disabled:opacity-50 disabled:hover:scale-100
                                 bg-accent hover:bg-accent/90`,disabled:a,children:[g.jsx(ta,{className:`h-4 w-4 ${a?"animate-spin":""}`}),a?"Running...":"Run"]})})]})})]})});Qa.displayName="Terminal";const Za=()=>{const[n,e]=S.useState(null),[t,i]=S.useState(!0),[r,s]=S.useState(null);S.useEffect(()=>{(async()=>{try{if(await new Promise(d=>{const p=()=>{typeof window.createJawsModule=="function"?d():setTimeout(p,100)};p()}),!window.createJawsModule)throw new Error("WASM module not loaded");const u=await window.createJawsModule(),f=new u.JawsWrapper;e(f)}catch(h){s(h instanceof Error?h.message:"Failed to initialize WASM module")}finally{i(!1)}})()},[]);const o=c=>h=>{if(!n)return"Interpreter not initialized";try{return n[c](h)}catch(u){return console.error(`${c} error:`,u),`Error: ${u instanceof Error?u.message:"Unknown error"}`}};return{evaluate:c=>{if(!n)return"Interpreter not initialized";try{const h=n.evaluate(c);return h.error?h.error:h.stdout&&h.stdout.trim()!==""?h.stdout.trim():h.result||""}catch(h){return console.error("evaluate error:",h),`Error: ${h instanceof Error?h.message:"Unknown error"}`}},evaluateWithOutput:c=>{if(!n)return{error:"Interpreter not initialized"};try{return n.evaluate(c)}catch(h){return console.error("evaluate error:",h),{error:`Error: ${h instanceof Error?h.message:"Unknown error"}`}}},getMacroExpanded:o("getMacroExpanded"),getANF:o("getANF"),getOptimizedANF:o("getOptimizedANF"),getThreeAC:o("getThreeAC"),getAST:o("getAST"),loading:t,error:r,instance:n}},{createElement:Ai,createContext:KC,createRef:HA,forwardRef:km,useCallback:Qe,useContext:Cm,useEffect:Ln,useImperativeHandle:Am,useLayoutEffect:GC,useMemo:JC,useRef:Ze,useState:fi}=Ru,vu=Ru[`useId${Math.random()}`.slice(0,5)],YC=GC,uo=KC(null);uo.displayName="PanelGroupContext";const Pn=YC,XC=typeof vu=="function"?vu:()=>null;let QC=0;function ec(n=null){const e=XC(),t=Ze(n||e||null);return t.current===null&&(t.current=""+QC++),n??t.current}function Mm({children:n,className:e="",collapsedSize:t,collapsible:i,defaultSize:r,forwardedRef:s,id:o,maxSize:l,minSize:a,onCollapse:c,onExpand:h,onResize:u,order:f,style:d,tagName:p="div",...b}){const m=Cm(uo);if(m===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:x,expandPanel:y,getPanelSize:C,getPanelStyle:M,groupId:w,isPanelCollapsed:A,reevaluatePanelConstraints:k,registerPanel:L,resizePanel:R,unregisterPanel:W}=m,H=ec(o),D=Ze({callbacks:{onCollapse:c,onExpand:h,onResize:u},constraints:{collapsedSize:t,collapsible:i,defaultSize:r,maxSize:l,minSize:a},id:H,idIsFromProps:o!==void 0,order:f});Ze({didLogMissingDefaultSizeWarning:!1}),Pn(()=>{const{callbacks:V,constraints:G}=D.current,Z={...G};D.current.id=H,D.current.idIsFromProps=o!==void 0,D.current.order=f,V.onCollapse=c,V.onExpand=h,V.onResize=u,G.collapsedSize=t,G.collapsible=i,G.defaultSize=r,G.maxSize=l,G.minSize=a,(Z.collapsedSize!==G.collapsedSize||Z.collapsible!==G.collapsible||Z.maxSize!==G.maxSize||Z.minSize!==G.minSize)&&k(D.current,Z)}),Pn(()=>{const V=D.current;return L(V),()=>{W(V)}},[f,H,L,W]),Am(s,()=>({collapse:()=>{x(D.current)},expand:V=>{y(D.current,V)},getId(){return H},getSize(){return C(D.current)},isCollapsed(){return A(D.current)},isExpanded(){return!A(D.current)},resize:V=>{R(D.current,V)}}),[x,y,C,A,H,R]);const X=M(D.current,r);return Ai(p,{...b,children:n,className:e,id:o,style:{...X,...d},"data-panel":"","data-panel-collapsible":i||void 0,"data-panel-group-id":w,"data-panel-id":H,"data-panel-size":parseFloat(""+X.flexGrow).toFixed(1)})}const Em=km((n,e)=>Ai(Mm,{...n,forwardedRef:e}));Mm.displayName="Panel";Em.displayName="forwardRef(Panel)";let Zl=null,Rn=null;function ZC(n,e){if(e){const t=(e&Om)!==0,i=(e&Lm)!==0,r=(e&Pm)!==0,s=(e&Im)!==0;if(t)return r?"se-resize":s?"ne-resize":"e-resize";if(i)return r?"sw-resize":s?"nw-resize":"w-resize";if(r)return"s-resize";if(s)return"n-resize"}switch(n){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function eA(){Rn!==null&&(document.head.removeChild(Rn),Zl=null,Rn=null)}function Jo(n,e){const t=ZC(n,e);Zl!==t&&(Zl=t,Rn===null&&(Rn=document.createElement("style"),document.head.appendChild(Rn)),Rn.innerHTML=`*{cursor: ${t}!important;}`)}function Tm(n){return n.type==="keydown"}function Dm(n){return n.type.startsWith("pointer")}function Rm(n){return n.type.startsWith("mouse")}function fo(n){if(Dm(n)){if(n.isPrimary)return{x:n.clientX,y:n.clientY}}else if(Rm(n))return{x:n.clientX,y:n.clientY};return{x:1/0,y:1/0}}function tA(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function nA(n,e,t){return n.x<e.x+e.width&&n.x+n.width>e.x&&n.y<e.y+e.height&&n.y+n.height>e.y}function iA(n,e){if(n===e)throw new Error("Cannot compare node with itself");const t={a:ku(n),b:ku(e)};let i;for(;t.a.at(-1)===t.b.at(-1);)n=t.a.pop(),e=t.b.pop(),i=n;re(i,"Stacking order can only be calculated for elements with a common ancestor");const r={a:Su(wu(t.a)),b:Su(wu(t.b))};if(r.a===r.b){const s=i.childNodes,o={a:t.a.at(-1),b:t.b.at(-1)};let l=s.length;for(;l--;){const a=s[l];if(a===o.a)return 1;if(a===o.b)return-1}}return Math.sign(r.a-r.b)}const rA=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function sA(n){var e;const t=getComputedStyle((e=Nm(n))!==null&&e!==void 0?e:n).display;return t==="flex"||t==="inline-flex"}function oA(n){const e=getComputedStyle(n);return!!(e.position==="fixed"||e.zIndex!=="auto"&&(e.position!=="static"||sA(n))||+e.opacity<1||"transform"in e&&e.transform!=="none"||"webkitTransform"in e&&e.webkitTransform!=="none"||"mixBlendMode"in e&&e.mixBlendMode!=="normal"||"filter"in e&&e.filter!=="none"||"webkitFilter"in e&&e.webkitFilter!=="none"||"isolation"in e&&e.isolation==="isolate"||rA.test(e.willChange)||e.webkitOverflowScrolling==="touch")}function wu(n){let e=n.length;for(;e--;){const t=n[e];if(re(t,"Missing node"),oA(t))return t}return null}function Su(n){return n&&Number(getComputedStyle(n).zIndex)||0}function ku(n){const e=[];for(;n;)e.push(n),n=Nm(n);return e}function Nm(n){const{parentNode:e}=n;return e&&e instanceof ShadowRoot?e.host:e}const Om=1,Lm=2,Pm=4,Im=8,lA=tA()==="coarse";let wt=[],di=!1,rn=new Map,po=new Map;const kr=new Set;function aA(n,e,t,i,r){var s;const{ownerDocument:o}=e,l={direction:t,element:e,hitAreaMargins:i,setResizeHandlerState:r},a=(s=rn.get(o))!==null&&s!==void 0?s:0;return rn.set(o,a+1),kr.add(l),_s(),function(){var h;po.delete(n),kr.delete(l);const u=(h=rn.get(o))!==null&&h!==void 0?h:1;if(rn.set(o,u-1),_s(),u===1&&rn.delete(o),wt.includes(l)){const f=wt.indexOf(l);f>=0&&wt.splice(f,1),nc(),r("up",!0,null)}}}function Cu(n){const{target:e}=n,{x:t,y:i}=fo(n);di=!0,tc({target:e,x:t,y:i}),_s(),wt.length>0&&(qs("down",n),n.preventDefault(),n.stopPropagation())}function qi(n){const{x:e,y:t}=fo(n);if(di&&n.buttons===0&&(di=!1,qs("up",n)),!di){const{target:i}=n;tc({target:i,x:e,y:t})}qs("move",n),nc(),wt.length>0&&n.preventDefault()}function Gn(n){const{target:e}=n,{x:t,y:i}=fo(n);po.clear(),di=!1,wt.length>0&&n.preventDefault(),qs("up",n),tc({target:e,x:t,y:i}),nc(),_s()}function tc({target:n,x:e,y:t}){wt.splice(0);let i=null;(n instanceof HTMLElement||n instanceof SVGElement)&&(i=n),kr.forEach(r=>{const{element:s,hitAreaMargins:o}=r,l=s.getBoundingClientRect(),{bottom:a,left:c,right:h,top:u}=l,f=lA?o.coarse:o.fine;if(e>=c-f&&e<=h+f&&t>=u-f&&t<=a+f){if(i!==null&&document.contains(i)&&s!==i&&!s.contains(i)&&!i.contains(s)&&iA(i,s)>0){let p=i,b=!1;for(;p&&!p.contains(s);){if(nA(p.getBoundingClientRect(),l)){b=!0;break}p=p.parentElement}if(b)return}wt.push(r)}})}function Yo(n,e){po.set(n,e)}function nc(){let n=!1,e=!1;wt.forEach(i=>{const{direction:r}=i;r==="horizontal"?n=!0:e=!0});let t=0;po.forEach(i=>{t|=i}),n&&e?Jo("intersection",t):n?Jo("horizontal",t):e?Jo("vertical",t):eA()}function _s(){rn.forEach((n,e)=>{const{body:t}=e;t.removeEventListener("contextmenu",Gn),t.removeEventListener("pointerdown",Cu),t.removeEventListener("pointerleave",qi),t.removeEventListener("pointermove",qi)}),window.removeEventListener("pointerup",Gn),window.removeEventListener("pointercancel",Gn),kr.size>0&&(di?(wt.length>0&&rn.forEach((n,e)=>{const{body:t}=e;n>0&&(t.addEventListener("contextmenu",Gn),t.addEventListener("pointerleave",qi),t.addEventListener("pointermove",qi))}),window.addEventListener("pointerup",Gn),window.addEventListener("pointercancel",Gn)):rn.forEach((n,e)=>{const{body:t}=e;n>0&&(t.addEventListener("pointerdown",Cu,{capture:!0}),t.addEventListener("pointermove",qi))}))}function qs(n,e){kr.forEach(t=>{const{setResizeHandlerState:i}=t,r=wt.includes(t);i(n,r,e)})}function cA(){const[n,e]=fi(0);return Qe(()=>e(t=>t+1),[])}function re(n,e){if(!n)throw console.error(e),Error(e)}const ic=10;function Wn(n,e,t=ic){return n.toFixed(t)===e.toFixed(t)?0:n>e?1:-1}function $t(n,e,t=ic){return Wn(n,e,t)===0}function lt(n,e,t){return Wn(n,e,t)===0}function hA(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){const r=n[i],s=e[i];if(!lt(r,s,t))return!1}return!0}function ri({panelConstraints:n,panelIndex:e,size:t}){const i=n[e];re(i!=null,`Panel constraints not found for index ${e}`);let{collapsedSize:r=0,collapsible:s,maxSize:o=100,minSize:l=0}=i;if(Wn(t,l)<0)if(s){const a=(r+l)/2;Wn(t,a)<0?t=r:t=l}else t=l;return t=Math.min(o,t),t=parseFloat(t.toFixed(ic)),t}function Xi({delta:n,initialLayout:e,panelConstraints:t,pivotIndices:i,prevLayout:r,trigger:s}){if(lt(n,0))return e;const o=[...e],[l,a]=i;re(l!=null,"Invalid first pivot index"),re(a!=null,"Invalid second pivot index");let c=0;if(s==="keyboard"){{const u=n<0?a:l,f=t[u];re(f,`Panel constraints not found for index ${u}`);const{collapsedSize:d=0,collapsible:p,minSize:b=0}=f;if(p){const m=e[u];if(re(m!=null,`Previous layout not found for panel index ${u}`),lt(m,d)){const x=b-m;Wn(x,Math.abs(n))>0&&(n=n<0?0-x:x)}}}{const u=n<0?l:a,f=t[u];re(f,`No panel constraints found for index ${u}`);const{collapsedSize:d=0,collapsible:p,minSize:b=0}=f;if(p){const m=e[u];if(re(m!=null,`Previous layout not found for panel index ${u}`),lt(m,b)){const x=m-d;Wn(x,Math.abs(n))>0&&(n=n<0?0-x:x)}}}}{const u=n<0?1:-1;let f=n<0?a:l,d=0;for(;;){const b=e[f];re(b!=null,`Previous layout not found for panel index ${f}`);const x=ri({panelConstraints:t,panelIndex:f,size:100})-b;if(d+=x,f+=u,f<0||f>=t.length)break}const p=Math.min(Math.abs(n),Math.abs(d));n=n<0?0-p:p}{let f=n<0?l:a;for(;f>=0&&f<t.length;){const d=Math.abs(n)-Math.abs(c),p=e[f];re(p!=null,`Previous layout not found for panel index ${f}`);const b=p-d,m=ri({panelConstraints:t,panelIndex:f,size:b});if(!lt(p,m)&&(c+=p-m,o[f]=m,c.toPrecision(3).localeCompare(Math.abs(n).toPrecision(3),void 0,{numeric:!0})>=0))break;n<0?f--:f++}}if(hA(r,o))return r;{const u=n<0?a:l,f=e[u];re(f!=null,`Previous layout not found for panel index ${u}`);const d=f+c,p=ri({panelConstraints:t,panelIndex:u,size:d});if(o[u]=p,!lt(p,d)){let b=d-p,x=n<0?a:l;for(;x>=0&&x<t.length;){const y=o[x];re(y!=null,`Previous layout not found for panel index ${x}`);const C=y+b,M=ri({panelConstraints:t,panelIndex:x,size:C});if(lt(y,M)||(b-=M-y,o[x]=M),lt(b,0))break;n>0?x--:x++}}}const h=o.reduce((u,f)=>f+u,0);return lt(h,100)?o:r}function uA({layout:n,panelsArray:e,pivotIndices:t}){let i=0,r=100,s=0,o=0;const l=t[0];re(l!=null,"No pivot index found"),e.forEach((u,f)=>{const{constraints:d}=u,{maxSize:p=100,minSize:b=0}=d;f===l?(i=b,r=p):(s+=b,o+=p)});const a=Math.min(r,100-s),c=Math.max(i,100-o),h=n[l];return{valueMax:a,valueMin:c,valueNow:h}}function Cr(n,e=document){return Array.from(e.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${n}"]`))}function Bm(n,e,t=document){const r=Cr(n,t).findIndex(s=>s.getAttribute("data-panel-resize-handle-id")===e);return r??null}function zm(n,e,t){const i=Bm(n,e,t);return i!=null?[i,i+1]:[-1,-1]}function jm(n,e=document){var t;if(e instanceof HTMLElement&&(e==null||(t=e.dataset)===null||t===void 0?void 0:t.panelGroupId)==n)return e;const i=e.querySelector(`[data-panel-group][data-panel-group-id="${n}"]`);return i||null}function mo(n,e=document){const t=e.querySelector(`[data-panel-resize-handle-id="${n}"]`);return t||null}function fA(n,e,t,i=document){var r,s,o,l;const a=mo(e,i),c=Cr(n,i),h=a?c.indexOf(a):-1,u=(r=(s=t[h])===null||s===void 0?void 0:s.id)!==null&&r!==void 0?r:null,f=(o=(l=t[h+1])===null||l===void 0?void 0:l.id)!==null&&o!==void 0?o:null;return[u,f]}function dA({committedValuesRef:n,eagerValuesRef:e,groupId:t,layout:i,panelDataArray:r,panelGroupElement:s,setLayout:o}){Ze({didWarnAboutMissingResizeHandle:!1}),Pn(()=>{if(!s)return;const l=Cr(t,s);for(let a=0;a<r.length-1;a++){const{valueMax:c,valueMin:h,valueNow:u}=uA({layout:i,panelsArray:r,pivotIndices:[a,a+1]}),f=l[a];if(f!=null){const d=r[a];re(d,`No panel data found for index "${a}"`),f.setAttribute("aria-controls",d.id),f.setAttribute("aria-valuemax",""+Math.round(c)),f.setAttribute("aria-valuemin",""+Math.round(h)),f.setAttribute("aria-valuenow",u!=null?""+Math.round(u):"")}}return()=>{l.forEach((a,c)=>{a.removeAttribute("aria-controls"),a.removeAttribute("aria-valuemax"),a.removeAttribute("aria-valuemin"),a.removeAttribute("aria-valuenow")})}},[t,i,r,s]),Ln(()=>{if(!s)return;const l=e.current;re(l,"Eager values not found");const{panelDataArray:a}=l,c=jm(t,s);re(c!=null,`No group found for id "${t}"`);const h=Cr(t,s);re(h,`No resize handles found for group id "${t}"`);const u=h.map(f=>{const d=f.getAttribute("data-panel-resize-handle-id");re(d,"Resize handle element has no handle id attribute");const[p,b]=fA(t,d,a,s);if(p==null||b==null)return()=>{};const m=x=>{if(!x.defaultPrevented)switch(x.key){case"Enter":{x.preventDefault();const y=a.findIndex(C=>C.id===p);if(y>=0){const C=a[y];re(C,`No panel data found for index ${y}`);const M=i[y],{collapsedSize:w=0,collapsible:A,minSize:k=0}=C.constraints;if(M!=null&&A){const L=Xi({delta:lt(M,w)?k-w:w-M,initialLayout:i,panelConstraints:a.map(R=>R.constraints),pivotIndices:zm(t,d,s),prevLayout:i,trigger:"keyboard"});i!==L&&o(L)}}break}}};return f.addEventListener("keydown",m),()=>{f.removeEventListener("keydown",m)}});return()=>{u.forEach(f=>f())}},[s,n,e,t,i,r,o])}function Au(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Hm(n,e){const t=n==="horizontal",{x:i,y:r}=fo(e);return t?i:r}function pA(n,e,t,i,r){const s=t==="horizontal",o=mo(e,r);re(o,`No resize handle element found for id "${e}"`);const l=o.getAttribute("data-panel-group-id");re(l,"Resize handle element has no group id attribute");let{initialCursorPosition:a}=i;const c=Hm(t,n),h=jm(l,r);re(h,`No group element found for id "${l}"`);const u=h.getBoundingClientRect(),f=s?u.width:u.height;return(c-a)/f*100}function mA(n,e,t,i,r,s){if(Tm(n)){const o=t==="horizontal";let l=0;n.shiftKey?l=100:r!=null?l=r:l=10;let a=0;switch(n.key){case"ArrowDown":a=o?0:l;break;case"ArrowLeft":a=o?-l:0;break;case"ArrowRight":a=o?l:0;break;case"ArrowUp":a=o?0:-l;break;case"End":a=100;break;case"Home":a=-100;break}return a}else return i==null?0:pA(n,e,t,i,s)}function gA({panelDataArray:n}){const e=Array(n.length),t=n.map(s=>s.constraints);let i=0,r=100;for(let s=0;s<n.length;s++){const o=t[s];re(o,`Panel constraints not found for index ${s}`);const{defaultSize:l}=o;l!=null&&(i++,e[s]=l,r-=l)}for(let s=0;s<n.length;s++){const o=t[s];re(o,`Panel constraints not found for index ${s}`);const{defaultSize:l}=o;if(l!=null)continue;const a=n.length-i,c=r/a;i++,e[s]=c,r-=c}return e}function Jn(n,e,t){e.forEach((i,r)=>{const s=n[r];re(s,`Panel data not found for index ${r}`);const{callbacks:o,constraints:l,id:a}=s,{collapsedSize:c=0,collapsible:h}=l,u=t[a];if(u==null||i!==u){t[a]=i;const{onCollapse:f,onExpand:d,onResize:p}=o;p&&p(i,u),h&&(f||d)&&(d&&(u==null||$t(u,c))&&!$t(i,c)&&d(),f&&(u==null||!$t(u,c))&&$t(i,c)&&f())}})}function os(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t])return!1;return!0}function bA({defaultSize:n,dragState:e,layout:t,panelData:i,panelIndex:r,precision:s=3}){const o=t[r];let l;return o==null?l=n!=null?n.toPrecision(s):"1":i.length===1?l="1":l=o.toPrecision(s),{flexBasis:0,flexGrow:l,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function xA(n,e=10){let t=null;return(...r)=>{t!==null&&clearTimeout(t),t=setTimeout(()=>{n(...r)},e)}}function Mu(n){try{if(typeof localStorage<"u")n.getItem=e=>localStorage.getItem(e),n.setItem=(e,t)=>{localStorage.setItem(e,t)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),n.getItem=()=>null,n.setItem=()=>{}}}function Fm(n){return`react-resizable-panels:${n}`}function Wm(n){return n.map(e=>{const{constraints:t,id:i,idIsFromProps:r,order:s}=e;return r?i:s?`${s}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(",")}function Vm(n,e){try{const t=Fm(n),i=e.getItem(t);if(i){const r=JSON.parse(i);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function yA(n,e,t){var i,r;const s=(i=Vm(n,t))!==null&&i!==void 0?i:{},o=Wm(e);return(r=s[o])!==null&&r!==void 0?r:null}function vA(n,e,t,i,r){var s;const o=Fm(n),l=Wm(e),a=(s=Vm(n,r))!==null&&s!==void 0?s:{};a[l]={expandToSizes:Object.fromEntries(t.entries()),layout:i};try{r.setItem(o,JSON.stringify(a))}catch(c){console.error(c)}}function Eu({layout:n,panelConstraints:e}){const t=[...n],i=t.reduce((s,o)=>s+o,0);if(t.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${t.map(s=>`${s}%`).join(", ")}`);if(!lt(i,100)&&t.length>0)for(let s=0;s<e.length;s++){const o=t[s];re(o!=null,`No layout data found for index ${s}`);const l=100/i*o;t[s]=l}let r=0;for(let s=0;s<e.length;s++){const o=t[s];re(o!=null,`No layout data found for index ${s}`);const l=ri({panelConstraints:e,panelIndex:s,size:o});o!=l&&(r+=o-l,t[s]=l)}if(!lt(r,0))for(let s=0;s<e.length;s++){const o=t[s];re(o!=null,`No layout data found for index ${s}`);const l=o+r,a=ri({panelConstraints:e,panelIndex:s,size:l});if(o!==a&&(r-=a-o,t[s]=a,lt(r,0)))break}return t}const wA=100,Qi={getItem:n=>(Mu(Qi),Qi.getItem(n)),setItem:(n,e)=>{Mu(Qi),Qi.setItem(n,e)}},Tu={};function $m({autoSaveId:n=null,children:e,className:t="",direction:i,forwardedRef:r,id:s=null,onLayout:o=null,keyboardResizeBy:l=null,storage:a=Qi,style:c,tagName:h="div",...u}){const f=ec(s),d=Ze(null),[p,b]=fi(null),[m,x]=fi([]),y=cA(),C=Ze({}),M=Ze(new Map),w=Ze(0),A=Ze({autoSaveId:n,direction:i,dragState:p,id:f,keyboardResizeBy:l,onLayout:o,storage:a}),k=Ze({layout:m,panelDataArray:[],panelDataArrayChanged:!1});Ze({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),Am(r,()=>({getId:()=>A.current.id,getLayout:()=>{const{layout:N}=k.current;return N},setLayout:N=>{const{onLayout:K}=A.current,{layout:$,panelDataArray:q}=k.current,J=Eu({layout:N,panelConstraints:q.map(le=>le.constraints)});Au($,J)||(x(J),k.current.layout=J,K&&K(J),Jn(q,J,C.current))}}),[]),Pn(()=>{A.current.autoSaveId=n,A.current.direction=i,A.current.dragState=p,A.current.id=f,A.current.onLayout=o,A.current.storage=a}),dA({committedValuesRef:A,eagerValuesRef:k,groupId:f,layout:m,panelDataArray:k.current.panelDataArray,setLayout:x,panelGroupElement:d.current}),Ln(()=>{const{panelDataArray:N}=k.current;if(n){if(m.length===0||m.length!==N.length)return;let K=Tu[n];K==null&&(K=xA(vA,wA),Tu[n]=K);const $=[...N],q=new Map(M.current);K(n,$,q,m,a)}},[n,m,a]),Ln(()=>{});const L=Qe(N=>{const{onLayout:K}=A.current,{layout:$,panelDataArray:q}=k.current;if(N.constraints.collapsible){const J=q.map(ht=>ht.constraints),{collapsedSize:le=0,panelSize:ge,pivotIndices:Me}=Cn(q,N,$);if(re(ge!=null,`Panel size not found for panel "${N.id}"`),!$t(ge,le)){M.current.set(N.id,ge);const ut=Qn(q,N)===q.length-1?ge-le:le-ge,we=Xi({delta:ut,initialLayout:$,panelConstraints:J,pivotIndices:Me,prevLayout:$,trigger:"imperative-api"});os($,we)||(x(we),k.current.layout=we,K&&K(we),Jn(q,we,C.current))}}},[]),R=Qe((N,K)=>{const{onLayout:$}=A.current,{layout:q,panelDataArray:J}=k.current;if(N.constraints.collapsible){const le=J.map($e=>$e.constraints),{collapsedSize:ge=0,panelSize:Me=0,minSize:ht=0,pivotIndices:ut}=Cn(J,N,q),we=K??ht;if($t(Me,ge)){const $e=M.current.get(N.id),Yt=$e!=null&&$e>=we?$e:we,Pi=Qn(J,N)===J.length-1?Me-Yt:Yt-Me,Le=Xi({delta:Pi,initialLayout:q,panelConstraints:le,pivotIndices:ut,prevLayout:q,trigger:"imperative-api"});os(q,Le)||(x(Le),k.current.layout=Le,$&&$(Le),Jn(J,Le,C.current))}}},[]),W=Qe(N=>{const{layout:K,panelDataArray:$}=k.current,{panelSize:q}=Cn($,N,K);return re(q!=null,`Panel size not found for panel "${N.id}"`),q},[]),H=Qe((N,K)=>{const{panelDataArray:$}=k.current,q=Qn($,N);return bA({defaultSize:K,dragState:p,layout:m,panelData:$,panelIndex:q})},[p,m]),D=Qe(N=>{const{layout:K,panelDataArray:$}=k.current,{collapsedSize:q=0,collapsible:J,panelSize:le}=Cn($,N,K);return re(le!=null,`Panel size not found for panel "${N.id}"`),J===!0&&$t(le,q)},[]),X=Qe(N=>{const{layout:K,panelDataArray:$}=k.current,{collapsedSize:q=0,collapsible:J,panelSize:le}=Cn($,N,K);return re(le!=null,`Panel size not found for panel "${N.id}"`),!J||Wn(le,q)>0},[]),V=Qe(N=>{const{panelDataArray:K}=k.current;K.push(N),K.sort(($,q)=>{const J=$.order,le=q.order;return J==null&&le==null?0:J==null?-1:le==null?1:J-le}),k.current.panelDataArrayChanged=!0,y()},[y]);Pn(()=>{if(k.current.panelDataArrayChanged){k.current.panelDataArrayChanged=!1;const{autoSaveId:N,onLayout:K,storage:$}=A.current,{layout:q,panelDataArray:J}=k.current;let le=null;if(N){const Me=yA(N,J,$);Me&&(M.current=new Map(Object.entries(Me.expandToSizes)),le=Me.layout)}le==null&&(le=gA({panelDataArray:J}));const ge=Eu({layout:le,panelConstraints:J.map(Me=>Me.constraints)});Au(q,ge)||(x(ge),k.current.layout=ge,K&&K(ge),Jn(J,ge,C.current))}}),Pn(()=>{const N=k.current;return()=>{N.layout=[]}},[]);const G=Qe(N=>{let K=!1;const $=d.current;return $&&window.getComputedStyle($,null).getPropertyValue("direction")==="rtl"&&(K=!0),function(J){J.preventDefault();const le=d.current;if(!le)return()=>null;const{direction:ge,dragState:Me,id:ht,keyboardResizeBy:ut,onLayout:we}=A.current,{layout:$e,panelDataArray:Yt}=k.current,{initialLayout:Ge}=Me??{},Pi=zm(ht,N,le);let Le=mA(J,N,ge,Me,ut,le);const Q=ge==="horizontal";Q&&K&&(Le=-Le);const Ir=Yt.map(qn=>qn.constraints),ke=Xi({delta:Le,initialLayout:Ge??$e,panelConstraints:Ir,pivotIndices:Pi,prevLayout:$e,trigger:Tm(J)?"keyboard":"mouse-or-touch"}),de=!os($e,ke);(Dm(J)||Rm(J))&&w.current!=Le&&(w.current=Le,!de&&Le!==0?Q?Yo(N,Le<0?Om:Lm):Yo(N,Le<0?Pm:Im):Yo(N,0)),de&&(x(ke),k.current.layout=ke,we&&we(ke),Jn(Yt,ke,C.current))}},[]),Z=Qe((N,K)=>{const{onLayout:$}=A.current,{layout:q,panelDataArray:J}=k.current,le=J.map($e=>$e.constraints),{panelSize:ge,pivotIndices:Me}=Cn(J,N,q);re(ge!=null,`Panel size not found for panel "${N.id}"`);const ut=Qn(J,N)===J.length-1?ge-K:K-ge,we=Xi({delta:ut,initialLayout:q,panelConstraints:le,pivotIndices:Me,prevLayout:q,trigger:"imperative-api"});os(q,we)||(x(we),k.current.layout=we,$&&$(we),Jn(J,we,C.current))},[]),E=Qe((N,K)=>{const{layout:$,panelDataArray:q}=k.current,{collapsedSize:J=0,collapsible:le}=K,{collapsedSize:ge=0,collapsible:Me,maxSize:ht=100,minSize:ut=0}=N.constraints,{panelSize:we}=Cn(q,N,$);we!=null&&(le&&Me&&$t(we,J)?$t(J,ge)||Z(N,ge):we<ut?Z(N,ut):we>ht&&Z(N,ht))},[Z]),O=Qe((N,K)=>{const{direction:$}=A.current,{layout:q}=k.current;if(!d.current)return;const J=mo(N,d.current);re(J,`Drag handle element not found for id "${N}"`);const le=Hm($,K);b({dragHandleId:N,dragHandleRect:J.getBoundingClientRect(),initialCursorPosition:le,initialLayout:q})},[]),j=Qe(()=>{b(null)},[]),Y=Qe(N=>{const{panelDataArray:K}=k.current,$=Qn(K,N);$>=0&&(K.splice($,1),delete C.current[N.id],k.current.panelDataArrayChanged=!0,y())},[y]),ee=JC(()=>({collapsePanel:L,direction:i,dragState:p,expandPanel:R,getPanelSize:W,getPanelStyle:H,groupId:f,isPanelCollapsed:D,isPanelExpanded:X,reevaluatePanelConstraints:E,registerPanel:V,registerResizeHandle:G,resizePanel:Z,startDragging:O,stopDragging:j,unregisterPanel:Y,panelGroupElement:d.current}),[L,p,i,R,W,H,f,D,X,E,V,G,Z,O,j,Y]),ue={display:"flex",flexDirection:i==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return Ai(uo.Provider,{value:ee},Ai(h,{...u,children:e,className:t,id:s,ref:d,style:{...ue,...c},"data-panel-group":"","data-panel-group-direction":i,"data-panel-group-id":f}))}const _m=km((n,e)=>Ai($m,{...n,forwardedRef:e}));$m.displayName="PanelGroup";_m.displayName="forwardRef(PanelGroup)";function Qn(n,e){return n.findIndex(t=>t===e||t.id===e.id)}function Cn(n,e,t){const i=Qn(n,e),s=i===n.length-1?[i-1,i]:[i,i+1],o=t[i];return{...e.constraints,panelSize:o,pivotIndices:s}}function SA({disabled:n,handleId:e,resizeHandler:t,panelGroupElement:i}){Ln(()=>{if(n||t==null||i==null)return;const r=mo(e,i);if(r==null)return;const s=o=>{if(!o.defaultPrevented)switch(o.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{o.preventDefault(),t(o);break}case"F6":{o.preventDefault();const l=r.getAttribute("data-panel-group-id");re(l,`No group element found for id "${l}"`);const a=Cr(l,i),c=Bm(l,e,i);re(c!==null,`No resize element found for id "${e}"`);const h=o.shiftKey?c>0?c-1:a.length-1:c+1<a.length?c+1:0;a[h].focus();break}}};return r.addEventListener("keydown",s),()=>{r.removeEventListener("keydown",s)}},[i,n,e,t])}function qm({children:n=null,className:e="",disabled:t=!1,hitAreaMargins:i,id:r,onBlur:s,onDragging:o,onFocus:l,style:a={},tabIndex:c=0,tagName:h="div",...u}){var f,d;const p=Ze(null),b=Ze({onDragging:o});Ln(()=>{b.current.onDragging=o});const m=Cm(uo);if(m===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:x,groupId:y,registerResizeHandle:C,startDragging:M,stopDragging:w,panelGroupElement:A}=m,k=ec(r),[L,R]=fi("inactive"),[W,H]=fi(!1),[D,X]=fi(null),V=Ze({state:L});Pn(()=>{V.current.state=L}),Ln(()=>{if(t)X(null);else{const O=C(k);X(()=>O)}},[t,k,C]);const G=(f=i==null?void 0:i.coarse)!==null&&f!==void 0?f:15,Z=(d=i==null?void 0:i.fine)!==null&&d!==void 0?d:5;return Ln(()=>{if(t||D==null)return;const O=p.current;return re(O,"Element ref not attached"),aA(k,O,x,{coarse:G,fine:Z},(Y,ee,ue)=>{if(ee)switch(Y){case"down":{R("drag"),re(ue,'Expected event to be defined for "down" action'),M(k,ue);const{onDragging:N}=b.current;N&&N(!0);break}case"move":{const{state:N}=V.current;N!=="drag"&&R("hover"),re(ue,'Expected event to be defined for "move" action'),D(ue);break}case"up":{R("hover"),w();const{onDragging:N}=b.current;N&&N(!1);break}}else R("inactive")})},[G,x,t,Z,C,k,D,M,w]),SA({disabled:t,handleId:k,resizeHandler:D,panelGroupElement:A}),Ai(h,{...u,children:n,className:e,id:r,onBlur:()=>{H(!1),s==null||s()},onFocus:()=>{H(!0),l==null||l()},ref:p,role:"separator",style:{...{touchAction:"none",userSelect:"none"},...a},tabIndex:c,"data-panel-group-direction":x,"data-panel-group-id":y,"data-resize-handle":"","data-resize-handle-active":L==="drag"?"pointer":W?"keyboard":void 0,"data-resize-handle-state":L,"data-panel-resize-handle-enabled":!t,"data-panel-resize-handle-id":k})}qm.displayName="PanelResizeHandle";const kA=({className:n,...e})=>g.jsx(_m,{className:xt("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",n),...e}),Du=Em,CA=({withHandle:n,className:e,...t})=>g.jsx(qm,{className:xt("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",e),...t,children:n&&g.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:g.jsx(ng,{className:"h-2.5 w-2.5"})})});function AA(){const[n,e]=S.useState(""),[t,i]=S.useState(!1),[r,s]=S.useState(!0),[o,l]=S.useState(!1),a=S.useRef(null),c=Za();S.useEffect(()=>{var b;const p=localStorage.getItem("editorCode");p&&(e(p),i(!0),localStorage.removeItem("editorCode"),(b=a.current)==null||b.writeSystem("Example code loaded!"))},[]);const h=async p=>{try{return c.evaluate(p)}catch(b){throw new Error(b instanceof Error?b.message:"An error occurred")}},u=()=>{var p,b,m,x;try{if(!n.trim()){(p=a.current)==null||p.writeSystem("No code to run. Please write some code in the editor first.");return}(b=a.current)==null||b.writeSystem("Running code from editor...");const y=c.evaluate(n);(m=a.current)==null||m.writeOutput(y)}catch(y){(x=a.current)==null||x.writeOutput(`Error: ${y instanceof Error?y.message:"An error occurred while running editor code"}`)}},f=()=>{s(!r)},d=()=>{l(!o)};return g.jsx("div",{className:`${o?"fixed inset-0 z-50 bg-white":"h-[calc(100vh-8rem)]"}`,children:g.jsxs("div",{className:"flex flex-col gap-4 h-full p-4",children:[g.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 px-3 py-2 border rounded-lg",children:[g.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Editor"}),g.jsx(Te,{variant:"ghost",size:"sm",onClick:f,className:"h-7 px-2 hover:bg-slate-200",children:r?g.jsx(ig,{className:"h-4 w-4"}):g.jsx(rg,{className:"h-4 w-4"})}),g.jsx(Te,{variant:"ghost",size:"sm",onClick:d,className:"h-7 px-2 hover:bg-slate-200",children:o?g.jsx(sg,{className:"h-4 w-4"}):g.jsx(og,{className:"h-4 w-4"})}),g.jsx("div",{className:"flex-1"}),g.jsx(Te,{variant:"outline",size:"sm",onClick:u,className:"h-7 w-7 p-0 flex items-center justify-center bg-green-50 hover:bg-green-100 text-green-700 border-green-200",title:"Run editor code",children:g.jsx(ta,{className:"h-4 w-4"})})]}),g.jsx("div",{className:"flex-1 min-h-0 border rounded-lg bg-zinc-900 overflow-hidden",children:g.jsxs(kA,{direction:"vertical",children:[g.jsx(Du,{defaultSize:50,minSize:30,className:r?"":"hidden",children:g.jsx(Xa,{value:n,onChange:e,height:"100%",fullEditor:!0})}),g.jsx(CA,{className:r?"h-2 bg-zinc-800 hover:bg-zinc-700":"hidden"}),g.jsx(Du,{defaultSize:100,minSize:20,children:g.jsx(Qa,{ref:a,onCommand:h,className:"h-full"})})]})})]})})}const MA=[{name:"Hello World",code:'(display "Hello, World!")',description:"A simple greeting program demonstrating basic output",difficulty:"Beginner"},{name:"Factorial Function",code:`(define factorial
  (lambda (n)
    (if (<= n 1)
        1
        (* n (factorial (- n 1))))))`,description:"Recursive function to calculate factorials",difficulty:"Intermediate"},{name:"List Operations",code:`(define numbers '(1 2 3 4 5))
(map (lambda (x) (* x x)) numbers)`,description:"Working with lists and mapping functions",difficulty:"Intermediate"},{name:"Fibonacci Sequence",code:`(define fib
  (lambda (n)
    (if (< n 2)
        n
        (+ (fib (- n 1))
           (fib (- n 2))))))`,description:"Classic recursive Fibonacci implementation",difficulty:"Advanced"},{name:"Define your own Syntax",code:`(define-syntax begin
    (syntax-rules ()
        ((begin expr)
        (expr))
    ((begin expr expr2 ...)
        ((let ((dummy expr))
        (begin expr2 ...))))))

(begin (display "Hello, World!") (newline))`,description:"Scheme allows for defining of own syntax",difficulty:"Advanced"},{name:"Syntax with syntax within it",code:`(define-syntax begin
    (syntax-rules ()
        ((begin expr)
        (expr))
    ((begin expr expr2 ...)
        ((let ((dummy expr))
        (begin expr2 ...))))))

(begin (display "Hello, World!") (newline))

(define-syntax cond
    (syntax-rules(else)
        ((cond)(#f))
        ((cond(else expr ...))
            (begin expr ...))
        ((cond(test expr ... ) clause ...)
        (if test
            (begin expr ...)
            (cond clause ...)))))

(cond ((< 5 3) (display "Impossible!"))
      ((= 5 5) (display "Math works!"))
      (else (display "Default case")))`,description:"Create syntax which contains other syntax",difficulty:"Advanced"},{name:"Build your own higher order functions",code:`(define map1
    (lambda (p ls)
        (if (null? ls)
            ls
        (cons (p (car ls))
            (map1 p 
                (cdr ls))))))

(map1 (lambda (x) (* x x)) '(1 4 8 16))`,description:"If inbuilt map is not your thing build your own!",difficulty:"Advanced"},{name:"Let Syntax Implementation",code:`(define-syntax myLet
    (syntax-rules ()
        ((myLet ((var val) ...) body ...)
            ((lambda(var ...) body ...) val ...))))

(myLet ((x 10) (y 20)) ((display (+ x y))))`,description:"Implementing let using syntax rules",difficulty:"Advanced"}];function Um({difficulty:n}){const e={Beginner:"text-green-600 bg-green-50",Intermediate:"text-blue-600 bg-blue-50",Advanced:"text-purple-600 bg-purple-50"};return g.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${e[n]}`,children:n})}function EA({example:n,onTryExample:e}){const t=Ti(),i=()=>{localStorage.setItem("compiler-explorer-code",n.code),t("/compiler-explorer")};return g.jsxs(Gs,{className:"bg-white text-slate-800 border border-slate-200 shadow-lg transition-all duration-300 hover:-translate-y-1",children:[g.jsx(ca,{className:"pb-4",children:g.jsxs("div",{className:"flex items-start justify-between",children:[g.jsxs("div",{children:[g.jsx(ha,{className:"text-xl font-semibold text-slate-900 mb-1",children:n.name}),g.jsx(ua,{className:"text-base text-slate-600",children:n.description})]}),g.jsx(Um,{difficulty:n.difficulty})]})}),g.jsxs(Js,{className:"pt-0 space-y-4",children:[g.jsx("div",{className:"bg-zinc-900 rounded-lg p-4 font-mono text-sm overflow-x-auto",children:g.jsx(Dt,{text:n.code,type:"input"})}),g.jsxs("div",{className:"flex flex-wrap gap-3",children:[g.jsxs(Te,{onClick:()=>e(n.code),className:`bg-[#dd3f0c] text-white hover:opacity-90 flex items-center gap-2 
                                transition-all duration-200 hover:-translate-y-1 text-base font-medium`,children:["Try It ",g.jsx(ys,{className:"h-4 w-4"})]}),g.jsxs(Te,{onClick:i,className:`bg-blue-900 text-white hover:bg-blue-800 flex items-center gap-2
                                transition-all duration-200 hover:-translate-y-1 text-base font-medium`,children:[g.jsx(Lu,{className:"h-4 w-4"})," Compiler Explorer"]})]})]})]})}function TA(){const n=Ti(),e=t=>{localStorage.setItem("editorCode",t),n("/editor")};return g.jsxs("div",{className:"min-h-screen bg-white",children:[g.jsx("div",{className:"container mx-auto px-4 py-12",children:g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"flex flex-col gap-2 animate-fadeSlideIn",children:[g.jsx("h1",{className:"text-2xl md:text-3xl font-semibold text-slate-900",children:"Example Programs"}),g.jsx("p",{className:"text-base text-slate-600",children:'Learn Scheme through practical examples. Click "Try It" to load any example into the editor.'})]}),g.jsx("div",{className:"grid gap-6",children:MA.map((t,i)=>g.jsx("div",{className:"animate-fadeScale",style:{animationDelay:`${i*.1}s`},children:g.jsx(EA,{example:t,onTryExample:e})},i))})]})}),g.jsx(Xs,{})]})}const DA=lg,Km=S.forwardRef(({className:n,...e},t)=>g.jsx(Pu,{ref:t,className:xt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",n),...e}));Km.displayName=Pu.displayName;const Zn=S.forwardRef(({className:n,...e},t)=>g.jsx(Iu,{ref:t,className:xt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",n),...e}));Zn.displayName=Iu.displayName;const ei=S.forwardRef(({className:n,...e},t)=>g.jsx(Bu,{ref:t,className:xt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),...e}));ei.displayName=Bu.displayName;const RA=`(define factorial
  (lambda (n)
    (if (= n 0)
        1
        (* n (factorial (- n 1))))))

(factorial 5)`,NA=()=>{const[n,e]=S.useState(RA),[t,i]=S.useState({ast:"",macroExpanded:"",anf:"",optimizedANF:"",threeAC:"",result:""}),[r,s]=S.useState(!1),o=Za(),l=Ti();S.useEffect(()=>{const c=localStorage.getItem("compiler-explorer-code");c&&(e(c),localStorage.removeItem("compiler-explorer-code"))},[]);const a=()=>{if(!(!o||o.loading)){s(!0);try{const c=o.evaluate(n);i({ast:o.getAST(n),macroExpanded:o.getMacroExpanded(n),anf:o.getANF(n),optimizedANF:o.getOptimizedANF(n),threeAC:o.getThreeAC(n),result:c})}catch(c){console.error("Compilation error:",c),i({...t,result:`Error: ${c instanceof Error?c.message:String(c)}`})}finally{s(!1)}}};return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-blue-900 flex flex-col",children:[g.jsxs("div",{className:"flex border-b border-blue-700/30 bg-slate-900/80 p-4 items-center gap-2",children:[g.jsx(Te,{variant:"ghost",size:"icon",onClick:()=>l("/"),className:"text-white hover:bg-blue-800/30",children:g.jsx(zu,{className:"h-5 w-5"})}),g.jsxs("h1",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[g.jsx(_t,{className:"h-5 w-5",style:{color:"#22d3ee"}}),"Scheme Compiler Explorer"]})]}),g.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-slate-900/70",children:[g.jsx("div",{className:"p-4 flex justify-end border-b border-blue-700/30",children:g.jsxs(Te,{onClick:a,className:"bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white hover:-translate-y-1 transition-all duration-200 flex items-center gap-2 shadow-lg",disabled:(o==null?void 0:o.loading)||r,children:[g.jsx(ta,{className:`h-4 w-4 ${o!=null&&o.loading||r?"animate-spin":""}`}),o!=null&&o.loading?"Loading Interpreter...":r?"Compiling...":"Compile"]})}),g.jsx("div",{className:"border-b border-blue-700/30 p-4 h-[25%]",children:g.jsx("div",{className:"h-full bg-zinc-800/80 rounded-lg overflow-hidden shadow-lg border border-blue-700/30",children:g.jsx(Xa,{value:n,onChange:e,height:"100%",fullEditor:!0})})}),g.jsx("div",{className:"flex-1 min-h-0 h-[60%] border-b border-blue-700/30",children:g.jsxs(DA,{defaultValue:"ast",className:"h-full",children:[g.jsx("div",{className:"border-b border-blue-700/30",children:g.jsxs(Km,{className:"bg-transparent w-full h-12 p-0",children:[g.jsx(Zn,{value:"ast",className:"data-[state=active]:bg-[#dd3f0c]/90 data-[state=active]:text-white rounded-none border-r border-blue-700/30 text-blue-100/70 hover:text-white",children:"Abstract Syntax Tree"}),g.jsx(Zn,{value:"macro",className:"data-[state=active]:bg-[#dd3f0c]/90 data-[state=active]:text-white rounded-none border-r border-blue-700/30 text-blue-100/70 hover:text-white",children:"Macro Expanded"}),g.jsx(Zn,{value:"anf",className:"data-[state=active]:bg-[#dd3f0c]/90 data-[state=active]:text-white rounded-none border-r border-blue-700/30 text-blue-100/70 hover:text-white",children:"ANF Form"}),g.jsx(Zn,{value:"optimized",className:"data-[state=active]:bg-[#dd3f0c]/90 data-[state=active]:text-white rounded-none border-r border-blue-700/30 text-blue-100/70 hover:text-white",children:"Optimized ANF"}),g.jsx(Zn,{value:"threac",className:"data-[state=active]:bg-[#dd3f0c]/90 data-[state=active]:text-white rounded-none border-r border-blue-700/30 text-blue-100/70 hover:text-white",children:"Three-Address Code"})]})}),g.jsxs("div",{className:"h-[calc(100%-48px)] overflow-auto p-4",children:[g.jsx(ei,{value:"ast",className:"mt-0 h-full",children:g.jsx("div",{className:"code-font text-blue-100 h-full bg-zinc-800/80 rounded-lg p-4 overflow-auto border border-blue-700/30",children:g.jsx(Dt,{text:t.ast,type:"input"})})}),g.jsx(ei,{value:"macro",className:"mt-0 h-full",children:g.jsx("div",{className:"code-font text-blue-100 h-full bg-zinc-800/80 rounded-lg p-4 overflow-auto border border-blue-700/30",children:g.jsx(Dt,{text:t.macroExpanded,type:"input"})})}),g.jsx(ei,{value:"anf",className:"mt-0 h-full",children:g.jsx("div",{className:"code-font text-blue-100 h-full bg-zinc-800/80 rounded-lg p-4 overflow-auto border border-blue-700/30",children:g.jsx(Dt,{text:t.anf,type:"input"})})}),g.jsx(ei,{value:"optimized",className:"mt-0 h-full",children:g.jsx("div",{className:"code-font text-blue-100 h-full bg-zinc-800/80 rounded-lg p-4 overflow-auto border border-blue-700/30",children:g.jsx(Dt,{text:t.optimizedANF,type:"input"})})}),g.jsx(ei,{value:"threac",className:"mt-0 h-full",children:g.jsx("div",{className:"code-font text-blue-100 h-full bg-zinc-800/80 rounded-lg p-4 overflow-auto border border-blue-700/30",children:g.jsx(Dt,{text:t.threeAC,type:"input"})})})]})]})}),g.jsx("div",{className:"p-4 h-[15%] overflow-auto",children:g.jsx("div",{className:"code-font text-green-400 bg-zinc-800/80 rounded-lg p-4 h-full overflow-auto border border-blue-700/30",children:g.jsx(Dt,{text:t.result,type:"output"})})})]}),g.jsx(Xs,{})]})},Xo=[{id:"basics",title:"Scheme Basics",description:"Learn the fundamentals of Scheme programming",sections:[{id:"intro",title:"Introduction to Scheme",content:"Scheme is a dialect of Lisp that supports multiple paradigms with a focus on functional programming. It is known for its simplicity, elegance, and powerful features such as first-class functions, lexical scoping, and proper tail recursion. Scheme was initially designed for education and research, making it an excellent language for learning programming concepts.",codeExamples:[{description:"Your first Scheme program:",code:'(display "Hello, World!")',explanation:`This example uses the display procedure to output the string "Hello, World!" to the console. It's the traditional first program in any language.`}],difficulty:"Beginner"},{id:"data-types",title:"Data Types",content:["Scheme has several basic data types including numbers, strings, symbols, and lists. Numbers include integers, floating-point, rationals, and complex. Strings are sequences of characters.","Symbols are identifiers that are typically used for variables and function names. They are unique objects in memory - when two symbols have the same name, they reference the same object.","Lists are the fundamental data structure in Scheme, represented with parentheses. They can contain elements of any type, including other lists."],codeExamples:[{description:"Working with numbers:",code:`; Integer addition
(+ 1 2)`,explanation:"In Scheme, operators like + are functions that are placed before their arguments. This expression adds 1 and 2, resulting in 3."},{description:"Multiplication:",code:`; Multiplication
(* 3 4)`,explanation:"The * function multiplies its arguments together. This expression computes 3 × 4, resulting in 12."},{description:"Subtraction:",code:`; Subtraction
(- 10 5)`,explanation:"The - function subtracts the second number from the first. This computes 10 - 5, resulting in 5."},{description:"Division:",code:`; Division
(/ 10 2)`,explanation:"The / function divides the first number by the second. This calculates 10 ÷ 2, resulting in 5."},{description:"String concatenation:",code:`; Joining strings
(string-append "Hello" " " "World")`,explanation:'The string-append function joins multiple strings together. This combines "Hello", a space, and "World" to create "Hello World".'},{description:"String length:",code:`; Finding string length
(string-length "Hello")`,explanation:'The string-length function counts the number of characters in a string. "Hello" has 5 characters.'},{description:"Creating a list:",code:`; Creating a list
(define my-list (list 1 2 3))
my-list`,explanation:"This creates a list of three numbers using the list function and assigns it to the variable my-list. The second line returns the list (1 2 3)."},{description:"Getting the first element (car):",code:`; First element of a list
(define my-list (list 1 2 3))
(car my-list)`,explanation:"The car function returns the first element of a list. For the list (1 2 3), the car is 1."},{description:"Getting all but the first element (cdr):",code:`; All but first element
(define my-list (list 1 2 3))
(cdr my-list)`,explanation:"The cdr function returns the rest of a list after the first element. For the list (1 2 3), the cdr is (2 3)."}],difficulty:"Beginner"},{id:"quoting",title:"Quoting and Evaluation",content:["In Scheme, expressions are normally evaluated to produce values. However, sometimes you want to treat code as data rather than evaluating it.","Quoting is a mechanism that prevents evaluation, allowing you to use symbols and lists as literal data. The quote special form (or its shorthand, the single quote ') treats its argument as literal data instead of evaluating it.","This concept is fundamental to metaprogramming in Scheme, especially for macros which transform code before it's evaluated."],codeExamples:[{description:"Expression without quoting (evaluates):",code:`; Evaluates the expression
(+ 1 2)`,explanation:"Without quoting, this expression is evaluated normally, calling the + function with arguments 1 and 2, resulting in 3."},{description:"Same expression with quoting (doesn't evaluate):",code:`; Returns the expression as data
'(+ 1 2)`,explanation:"With quoting, the expression is treated as data instead of being evaluated. This returns the list (+ 1 2) rather than computing the sum."},{description:"Explicit quote form:",code:`; Using the quote special form
(quote (+ 1 2))`,explanation:"This is the full form of quoting. It's equivalent to '(+ 1 2) and returns the list (+ 1 2) without evaluation."},{description:"Quoting a symbol:",code:`; Symbol literal
'abc`,explanation:"Quoting a symbol name creates a symbol. Without the quote, abc would be treated as a variable name."},{description:"Quoting a list:",code:`; List literal
'(a b c)`,explanation:"This creates a list containing three symbols: a, b, and c. Without quoting, Scheme would try to call function a with arguments b and c."},{description:"Quoting a list of numbers:",code:`; List of numbers
'(1 2 3)`,explanation:"This creates a list containing the numbers 1, 2, and 3 as data. Numbers are self-evaluating, but quoting still prevents the list from being treated as a function call."},{description:"Setting up for quasiquoting:",code:`; Define variables for the next examples
(define x 5)
(define y 10)
x`,explanation:"This defines two variables, x with value 5 and y with value 10, for use in the next examples. The last line returns the value of x."},{description:"Quasiquoting with unquoting:",code:"; Quasiquote (backtick) with unquote (comma)\n`(x is ,x and y is ,y)",explanation:"Quasiquote (backtick) works like quote, but allows selective evaluation using unquote (comma). Here, the symbols x and y remain as symbols, but their values (5 and 10) are inserted at the comma positions."},{description:"Setting up for unquote-splicing:",code:`; Define a list for splicing
(define nums '(1 2 3))
nums`,explanation:"This defines a variable nums containing the list (1 2 3) for use in the next example."},{description:"Unquote-splicing example:",code:"; Using unquote-splicing (,@) for lists\n`(The numbers are: ,@nums)",explanation:"Unquote-splicing (,@) inserts each element of a list into the surrounding list. This results in (The numbers are: 1 2 3) rather than (The numbers are: (1 2 3))."}],difficulty:"Beginner"}]},{id:"functions",title:"Functions & Procedures",description:"Master function definition and usage in Scheme",sections:[{id:"defining-functions",title:"Defining Functions",content:"Functions in Scheme are defined using the define keyword. Scheme functions (also called procedures) can take any number of parameters and return a value. In Scheme, functions are first-class objects, meaning they can be passed as arguments, returned from other functions, and assigned to variables.",codeExamples:[{description:"Defining a simple function:",code:`; Define a function to square a number
(define (square x)
  (* x x))`,explanation:"This defines a function named square that takes one parameter x and returns the result of multiplying x by itself. The (define (square x) ...) syntax is shorthand for (define square (lambda (x) ...))."},{description:"Using the function:",code:`; Call the square function
(square 5)`,explanation:"This calls the square function with the argument 5. The function returns 5 × 5, which is 25."}],difficulty:"Beginner"},{id:"lambda",title:"Lambda Expressions",content:"Lambda expressions allow you to create anonymous functions in Scheme. These are useful for creating functions that are used only once or as arguments to higher-order functions. The syntax is (lambda (parameters) body).",codeExamples:[{description:"Creating an anonymous function:",code:`; Anonymous function expression
(lambda (x) (* x x))`,explanation:"This creates an anonymous function that squares its argument. The function isn't called or bound to a name; it's just a value."},{description:"Using a lambda expression directly:",code:`; Applying a lambda directly
((lambda (x) (* x x)) 5)`,explanation:"This creates an anonymous squaring function and immediately applies it to the argument 5. The extra parentheses cause the lambda to be evaluated and then called with 5."},{description:"Assigning a lambda to a variable:",code:`; Defining a function with lambda
(define square (lambda (x) (* x x)))`,explanation:"This creates a lambda expression and binds it to the name square. This is equivalent to the square function definition we saw earlier, but written with the explicit lambda form."},{description:"Using the function:",code:`; Using the lambda-defined function
(square 5)`,explanation:"This calls the square function created with lambda, passing the argument 5. The function returns 25, just like the previous square function."}],difficulty:"Intermediate"},{id:"higher-order",title:"Higher-Order Functions",content:["Higher-order functions are functions that operate on other functions, either by taking functions as arguments or returning functions as results.","This concept is central to functional programming and enables powerful abstractions. Common higher-order functions in Scheme include map, filter, and fold, which apply operations to elements in lists."],codeExamples:[{description:"Defining a list for our examples:",code:`; Create a list of numbers
(define numbers '(1 2 3 4 5))
numbers`,explanation:"This creates a list of numbers from 1 to 5 and assigns it to the variable numbers. We'll use this list in the following examples."},{description:"Using map:",code:`; Map doubles each element
(map (lambda (x) (* x 2)) numbers)`,explanation:"The map function applies a given function to each element in a list. Here, we're applying an anonymous function that doubles its input to each number in our list, resulting in (2 4 6 8 10)."},{description:"Defining a predicate function:",code:`; Define a predicate for even numbers
(define (even? x) (= (remainder x 2) 0))`,explanation:"This defines a predicate function named even? that returns #t if its argument is even and #f otherwise. It works by checking if the remainder when dividing by 2 is zero."},{description:"Using filter:",code:`; Filter keeps only even numbers
(filter even? '(1 2 3 4 5 6))`,explanation:"The filter function creates a new list containing only the elements that satisfy a predicate. Here, we're keeping only the even numbers from the list, resulting in (2 4 6)."},{description:"Using fold to sum elements:",code:`; Fold/reduce to sum all elements
(fold-left + 0 '(1 2 3 4 5))`,explanation:"The fold-left function combines list elements using a binary function. Starting with an initial value (0), it applies the function (+) between the accumulator and each element. This computes 0+1+2+3+4+5=15."},{description:"Using fold to reverse a list:",code:`; Using fold to reverse a list
(fold-left (lambda (acc x) (cons x acc)) '() '(1 2 3 4))`,explanation:"This uses fold-left to build a reversed list. Starting with an empty list, for each element x, we cons x onto the front of our accumulated list, resulting in (4 3 2 1)."}],difficulty:"Intermediate"},{id:"variable-bindings",title:"Variable Binding Forms",content:["Scheme provides several special forms for creating local variables with different scoping rules. The basic form is let, which binds variables in parallel. Two variations are let* (sequential binding) and letrec (recursive binding).","Understanding these binding forms is essential for managing variable scope and creating complex algorithms in Scheme. Each has specific use cases where it is most appropriate."],codeExamples:[{description:"Basic let binding:",code:`; Simple parallel binding
(let ((x 5)
      (y 10))
  (+ x y))`,explanation:"The let form creates local variables with specific values. Here, x is bound to 5 and y to 10, and then we compute x + y, which is 15."},{description:"Limitation of let (parallel evaluation):",code:`; This will cause an error
; (let ((x 5)
;       (y (* x 2)))
;   (+ x y))

; Instead, we can do:
(define x 5)
(let ((y (* x 2)))
  (+ x y))`,explanation:"In let, all bindings are evaluated before any of them are available. We can't reference earlier bindings within the binding list. The commented code would fail because x isn't defined when computing y. The alternative defines x globally first."},{description:"Using let* for sequential binding:",code:`; Sequential binding with let*
(let* ((x 5)
       (y (* x 2))
       (z (+ x y)))
  z)`,explanation:"The let* form evaluates bindings in sequence, making earlier bindings available to later ones. Here, x is bound to 5, then y to 10 (5×2), and z to 15 (5+10). The result is 15."},{description:"Equivalent nested lets:",code:`; Equivalent to the previous let*
(let ((x 5))
  (let ((y (* x 2)))
    (let ((z (+ x y)))
      z)))`,explanation:"This shows how let* works internally. It's equivalent to nested let forms, where each new binding is made inside the scope of the previous ones."},{description:"Using letrec for recursive definitions:",code:`; Creating mutually recursive functions
(letrec ((even? (lambda (n)
                  (if (zero? n)
                      #t
                      (odd? (- n 1)))))
         (odd? (lambda (n)
                 (if (zero? n)
                     #f
                     (even? (- n 1))))))
  (even? 4))`,explanation:"The letrec form allows bindings to reference each other, which is essential for mutually recursive functions. Here, even? calls odd? and vice versa. This determines that 4 is even by recursively checking if 0 is even (which it is by definition)."}],difficulty:"Intermediate"}]},{id:"advanced",title:"Advanced Concepts",description:"Explore powerful features of the Scheme language",sections:[{id:"macros",title:"Macros and Syntax Rules",content:["Macros are one of Scheme's most powerful features, allowing you to extend the language by creating new syntactic forms. Unlike functions, macros operate on code before it's evaluated, enabling transformations that would be impossible with functions alone.","The define-syntax and syntax-rules forms provide a pattern-based system for defining macros. Patterns specify what the macro matches, and templates specify how to transform the code."],codeExamples:[{description:"Defining a simple when macro:",code:`; Define the when macro
(define-syntax when
  (syntax-rules ()
    ((when condition body ...)
     (if condition
         (begin body ...)))))`,explanation:"This defines a when macro that executes a series of expressions only if a condition is true. The syntax-rules specify that when takes a condition followed by any number of body expressions, and transforms this into an if with a begin for the body."},{description:"Using the when macro:",code:`; Using our when macro
(when (> 5 3)
  (display "5 is greater than 3")
  (newline))`,explanation:"This uses our when macro with the condition (> 5 3) and two body expressions. Since 5 is greater than 3, both expressions will execute, displaying the text and a newline."},{description:"Defining a cond macro:",code:`; Define a simplified cond macro
(define-syntax cond
  (syntax-rules (else)
    ((cond) #f)  ; No clauses
    ((cond (else result1 result2 ...))
     (begin result1 result2 ...))
    ((cond (test result1 result2 ...) clause ...)
     (if test
         (begin result1 result2 ...)
         (cond clause ...)))))`,explanation:'This defines a cond macro for multi-way conditionals. It handles three cases: empty cond (returns #f), an else clause (executes its body), and a test clause (converts to an if-then-else where the "else" recursively processes remaining clauses).'},{description:"Using the cond macro:",code:`; Using our cond macro
(define x 5)
(cond
  ((< x 0) "negative")
  ((> x 0) "positive")
  (else "zero"))`,explanation:'This uses our cond macro to check if x is negative, positive, or zero. Since x is 5, the second clause matches, so it returns "positive".'},{description:"Implementing let* with macros:",code:`; Implementing let* as a macro
(define-syntax let*
  (syntax-rules ()
    ((let* () body ...)
     (begin body ...))
    ((let* ((name value)) body ...)
     (let ((name value))
       body ...))
    ((let* ((name1 value1) (name2 value2) rest ...) body ...)
     (let ((name1 value1))
       (let* ((name2 value2) rest ...)
         body ...)))))`,explanation:"This implements let* as a macro that transforms nested bindings into nested let expressions. It handles three cases: empty bindings (just execute the body), one binding (use a simple let), and multiple bindings (use a let for the first binding and recursively process the rest)."},{description:"Using our let* implementation:",code:`; Try our let* implementation
(let* ((a 5)
       (b (+ a 2))
       (c (* a b)))
  (+ a b c))`,explanation:"This uses our let* implementation to create three variables: a=5, b=7 (5+2), and c=35 (5×7). Then it computes a+b+c, which is 5+7+35=47."},{description:"Implementing letrec with macros:",code:`; Implementing letrec as a macro
(define-syntax letrec
  (syntax-rules ()
    ((letrec ((var val) ...) body ...)
     ((lambda ()
        ; First create uninitialized variables
        (define var #f) ...
        ; Then assign them their values
        (set! var val) ...
        ; Finally, execute the body
        body ...)))))`,explanation:"This implements letrec as a macro using a lambda and define/set! combination. It first creates all variables with dummy values (#f), then sets their actual values, allowing recursive references."},{description:"Using our letrec implementation:",code:`; Using our letrec implementation
(letrec ((is-even? (lambda (n)
                    (if (zero? n)
                        #t
                        (is-odd? (- n 1)))))
         (is-odd? (lambda (n)
                   (if (zero? n)
                       #f
                       (is-even? (- n 1))))))
  (is-even? 6))`,explanation:"This uses our letrec implementation to define mutually recursive functions is-even? and is-odd?. Then it calls is-even? with 6, which recursively checks if 5 is odd, 4 is even, etc., eventually returning #t."}],difficulty:"Advanced"},{id:"recursion",title:"Recursion Patterns",content:"Scheme excels at recursive solutions due to its proper tail call optimization. This section covers common recursion patterns and techniques for efficient recursive algorithms.",codeExamples:[{description:"Defining a recursive factorial function:",code:`; Recursive factorial function
(define factorial
  (lambda (n)
    (if (<= n 1)
        1
        (* n (factorial (- n 1))))))`,explanation:"This defines a recursive function to compute the factorial of a number. If n is 0 or 1, it returns 1; otherwise, it multiplies n by the factorial of (n-1)."},{description:"Computing factorial of 5:",code:`; Calculate 5!
(factorial 5)`,explanation:"This calls our factorial function with the argument 5. It computes 5×4×3×2×1=120."},{description:"Recursive list length:",code:`; Recursive function to find list length
(define (my-length lst)
  (if (null? lst)
      0
      (+ 1 (my-length (cdr lst)))))`,explanation:"This defines a recursive function to compute the length of a list. If the list is empty, the length is 0; otherwise, it's 1 plus the length of the list's cdr (rest)."},{description:"Using the list length function:",code:`; Find length of a list
(my-length '(a b c d))`,explanation:"This calls our my-length function on a list with 4 elements. The function returns 4."}],difficulty:"Intermediate"},{id:"tail-recursion",title:"Tail Recursion Optimization",content:["Tail recursion is a special case of recursion where the recursive call is the last operation in a function. Scheme implementations are required to optimize tail-recursive calls, turning them into iterations that don't grow the call stack.","This optimization allows writing elegant recursive algorithms that are also efficient, even for large inputs or deep recursion levels. Understanding and applying tail recursion is crucial for writing efficient recursive code in Scheme."],codeExamples:[{description:"Standard recursive factorial (not tail-recursive):",code:`; Standard recursive factorial
(define (factorial n)
  (if (<= n 1)
      1
      (* n (factorial (- n 1)))))`,explanation:"This is a standard recursive factorial function. The recursive call is not in tail position because after (factorial (- n 1)) returns, there's still a multiplication to perform. This means the call stack grows with n."},{description:"Tail-recursive factorial implementation:",code:`; Tail-recursive factorial
(define (factorial-tail n)
  (define (fact-iter n acc)
    (if (<= n 1)
        acc
        (fact-iter (- n 1) (* n acc))))
  (fact-iter n 1))`,explanation:"This is a tail-recursive factorial. It uses a helper function that carries an accumulator. Since the recursive call is the last operation, Scheme optimizes it to use constant stack space regardless of n."},{description:"Using the tail-recursive factorial:",code:`; Calculate 5! using tail recursion
(factorial-tail 5)`,explanation:"This calls our tail-recursive factorial function with argument 5. It computes 5! = 120, just like the standard version, but more efficiently for large inputs."},{description:"Standard recursive sum (not tail-recursive):",code:`; Recursive sum (not tail-recursive)
(define (sum-list lst)
  (if (null? lst)
      0
      (+ (car lst) (sum-list (cdr lst)))))`,explanation:"This is a standard recursive function to sum a list. Like the standard factorial, it's not tail-recursive because there's an addition to perform after the recursive call returns."},{description:"Testing the recursive sum:",code:`; Test the recursive sum
(sum-list '(1 2 3 4 5))`,explanation:"This calls our sum-list function on a list of numbers. It computes 1+2+3+4+5=15."},{description:"Tail-recursive sum implementation:",code:`; Tail-recursive sum
(define (sum-list-tail lst)
  (define (sum-iter lst acc)
    (if (null? lst)
        acc
        (sum-iter (cdr lst) (+ (car lst) acc))))
  (sum-iter lst 0))`,explanation:"This is a tail-recursive sum function. Like the tail-recursive factorial, it uses an accumulator to carry the partial sum, making the recursive call the last operation."},{description:"Testing the tail-recursive sum:",code:`; Test the tail-recursive sum
(sum-list-tail '(1 2 3 4 5))`,explanation:"This calls our tail-recursive sum function. It computes the same result (15) as the standard version, but can handle very large lists without stack overflow."}],difficulty:"Intermediate"},{id:"continuations",title:"Continuations",content:['Continuations represent "the rest of the computation" at a given point in a program. Scheme provides first-class continuations through the call-with-current-continuation (call/cc) procedure.',"This powerful feature enables advanced control flow patterns like non-local exits, exception handling, coroutines, and even backtracking algorithms. Continuations are one of the most powerful and unique features of Scheme."],codeExamples:[{description:"Early return with call/cc:",code:`; Find first even number in a list
(define (find-first pred lst)
  (call/cc
   (lambda (return)
     (for-each
      (lambda (x)
        (if (pred x)
            (return x)))
      lst)
     #f)))`,explanation:'This function uses call/cc to create an early-return mechanism. The continuation "return" captures the current execution state. When an element satisfying the predicate is found, the continuation is called with that element, immediately jumping out of the for-each loop and returning the value. If no element matches, #f is returned as a default value.'},{description:"Using the find-first function:",code:`; Find first even number
(find-first even? '(1 3 5 6 7 8 9))`,explanation:"This calls our find-first function with the even? predicate and a list of numbers. It searches through the list (1 3 5 6 7 8 9) and returns 6, the first even number it encounters. The early-return mechanism avoids unnecessary iteration through the rest of the list."},{description:"Implementing division with error handling:",code:`; Safe division with continuations
(define (divide a b)
  (call/cc
   (lambda (k)
     (if (= b 0)
         (k '(error "Division by zero"))
         (k \`(ok ,(/ a b)))))))`,explanation:'This function implements safe division using continuations for error handling. The continuation k is used to return early with an error message if b is zero. Otherwise, it returns a list containing the symbol "ok" and the result of the division. This pattern allows for structured error returns without using exceptions.'},{description:"Creating a function to handle the result:",code:`; Function to process the result
(define (handle-result result)
  (if (eq? (car result) 'error)
      (cadr result)
      (cadr result)))`,explanation:'This function processes the result returned by the divide function. It checks if the first element of the result list is the symbol "error". In either case, it returns the second element of the list, which is either the error message or the division result. Note that this implementation would typically have different behavior for error vs. success cases.'},{description:"Testing successful division:",code:`; Successful division
(handle-result (divide 10 2))`,explanation:"This tests the divide function with valid inputs 10 and 2. The divide function returns (ok 5), and handle-result extracts and returns 5."},{description:"Testing division by zero:",code:`; Division by zero
(handle-result (divide 10 0))`,explanation:'This tests the divide function with inputs that would cause division by zero. The divide function returns (error "Division by zero"), and handle-result extracts and returns the error message "Division by zero" instead of causing a runtime error.'}],difficulty:"Advanced"},{id:"vectors",title:"Vectors",content:["Vectors are another important data structure in Scheme. Unlike lists, vectors allow constant-time access to any element by index. They are useful when random access is needed or when dealing with large amounts of data.","Vectors are written with the #(...) syntax and provide operations for creation, access, and modification."],codeExamples:[{description:"Creating a vector:",code:`; Create a vector
(define v #(1 2 3 4 5))
v`,explanation:"This creates a vector with five elements and assigns it to the variable v. Vectors in Scheme use the #(...) literal syntax, which is different from the list syntax. When v is evaluated on the third line, it displays the vector as #(1 2 3 4 5)."},{description:"Finding vector length:",code:`; Get the number of elements
(vector-length v)`,explanation:"The vector-length function returns the number of elements in a vector. For our vector v with elements (1 2 3 4 5), this returns 5. Unlike lists where finding the length requires traversing the entire list, vector length is stored directly and can be accessed in constant time."},{description:"Accessing a vector element:",code:`; Access element at index 2
(vector-ref v 2)`,explanation:"The vector-ref function retrieves an element from a vector at a specified index. Indices in Scheme start at 0, so vector-ref v 2 returns the third element of v, which is 3. This is a constant-time operation, unlike list access which may require traversing the list."},{description:"Creating a vector programmatically:",code:`; Create a vector with initial value 0
(define v2 (make-vector 5 0))
v2`,explanation:"The make-vector function creates a new vector of a specified length with all elements initialized to a given value. This creates a vector of length 5 with each element set to 0, so v2 is #(0 0 0 0 0). This is useful when you need a vector of a specific size but don't know the values yet."},{description:"Modifying a vector element:",code:`; Change element at index 2 to 42
(vector-set! v2 2 42)
v2`,explanation:"The vector-set! function changes an element in a vector at a specified index. The ! in the name indicates that this function modifies its argument. After setting the element at index 2 to 42, v2 becomes #(0 0 42 0 0). Unlike lists, vectors can be efficiently modified in-place without creating a new copy."},{description:"Converting list to vector:",code:`; Convert a list to a vector
(list->vector '(a b c d))`,explanation:"The list->vector function creates a new vector containing the elements of a list. This converts the list (a b c d) to a vector #(a b c d). This conversion is useful when you need faster random access to elements or when using functions that require vectors as input."},{description:"Converting vector to list:",code:`; Convert a vector to a list
(vector->list #(a b c d))`,explanation:"The vector->list function creates a new list containing the elements of a vector. This converts the vector #(a b c d) to a list (a b c d). This conversion is useful when you need to use list-specific functions or when working with code that expects lists as input."}],difficulty:"Intermediate"}]},{id:"io-operations",title:"Input/Output Operations",description:"Learn how to handle input and output in Scheme programs",sections:[{id:"basic-io",title:"Basic Input and Output",content:["Scheme provides a set of procedures for basic input and output operations. These procedures allow you to read from the keyboard, write to the screen, and interact with files.","The most common I/O procedures include display, write, newline for output and read for input. Understanding these basic operations is essential for creating interactive Scheme programs."],codeExamples:[{description:"Writing to the console:",code:`; Display a string
(display "Hello, world!")
(newline)`,explanation:"The display procedure outputs its argument to the console. When displaying strings, the quotes aren't shown in the output. The newline procedure starts a new line, similar to pressing Enter."},{description:"Writing with write:",code:`; Using write instead of display
(write "Hello, world!")
(newline)`,explanation:"The write procedure is similar to display, but it outputs values in a form that can be read back by the Scheme reader. For strings, this means including the quotation marks in the output."},{description:"Reading from the console:",code:`; Read a Scheme expression
(define user-input (read))
; After entering (+ 2 3), user-input contains 5`,explanation:"The read procedure reads a complete Scheme expression from the input and returns it. If the user enters (+ 2 3), Scheme evaluates this to 5 before assigning it to user-input."},{description:"Reading a line of text:",code:`; Read a full line of text
(define line (read-line))`,explanation:"The read-line procedure reads characters until it reaches a newline. Unlike read, it doesn't evaluate what the user enters, but returns it as a string."}],difficulty:"Beginner"},{id:"file-io",title:"File Input and Output",content:["Scheme allows you to read from and write to files using ports. A port is an object that represents a connection to a file or another device.","You can open a file for reading or writing, perform operations on the port, and then close it when you're done. Proper file handling is important for data persistence and processing larger datasets."],codeExamples:[{description:"Opening a file for output:",code:`; Open a file for writing
(define out-port (open-output-file "example.txt"))`,explanation:"The open-output-file procedure opens a file for writing and returns an output port. If the file already exists, it will typically be overwritten (though the exact behavior may depend on the Scheme implementation)."},{description:"Writing to a file:",code:`; Write data to the file
(display "Hello, file!" out-port)
(newline out-port)`,explanation:"The display procedure can take an optional second argument specifying the output port. Here, we're writing to our file port instead of the default console. The newline works similarly."},{description:"Closing an output file:",code:`; Close the output port
(close-output-port out-port)`,explanation:"After writing to a file, it's important to close the port with close-output-port. This ensures all data is properly flushed to the file and system resources are released."},{description:"Opening a file for input:",code:`; Open a file for reading
(define in-port (open-input-file "example.txt"))`,explanation:"The open-input-file procedure opens a file for reading and returns an input port. The file must exist, or an error will be raised."},{description:"Reading from a file:",code:`; Read a line from the file
(define file-line (read-line in-port))`,explanation:"Read operations like read-line can also take an optional port argument. Here, we're reading a line of text from the file instead of from the console."},{description:"Closing an input file:",code:`; Close the input port
(close-input-port in-port)`,explanation:"After reading from a file, it's important to close the port with close-input-port to release system resources."},{description:"Reading an entire file:",code:`; Function to read entire file contents
(define (read-file filename)
  (let ((p (open-input-file filename)))
    (let ((content (read-all p)))
      (close-input-port p)
      content)))

; Helper function to read all expressions
(define (read-all port)
  (let ((data (read port)))
    (if (eof-object? data)
        '()
        (cons data (read-all port)))))`,explanation:"This example defines a function to read the entire contents of a file. It opens the file, reads all expressions until reaching the end-of-file (EOF), closes the port, and returns the content as a list."}],difficulty:"Intermediate"},{id:"string-manipulation",title:"String Manipulation",content:["String manipulation is essential for many programming tasks, especially when dealing with text processing or user input. Scheme provides a set of procedures for creating, combining, and extracting parts of strings.","These operations allow you to build complex string processing functions for tasks like parsing, formatting, or generating text output."],codeExamples:[{description:"Creating a string:",code:`; Creating strings
(define greeting "Hello")
(define name "World")`,explanation:"Strings in Scheme are enclosed in double quotes. Here, we define two string variables for use in our examples."},{description:"Getting string length:",code:`; Find the length of a string
(string-length greeting)`,explanation:'The string-length procedure returns the number of characters in a string. In this case, "Hello" has 5 characters.'},{description:"Concatenating strings:",code:`; Combining strings
(string-append greeting ", " name "!")`,explanation:'The string-append procedure joins multiple strings together. This example combines "Hello", ", ", "World", and "!" to create "Hello, World!".'},{description:"Accessing characters in a string:",code:`; Get a character from a string
(string-ref greeting 1)`,explanation:'The string-ref procedure accesses a specific character in a string by index (starting from 0). string-ref greeting 1 returns the character at index 1 in "Hello", which is #\\e.'},{description:"Creating a string from characters:",code:`; Create a string from individual characters
(string #\\S #\\c #\\h #\\e #\\m #\\e)`,explanation:'The string procedure creates a new string from individual characters. Characters in Scheme are written with the #\\ prefix. This example creates the string "Scheme".'},{description:"Extracting a substring:",code:`; Get part of a string
(substring "Scheme Programming" 0 6)`,explanation:'The substring procedure extracts a portion of a string. It takes three arguments: the string, the start index (inclusive), and the end index (exclusive). This example returns "Scheme".'},{description:"Converting case:",code:`; Convert to uppercase and lowercase
(string-upcase "Hello")
(string-downcase "WORLD")`,explanation:'The string-upcase and string-downcase procedures convert a string to uppercase or lowercase. They return "HELLO" and "world" respectively.'},{description:"Checking string equality:",code:`; Compare strings
(string=? "Scheme" "scheme")
(string-ci=? "Scheme" "scheme")`,explanation:"The string=? procedure checks if two strings are exactly equal (case-sensitive). string-ci=? performs a case-insensitive comparison. The first returns #f (false) while the second returns #t (true)."}],difficulty:"Beginner"}]},{id:"practical-examples",title:"Practical Scheme Examples",description:"Apply Scheme concepts to solve real-world problems",sections:[{id:"data-processing",title:"Data Processing",content:["Data processing is a common task in programming. Scheme's powerful list processing capabilities make it well-suited for manipulating and analyzing structured data.","In this section, we'll see how to use Scheme to process collections of data, perform aggregations, and transform data from one form to another."],codeExamples:[{description:"Defining some sample data:",code:`; Student records: (name score major)
(define students
  '((Alice 95 Computer-Science)
    (Bob 87 Mathematics)
    (Charlie 92 Physics)
    (Diana 97 Computer-Science)
    (Eva 85 Mathematics)))`,explanation:"We define a list of student records, where each record is a list containing a name, score, and major. This represents a typical dataset we might want to process."},{description:"Extracting specific data:",code:`; Get all student names
(define (get-names students)
  (map car students))

(get-names students)`,explanation:"This function uses map with car to extract the first element (name) from each student record. When applied to our dataset, it returns (Alice Bob Charlie Diana Eva)."},{description:"Filtering data:",code:`; Filter Computer Science students
(define (cs-students students)
  (filter (lambda (student)
            (eq? (caddr student) 'Computer-Science))
          students))

(cs-students students)`,explanation:"This function uses filter with a predicate that checks if the third element (major) of each student record is Computer-Science. It returns just the records for Alice and Diana."},{description:"Calculating averages:",code:`; Calculate average score
(define (average-score students)
  (let ((scores (map cadr students)))
    (/ (apply + scores) (length scores))))

(average-score students)`,explanation:"This function calculates the average score of all students. It extracts the scores using map with cadr, then divides the sum (computed with apply +) by the number of scores. For our dataset, it returns 91.2."},{description:"Grouping data:",code:`; Group students by major
(define (group-by-major students)
  (let ((majors (remove-duplicates (map caddr students))))
    (map (lambda (major)
           (cons major
                 (filter (lambda (student)
                           (eq? (caddr student) major))
                         students)))
         majors)))

; Helper function to remove duplicates
(define (remove-duplicates lst)
  (cond ((null? lst) '())
        ((member (car lst) (cdr lst))
         (remove-duplicates (cdr lst)))
        (else (cons (car lst)
                    (remove-duplicates (cdr lst))))))`,explanation:"This function groups students by their major. It first extracts all unique majors, then for each major, creates a pair with the major and a list of all students in that major. The result is a list of major-students pairs."},{description:"Sorting data:",code:`; Sort students by score (descending)
(define (sort-by-score students)
  (sort students
        (lambda (a b) (> (cadr a) (cadr b)))))

(sort-by-score students)`,explanation:"This function sorts the students by their scores in descending order. It uses the sort procedure with a comparison function that compares the second element (score) of each student record."}],difficulty:"Intermediate"},{id:"functional-algorithms",title:"Functional Algorithms",content:["Functional programming excels at expressing algorithms in a clear, concise manner. Scheme's functional nature makes it an excellent language for implementing classic algorithms.","In this section, we'll implement several common algorithms using Scheme's functional programming features, demonstrating how complex operations can be expressed elegantly."],codeExamples:[{description:"Fibonacci sequence (recursive):",code:`; Recursive Fibonacci implementation
(define (fib n)
  (cond ((= n 0) 0)
        ((= n 1) 1)
        (else (+ (fib (- n 1))
                 (fib (- n 2))))))

(fib 10)`,explanation:"This is a classic recursive implementation of the Fibonacci sequence. It directly follows the mathematical definition: fib(n) = fib(n-1) + fib(n-2) with base cases fib(0) = 0 and fib(1) = 1. While elegant, this implementation is inefficient for large n due to repeated calculations."},{description:"Fibonacci sequence (tail-recursive):",code:`; Tail-recursive Fibonacci
(define (fib-tail n)
  (define (fib-iter a b count)
    (if (= count 0)
        a
        (fib-iter b (+ a b) (- count 1))))
  (fib-iter 0 1 n))

(fib-tail 10)`,explanation:"This is an efficient tail-recursive implementation of Fibonacci. It uses an iterative approach with an accumulator pattern, tracking two consecutive Fibonacci numbers at each step. This version uses constant stack space and is much more efficient."},{description:"QuickSort algorithm:",code:`; QuickSort implementation
(define (quicksort lst)
  (if (or (null? lst) (null? (cdr lst)))
      lst
      (let ((pivot (car lst))
            (rest (cdr lst)))
        (append (quicksort (filter (lambda (x) (< x pivot)) rest))
                (list pivot)
                (quicksort (filter (lambda (x) (>= x pivot)) rest))))))

(quicksort '(3 1 4 1 5 9 2 6 5))`,explanation:"This implements the QuickSort algorithm in a functional style. It picks the first element as a pivot, partitions the remaining elements into those less than and greater than or equal to the pivot, recursively sorts each partition, and combines the results. The result for our input is (1 1 2 3 4 5 5 6 9)."},{description:"Binary search:",code:`; Binary search in a sorted list
(define (binary-search lst item)
  (define (search low high)
    (if (> low high)
        #f  ; Not found
        (let* ((mid (quotient (+ low high) 2))
               (mid-val (list-ref lst mid)))
          (cond ((= mid-val item) mid)  ; Found, return index
                ((< mid-val item) (search (+ mid 1) high))
                (else (search low (- mid 1)))))))
  (search 0 (- (length lst) 1)))

(binary-search '(1 3 5 7 9 11 13) 7)`,explanation:"This implements binary search, an efficient algorithm for finding an item in a sorted list. It repeatedly divides the search range in half, eliminating half of the remaining elements at each step. If the item is found, it returns its index; otherwise, it returns #f. For our example, it returns 3 (the index of 7)."},{description:"Merge sort:",code:`; Merge sort implementation
(define (merge-sort lst)
  (define (merge lst1 lst2)
    (cond ((null? lst1) lst2)
          ((null? lst2) lst1)
          ((< (car lst1) (car lst2))
           (cons (car lst1) (merge (cdr lst1) lst2)))
          (else
           (cons (car lst2) (merge lst1 (cdr lst2))))))
  
  (define (split lst)
    (if (or (null? lst) (null? (cdr lst)))
        (values lst '())
        (let-values (((first-half second-half)
                      (split (cddr lst))))
          (values (cons (car lst) first-half)
                  (cons (cadr lst) second-half)))))
  
  (if (or (null? lst) (null? (cdr lst)))
      lst
      (let-values (((first-half second-half) (split lst)))
        (merge (merge-sort first-half)
               (merge-sort second-half)))))

(merge-sort '(3 1 4 1 5 9 2 6 5))`,explanation:"This implements the merge sort algorithm. It recursively splits the list into two halves, sorts each half, and then merges the sorted halves. The merge operation takes two sorted lists and combines them into a single sorted list. Merge sort has better worst-case performance than quicksort and is stable, meaning it preserves the relative order of equal elements."}],difficulty:"Advanced"},{id:"building-dsl",title:"Building Domain-Specific Languages",content:["One of Scheme's strengths is its ability to extend the language through macros, making it ideal for creating domain-specific languages (DSLs). DSLs are specialized languages designed for a particular application domain.","By building a DSL, you can create abstractions that match the concepts in your problem domain, making your code more readable and maintainable. Scheme's macro system enables powerful DSL construction."],codeExamples:[{description:"A simple query language:",code:`(import jawslist)
; Define a simple SQL-like query language
(define-syntax select
  (syntax-rules (from where)
    ((select fields from table where condition)
     (map fields (filter condition table)))
    ((select fields from table)
     (map fields table))))

; Sample data
(define people
  '((name "Alice" age 30 city "New York")
    (name "Bob" age 25 city "Boston")
    (name "Charlie" age 35 city "New York")
    (name "Diana" age 28 city "Boston")))

; Use our DSL
(select (lambda (p) (list (cadr p) (cadddr p)))
        from people
        where (lambda (p) (> (cadddr p) 27)))`,explanation:"This example creates a simple SQL-like DSL for querying data. The select macro takes field selectors, a data source, and an optional condition. It transforms these into appropriate map and filter operations. In this example, we select the name and age of people older than 27, resulting in a list of (name age) pairs."},{description:"A DSL for mathematical expressions:",code:`; Define a mathematics DSL
(define-syntax sum
  (syntax-rules (to)
    ((sum var from start to end expr)
     (let loop ((var start) (result 0))
       (if (> var end)
           result
           (loop (+ var 1) (+ result expr)))))))

; Calculate the sum of squares from 1 to 5
(sum i from 1 to 5 (* i i))`,explanation:"This example creates a DSL for mathematical summations. The sum macro takes a variable, a range, and an expression to evaluate for each value in the range. It transforms this high-level notation into an efficient iterative computation. In this example, we calculate the sum of squares from 1 to 5, which is 1²+2²+3²+4²+5² = 55."},{description:"A DSL for pattern matching:",code:`; Define a pattern matching DSL
(define-syntax match
  (syntax-rules (else)
    ((match value
       (pattern1 expr1)
       (pattern2 expr2) ...)
     (let ((val value))
       (cond
        ((equal? val pattern1) expr1)
        ((equal? val pattern2) expr2) ...)))
    
    ((match value
       (pattern1 expr1)
       (pattern2 expr2) ...
       (else default-expr))
     (let ((val value))
       (cond
        ((equal? val pattern1) expr1)
        ((equal? val pattern2) expr2) ...
        (else default-expr))))))

; Use our pattern matching DSL
(define (factorial n)
  (match n
    (0 1)
    (1 1)
    (else (* n (factorial (- n 1))))))

; Call the factorial function
(factorial 5)`,explanation:"This example creates a DSL for pattern matching, a common feature in functional languages. The match macro takes a value and a series of pattern-expression pairs, matching the value against each pattern in turn. This allows for clear, declarative code. We use it to implement factorial with explicit base cases, then call it with the value 5 to calculate 5! = 120."},{description:"A DSL for data validation:",code:`; Define a data validation DSL
(define-syntax validate
  (syntax-rules (is length > <)
    ((validate value is number)
     (number? value))
    ((validate value is string)
     (string? value))
    ((validate value length > min)
     (and (or (string? value) (list? value) (vector? value))
          (> (length value) min)))
    ((validate value length < max)
     (and (or (string? value) (list? value) (vector? value))
          (< (length value) max)))))

; Test our validation DSL
(define data "test")
(and (validate data is string)
     (validate data length > 2)
     (validate data length < 10))`,explanation:"This example creates a DSL for data validation. The validate macro provides a readable syntax for common validation tasks. It transforms these high-level descriptions into the appropriate Scheme predicates. In this example, we check if data is a string between 3 and 9 characters long."}],difficulty:"Advanced"}]},{id:"loop-constructs",title:"Loop Constructs",description:"Explore various looping mechanisms and iteration patterns in Scheme",sections:[{id:"basic-loops",title:"Basic Looping Constructs",content:["While Scheme is primarily a functional language that encourages recursion, looping constructs can make certain algorithmic patterns more readable and intuitive. Scheme's macro system allows us to define custom loop constructs that provide convenient syntactic forms for common iteration patterns.","In this section, we'll explore basic looping constructs like while, until, and do-while, which mirror similar constructs in other programming languages but with Scheme's distinctive syntax and semantics."],codeExamples:[{description:"The while loop:",code:`; Define a counter
(define counter 1)

; Count from 1 to 5 using while
(while (<= counter 5)
  (display counter)
  (display " ")
  (set! counter (+ counter 1)))`,explanation:"The while macro repeatedly executes its body as long as the condition remains true. Here we count from 1 to 5, displaying each number. Behind the scenes, this is implemented as a named let loop that conditionally recurses."},{description:"The until loop:",code:`; Define a counter
(define counter 1)

; Count from 1 to 5 using until
(until (> counter 5)
  (display counter)
  (display " ")
  (set! counter (+ counter 1)))`,explanation:"The until macro is the logical complement of while - it continues looping as long as the condition is false. This example produces the same output as the while example, but the termination condition is inverted."},{description:"The do-while loop:",code:`; Define a counter
(define counter 6)

; Try to count from 6 to 5 (impossible, but body executes once)
(do-while (< counter 5)
  (display counter)
  (display " ")
  (set! counter (+ counter 1)))`,explanation:'The do-while macro guarantees that its body executes at least once, even if the condition is false initially. In this example, even though counter is already 6 (which exceeds our limit of 5), the body still executes once, displaying "6 ".'},{description:"Implementing a simple loop:",code:`; Compute factorial using a while loop
(define (factorial n)
  (let ((result 1)
        (i 1))
    (while (<= i n)
      (set! result (* result i))
      (set! i (+ i 1)))
    result))

(factorial 5)`,explanation:"This example implements the factorial function using a while loop instead of recursion. We initialize result to 1 and i to 1, then multiply result by i for each value from 1 to n. The factorial of 5 is 120."}],difficulty:"Beginner"},{id:"list-iteration",title:"Iterating Over Lists",content:["Scheme excels at list processing, and its functional nature provides elegant ways to operate on lists. However, sometimes a more imperative style of iteration can be clearer, especially for those coming from other programming paradigms.","In this section, we'll explore macros that provide convenient syntax for iterating over lists, including for loops with various configurations and specialized iterators that expose element indices."],codeExamples:[{description:"The for loop:",code:`(import loops)
; Simple list of numbers
(define numbers '(1 2 3 4 5))

; Square each number using for
(for x in numbers
  (* x x))`,explanation:"The for macro provides a simple way to iterate over a list. Here we square each number in the list. Note that for is implemented using map, so it returns a new list containing the results of applying the body expression to each element. The result is (1 4 9 16 25)."},{description:"Alternative for syntax:",code:`(import loops)
; Using the alternative "as" syntax
(for numbers as x
  (* x x))`,explanation:'The for macro supports an alternative syntax where the list comes first, followed by "as" and the element variable. This can be more readable in some cases, especially with complex list expressions. The result is the same: (1 4 9 16 25).'},{description:"The for-each-with-index macro:",code:`
(import loops); Print each element with its index
(for-each-with-index (element index) in '(a b c d e)
  (display "Element at index ")
  (display index)
  (display ": ")
  (display element)
  (newline))`,explanation:"The for-each-with-index macro iterates over a list, providing both the current element and its index for each iteration. Unlike for, it does not collect return values, making it suitable for side effects like displaying output."},{description:"Processing list elements:",code:`
(import loops); Find the sum and product of a list
(define (sum-and-product numbers)
  (let ((sum 0)
        (product 1))
    (for-each-with-index (num _) in numbers
      (set! sum (+ sum num))
      (set! product (* product num)))
    (list sum product)))

(sum-and-product '(1 2 3 4 5))`,explanation:"This example uses for-each-with-index to calculate both the sum and product of a list of numbers. We use _ as a placeholder for the index since we don't need it. The result is (15 120), representing the sum and product of 1 through 5."}],difficulty:"Beginner"},{id:"numeric-iteration",title:"Numeric Iteration Patterns",content:["Many algorithms involve iterating over ranges of numbers. While this can be done with basic loops and manual counters, dedicated numeric iteration constructs make the code more concise and readable.","This section covers various forms of numeric iteration, including range-based loops, repeat loops for fixed-count iteration, and loops with custom step sizes."],codeExamples:[{description:"The repeat macro:",code:`(import loops)
 Display "Hello" 3 times
(repeat 3
  (display "Hello")
  (newline))`,explanation:`The repeat macro executes its body a fixed number of times. It's useful when you need to perform an operation repeatedly without needing a loop variable. Here, it displays "Hello" three times.`},{description:"The for-range macro:",code:`
(import loops); Display numbers from 1 to 5
(for-range i 1 5
  (display i)
  (display " "))`,explanation:"The for-range macro provides a convenient way to iterate over a range of numbers. It takes a variable name, starting value, and ending value (inclusive). This example displays the numbers 1 through 5."},{description:"The iterate macro with custom step:",code:`
(import loops); Display even numbers from 2 to 10
(iterate i from 2 to 10 by 2
  (display i)
  (display " "))`,explanation:"The iterate macro extends for-range by adding the ability to specify a custom step size. This example counts by 2s, displaying only even numbers from 2 to 10."},{description:"Computing a sum using for-range:",code:`; Calculate the sum of numbers from 1 to 10
(define (sum-range from to)
  (let ((result 0))
    (for-range i from to
      (set! result (+ result i)))
    result))

(sum-range 1 10)`,explanation:"This example uses for-range to calculate the sum of integers from 1 to 10. We initialize result to 0, then add each number in the range to it. The sum of 1 to 10 is 55."}],difficulty:"Beginner"},{id:"nested-loops",title:"Nested and Advanced Loop Patterns",content:["Many algorithms require nested loops or more complex iteration patterns. Scheme's macro system allows us to create specialized constructs that express these patterns clearly and concisely.","This section explores nested loops, fold-like accumulation patterns, and pattern-matching based control flow that combines selection and iteration."],codeExamples:[{description:"The nested-loop macro:",code:`; Print a multiplication table from 1×1 to 3×3
(nested-loop (outer i 1 3)
             (inner j 1 3)
  (display i)
  (display "×")
  (display j)
  (display "=")
  (display (* i j))
  (newline))`,explanation:"The nested-loop macro provides a clean syntax for nested iterations, which are common in many algorithms. This example generates a small multiplication table, with the outer loop iterating over values for i and the inner loop iterating over values for j."},{description:"The fold-loop pattern:",code:`; Calculate the sum of a list using fold-loop
(define numbers '(1 2 3 4 5))

(fold-loop sum init 0 in numbers
  (+ sum element))`,explanation:"The fold-loop macro combines iteration with accumulation, similar to a fold/reduce operation. It maintains an accumulator that is updated at each step based on the current element. This example calculates the sum of a list of numbers, starting with an initial value of 0."},{description:"The select-case construct:",code:`; Process different types of data
(define (process-item item)
  (select-case (car item)
    ((number) (display "Processing number: ")
               (display (cadr item)))
    ((string) (display "Processing string: ")
               (display (string-upcase (cadr item))))
    ((list)   (display "Processing list of length: ")
               (display (length (cadr item))))
    (else     (display "Unknown item type"))))

(process-item '(number 42))
(newline)
(process-item '(string "hello"))`,explanation:"The select-case macro combines pattern matching with control flow, allowing you to execute different code based on the structure or value of data. This example processes different types of items, displaying different information depending on whether the item is a number, string, or list."},{description:"Building a matrix with nested loops:",code:`; Create a 3×3 identity matrix
(define (make-identity-matrix size)
  (let ((matrix (make-vector size)))
    (for-range i 0 (- size 1)
      (vector-set! matrix i (make-vector size 0)))
    (for-range i 0 (- size 1)
      (vector-set! (vector-ref matrix i) i 1))
    matrix))

; Display a matrix
(define (display-matrix matrix)
  (let ((size (vector-length matrix)))
    (for-range i 0 (- size 1)
      (for-range j 0 (- size 1)
        (display (vector-ref (vector-ref matrix i) j))
        (display " "))
      (newline))))

(define identity-3 (make-identity-matrix 3))
(display-matrix identity-3)`,explanation:"This example uses nested for-range loops to create and display a 3×3 identity matrix (a matrix with 1s on the diagonal and 0s elsewhere). The make-identity-matrix function first creates a vector of vectors filled with zeros, then sets the diagonal elements to 1. The display-matrix function uses nested loops to print the matrix rows."}],difficulty:"Intermediate"},{id:"loop-implementation",title:"Implementing Loop Constructs",content:["Understanding how loop constructs are implemented as macros provides insight into Scheme's macro system and helps you create your own control structures. Most loops in Scheme are built on top of recursion, leveraging Scheme's tail-call optimization.","This section examines the implementation of various loop macros, showing how they transform high-level loop syntax into recursive procedures."],codeExamples:[{description:"Implementation of the while macro:",code:`; Definition of the while macro
(define-syntax while
  (syntax-rules ()
    ((while condition body ...)
     (let loop ()
       (if condition
           (begin
             body ...
             (loop))
           #f)))))`,explanation:"The while macro transforms its high-level loop syntax into a named let expression that implements a tail-recursive loop. If the condition is true, it executes the body expressions and then recurses by calling loop again. If the condition is false, it returns #f (though the return value is typically ignored)."},{description:"Implementation of the for macro:",code:`; Definition of the for macro
(define-syntax for
  (syntax-rules (in as)
    ((for element in list body ...)
     (map (lambda (element)
            body ...)
          list))
    ((for list as element body ...)
     (for element in list body ...))))`,explanation:'The for macro uses map to apply a lambda function to each element in a list. The lambda takes the element variable as its parameter and executes the body expressions. The macro supports two syntax forms: "for element in list" and "for list as element". Unlike imperative for loops, this is a functional construct that returns a new list of results.'},{description:"Implementation of the for-range macro:",code:`; Definition of the for-range macro
(define-syntax for-range
  (syntax-rules ()
    ((for-range var from to body ...)
     (let loop ((var from))
       (when (<= var to)
         body ...
         (loop (+ var 1)))))))`,explanation:"The for-range macro also uses a named let to create a recursive loop, but it manages the loop variable explicitly. It initializes var to the starting value, executes the body as long as var is less than or equal to the ending value, and increments var before each recursive call."},{description:"Implementing a custom loop macro:",code:`; Define a countdown macro
(define-syntax countdown
  (syntax-rules (from to)
    ((countdown var from start to end body ...)
     (let loop ((var start))
       (when (>= var end)
         body ...
         (loop (- var 1)))))))

; Use the countdown macro
(countdown i from 5 to 1
  (display i)
  (display " "))`,explanation:'This example shows how to implement a custom countdown macro that counts downward instead of upward. Like for-range, it uses a named let, but it decreases the loop variable and continues as long as it remains greater than or equal to the end value. This displays "5 4 3 2 1 ".'},{description:"A more complex loop implementation:",code:`; Define a "times" macro that returns a list of results
(define-syntax times
  (syntax-rules (collect)
    ((times n collect expr)
     (let loop ((i 0) (results '()))
       (if (= i n)
           (reverse results)
           (loop (+ i 1) (cons expr results)))))))

; Use the times macro to create a list of squares
(times 5 collect (* i i))`,explanation:'This example implements a "times" macro that not only repeats an operation n times but also collects the results into a list. It maintains an accumulator called results which it builds in reverse order (for efficiency), then reverses at the end. This returns (0 1 4 9 16), the squares of 0 through 4.'}],difficulty:"Advanced"}]}];function OA(){const[n,e]=S.useState(Xo[0]),[t,i]=S.useState(Xo[0].sections[0]),r=S.useRef(null),s=Ti(),o=Za(),l=async c=>{if(c&&r.current){r.current.setInput(c),r.current.writeInput(c);try{const h=await a(c);r.current.writeOutput(h)}catch(h){r.current.writeOutput(`Error: ${h instanceof Error?h.message:String(h)}`)}r.current.clearInput()}},a=async c=>{if(o.loading)return"Loading JAWS interpreter...";if(o.error)return`Interpreter error: ${o.error}`;try{return o.evaluate(c)}catch(h){return console.error("Evaluation error:",h),`Error: ${h instanceof Error?h.message:String(h)}`}};return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-blue-900 flex flex-col",children:[g.jsxs("div",{className:"flex border-b border-blue-700/30 bg-slate-900/80 p-4 items-center gap-2",children:[g.jsx(Te,{variant:"ghost",size:"icon",onClick:()=>s("/"),className:"text-white hover:bg-blue-800/30",children:g.jsx(zu,{className:"h-5 w-5"})}),g.jsxs("h1",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[g.jsx(_t,{className:"h-5 w-5 text-cyan-400"}),"Learn Scheme"]})]}),g.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[g.jsxs("div",{className:"w-80 border-r border-blue-700/30 bg-slate-900/80 flex flex-col overflow-hidden",children:[g.jsx("div",{className:"p-4 border-b border-blue-700/30 bg-gradient-to-r from-slate-900 to-blue-900",children:g.jsx("h2",{className:"text-lg font-semibold text-white",children:"Curriculum"})}),g.jsx("div",{className:"flex-1 overflow-auto scrollbar-thin scrollbar-thumb-blue-500/50 scrollbar-track-transparent",children:Xo.map((c,h)=>g.jsxs("div",{className:"border-b border-blue-800/30 animate-fadeScale",style:{animationDelay:`${h*.1}s`},children:[g.jsxs("button",{onClick:()=>{e(c),i(c.sections[0])},className:`w-full text-left p-4 transition-colors hover:bg-blue-800/20 ${n.id===c.id?"bg-gradient-to-r from-blue-900 to-blue-800 text-white":"text-blue-100/70 hover:text-white"}`,children:[g.jsx("h3",{className:"font-medium text-current",children:c.title}),g.jsx("p",{className:"text-sm mt-1 opacity-80 text-current",children:c.description})]}),n.id===c.id&&g.jsx("div",{className:"bg-blue-900/20 border-t border-blue-700/30",children:c.sections.map(u=>g.jsxs("button",{onClick:()=>i(u),className:`w-full text-left p-3 pl-8 text-sm transition-colors flex items-center ${t.id===u.id?"bg-blue-800/30 text-white":"text-blue-100/70 hover:bg-blue-800/30 hover:text-white"}`,children:[t.id===u.id&&g.jsx(_t,{className:"h-3.5 w-3.5 text-[#dd3f0c] mr-1.5 flex-shrink-0"}),g.jsx("span",{className:"text-current",children:u.title})]},u.id))})]},c.id))})]}),g.jsxs("div",{className:"flex-1 grid md:grid-cols-2 divide-x divide-blue-700/30 overflow-hidden",children:[g.jsxs("div",{className:"overflow-auto p-8 bg-slate-900/70 animate-fadeSlideIn",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[g.jsx("h1",{className:"text-2xl font-semibold text-white",children:t.title}),g.jsx(Um,{difficulty:t.difficulty})]}),g.jsx("div",{className:"prose prose-invert max-w-none text-white",children:Array.isArray(t.content)?t.content.map((c,h)=>g.jsx("p",{className:"text-blue-100/90",children:c},h)):g.jsx("p",{className:"text-blue-100/90",children:t.content})}),t.codeExamples&&t.codeExamples.length>0&&g.jsx("div",{className:"mt-6 space-y-8",children:t.codeExamples.map((c,h)=>g.jsx("div",{className:"animate-fadeScale",style:{animationDelay:`${h*.1+.2}s`},children:g.jsxs(Gs,{className:"bg-zinc-800/80 border-blue-700/30 overflow-hidden shadow-lg",children:[g.jsxs(ca,{className:"pb-2 text-left",children:[g.jsxs(ha,{className:"tracking-tight text-lg font-semibold text-white flex items-center gap-2 justify-start",children:[g.jsx(_t,{className:"h-4 w-4",style:{color:"#22d3ee"}}),c.description]}),g.jsx(ua,{className:"text-blue-100 mt-1 text-base",children:c.explanation})]}),g.jsxs(Js,{className:"border-t border-blue-800/30 p-4",children:[g.jsx("div",{className:"font-mono text-sm text-blue-100 overflow-x-auto",children:g.jsx(Dt,{text:c.code,type:"input"})}),g.jsx("div",{className:"mt-4 flex justify-end",children:g.jsxs(Te,{className:"bg-[#dd3f0c] hover:bg-[#dd3f0c]/90 text-white hover:-translate-y-1 transition-all duration-200 flex items-center gap-2 shadow-lg",onClick:()=>l(c.code),disabled:o.loading,children:[o.loading?"Loading Interpreter...":"Run Example"," ",g.jsx(ys,{className:"h-4 w-4"})]})})]})]})},`code-${t.id}-${h}`))})]}),g.jsx("div",{className:"bg-zinc-900 border-l border-blue-700/30 overflow-hidden animate-fadeScale animation-delay-300",children:o.loading?g.jsx("div",{className:"flex items-center justify-center h-full text-blue-300",children:g.jsx("p",{children:"Loading JAWS interpreter..."})}):o.error?g.jsx("div",{className:"flex items-center justify-center h-full text-red-400",children:g.jsxs("p",{children:["Error loading interpreter: ",o.error]})}):g.jsx(Qa,{ref:r,onCommand:a,className:"h-full"})})]})]}),g.jsx(Xs,{})]})}function LA(){return g.jsx(P0,{basename:"/Jaws",children:g.jsxs(h0,{children:[g.jsx(An,{path:"/",element:g.jsx(yx,{})}),g.jsxs(An,{element:g.jsx(vx,{}),children:[g.jsx(An,{path:"/compiler-explorer",element:g.jsx(NA,{})}),g.jsx(An,{path:"/editor",element:g.jsx(AA,{})}),g.jsx(An,{path:"/examples",element:g.jsx(TA,{})}),g.jsx(An,{path:"/learn",element:g.jsx(OA,{})})]})]})})}ju(document.getElementById("root")).render(g.jsx(S.StrictMode,{children:g.jsx(LA,{})}));
